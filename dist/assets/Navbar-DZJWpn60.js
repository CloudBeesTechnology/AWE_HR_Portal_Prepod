import{l as e,L as x,w as z,r as l,y as R}from"./index-XU-YZIKh.js";import{O as U,F as q,P as W,Q as G,A as H,R as J,E as Q}from"./index-CaMUU3xE.js";import{c as Y,l as B}from"./logo-with-name-TLdizOyj.js";const K=({setIsOpen:u,profilePhoto:i,name:j,email:h,contactNo:s})=>{const p=async()=>{try{await q(),localStorage.removeItem("userID"),localStorage.removeItem("userType"),window.location.href="/login"}catch(n){console.log("Error signing out",n)}};return e.jsxs("section",{children:[e.jsxs("div",{className:"center flex-col gap-2 py-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"max-w-10 h-10 w-full rounded-full relative overflow-hidden shadow-md shadow-[#00000033]",children:e.jsx("img",{className:"w-full object-cover",src:i,alt:"avatar not found"})}),e.jsx("p",{className:"absolute -right-2 bottom-0 h-5 w-5 rounded-full bg-[#D9D9D9] center",children:e.jsx(Y,{className:"text-xs text-dark_grey"})})]}),e.jsx(x,{to:"/personalInformation",className:"text-xs text-dark_grey",onClick:()=>{u(!1)},children:"Personal Info Edit"}),e.jsx("div",{className:"h-1 w-full bg-[#AAAAAA]"})]}),e.jsxs("div",{className:"space-y-2 mb-3 px-4",children:[e.jsxs("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[e.jsx("label",{htmlFor:"name",className:"font-medium ",children:"Name"}),e.jsx("div",{className:"border flex-1 rounded-md border-[#d4cfcf]  px-2 py-1 ",children:e.jsx("input",{id:"name",className:"outline-none w-full",type:"text",value:j,readOnly:!0})})]}),e.jsxs("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[e.jsx("label",{htmlFor:"phoneNo",className:"font-medium ",children:"Phone Number"}),e.jsx("div",{className:"border rounded-md border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-1 ",children:e.jsx("input",{id:"phoneNo",className:"outline-none w-full",type:"text",value:s,readOnly:!0})})]}),e.jsxs("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[e.jsx("label",{htmlFor:"email",className:"font-medium ",children:"Email"}),e.jsx("div",{className:"border rounded-md border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-1 ",children:e.jsx("input",{id:"email",className:"outline-none w-full",type:"text",value:h,readOnly:!0})})]}),e.jsxs("div",{className:"flex justify-between text-xs text-dark_grey font-semibold pt-3",children:[e.jsx(x,{to:"/changePassword",className:"py-1 px-2 border-2 rounded-md border-primary ",children:"Change Password"}),e.jsxs(x,{className:"flex items-center gap-1 py-1 px-2 bg-primary  rounded-md ",onClick:p,children:["Logout",e.jsx("span",{children:e.jsx(U,{className:"text-lg text-dark_grey"})})]})]})]})]})},V=z(),te=()=>{const[u,i]=l.useState(!1),[j,h]=l.useState(""),[s,p]=l.useState({profilePhoto:"",name:"",email:"",contactNo:""}),[n,S]=l.useState(""),y=()=>{i(t=>!t)},f=l.useRef(null),v=t=>{f.current&&!f.current.contains(t.target)&&i(!1)};l.useEffect(()=>{const t=localStorage.getItem("userType");return h(t),document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);const c=new Date,k=c.getDate(),E=c.getMonth()+1,O=c.getFullYear(),_=`${k}/${E}/${O}`;let o=c.getHours();const g=c.getMinutes(),N=c.getSeconds(),$=o>=12?"PM":"AM";o=o%12,o=o||12;const C=g<10?"0"+g:g,M=N<10?"0"+N:N,L=`${o}:${C}:${M} ${$}`;return setInterval(()=>{},100),l.useEffect(()=>{const t=localStorage.getItem("userID");S(t)},[]),l.useEffect(()=>{n&&(async()=>{var w,b,F;try{const d=await V.graphql({query:R}),I=((b=(w=d==null?void 0:d.data)==null?void 0:w.listEmpPersonalInfos)==null?void 0:b.items)||[];if(I.length===0)return;const r=I.find(P=>P.empID.toLowerCase()===n.toLowerCase());if(r){let a=(r==null?void 0:r.profilePhoto).replace(/=/g,":");a=a.replace(/(\w+)(?=:)/g,'"$1"'),a=a.replace(new RegExp("(?<=:)([^,}\\]]+)(?=[,\\}\\]])","g"),'"$1"'),a.startsWith("[")||(a=`[${a}]`);let m=[];try{m=JSON.parse(a)}catch{}const A=(F=m==null?void 0:m[m.length-1])==null?void 0:F.upload;(async D=>{const T=await Q({path:D});return p({profilePhoto:T.url.toString(),name:r.name,email:r.email,contactNo:r.contactNo||""})})(A)}else console.log(`No matching employee found for userID: ${n}`)}catch(d){console.log("Error fetching employee personal infos:",d)}})()},[n]),e.jsx("nav",{className:"center bg-medium_white h-28 fixed top-0 w-full z-50 shadow-sm",children:e.jsxs("div",{className:"screen-size flex justify-between items-center gap-10 py-7 px-3",children:[e.jsx("section",{className:"flex-initial",children:e.jsx("div",{className:"max-w-[250px] w-full",children:e.jsx("img",{className:"w-full",src:B,alt:"not found"})})}),e.jsxs("section",{className:"flex-initial flex item-center gap-5 ",children:[e.jsx("div",{className:"my-auto px-2",children:e.jsx("span",{children:e.jsx(W,{className:"text-2xl"})})}),e.jsx("div",{className:" my-auto",children:e.jsxs("p",{className:"relative",children:[e.jsxs(x,{to:"/notifications",children:[" ",e.jsx(G,{className:"text-2xl"})]}),e.jsxs("span",{className:"absolute -top-3 -right-3 rounded-full h-5 w-5 text-dark_grey bg-primary text-xs center",children:["1"," "]})]})}),e.jsxs("div",{className:"flex items-center gap-5 px-5",children:[e.jsxs("div",{className:"space-y-2 ",children:[e.jsxs("p",{className:"text-dark_grey text_size_5",children:[" ","Welcome ",s.name]}),e.jsxs("article",{className:"flex gap-5 text_size_7 text-dark_grey",children:[e.jsx("p",{children:_}),e.jsx("p",{children:L})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"max-w-10 h-10 w-full rounded-full relative overflow-hidden shadow-md shadow-[#00000033]",onClick:()=>y(),children:e.jsx("img",{className:"w-full object-cover",src:s.profilePhoto||H,alt:"avatar not found"})}),e.jsx("p",{className:"absolute -right-2 bottom-0 h-5 w-5 rounded-full bg-[#D9D9D9] center",onClick:()=>y(),children:e.jsx(J,{className:"text-xs text-dark_grey"})})]}),u&&e.jsx("div",{ref:f,className:"absolute top-12 -left-40 bg-white shadow-md  py-2 text-dark_grey text-[15px]  w-[250px]  flex flex-col",children:e.jsx(K,{setIsOpen:i,name:s.name,email:s.email,profilePhoto:s.profilePhoto,contactNo:s.contactNo})})]})]})]})]})})};export{te as default};
