(self.webpackChunkcheckingproject=self.webpackChunkcheckingproject||[]).push([[401],{817:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>TrainingCertifyMD});var E_arthi_Web_Project_awe_adinin_1_AWE_HR_Portal_Prepod_main_AWE_HR_Portal_Prepod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9379),axios__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9722),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5043),xlsx__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1238),_utils_DataStoredContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1444),_services_createMethod_TCDataFun__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4791),_services_updateMethod_TCDataUpdate__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(940),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(579);const TrainingCertifyMD=()=>{const{trainingCertifi:trainingCertifi}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_utils_DataStoredContext__WEBPACK_IMPORTED_MODULE_1__.Y),{TCData:TCData}=(0,_services_createMethod_TCDataFun__WEBPACK_IMPORTED_MODULE_2__.Z)(),{TCDataFunUp:TCDataFunUp}=(0,_services_updateMethod_TCDataUpdate__WEBPACK_IMPORTED_MODULE_3__.P)();console.log(trainingCertifi);const excelDateToJSDate=e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)},fetchExcelFile=async()=>{try{const response=await axios__WEBPACK_IMPORTED_MODULE_5__.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/Training+Data/trainingCertifi+OME+Prod.csv",{responseType:"arraybuffer"}),data=new Uint8Array(response.data),workbook=xlsx__WEBPACK_IMPORTED_MODULE_6__.LF(data,{type:"array"}),firstSheetName=workbook.SheetNames[0],firstSheet=workbook.Sheets[firstSheetName],sheetData=xlsx__WEBPACK_IMPORTED_MODULE_6__.Wp.sheet_to_json(firstSheet,{header:1}),dateKeys=["certifiExpiry","eCertifiDate","orgiCertifiDate"],transformedData=sheetData.slice(1).map((e=>{let t={};return sheetData[0].forEach(((a,r)=>{let n=e[r];dateKeys.includes(a)&&!isNaN(n)&&(n=excelDateToJSDate(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const TCValue of transformedData){if(!TCValue.empID)continue;TCValue.empID&&(TCValue.empID=String(TCValue.empID));const checkingBJLTable=trainingCertifi.find((e=>e.empID===TCValue.empID));if(checkingBJLTable){const existingProof=JSON.parse(checkingBJLTable.trainingProof),convterEval=eval(existingProof),newProof=eval(TCValue.trainingProof),mergedProof=[...convterEval,...newProof],mergedProofStr=JSON.stringify(mergedProof),TCDataUp=(0,E_arthi_Web_Project_awe_adinin_1_AWE_HR_Portal_Prepod_main_AWE_HR_Portal_Prepod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__.A)((0,E_arthi_Web_Project_awe_adinin_1_AWE_HR_Portal_Prepod_main_AWE_HR_Portal_Prepod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__.A)({},TCValue),{},{id:checkingBJLTable.id,trainingProof:mergedProofStr});await TCDataFunUp({TCDataUp:TCDataUp})}else await TCData({TCValue:TCValue})}}catch(error){console.error("Error fetching Excel file:",error)}};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"flex flex-col gap-40",children:["TrainingCertifyMD",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{onClick:fetchExcelFile,children:"Click Here"})]})}},8585:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>TriningReqMD});var E_arthi_Web_Project_awe_adinin_1_AWE_HR_Portal_Prepod_main_AWE_HR_Portal_Prepod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9379),axios__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9722),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5043),xlsx__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1238),_utils_DataStoredContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1444),_services_createMethod_AddEmpFun__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5765),_services_updateMethod_AddEmpReqUp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4954),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(579);const TriningReqMD=()=>{const{AddEmpReq:AddEmpReq}=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_utils_DataStoredContext__WEBPACK_IMPORTED_MODULE_1__.Y),{AddEmpData:AddEmpData}=(0,_services_createMethod_AddEmpFun__WEBPACK_IMPORTED_MODULE_2__.r)(),{TrReqUp:TrReqUp}=(0,_services_updateMethod_AddEmpReqUp__WEBPACK_IMPORTED_MODULE_3__.J)();console.log(AddEmpReq);const excelDateToJSDate=e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)},fetchExcelFile=async()=>{try{const response=await axios__WEBPACK_IMPORTED_MODULE_5__.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/Training+Data/TrainingReq+OME+Prod.csv",{responseType:"arraybuffer"}),data=new Uint8Array(response.data),workbook=xlsx__WEBPACK_IMPORTED_MODULE_6__.LF(data,{type:"array"}),firstSheetName=workbook.SheetNames[0],firstSheet=workbook.Sheets[firstSheetName],sheetData=xlsx__WEBPACK_IMPORTED_MODULE_6__.Wp.sheet_to_json(firstSheet,{header:1}),dateKeys=["traineeED","traineeSD","medicalAppointDate","medicalExpiry",""],transformedData=sheetData.slice(1).map((e=>{let t={};return sheetData[0].forEach(((a,r)=>{let n=e[r];dateKeys.includes(a)&&!isNaN(n)&&(n=excelDateToJSDate(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const AddEmpValue of transformedData){if(!AddEmpValue.empID)continue;AddEmpValue.empID&&(AddEmpValue.empID=String(AddEmpValue.empID));const checkingBJLTable=AddEmpReq.find((e=>e.empID===AddEmpValue.empID));if(checkingBJLTable){const existingProof=JSON.parse(checkingBJLTable.traineeTrack),convterEval=eval(existingProof),newProof=eval(AddEmpValue.traineeTrack),mergedProof=[...convterEval,...newProof],mergedProofStr=JSON.stringify(mergedProof),TMRDataUp=(0,E_arthi_Web_Project_awe_adinin_1_AWE_HR_Portal_Prepod_main_AWE_HR_Portal_Prepod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__.A)((0,E_arthi_Web_Project_awe_adinin_1_AWE_HR_Portal_Prepod_main_AWE_HR_Portal_Prepod_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_7__.A)({},AddEmpValue),{},{id:checkingBJLTable.id,traineeTrack:mergedProofStr});await TrReqUp({TMRDataUp:TMRDataUp})}else await AddEmpData({AddEmpValue:AddEmpValue})}}catch(error){console.error("Error fetching Excel file:",error)}};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"flex flex-col gap-40",children:["Trining Req",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{onClick:fetchExcelFile,children:"Click Here"})]})}},5324:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>vd});var r=a(2250),n=a(5043),s=a(1444),i=a(579);const l=e=>{if(!e)return null;const t=e.split("/");if(3===t.length){const e=t[0],a=t[1]-1,r=t[2],n=new Date(r,a,e);return isNaN(n.getTime())?null:n}const a=new Date(e);return isNaN(a.getTime())?null:a},o=()=>{const{hiringData:e,empPDData:t}=(0,n.useContext)(s.Y),a=null===e||void 0===e?void 0:e.filter((e=>{const t=new Date;t.setHours(0,0,0,0);const a=l(e.expiryDate);return!!a&&(a.setHours(0,0,0,0),a>=t)})),r=null===a||void 0===a?void 0:a.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).slice(0,4);return(0,i.jsxs)("div",{className:"flex justify-center  h-full flex-col w-full",children:[(0,i.jsx)("div",{className:"bg-lite_grey rounded-t-2xl font-semibold p-3",children:(0,i.jsx)("h2",{className:"mx-2",children:"Application Received"})}),(0,i.jsx)("div",{className:"rounded-lg shadow-md w-full center h-full",children:(0,i.jsx)("div",{className:"flex flex-col items-center justify-center p-1",children:(0,i.jsx)("div",{className:"w-full flex flex-wrap justify-evenly items-center custom-gap gap-3",children:r.length>0?r.map(((e,a)=>{const r=l(e.startDate),n=l(e.expiryDate);if(!n)return null;n.setHours(0,0,0,0);const s=new Date;if(s.setHours(0,0,0,0),n<s)return null;const o=(null===t||void 0===t?void 0:t.filter((t=>{var a,s;const i=new Date(t.createdAt);return(null===t||void 0===t||null===(a=t.position)||void 0===a?void 0:a.trim().toLowerCase())===(null===e||void 0===e||null===(s=e.jobTitle)||void 0===s?void 0:s.trim().toLowerCase())&&i>=r&&i<=n})).length)||0;return(0,i.jsxs)("div",{className:"rounded-lg shadow-lg flex items-center border h-[120px] w-[150px] border-lite_grey",children:[(0,i.jsx)("div",{className:"w-2 h-28 rounded-md ".concat(0===a?"bg-[#6E349E]":1===a?"bg-[#F1A924]":2===a?"bg-[#E61A1A]":"bg-[#17C900]")}),(0,i.jsxs)("div",{className:"w-full flex justify-center items-center flex-col m-1",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-center",children:e.jobTitle}),(0,i.jsx)("p",{className:"text-lg mt-2 text-center",children:o})]})]},a)})):(0,i.jsx)("div",{className:"flex justify-center items-center w-full h-full",children:(0,i.jsx)("p",{className:"text-dark_grey text-lg ",children:"No Hiring Job Posts Available"})})})})})]})};const d=a.p+"static/media/Group1.7e3f963c1fec7558650e1452ea30b610.svg";const c=a.p+"static/media/Group2.9e773acd6b67fb2676fbab43da8af704.svg";const p=a.p+"static/media/Group3.a20151449024b194746cd343debd00e5.svg";const m=a.p+"static/media/Group4.10269a09c5f1972d27c4a5925d0502dc.svg",u=()=>{const{empPIData:e,IDData:t}=(0,n.useContext)(s.Y),[a,l]=(0,n.useState)([]),[o,u]=(0,n.useState)(0),[h,x]=(0,n.useState)(0),[g,f]=(0,n.useState)(0),[v,y]=(0,n.useState)(0);return(0,n.useEffect)((()=>{(()=>{try{const a=[...e,...t];l(a);const r=a.filter((e=>{const t=null===e||void 0===e?void 0:e.contractType,a=Array.isArray(t)&&t.length>0?t[t.length-1]:null;return"LOCAL"===(null===a||void 0===a?void 0:a.toUpperCase())})).length;u(r);const n=a.filter((e=>{const t=null===e||void 0===e?void 0:e.contractType,a=Array.isArray(t)&&t.length>0?t[t.length-1]:null;return"LPA"===(null===a||void 0===a?void 0:a.toUpperCase())})).length;f(n);const s=a.filter((e=>{const t=null===e||void 0===e?void 0:e.contractType,a=Array.isArray(t)&&t.length>0?t[t.length-1]:null;return"SAWP"===(null===a||void 0===a?void 0:a.toUpperCase())})).length;y(s),x(r+n+s)}catch(a){}})()}),[]),(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"grid grid-cols-4 p-4 gap-5",children:[(0,i.jsxs)(r.N_,{to:"/allempDetails",className:"p-4 bg-gradient-to-r from-[#FFAAAA] to-[#EBEBEB] rounded-lg shadow-lg flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-1 h-16 mr-4 border rounded-md bg-[#B17A7A] border-[#B17A7A]"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:h}),(0,i.jsx)("p",{className:"text-sm font-medium",children:"Total Employees"})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-center p-2",children:(0,i.jsx)("img",{src:d,alt:"icon1"})})]}),(0,i.jsxs)(r.N_,{to:"/allempDetails",className:"p-4 bg-gradient-to-r from-[#DAFFA6] to-[#EBEBEB] rounded-lg shadow-lg flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-1 h-16 mr-4 border rounded-md bg-[#91A672] border-[#91A672]"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:g}),(0,i.jsx)("p",{className:"text-sm font-medium",children:"LPA"})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-center p-2",children:(0,i.jsx)("img",{src:c,alt:"icon2"})})]}),(0,i.jsxs)(r.N_,{to:"/allempDetails",className:"p-4 bg-gradient-to-r from-[#C9DFFF] to-[#EBEBEB] rounded-lg shadow-lg flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-1 h-16 mr-4 border rounded-md bg-[#687FA4] border-[#B17A7A]"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:v}),(0,i.jsx)("p",{className:"text-sm font-medium",children:"SAWP"})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-center p-2",children:(0,i.jsx)("img",{src:p,alt:"icon3"})})]}),(0,i.jsxs)(r.N_,{to:"/allempDetails",className:"p-4 bg-gradient-to-r from-[#FFDFAB] to-[#EBEBEB] rounded-lg shadow-lg flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-1 h-16 mr-4 border rounded-md bg-[#AB8851] border-[#B17A7A]"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:o}),(0,i.jsxs)("p",{className:"text-sm font-medium",children:["BRUNEIAN / PR"," ",(0,i.jsx)("span",{className:"text-[#B17A7A] text-xs",children:"Citizen / PR"})]})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-center p-2",children:(0,i.jsx)("img",{src:m,alt:"icon4"})})]})]})})};var h=a(8280);const x=()=>{const{matchingNotifications:e}=(0,h.q)(),[t,a]=(0,n.useState)([]);(0,n.useEffect)((()=>{a(e)}),[e]);const s=t.sort(((e,t)=>Date.parse(t.createdAt)-Date.parse(e.createdAt))).filter((e=>"Unread"===e.status)).slice(0,3),l=["bg-[#DEFFFF]","bg-[#ECF9E2]","bg-[#FFF3DC]"],o=["Passport Expiry","Employment Pass Expiry","LD Expiry","Medical Expiry","Training Certificate Expiry","Probation Review Expiry","Contract Expiry"];return(0,i.jsx)("div",{className:"flex justify-center w-full h-full ",children:(0,i.jsxs)("div",{className:"rounded-lg shadow-md w-full h-full",children:[(0,i.jsx)("div",{className:"bg-lite_grey rounded-t-2xl  font-semibold p-3",children:(0,i.jsx)("h2",{className:"mx-2",children:"Recent Notifications"})}),s.length>0?(0,i.jsxs)("section",{children:[[...s].map(((e,t)=>{const{createdAt:a,message:r}=e,n=new Date(a),s=n.getDate(),d=n.toLocaleString("default",{month:"long"}).toUpperCase();return null!==o&&void 0!==o&&o.includes(e.leaveType),(0,i.jsxs)("div",{className:"flex justify-evenly items-center m-2",children:[(0,i.jsx)("div",{className:"w-[130px] p-4",children:(0,i.jsxs)("div",{className:"p-1 text-center rounded-md ".concat(l[t]),children:[(0,i.jsx)("small",{children:s}),(0,i.jsx)("br",{}),(0,i.jsx)("small",{children:d})]})}),(0,i.jsxs)("div",{className:"px flex flex-col w-[200px]",children:[(0,i.jsx)("small",{children:(0,i.jsx)("b",{children:null===e||void 0===e?void 0:e.leaveType})}),(0,i.jsx)("small",{className:"text-grey mt-1",children:"string"===typeof r&&r.includes("Dear")?r.split(":")[0].trim():r})]})]},t)})),(0,i.jsx)("div",{className:"underline text-[blue] text-center px-16  my-5",children:(0,i.jsx)(r.N_,{to:"/notifications",children:"View More"})})]}):(0,i.jsx)("div",{className:"text-dark_grey text-center h-full  pt-40 overflow-hidden",children:(0,i.jsx)("p",{children:"No new notifications available."})})]})})};var g=a(9379),f=a(2926),v=a(4598);const y=e=>{var t,a;if(!e||isNaN(new Date(e).getTime()))return"";let r,n,s,i=e.toString();if(null!==i&&void 0!==i&&i.includes("T")){const e=new Date(i);s=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0")}else if(null!==i&&void 0!==i&&i.includes("/"))[r,n,s]=null===i||void 0===i?void 0:i.split("/");else{if(null===i||void 0===i||!i.includes("-"))return"";[s,n,r]=null===i||void 0===i?void 0:i.split("-")}const l=null===(t=r)||void 0===t?void 0:t.padStart(2,"0"),o=null===(a=n)||void 0===a?void 0:a.padStart(2,"0");return"".concat(l,"/").concat(o,"/").concat(s)},N=e=>{if(!e||"string"!==typeof e)return"";return e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")},b=()=>{const{empPIData:e,workInfoData:t,IDData:a}=(0,n.useContext)(s.Y),[l,o]=(0,n.useState)([]),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)([]);return(0,n.useEffect)((()=>{(async()=>{try{const r=e.map((e=>{const r=t?t.find((t=>t.empID===e.empID)):{},n=a?a.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)({},e),r),n)})).filter(Boolean),n=r.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).slice(0,4);o(n),c(r),m(n)}catch(r){console.error("Error fetching data:",r)}})()}),[e,t,a]),(0,n.useEffect)((()=>{p.length>0&&(async()=>{try{const e=await Promise.all(p.map((async e=>{if(e.profilePhoto){const t=await(0,f.I)({path:e.profilePhoto});return(0,g.A)((0,g.A)({},e),{},{profilePhotoUrl:t.url})}return(0,g.A)((0,g.A)({},e),{},{profilePhotoUrl:null})})));m(e)}catch(e){console.error("Error fetching profile photos:",e)}})()}),[p]),(0,i.jsxs)("div",{className:"bg-white shadow-md rounded-2xl overflow-hidden m-2",children:[(0,i.jsxs)("div",{className:"bg-lite_grey p-4 flex justify-between",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"New Joinee"}),(0,i.jsxs)(r.N_,{to:"/allempDetails",className:"px-10 underline text-[blue]",children:[" ","View All"]})]}),(0,i.jsxs)("table",{className:"min-w-full bg-white",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium",children:"Employee"}),(0,i.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium",children:"Date of Join"}),(0,i.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium",children:"Nationality"}),(0,i.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium",children:"Position"}),(0,i.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium",children:"Type"})]})}),(0,i.jsx)("tbody",{children:p.map(((e,t)=>{var a,r,n,s;return(0,i.jsxs)("tr",{className:"border-b last:border-none text-sm",children:[(0,i.jsxs)("td",{className:"py-4 px-6 flex items-center",children:[(0,i.jsx)("img",{className:"w-10 h-10 rounded-full mr-4",src:e.profilePhotoUrl||v,alt:e.name}),(0,i.jsx)("span",{className:"text-grey",children:e.name})]}),(0,i.jsx)("td",{className:"py-4 px-6 text-grey ",children:y(e.doj)||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-6 text-grey",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-6 text-grey",children:null!==e&&void 0!==e&&null!==(a=e.position)&&void 0!==a&&null!==(r=a[0])&&void 0!==r&&r.trim()?e.position:"N/A"}),(0,i.jsx)("td",{className:"py-4 px-6 text-grey",children:null!==(n=e.empType)&&void 0!==n&&null!==(s=n[0])&&void 0!==s&&s.trim()?e.empType:"N/A"})]},t)}))})]})]})};var D=a(5865),j=a(5394),A=a(5659);const w=()=>{const{empPIData:e}=(0,n.useContext)(s.Y),[t,a]=(0,n.useState)([]),[r,l]=(0,n.useState)({}),[o,d]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{if(e){const t=(e=>{const t=(0,D.GP)(new Date,"MM-dd");return e.filter((e=>{if(!e.dob)return!1;const a=new Date(e.dob);return!isNaN(a)&&(0,D.GP)(a,"MM-dd")===t}))})(e);a(t)}}),[e]),(0,n.useEffect)((()=>{(async()=>{const e={};for(const r of t)if(r.profilePhoto)try{const t=await(0,f.I)({path:r.profilePhoto});e[r.name]=t.url}catch(a){console.error("Error fetching profile image:",a)}l(e)})()}),[t]),(0,i.jsxs)("div",{className:" w-full shadow-md rounded-2xl bg-white h-[100%] overflow-hidden ",children:[(0,i.jsx)("div",{className:"bg-lite_grey p-4 rounded-t-2xl",children:(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"Birthday Reminder"})}),(0,i.jsxs)("div",{className:"p-4",children:[(0,i.jsx)("h3",{className:"text-base font-medium",children:"Today's Birthday"}),(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-5 ",children:[t.slice(0,2).map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-[auto,1fr] gap-2 items-center bg-[#F5F7FB] p-2  rounded-md shadow-sm",children:[(0,i.jsx)("div",{className:"w-10 h-10",children:null!==r&&void 0!==r&&r[e.name]?(0,i.jsx)("img",{src:r[e.name],alt:e.name,className:"w-10 h-10 rounded-full object-cover"}):(0,i.jsx)(j.Mw2,{className:"w-10 h-10 rounded-full"})}),(0,i.jsxs)("div",{className:"p-1 min-w-0",children:[(0,i.jsx)("p",{className:"text-[10px] font-medium",children:e.name}),(0,i.jsx)("p",{className:"text-[10px] text-gray-600",children:e.message||"Happy Birthday!"}),(0,i.jsx)("p",{className:"text-[10px] text-gray-500",children:(0,D.GP)(new Date(e.dob),"MMMM dd")})]})]},t))),t.length>0&&(0,i.jsx)("button",{onClick:()=>d(!0),className:"text-[blue] underline ",children:"View More"})]})]}),o&&(0,i.jsx)("div",{className:"fixed inset-0 center z-50 bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full h-[550px] overflow-y-auto scrollBar",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold",children:"All Birthdays Today"}),(0,i.jsx)("button",{onClick:()=>d(!1),className:"text-[24px] rounded",children:(0,i.jsx)(A.RQJ,{})})]}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-5",children:t.map(((e,t)=>(0,i.jsxs)("div",{className:"flex justify-start flex-wrap items-center space-x-3 bg-[#F5F7FB] p-2 rounded-md shadow-sm mb-2 gap-5",children:[(0,i.jsx)("p",{className:"w-10 h-10 text-[50px] rounded-full center",children:r[e.name]?(0,i.jsx)("img",{src:r[e.name],alt:e.name,className:"w-full h-full rounded-full object-cover"}):(0,i.jsx)(j.Mw2,{})}),(0,i.jsxs)("div",{className:" ",children:[(0,i.jsx)("p",{className:"text-[14px] font-semibold",children:e.name}),(0,i.jsx)("p",{className:"text-[10px] text-grey",children:e.message||"Happy Birthday!"}),(0,i.jsx)("p",{className:"text-[10px] text-grey",children:(0,D.GP)(new Date(e.dob),"MMMM dd")})]})]},t)))})]})})]})},S=()=>{const{userData:e}=(0,n.useContext)(s.Y),t=e.reduce(((e,t)=>("Employee"!==t.selectType&&"Active"===t.status?e.active+=1:"Employee"!==t.selectType&&"InActive"===t.status&&(e.inactive+=1),e)),{active:0,inactive:0});return(0,i.jsxs)("div",{className:"flex justify-evenly items-center w-full gap-3 bg-white py-7 px-2 rounded-2xl shadow-lg",children:[(0,i.jsxs)("div",{className:"text-center w-full ",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Active users"}),(0,i.jsx)("div",{className:"relative w-full h-2 bg-grey rounded-full overflow-hidden my-2",children:(0,i.jsx)("div",{className:"absolute h-full bg-[#32d432]",style:{width:"".concat(t.active,"%")}})}),(0,i.jsxs)("p",{className:"font-medium",children:[t.active," user"]})]}),(0,i.jsxs)("div",{className:"text-center  w-full",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Inactive users"}),(0,i.jsx)("div",{className:"relative w-full h-2 bg-grey rounded-full overflow-hidden my-2",children:(0,i.jsx)("div",{className:"absolute h-full bg-yellow",style:{width:"".concat(t.inactive,"%")}})}),(0,i.jsxs)("p",{className:"font-medium",children:[t.inactive," user"]})]})]})};const E=(e,t)=>{const[a,r]=(0,n.useState)([]),{userData:i}=(0,n.useContext)(s.Y);return(0,n.useEffect)((()=>{var a;const n=null===(a=localStorage.getItem(e))||void 0===a?void 0:a.toUpperCase(),s=i.find((e=>e.empID===n));s&&Array.isArray(s.setPermissions)&&s.setPermissions.forEach((e=>{const a=function(e){var t,a,r;if(!e)return null;let n=null===e||void 0===e?void 0:e.replace(/=/g,":");n=null===(t=n)||void 0===t?void 0:t.replace(/([a-zA-Z]+):/g,'"$1":'),n=null===(a=n)||void 0===a?void 0:a.replace(/\[([^\]]+)\]/g,((e,t)=>{let a=t.split(",").map((e=>'"'.concat(e.trim(),'"')));return"[".concat(a.join(", "),"]")})),n="{".concat(null===(r=n)||void 0===r?void 0:r.slice(1,-1),"}");try{return JSON.parse(n)}catch(s){return console.error("Error parsing JSON:",s),null}}(e);a&&a[t]&&r(a[t])}))}),[e,t,i]),a},I=()=>{const e=E("userID","Dashboard");(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const t=(0,n.useCallback)((()=>(0,i.jsxs)("div",{className:"flex flex-col",children:[e.includes("Employee count")&&(0,i.jsx)("div",{children:(0,i.jsx)(u,{})}),(0,i.jsxs)("div",{className:"flex gap-2 px-3 w-full py-2",children:[e.includes("Recent Notifications")&&(0,i.jsx)("div",{className:"flex-1 w-full",children:(0,i.jsx)(x,{})}),e.includes("Application Received")&&(0,i.jsx)("div",{className:"w-full flex-1",children:(0,i.jsx)(o,{})}),(e.includes("User Action")||e.includes("Birthday Reminder"))&&(0,i.jsxs)("div",{className:"flex-1 gap-2  flex flex-col justify-between items-end h-full ",children:[e.includes("User Action")&&(0,i.jsx)("div",{className:"w-full flex-1",children:(0,i.jsx)(S,{})}),e.includes("Birthday Reminder")&&(0,i.jsx)("div",{className:"w-full flex-1",children:(0,i.jsx)(w,{})})]})]}),e.includes("New Joinee")&&(0,i.jsxs)("div",{children:[" ",(0,i.jsx)(b,{})]})]})),[e]);return(0,i.jsx)("section",{className:"flex flex-col w-full pb-10 pt-5",children:t()})};const k=a.p+"static/media/icon1.a0e21c4a3cdac1ce8ac63036afedddd0.svg";const T=a.p+"static/media/icon2.2f73b29a81000b7ff98cd001a1154440.svg";const C=a.p+"static/media/icon3.631bc42c4a66ff9250f8ab2d5cb5a220.svg";const R=a.p+"static/media/icon4.1aee7c814eb0d2498cf611d522120f90.svg";const P=a.p+"static/media/icon5.92b1b0faf71117afa6ee1967ab502670.svg";const O=a.p+"static/media/icon6.440304a99f330ad76078e70046367bfa.svg";const _=a.p+"static/media/icon7.7cd162248f372a0e9bf87c7ee6b61cdf.svg",M=()=>{const e=E("userID","Employee");(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const t=[{id:1,to:"/allempDetails",img:k,alt:"All Employee",title:"All Employee",borderColor:"border-[#AF0A12]"},{id:2,to:"/employeeInfo",img:T,alt:"Employee Info",title:"Employee Info",borderColor:"border-[#0AAF19]"},{id:3,to:"/workInfo",img:C,alt:"Work Info",title:"Work Info",borderColor:"border-[#F9A938]"},{id:4,to:"/sawp",img:R,alt:"Work Pass",title:"Work Pass",borderColor:"border-[#0072FE]"},{id:5,to:"/labourImmigration",img:P,alt:"Medical & Dependent Info",title:"Medical & Dependent Info",borderColor:"border-[#AF0A12]"},{id:6,to:"/insuranceAdd",img:O,alt:"Insurance",title:"Insurance",borderColor:"border-[#0072FE]"},{id:7,to:"/nonLocalAcco",img:_,alt:"Non-Local",title:"Non-Local Accommodation in Brunei",borderColor:"border-[#F9A938]"}].filter((t=>e.includes(t.title)));return(0,i.jsx)("section",{className:" bg-[#F5F6F1CC] w-full p-10 min-h-screen",children:(0,i.jsx)("div",{className:"flex w-full flex-wrap justify-between gap-y-10 gap-x-2 mb-40",children:t.map((e=>(0,i.jsx)(r.N_,{to:e.to,className:"  flex flex-col justify-center items-center p-2 max-w-xs w-full bg-white rounded-lg shadow-lg  transition-shadow duration-200",children:(0,i.jsxs)("div",{className:"w-full h-full flex flex-col justify-center items-center  border-l-4 ".concat(e.borderColor),children:[(0,i.jsx)("img",{className:"w-[100px] h-[100px] p-3",src:e.img,alt:e.alt}),(0,i.jsx)("h2",{className:"text-[14px] font-semibold text-center",children:e.title})]})},e.id)))})})},F=e=>{let{img:t,text1:a,text2:n,fontSize:s,borderColor:l,bgColor:o,link:d,onClick:c}=e;return(0,i.jsxs)(r.N_,{to:d,onClick:c,className:"shadow-lg border ".concat(l," ").concat(o," text-secondary my-5 h-36 max-w-48 w-full rounded-xl flex flex-col items-center justify-center text-center gap-3 p-5"),children:[(0,i.jsx)("div",{className:"w-full max-w-[60px]",children:(0,i.jsx)("img",{className:"w-full",src:t,alt:"TimeSheet icons not found"})}),(0,i.jsxs)("p",{className:"".concat(s),children:[a," ",(0,i.jsx)("br",{}),n]})]})};const L=a.p+"static/media/icon1.5904eec4bc73374c86fbb0c90e86b0f2.svg";const U=a.p+"static/media/icon2.5d87d184d925928a0e49dbc3de6bd1f4.svg";const B=a.p+"static/media/icon3.6a9898df227c282402737584f8684101.svg";const q=a.p+"static/media/icon4.fae728d68a09e997ac4f3d24320c32db.svg",H=()=>{(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const e=E("userID","Training");return(0,i.jsxs)("section",{className:"min-h-screen p-10 bg-[#F5F6F1CC] flex gap-16",children:[e.includes("HR")&&(0,i.jsx)(F,{img:L,text1:"HR",fontSize:"text_size_5 ",borderColor:"border-[#BF91FF]",bgColor:"bg-white",link:"/training/hr"}),e.includes("Training Requestor")&&(0,i.jsx)(F,{img:U,text1:"Training Requestor",fontSize:"text_size_5 ",borderColor:"border-[#7DA2F2]",bgColor:"bg-white",link:"/trainingReq"}),e.includes("BLNG")&&(0,i.jsx)(F,{img:B,text1:"BLNG",fontSize:"text_size_5 ",borderColor:"border-[#F589C1]",bgColor:"bg-white",link:"/blngCertify"}),e.includes("OME")&&(0,i.jsx)(F,{img:q,text1:"OME",fontSize:"text_size_5 ",borderColor:"border-[#F589C1]",bgColor:"bg-white",link:"/omgCertify"})]})};const W=a.p+"static/media/icon1.f804c2929c0874428e0eb46a708f1446.svg";const z=a.p+"static/media/icon2.a8c12963c0f096775b5ab570228bda87.svg";const Y=a.p+"static/media/icon3.39f992fc0573162c53e7a4565f4c2be4.svg";a.p;const V=a.p+"static/media/icon5.a7196761bc58a431fa73896a1310a8cb.svg";const G=a.p+"static/media/icon6.8653a3ab47dd20c1c5762792c6843dd4.svg";const J=a.p+"static/media/icon7.0889dda9fda79433bc73b15c525cd1d1.svg";const K=a.p+"static/media/icon8.632f033f40b934e8cb8055d3ddae7529.svg";const Q=a.p+"static/media/icon9.6cceeab5e33a6c8e397bfe12ddb4848e.svg";const $=a.p+"static/media/icon10.0b85d9b5dbc241106bf4988639243c71.svg",Z=()=>{const e=E("userID","TimeSheet");return(0,i.jsx)("section",{className:"p-16 bg-[#f5f6f1cc] h-screen",children:(0,i.jsxs)("div",{className:" screen-size",children:[(0,i.jsx)("h4",{className:"text_size_4  w-fit py-2    text-dark_grey ",children:"Upload Time Sheet"}),(0,i.jsxs)("div",{className:"flex justify-start gap-20",children:[e.includes("HO")&&(0,i.jsx)(F,{img:V,text1:"HO",borderColor:"border-[#4E00BC]",bgColor:"bg-white",link:"/timesheetHO"}),e.includes("SBW")&&(0,i.jsx)(F,{img:W,text1:"SBW",borderColor:"border-[#B70B36]",bgColor:"bg-white",link:"/timesheetSBW"}),e.includes("ORMC")&&(0,i.jsx)(F,{img:J,text1:"ORMC",borderColor:"border-[#06830E]",bgColor:"bg-white",link:"/timesheetORMC"}),e.includes("Offshore")||e.includes("Offshore's ORMC")?(0,i.jsx)(F,{img:Y,text1:"Offshore's",text2:"excel Sheet",borderColor:"border-[#B70BA0]",bgColor:"bg-white",link:"/OffshoreSheets"}):null]}),(0,i.jsxs)("div",{className:"flex justify-start gap-20",children:[e.includes("BLNG")&&(0,i.jsx)(F,{img:z,text1:"BLNG",borderColor:"border-[#EB9916]",bgColor:"bg-white",link:"/timesheetBlng"}),e.includes("View Time Sheet")&&(0,i.jsx)(F,{img:K,text1:"View Time",text2:"sheet",borderColor:"border-[#9B9F27]",bgColor:"bg-white",link:"/viewTimesheet"}),e.includes("View Summary")&&(0,i.jsx)(F,{img:G,text1:"View",text2:"Summary",borderColor:"border-[#107B8E]",bgColor:"bg-white",link:"/viewSummary"})]})]})})};const X=a.p+"static/media/rm.c3c8abc3a028100a45b11a8284f94e45.svg";const ee=a.p+"static/media/terminate.def37d70f86ef6f8f1225da048324655.svg";const te=a.p+"static/media/probation.6f1564510be983567ee52ee158273d79.svg";const ae=a.p+"static/media/contract.a5272e0bbad885f8972a9230c09af9c6.svg";const re=a.p+"static/media/passExpiry.d3de2574c8362292a10455bba96cf0ee.svg";const ne=a.p+"static/media/LD.0a8b7c04b96cf1d051d8c2236e3fd7b8.svg";const se=a.p+"static/media/passport.e93e6a04f2e3c488ae0adf817ba78145.svg";const ie=a.p+"static/media/medical.44cd861befd1486181a5fa4295312a0e.svg";const le=a.p+"static/media/req.40bc73c644d28288f8f6e03bf655bb79.svg";const oe=a.p+"static/media/training.89ccaa7494711584f8d9cc5c6ffee773.svg";const de=a.p+"static/media/LBDKPI.4bff947ed573a10d2873a27d22d0a6ed.svg";const ce=a.p+"static/media/groupHS.a10ba48984b7ec0d00644ff0fce043e3.svg";const pe=a.p+"static/media/Resignation.7d5f77532b534a9f53caefe2c9eae0eb.svg";const me=a.p+"static/media/leavePass.138ab4c7e5770c8c798f1a05fc9bc24a.svg";const ue=a.p+"static/media/promotion.2f11261d602b64ecfdc4810403f5b81a.svg",he=()=>{const{empPIData:e=[],workInfoData:t=[],ProbFData:a=[],SRData:r=[]}=(0,n.useContext)(s.Y),[i,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{if(!e||0===e.length)return l([]),void d(!1);const n=new Map(e.map((e=>[e.empID,e]))),s=new Map(t.map((e=>[e.empID,e]))),i=new Map(r.map((e=>[e.empID,e]))),o=[];for(const e of a){const t=n.get(e.empID);if(t){const a=s.get(e.empID)||{},r=i.get(e.empID)||{},n=(0,g.A)((0,g.A)((0,g.A)((0,g.A)({empCreatedAt:t.createdAt,probCreatedAt:null===e||void 0===e?void 0:e.createdAt,workInfoCreatedAt:null===a||void 0===a?void 0:a.createdAt,empInfoId:t.id,probID:e.id,workInfoId:a.id},t),e),a),r);o.push(n)}}for(const t of e)if(!a.find((e=>e.empID===t.empID))){const e=s.get(t.empID)||{},a=i.get(t.empID)||{},r=(0,g.A)((0,g.A)((0,g.A)({empCreatedAt:t.createdAt,probCreatedAt:null,workInfoCreatedAt:null===e||void 0===e?void 0:e.createdAt,empInfoId:t.id,probID:null,workInfoId:e.id},t),e),a);o.push(r)}l((e=>JSON.stringify(e)===JSON.stringify(o)?e:o)),d(!1)}),[e,t,a]),{mergedProbData:i,loading:o}},xe=()=>{const{empPIData:e,LMIData:t,PPValidsData:a,IDData:l,workInfoData:o,terminateData:d,DNData:c,EmpInsuranceData:p,WeldeInfo:m,BastingInfo:u,leaveDetailsData:h,trainingCertifi:x,AddEmpReq:f,ProbFData:v,contractForms:y,IVSSDetails:N,WPTrackings:b,localMobiliz:D,SRData:j}=(0,n.useContext)(s.Y),A=E("userID","Report"),[w,S]=(0,n.useState)([]),{mergedProbData:I}=he(),k=(0,r.Zp)(),T=[{title:"Recruitment & Mobilization",icon:X,path:"/rm"},{title:"Resignation",icon:pe,path:"/resignation"},{title:"Termination",icon:ee,path:"/termination"},{title:"Probation Review",icon:te,path:"/probationReview"},{title:"Probation Form Update",icon:te,path:"/probFormUpdate"},{title:"Contract Expiry Review",icon:ae,path:"/contractReview"},{title:"Contract Expiry Form Update",icon:ae,path:"/ContractUp"},{title:"Employment Pass Expiry",icon:re,path:"/empPassExpiry"},{title:"LD Expiry",icon:ne,path:"/ldExpiry"},{title:"Passport Expiry",icon:se,path:"/passportExpiry"},{title:"Employment Medical",icon:ie,path:"/empMedical"},{title:"New Recruitment",icon:le,path:"/newRecruit"},{title:"Training Records",icon:oe,path:"/trainingRC"},{title:"LBD KPI",icon:de,path:"/lbdKpi"},{title:"Group H&S",icon:ce,path:"/groupHS"},{title:"Leave Passage",icon:me,path:"/leavePass"},{title:"Promotion",icon:ue,path:"/promotion"}];(0,n.useEffect)((()=>{if(!e||0===e.length)return;const r=N.map((e=>{const{empID:t,tempID:a}=e,r=b.find((e=>e.tempID===a))||{},n=D.find((e=>e.tempID===a))||{};return(0,g.A)((0,g.A)((0,g.A)({},e),r),n)})),n=e.map((e=>{const n=e.empID,s=r.find((e=>e.empID===n))||{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),(null===l||void 0===l?void 0:l.find((e=>e.empID===n)))||{}),(null===d||void 0===d?void 0:d.find((e=>e.empID===n)))||{}),(null===c||void 0===c?void 0:c.find((e=>e.empID===n)))||{}),(null===a||void 0===a?void 0:a.find((e=>e.empID===n)))||{}),(null===t||void 0===t?void 0:t.find((e=>e.empID===n)))||{}),(null===p||void 0===p?void 0:p.find((e=>e.empID===n)))||{}),(null===m||void 0===m?void 0:m.find((e=>e.empID===n)))||{}),(null===u||void 0===u?void 0:u.find((e=>e.empID===n)))||{}),(null===h||void 0===h?void 0:h.find((e=>e.empID===n)))||{}),(null===x||void 0===x?void 0:x.find((e=>e.empID===n)))||{}),(null===f||void 0===f?void 0:f.find((e=>e.empID===n)))||{}),(null===v||void 0===v?void 0:v.find((e=>e.empID===n)))||{}),(null===y||void 0===y?void 0:y.find((e=>e.empID===n)))||{}),(null===N||void 0===N?void 0:N.find((e=>e.empID===n)))||{}),s),(null===j||void 0===j?void 0:j.find((e=>e.empID===n)))||{}),(null===o||void 0===o?void 0:o.find((e=>e.empID===n)))||{})}));S((e=>JSON.stringify(e)===JSON.stringify(n)?e:n))}),[e,l,o,d,c,a,t,p,m,u,h,x,f,v,y,N,b,D,j]);const C=T.filter((e=>A.includes(e.title)));return(0,i.jsxs)("div",{className:"p-10 w-full bg-[#F5F6F1CC] min-h-screen",children:[(0,i.jsx)("p",{className:"text-2xl font-semibold text-dark_grey text-center uppercase ",children:"Report"}),(0,i.jsx)("div",{className:"grid grid-cols-4 flex-wrap gap-5 mt-14",children:C.map(((e,t)=>(0,i.jsxs)("div",{className:"flex flex-col justify-center items-center p-6 bg-white rounded-lg shadow-md hover:shadow-lg cursor-pointer border-2 border-[#EAD892] w-[200px] h-[150px]",onClick:()=>k(e.path,{state:{allData:"Probation Review"===e.title||"Probation Form Update"===e.title?I:w,title:e.title}}),children:[(0,i.jsx)("img",{src:e.icon,alt:e.title,className:"mb-4 w-12 h-12"}),(0,i.jsx)("p",{className:"text-center font-medium text-gray-700",children:e.title})]},t)))})]})};const ge=a.p+"static/media/employee-requisition.41b025adf1d775d5ccf3be283b8140f0.svg";const fe=a.p+"static/media/candidate.b8f45bdcafc47783d7843bcc9e753dfa.svg";const ve=a.p+"static/media/local-cv.f6d00c778df12080f7bc80d54b41bfda.svg";const ye=a.p+"static/media/non-local-cv.de560396a9e8c4558f7c9fd722936e80.svg";const Ne=a.p+"static/media/status.87b997dd7fac7bf90b2c784e229b3c0f.svg";const be=a.p+"static/media/workpass-tracking.39e64ac55e0af35002d6b7fb52854f0d.svg";const De=a.p+"static/media/apply_employreq.5dd5127bc5e2ec5006821b6f8b466da2.svg";const je=[{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#C9C9C9]",icons:De,title:"Apply Employee Requisition",path:"applyemployreq"},{bg:" shadow-[0_1px_4px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#9BE9FF]",icons:ge,title:"Employee Requisition",path:"employreq"},{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#FFEDA5]",icons:fe,title:"Candidate",path:"candidate"},{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#F58DC3]",icons:ve,title:"Local CV",path:"localcandi"},{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#B1F094]",icons:ye,title:"Non Local CV",path:"nonloccandi"},{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#BF91FF]",icons:Ne,title:"Status",path:"status"},{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#FBB995]",icons:be,title:"WorkPass Tracking",path:"workpasstracking"},{bg:" shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",bg1:"bg-[#E993FF]",icons:a.p+"static/media/HiringJob.3e8ab1aa0e357f542ee0a956825eec3d.svg",title:"Hiring Job",path:"/hiringJob"}],Ae=()=>{const e=(0,r.Zp)(),t=E("userID","Recruitment"),a=je.filter((e=>t.includes(e.title)));return(0,i.jsx)("section",{className:"min-h-screen p-10 bg-[#F5F6F1]",children:(0,i.jsx)("div",{className:"screen-size flex ".concat(a.length<=2?"justify-start":"justify-evenly"," items-center flex-wrap gap-10 text-black"),children:a.map(((t,a)=>(0,i.jsxs)("div",{onClick:()=>{var a;"Apply Employee Requisition"===(a=t.title)?e("/recrutiles/applyemployreq"):"Employee Requisition"===a?e("/recrutiles/employreq"):"Candidate"===a?e("/recrutiles/candidate"):"Local CV"===a?e("/recrutiles/localcandi"):"Non Local CV"===a?e("/recrutiles/nonloccandi"):"Status"===a?e("/recrutiles/status"):"WorkPass Tracking"===a?e("/recrutiles/workpasstracking"):"Hiring Job"===a&&e("/hiringJob")},className:"".concat(t.bg," rounded-3xl w-[320px] h-50 p-4 bg-white border-4 border-white cursor-pointer transition-all duration-50 hover:border-[#faf362] hover:border-4"),children:[(0,i.jsx)("div",{className:"".concat(t.bg1," rounded-full my-8 w-24 h-24 center m-auto"),children:(0,i.jsx)("img",{className:"w-13 h-16 object-cover",src:t.icons,alt:"".concat(a," Icon not found")})}),(0,i.jsx)("h5",{className:"text-[18px] font-semibold text-center",children:t.title})]},a)))})})},we=()=>((0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,i.jsx)("div",{children:(0,i.jsx)(Ae,{})}));var Se=a(7305),Ee=a(8382),Ie=a(3646),ke=a(3482);const Te=(0,Ee.D)(),Ce=()=>{const[e,t]=(0,n.useState)({mergedData:[],ticketMerged:[],personalDetails:[]}),[a,r]=(0,n.useState)(!0),[s,i]=(0,n.useState)(null),l=(0,n.useCallback)((async()=>{r(!0);let e=[],a=[],n=[],s=[],l=[],o=null,d=null,c=null,p=null,m=null;try{do{const t=await Te.graphql({query:Ie._n,variables:{nextToken:o}});e=[...e,...t.data.listLeaveStatuses.items],o=t.data.listLeaveStatuses.nextToken}while(o);do{const e=await Te.graphql({query:Ie.it,variables:{nextToken:d}});a=[...a,...e.data.listEmpPersonalInfos.items],d=e.data.listEmpPersonalInfos.nextToken}while(d);do{const e=await Te.graphql({query:Ie.bJ,variables:{nextToken:c}});n=[...n,...e.data.listEmpWorkInfos.items],c=e.data.listEmpWorkInfos.nextToken}while(c);do{const e=await Te.graphql({query:Ie.uh,variables:{nextToken:p}});s=[...s,...e.data.listEmpLeaveDetails.items],p=e.data.listEmpLeaveDetails.nextToken}while(p);do{const e=await Te.graphql({query:Ie.tt,variables:{nextToken:m}});l=[...l,...e.data.listTicketRequests.items],m=e.data.listTicketRequests.nextToken}while(m);const r=a.reduce(((e,t)=>(e[t.empID]=t,e)),{}),i=n.reduce(((e,t)=>(e[t.empID]=t,e)),{}),u=s.reduce(((e,t)=>(e[t.empID]=t,e)),{}),h=e.map((e=>{const t=r[e.empID]||{},a=i[e.empID]||{},n=u[e.empID]||{};return(0,g.A)((0,g.A)((0,g.A)({},e),n),{},{id:e.id,empID:e.empID,empName:t.name,empBadgeNo:t.empBadgeNo,gender:t.gender,empOfficialEmail:t.officialEmail,doj:a.doj,leaveStatusCreatedAt:e.createdAt,leaveStatusReceivedDate:e.receivedDate,leaveDays:e.days,supervisorName:e.supervisorName,supervisorEmpID:e.supervisorEmpID,supervisorStatus:e.supervisorStatus,supervisorDate:e.supervisorDate,supervisorRemarks:e.supervisorRemarks,managerName:e.managerName,managerEmpID:e.managerEmpID,managerStatus:e.managerStatus,managerDate:e.managerDate,managerRemarks:e.managerRemarks,empStatus:e.empStatus,reason:e.reason,medicalCertificate:e.medicalCertificate,empLeaveType:e.leaveType,position:a.position||"",department:a.department||"",workHrs:(null===a||void 0===a?void 0:a.workHrs)||[],workMonth:(null===a||void 0===a?void 0:a.workMonth)||[],workWeek:(null===a||void 0===a?void 0:a.workWeek)||[],empLeaveStartDate:null===e||void 0===e?void 0:e.fromDate,empLeaveEndDate:null===e||void 0===e?void 0:e.toDate,empLeaveSelectedFrom:null===e||void 0===e?void 0:e.selectedFrom,empLeaveSelectedTo:null===e||void 0===e?void 0:e.selectedTo,empLeaveUpdatedAt:e.updatedAt,compassionateLeave:n.compasLeave||0,annualLeave:n.annualLeave||0,sickLeave:n.sickLeave||0,maternityLeave:n.materLeave||0,paternityLeave:n.paterLeave||0,hospitalLeave:n.hospLeave||0,marriageLeave:n.mrageLeave||0,empPervAnnualLeaveBal:n.pervAnnualLeaveBal||0,leaveDetailsCreatedAt:n.createdAt,leaveDetailsUpdatedAt:n.updatedAt,empsickLeaveTaken:n.sickLeaveTaken,empSickLeaveDate:n.sickLeaveDate,empAnnualLeaveDate:null===n||void 0===n?void 0:n.annualLeaveDate})})),x=l.map((e=>{const t=r[e.empID]||{},a=i[e.empID]||{};return{id:e.id,empID:e.empID,empName:t.name,position:a.position||"",department:a.department||"",doj:a.doj,empBadgeNo:t.empBadgeNo,empOfficialEmail:t.officialEmail,departureDate:e.departureDate,empDepartureDate:e.from,arrivalDate:e.arrivalDate,empArrivalDate:e.to,destination:e.destination,empStatus:e.empStatus,empDate:e.empDate,empRemarks:e.empRemarks,hrStatus:e.hrStatus,hrDate:e.hrDate,hrRemarks:e.hrRemarks,hrName:e.hrName,hrEmpID:e.hrEmpID,gmStatus:e.gmStatus,gmDate:e.gmDate,gmRemarks:e.gmRemarks,gmEmpID:e.gmEmpID,managerEmpID:a.manager||"",createdAt:e.createdAt}}));t({mergedData:h,ticketMerged:x,personalDetails:a})}catch(u){i(u),console.error("Error fetching data:",u)}finally{r(!1)}}),[]);(0,n.useEffect)((()=>{l()}),[l]);return(0,g.A)((0,g.A)({},e),{},{loading:a,error:s,handleDeleteLeaveStatus:async e=>{r(!0);try{await Te.graphql({query:ke.RT,variables:{input:{id:e}}}),t((t=>(0,g.A)((0,g.A)({},t),{},{mergedData:t.mergedData.filter((t=>t.id!==e))})))}catch(a){i(a),console.error("Error deleting leave status:",a)}finally{r(!1)}},handleUpdateLeaveStatus:async(e,a)=>{r(!0);try{var n;const r=await Te.graphql({query:ke.Ve,variables:{input:(0,g.A)({id:e},a)}}).then((e=>{})).catch((e=>{console.log(e)})),s=null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.updateLeaveStatus;t((t=>(0,g.A)((0,g.A)({},t),{},{mergedData:t.mergedData.map((t=>t.id===e?s:t))})))}catch(s){i(s),console.error("Error updating leave status:",s)}finally{r(!1)}},handleUpdateTicketRequest:async(e,a)=>{r(!0);try{const r=(await Te.graphql({query:ke.Bu,variables:{input:(0,g.A)({id:e},a)}})).data.updateTicketRequest;t((t=>(0,g.A)((0,g.A)({},t),{},{mergedData:t.mergedData.map((t=>t.id===e?r:t))})))}catch(n){i(n),console.error("Error updating ticket request:",n)}finally{r(!1)}},handleUpdateEmpLeaveDetails:async(e,a)=>{r(!0);try{const r=(await Te.graphql({query:ke.Jo,variables:{input:(0,g.A)({empID:e},a)}})).data.updateEmpLeaveDetails;t((t=>(0,g.A)((0,g.A)({},t),{},{mergedData:t.mergedData.map((t=>t.empID===e?r:t))})))}catch(n){i(n),console.error("Error updating employee leave details:",n)}finally{r(!1)}},refreshData:l})},Re=a.p+"static/media/logo.d552b150183f7ac370ee.png",Pe=e=>{let{notification:t,text:a,path:r}=e;const[s,l]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{if(t){l(!0);const e=setTimeout((()=>{l(!1),r&&(window.location.href=r)}),3e3);return()=>clearTimeout(e)}}),[t,r]),(0,i.jsx)("section",{children:s&&(0,i.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-[70]",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[(0,i.jsx)("p",{className:"text-dark_grey font-semibold",children:a}),(0,i.jsx)("img",{src:Re,alt:"Logo",className:"mt-4 cursor-pointer w-12 h-12 mx-auto animate-spin-slow"})]})})})},Oe=(0,Ee.D)(),_e=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(null),[s,i]=(0,n.useState)(null);return{createNotification:async e=>{t(!0);try{var a;const t=await Oe.graphql({query:ke._x,variables:{input:{empID:e.empID,leaveType:e.leaveType,senderEmail:e.senderEmail,receipentEmail:e.receipentEmail,receipentEmpID:e.receipentEmpID,status:e.status,message:e.message},variables:{limit:2e4}}}),r=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.createEmailNotifi;console.log("Created Email Notification:",r),i(r)}catch(n){r(n),console.error("Error creating email notification:",n)}finally{t(!1)}},loading:e,error:a,notification:s}},Me=async(e,t,a,r)=>{try{const s=await fetch("https://j1wcrd0160.execute-api.ap-southeast-1.amazonaws.com/adinin-send-mail-stage/sendemail",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":"HnBNb3SSva9efDAVIQ0256ihdKMTlYBraAbr96Gu"},body:JSON.stringify({subject:e,message:t,fromid:a,toaddress:r})});console.log(s,"Response");try{const e=await s.json();return console.log("Email Response:",e),"Email sent successfully"===e.message?(console.log("Email sent successfully"),"success"):"failed"}catch(n){console.log("log",n)}}catch(s){console.error("Error sending email:",s)}};var Fe=a(4292);const Le=e=>{let{handleClickForToggle:t,leaveData:a,ticketData:r,source:l,userType:o,personalInfo:d}=e;const{empPIData:c}=(0,n.useContext)(s.Y),{gmPosition:p,gmMail:m,GMEmpID:u,HRMPosition:h,hrManagerMail:x}=(0,Fe.b)(),[g,f]=(0,n.useState)(""),[v,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(""),[j,w]=(0,n.useState)(""),{handleUpdateLeaveStatus:S,handleUpdateTicketRequest:E}=Ce(),{createNotification:I}=_e(),k=c.find((e=>(null===a||void 0===a?void 0:a.managerEmpID)===e.empID)),T=c.find((e=>(null===a||void 0===a?void 0:a.supervisorEmpID)===e.empID)),C=e=>"Rejected"===e?"text-[red]":"Approved"===e?"text-[#339933]":"text-[#E8A317]",R="HR MANAGER",P=e=>/^\d{4}\/\d{1,2}\/\d{1,2}$/.test(e)||/^\d{4}-\d{2}-\d{2}$/.test(e),O=async e=>{const t={},n={},s=localStorage.getItem("userType"),i=(new Date).toISOString();if("Manager"===s?(t.managerStatus=e,t.managerRemarks=g,t.managerDate=i):"Supervisor"===s&&(t.supervisorStatus=e,t.supervisorRemarks=g,t.supervisorDate=i),"LM"===l){const r=a.empLeaveSelectedFrom&&a.empLeaveSelectedTo?P(a.empLeaveSelectedFrom)&&P(a.empLeaveSelectedTo)?"".concat(y(a.empLeaveSelectedFrom)," to ").concat(y(a.empLeaveSelectedTo)):"".concat(a.empLeaveSelectedFrom," to ").concat(a.empLeaveSelectedTo):a.empLeaveStartDate&&a.empLeaveEndDate?"".concat(y(a.empLeaveStartDate)," to ").concat(y(a.empLeaveEndDate)):"N/A";S(a.id,t).then((()=>{if(D("Leave ".concat(e," by ").concat(d.name," on ").concat(y(i))),"Manager"!==s||null!=a.supervisorEmpID&&""!==a.supervisorEmpID||"Approved"!==e&&"Rejected"!==e)if("Supervisor"!==s||!a.supervisorEmpID||"Pending"!==(null===a||void 0===a?void 0:a.managerStatus)||"Approved"!==e&&"Rejected"!==e){if("Manager"===s&&a.managerEmpID&&"Approved"===a.supervisorStatus&&("Approved"===e||"Rejected"===e)){const t=c.filter((e=>a.supervisorEmpID.toLowerCase()===e.empID.toLowerCase())),n=async()=>{try{await Me("Leave Application ".concat(e),"<html>\n                   <body>\n                     <p> \n                      Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Manager, ").concat(k.name||"Not mentioned",'.\n                    </p>\n                 <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n                 </body>\n               </html>'),"leave_no-reply@adininworks.com",t[0].officialEmail),await Me("Leave Application ".concat(e),"<html>\n                    <body>\n                     <p> \n                       Dear ".concat(a.empName||"Not mention",", <br /> Your ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Manager, ").concat(k.name||"Not mention",'. \n                    </p>\n                    <p>Click here <a href="https://employee.adininworks.co">employee.adininworks.co</a> to view the status.</p>\n                   </body>\n                 </html>'),"leave_no-reply@adininworks.com",a.empOfficialEmail),await Me("Leave Application ".concat(e),"<html>\n                     <body>\n                       <p> \n                          Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Manager, ").concat(k.name||"Not mentioned",'.\n                       </p>\n                       <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n                     </body>\n                 </html>'),"leave_no-reply@adininworks.com","hr-notification@adininworks.com"),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Manager ").concat(k.name||"Not mentioned"," ."),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:a.empOfficialEmail,receipentEmpID:a.empID,status:"Unread"}),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Manager ").concat(k.name||"Not mentioned","."),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:t[0].officialEmail,receipentEmpID:a.supervisorEmpID,status:"Unread"}),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Manager ").concat(k.name||"Not mentioned","."),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:"hr-notification@adininworks.com",status:"Unread"})}catch(n){console.error("An error occurred:",n)}};setTimeout((()=>{n()}),200)}}else{const t=c.filter((e=>(null===a||void 0===a?void 0:a.managerEmpID.toLowerCase())===e.empID.toLowerCase())),n=async()=>{try{"Approved"===e&&(await Me("Leave Application ".concat(e),"<html>\n                      <body>\n                        <p>\n                          Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s, ").concat(a.empLeaveType," request for the period   ").concat(r,", \n                          which has been ").concat(e," by Supervisor, ").concat(T.name||"Not mentioned",'.\n                        </p>\n                        <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the status.</p>\n                      </body>\n                    </html>'),"leave_no-reply@adininworks.com",t[0].officialEmail),await Me("Leave Application ".concat(e),"<html>\n                      <body>\n                        <p> \n                          Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s, ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Supervisor, ").concat(T.name||"Not mentioned",'.\n                        </p>\n                        <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n                      </body>\n                    </html>'),"leave_no-reply@adininworks.com","hr-notification@adininworks.com"),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Supervisor ").concat(T.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:t[0].officialEmail,receipentEmpID:a.managerEmpID,status:"Unread"}),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Supervisor ").concat(T.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:"hr-notification@adininworks.com",status:"Unread"})),"Rejected"===e&&(await Me("Leave Application ".concat(e),"<html>\n                      <body>\n                        <p> \n                          Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s, ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Supervisor, ").concat(T.name||"Not mentioned",'.\n                        </p>\n                        <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n                      </body>\n                    </html>'),"leave_no-reply@adininworks.com","hr-notification@adininworks.com"),await Me("Leave Application ".concat(e),"<html>\n                      <body>\n                        <p>\n                          Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s, ").concat(a.empLeaveType," request for the period ").concat(r,", \n                          which has been ").concat(e," by Supervisor, ").concat(T.name||"Not mentioned",'.\n                        </p>\n                        <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the status.</p>\n                      </body>\n                    </html>'),"leave_no-reply@adininworks.com",t[0].officialEmail),await Me("Leave Application ".concat(e),"<html>\n                     <body>\n                      <p> \n                        Dear ".concat(a.empName||"Not mention",", <br /> Your ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Supervisor, ").concat(T.name||"Not mention",'. \n                     </p>\n                      <p>Click here <a href="https://employee.adininworks.co">employee.adininworks.co</a> to view the status.</p>\n                     </body>\n                     </html>'),"leave_no-reply@adininworks.com",a.empOfficialEmail),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Supervisor ").concat(T.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:t[0].officialEmail,receipentEmpID:a.managerEmpID,status:"Unread"}),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Supervisor ").concat(T.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:a.empOfficialEmail,receipentEmpID:a.empID,status:"Unread"}),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Supervisor ").concat(T.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:"hr-notification@adininworks.com",status:"Unread"}))}catch(n){}};setTimeout((()=>{n()}),100)}else{const t=async()=>{try{await Me("Leave Application ".concat(e),"<html>\n                    <body>\n                      <p>\n                        Dear ".concat(a.empName||"Not mentioned",", <br />\n                        Your ").concat(a.empLeaveType," request for the period \n                        ").concat(r," has been ").concat(e," by Manager, ").concat(k.name||"Not mentioned",'.\n                      </p>\n                       <p>Click here <a href="https://employee.adininworks.co">employee.adininworks.co</a> to view the status.</p>\n                    </body>\n                  </html>'),"leave_no-reply@adininworks.com",a.empOfficialEmail),await Me("Leave Application ".concat(e),"<html>\n                    <body>\n                      <p> \n                        Your Employee Mr/Ms. ".concat(a.empName||"Not mentioned","'s, ").concat(a.empLeaveType," request for the period ").concat(r," has been ").concat(e," by Manager, ").concat(k.name||"Not mentioned",'.\n                      </p>\n                      <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n                    </body>\n                  </html>'),"leave_no-reply@adininworks.com","hr-notification@adininworks.com"),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Manager ").concat(k.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:a.empOfficialEmail,receipentEmpID:a.empID,status:"Unread"}),await I({empID:a.empID,leaveType:a.empLeaveType,message:"Leave request for ".concat(a.empName," has been ").concat(e," by Manager ").concat(k.name),senderEmail:"leave_no-reply@adininworks.com",receipentEmail:"hr-notification@adininworks.com",status:"Unread"})}catch(t){console.error("An error occurred:",t)}};setTimeout((()=>{t()}),100)}setTimeout((()=>{N(!0),w("/leaveManagement")}),500)})).catch((e=>console.log(e)))}else if("Tickets"===l){h===R?(n.hrStatus=e,n.hrRemarks=g,n.hrDate=i):"GENERAL MANAGER"===p&&(n.gmStatus=e,n.gmRemarks=g,n.gmDate=i);const t=r.empDepartureDate||y(r.departureDate),a=r.empArrivalDate||y(r.arrivalDate);E(r.id,n).then((async()=>{D("Ticket request ".concat(e," by ").concat(d.name," on ").concat(y(i)));const n=r.managerEmpID[r.managerEmpID.length-1],s=c.find((e=>e.empID===n));if(h===R&&"Verified"===e){if(m&&Array.isArray(m))for(const n of m)await Me("Ticket Request  ".concat("Verified"===e?"verified":"marked as not eligible"),"Your employee  ".concat(r.empName||"Not mention"," , Applied ticket request for the period ").concat(t," to ").concat(a," has been ").concat("Verified"===e?"verified":"marked as not eligible"," by HR Manager ").concat(d.name||"Not mention",'.\n              <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n               '),"hr_no-reply@adininworks.com",n);else console.log("Invalid email list");if(m&&Array.isArray(m)&&u&&Array.isArray(u))for(let n=0;n<m.length;n++)await I({empID:r.empID,leaveType:"Ticket Request",message:"Your employee ".concat(r.empName||"Not mentioned",", your ticket request for the period ").concat(t," to ").concat(a," has been ").concat("Verified"===e?"verified":"marked as not eligible"," by HR Manager ").concat(d.name),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:m[n],receipentEmpID:u[n],status:"Unread"});else console.log("Invalid GM email or Employee ID list")}else if(h===R&&"Not Eligible"===e)await Me("Ticket Request  ".concat("Verified"===e?"verified":"marked as not eligible"),"Dear  ".concat(r.empName||"Not mention"," , Your ticket request for the period ").concat(t," to ").concat(a," has been ").concat("Verified"===e?"verified":"marked as not eligible"," by HR Manager ").concat(d.name||"Not mention",'. <p>View at : <a href="https://employee.adininworks.co">employee.adininworks.co</a></p> '),"hr_no-reply@adininworks.com",r.empOfficialEmail),await Me("Ticket Request  ".concat("Verified"===e?"verified":"marked as not eligible"),"Your employee  ".concat(r.empName||"Not mention"," , Applied ticket request for the period ").concat(t," to ").concat(a," has been ").concat("Verified"===e?"Verified":"marked as not eligible"," by HR Manager ").concat(d.name||"Not mention",'.\n              <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n              '),"hr_no-reply@adininworks.com",s.officialEmail),await I({empID:r.empID,leaveType:"Ticket Request",message:"Dear ".concat(r.empName||"Not mentioned",", your ticket request for the period ").concat(t," to ").concat(a," has been ").concat("Verified"===e?"verified":"marked as not eligible"," by HR Manager ").concat(d.name||"Not mentioned","."),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:r.empOfficialEmail,receipentEmpID:r.empID,status:"Unread"}),await I({empID:r.empID,leaveType:"Ticket Request",message:"Your employee ".concat(r.empName||"Not mentioned",", your ticket request for the period ").concat(t," to ").concat(a," has been ").concat("Verified"===e?"verified":"marked as not eligible"," by HR Manager ").concat(d.name),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:s.officialEmail,receipentEmpID:r.managerEmpID,status:"Unread"});else if("GENERAL MANAGER"===p){if(await Me("Ticket Request ".concat(e),"Dear  ".concat(r.empName||"Not mention"," , Your ticket request for the period ").concat(t," to ").concat(a," has been ").concat(e," by GM ").concat(d.name||"Not mention",'. <p>View at : <a href="https://employee.adininworks.co">employee.adininworks.co</a></p> '),"hr_no-reply@adininworks.com",r.empOfficialEmail),await Me("Ticket Request ".concat(e),"Your employee  ".concat(r.empName||"Not mention"," , Applied ticket request for the period ").concat(t," to ").concat(a," has been ").concat(e," by GM ").concat(d.name||"Not mention",'.\n                <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>\n              '),"hr_no-reply@adininworks.com",s.officialEmail),x&&Array.isArray(x))for(const n of x)await Me("Ticket Request ".concat(e),"Your employee ".concat(r.empName||"Not mention"," applied for a ticket request for the period ").concat(t," to ").concat(a," and the request has been ").concat(e," by GM ").concat(d.name||"Not mention",'.<p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the updates.</p>'),"hr_no-reply@adininworks.com",n);else console.log("Invalid email list");await I({empID:r.empID,leaveType:"Ticket Request",message:"Dear ".concat(r.empName||"Not mentioned",", your ticket request for the period ").concat(t," to ").concat(a," has been ").concat(e," by General Manager ").concat(d.name),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:r.empOfficialEmail,receipentEmpID:r.empID,status:"Unread"}),await I({empID:r.empID,leaveType:"Ticket Request",message:"Your employee ".concat(r.empName||"Not mentioned",", your ticket request for the period ").concat(t," to ").concat(a," has been ").concat(e," by General Manager ").concat(d.name),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:s.officialEmail,receipentEmpID:r.empID,status:"Unread"}),await I({empID:r.empID,leaveType:"Ticket Request",message:"Your employee ".concat(r.empName||"Not mentioned",", your ticket request for the period ").concat(t," to ").concat(a," has been ").concat(e," by General Manager ").concat(d.name),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:x,status:"Unread"})}setTimeout((()=>{N(!0),w("/leaveManagement/requestTickets")}),1e3)})).catch((e=>console.log(e)))}},_=()=>O("Approved"),M=()=>O("Rejected");return(0,i.jsx)("main",{className:"flex flex-col items-center justify-center bg-grey bg-opacity-75 inset-0 z-50 fixed",children:(0,i.jsx)("div",{className:"center min-h-screen overflow-y-auto",children:(0,i.jsxs)("header",{className:"bg-white w-full max-w-[600px] rounded-lg relative p-5 ",children:[(0,i.jsx)("button",{onClick:t,className:"absolute top-5 right-6 border rounded-full p-1",children:(0,i.jsx)(A.RQJ,{size:20})}),(0,i.jsxs)("div",{className:" justify-items-center gap-4",children:[(0,i.jsx)("img",{src:Se.A,alt:"Logo",className:"max-w-[180px] w-full"}),(0,i.jsx)("h2",{className:"text-xl mt-2 font-bold underline",children:"LM"===l?"Leave Application Form":"Tickets"===l&&"Ticket Request Form"})]}),v&&(0,i.jsx)(Pe,{text:b,notification:v,path:j}),"LM"===l&&(0,i.jsxs)("section",{className:"shadow-md w-[500px] p-5 bg-white",children:[(0,i.jsxs)("div",{className:"text_size_6 ",children:[[{label:"Name",value:a.empName||""},{label:"Badge No",value:a.empBadgeNo},{label:"Job Title",value:Array.isArray(a.position)&&a.position.length>0?a.position[a.position.length-1]:"N/A"},{label:"Department",value:Array.isArray(a.department)&&a.department.length>0?a.department[a.department.length-1]:"N/A"},{label:"Leave Type",value:a.empLeaveType},{label:"Applied Dates",value:a.empLeaveSelectedFrom&&a.empLeaveSelectedTo?P(a.empLeaveSelectedFrom)&&P(a.empLeaveSelectedTo)?"".concat(y(a.empLeaveSelectedFrom)," to ").concat(y(a.empLeaveSelectedTo)):"".concat(a.empLeaveSelectedFrom," to ").concat(a.empLeaveSelectedTo):a.empLeaveStartDate&&a.empLeaveEndDate?"".concat(y(a.empLeaveStartDate)," to ").concat(y(a.empLeaveEndDate)):"N/A"},{label:"Total No of Days",value:a.leaveDays},{label:"Reason",value:a.reason}].map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:e.label}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.value]})]},t))),"Pending"===a.managerStatus&&"Pending"===a.supervisorStatus&&"SuperAdmin"!==o&&"HR"!==o&&h!==R&&(0,i.jsxs)("div",{className:"grid grid-cols-[150px_auto_1fr] gap-2 items-center pt-1",children:[(0,i.jsx)("label",{className:"font-semibold",htmlFor:"remark",children:"Remark"}),(0,i.jsx)("span",{className:"text-center",children:":"}),(0,i.jsx)("input",{id:"remark",type:"text",value:g,onChange:e=>f(e.target.value),className:"border border-lite_grey h-9 outline-none pl-2"})]}),"Pending"===a.managerStatus&&"Pending"!==a.supervisorStatus&&"Manager"===o&&"SuperAdmin"!==o&&"HR"!==o&&h!==R&&(0,i.jsxs)("div",{className:"grid grid-cols-[150px_auto_1fr] gap-2 items-center pt-1",children:[(0,i.jsx)("label",{className:"font-semibold",htmlFor:"remark",children:"Remark"}),(0,i.jsx)("span",{className:"text-center",children:":"}),(0,i.jsx)("input",{id:"remark",type:"text",value:g,onChange:e=>f(e.target.value),className:"border border-lite_grey h-9 outline-none pl-2"})]}),a.remark&&(0,i.jsxs)("div",{className:"grid grid-cols-2 py-6",children:[(0,i.jsx)("p",{children:"Comments:"}),(0,i.jsx)("p",{className:"text-start text-[16px] font-medium border border-grey w-full break-words overflow-hidden h-[51px]",children:a.empRemarks||"No remarks added"})]}),"SuperAdmin"===o||"HR"===o||h?(0,i.jsx)("div",{className:"font-medium",children:(0,i.jsxs)("table",{className:"w-full border-collapse",children:[(0,i.jsx)("thead",{className:"bg-gradient-to-r from-[#f5ee6ad7] via-[#faf362] to-[#f5ee6ad7] shadow-[0_4px_6px_rgba(255,250,150,0.5)]",children:(0,i.jsxs)("tr",{className:"text-[#6a2b2b] font-bold text-center",children:[(0,i.jsx)("th",{className:" p-1.5 rounded-tl-lg shadow-lg",children:"Role"}),(0,i.jsx)("th",{className:" p-1.5 shadow-md",children:"Status"}),(0,i.jsx)("th",{className:" p-1.5 rounded-tr-lg shadow-lg",children:"Remarks"})]})}),(0,i.jsxs)("tbody",{children:[a.supervisorEmpID&&(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"Supervisor"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat(C(a.supervisorStatus)),children:a.supervisorStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:a.supervisorRemarks||"No remarks"})]}),"Rejected"!==(null===a||void 0===a?void 0:a.supervisorStatus)&&(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"Manager"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat(C(a.managerStatus)),children:a.managerStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:a.managerRemarks||"No remarks"})]})]})]})}):"Supervisor"===o&&"Pending"!==a.supervisorStatus?(0,i.jsxs)("table",{className:"w-full mt-5 border-collapse",children:[(0,i.jsx)("thead",{className:"bg-gradient-to-r from-[#f5ee6ad7] via-[#faf362] to-[#f5ee6ad7] shadow-[0_4px_6px_rgba(255,250,150,0.5)]",children:(0,i.jsxs)("tr",{className:"text-[#6a2b2b] font-bold text-center",children:[(0,i.jsx)("th",{className:" p-1.5 rounded-tl-lg shadow-lg",children:"Role"}),(0,i.jsx)("th",{className:" p-1.5 shadow-md",children:"Status"}),(0,i.jsx)("th",{className:" p-1.5 rounded-tr-lg shadow-lg",children:"Remarks"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"Supervisor"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat(C(a.supervisorStatus)),children:a.supervisorStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:a.supervisorRemarks||"No remarks"})]}),"Approved"===a.supervisorStatus&&(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"Manager"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat(C(a.managerStatus)),children:a.managerStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:a.managerRemarks||"No remarks"})]})]})]}):"Manager"===o&&("Pending"!==a.managerStatus||a.supervisorEmpID?(0,i.jsxs)("table",{className:"w-full mt-5 border-collapse",children:[(0,i.jsx)("thead",{className:"bg-gradient-to-r from-[#f5ee6ad7] via-[#faf362] to-[#f5ee6ad7] shadow-[0_4px_6px_rgba(255,250,150,0.5)]",children:(0,i.jsxs)("tr",{className:"text-[#6a2b2b] font-bold text-center",children:[(0,i.jsx)("th",{className:" p-1.5 rounded-tl-lg shadow-lg",children:"Role"}),(0,i.jsx)("th",{className:" p-1.5 shadow-md",children:"Status"}),(0,i.jsx)("th",{className:" p-1.5 rounded-tr-lg shadow-lg",children:"Remarks"})]})}),(0,i.jsxs)("tbody",{children:[a.supervisorEmpID&&(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"Supervisor"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat(C(a.supervisorStatus)),children:a.supervisorStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:a.supervisorRemarks||"No remarks"})]}),"Pending"!==a.managerStatus&&(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"Manager"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat(C(a.managerStatus)),children:a.managerStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:a.managerRemarks||"No remarks"})]})]})]}):null)]}),(0,i.jsx)("div",{className:"flex justify-between px-5 mt-6",children:(()=>{const{supervisorStatus:e,managerStatus:t,supervisorEmpID:r}=a,n="Pending"===t,s="Approved"===e,l="SuperAdmin"!==o&&"HR"!==o;return s&&"Rejected"!==e&&n&&"Supervisor"===o&&l?(0,i.jsx)("div",{className:"center w-full"}):"Pending"===e&&r&&l||s&&n&&l||n&&(""===r||null===r)&&l?(0,i.jsxs)("div",{className:"w-full flex justify-evenly",children:[(0,i.jsx)("button",{className:"hover:bg-medium_red hover:border-medium_red border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:M,children:"Reject"}),(0,i.jsx)("button",{className:"hover:bg-[#faf362] border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:_,children:"Approve"})]}):null})()})]}),"Tickets"===l&&(0,i.jsxs)("section",{className:"px-5 bg-white",children:[(0,i.jsxs)("div",{className:"text_size_6 mt-5",children:[[{label:"Name",value:r.empName},{label:"Badge Number",value:r.empBadgeNo||"N/A"},{label:"Department",value:Array.isArray(r.department)&&r.department.length>0?r.department[r.department.length-1]:"N/A"},{label:"Position",value:Array.isArray(r.position)&&r.position.length>0?r.position[r.position.length-1]:"N/A"},{label:"Date of Join",value:y(r.doj)||"N/A"},{label:"Destination",value:r.destination},{label:"Departure Date",value:r.empDepartureDate?P(r.empDepartureDate)?"".concat(y(r.empDepartureDate)):"".concat(r.empDepartureDate):r.departureDate?"".concat(y(r.departureDate)):"N/A"},{label:"Arrival Date",value:r.empArrivalDate?P(r.empArrivalDate)?"".concat(y(r.empArrivalDate)):"".concat(r.empArrivalDate):r.arrivalDate?"".concat(y(r.arrivalDate)):"N/A"},{label:"Employee Remarks",value:r.empRemarks||"N/A"}].filter(Boolean).map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[(0,i.jsx)("strong",{className:"w-full",children:e.label}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.value]})]},t))),("SuperAdmin"===o||h===R||"GENERAL MANAGER"===p)&&"Pending"!==r.hrStatus&&(0,i.jsxs)("table",{className:"w-full mt-5 border-collapse",children:[(0,i.jsx)("thead",{className:"bg-gradient-to-r from-[#f5ee6ad7] via-[#faf362] to-[#f5ee6ad7] shadow-[0_4px_6px_rgba(255,250,150,0.5)]",children:(0,i.jsxs)("tr",{className:"text-[#6a2b2b] font-bold text-center",children:[(0,i.jsx)("th",{className:" p-1.5 rounded-tl-lg shadow-lg",children:"Role"}),(0,i.jsx)("th",{className:" p-1.5 shadow-md",children:"Status"}),(0,i.jsx)("th",{className:" p-1.5 rounded-tr-lg shadow-lg",children:"Remarks"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"HR Manager"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat((F=r.hrStatus,"Not Eligible"===F?"text-[red]":"Verified"===F?"text-[#339933]":"text-[#E8A317]")),children:r.hrStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:r.hrRemarks||"No remarks"})]}),("Approved"===r.gmStatus||"Rejected"===r.gmStatus)&&(0,i.jsxs)("tr",{className:"border-b border-lite_grey",children:[(0,i.jsx)("td",{className:"p-2 text-center font-semibold",children:"GM"}),(0,i.jsx)("td",{className:"text-center font-bold p-2 ".concat((e=>"Rejected"===e?"text-[red]":"Approved"===e?"text-[#339933]":"text-[#E8A317]")(r.gmStatus)),children:r.gmStatus}),(0,i.jsx)("td",{className:"p-2 break-words max-w-[200px] text-center text-grey",children:r.gmRemarks||"No remarks"})]})]})]}),"Pending"===r.hrStatus&&h===R&&(0,i.jsxs)("div",{className:"grid grid-cols-[150px_auto_1fr] gap-2 items-center",children:[(0,i.jsx)("label",{className:"font-semibold",htmlFor:"remark",children:"Remark"}),(0,i.jsx)("span",{className:"text-center",children:":"}),(0,i.jsx)("input",{id:"remark",type:"text",value:g,onChange:e=>f(e.target.value),className:"border border-lite_grey h-9 outline-none pl-2"})]}),"GENERAL MANAGER"===p&&"Pending"===r.gmStatus&&"Pending"!==r.hrStatus&&"SuperAdmin"!==o&&(0,i.jsxs)("div",{className:"grid grid-cols-[150px_auto_1fr] gap-2 items-center mt-4",children:[(0,i.jsx)("label",{className:"font-semibold",htmlFor:"remark",children:"Remark"}),(0,i.jsx)("span",{className:"text-center",children:":"}),(0,i.jsx)("input",{id:"remark",type:"text",value:g,onChange:e=>f(e.target.value),className:"border border-lite_grey h-9 outline-none pl-2"})]})]}),(0,i.jsx)("div",{className:"flex justify-evenly mt-7 ",children:"Pending"===r.hrStatus&&h===R&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{className:"hover:bg-medium_red hover:border-medium_red border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:()=>O("Not Eligible"),children:"Not Eligible"}),(0,i.jsx)("button",{className:"hover:bg-[#faf362] border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:()=>O("Verified"),children:"Verify"})]})}),(0,i.jsx)("div",{className:"flex justify-evenly mt-7 ",children:"Pending"===r.gmStatus&&"Pending"!==r.hrStatus&&"GENERAL MANAGER"===p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{className:"hover:bg-medium_red hover:border-medium_red border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:M,children:"Reject"}),(0,i.jsx)("button",{className:"hover:bg-[#faf362] border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:_,children:"Approve"})]})})]})]})})});var F},Ue=(0,Ee.D)(),Be=e=>{const[t,a]=(0,n.useState)({empID:"",profilePhoto:"",name:"",email:"",officialEmail:"",contactNo:""}),[r,s]=(0,n.useState)({empID:"",department:"",position:""}),[i,l]=(0,n.useState)(!0),[o,d]=(0,n.useState)(null);return(0,n.useEffect)((()=>{e&&(async()=>{l(!0),d(null);let t=[],r=[],n=null,i=null;try{do{const e=await Ue.graphql({query:Ie.it,variables:{nextToken:n}});t=[...t,...e.data.listEmpPersonalInfos.items],n=e.data.listEmpPersonalInfos.nextToken}while(n);do{const e=await Ue.graphql({query:Ie.bJ,variables:{nextToken:i}});r=[...r,...e.data.listEmpWorkInfos.items],i=e.data.listEmpWorkInfos.nextToken}while(i);if(0===t.length)return d("No employee data found."),void l(!1);const o=t.find((t=>t.empID.toLowerCase()===e.toLowerCase()));o?a({empID:o.empID,profilePhoto:o.profilePhoto,name:o.name,email:o.email,officialEmail:o.officialEmail,contactNo:o.contactNo||""}):d("No matching employee found for userID: ".concat(e));const c=r.find((t=>t.empID.toLowerCase()===e.toLowerCase()));c&&s({empID:c.empID,department:c.department,position:c.position})}catch(o){d("Error fetching employee data."),console.error("Error fetching data:",o)}finally{l(!1),console.log("Finished fetching employee data")}})()}),[e]),{personalInfo:t,workInfo:r,loading:i,error:o}},qe=()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(!1),[l,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),[p,m]=(0,n.useState)(""),[u,h]=(0,n.useState)(""),{mergedData:x,handleDeleteLeaveStatus:g,handleUpdateLeaveStatus:f,ticketMerged:v,statusUpdate:N,loading:b}=Ce();(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");h(e);const t=localStorage.getItem("userType");m(t)}),[]);const{personalInfo:D}=Be(u),j=()=>{s(!a)};return(0,i.jsxs)("section",{className:"py-20 px-10",children:[(0,i.jsx)("div",{className:"screen-size",children:(0,i.jsx)("section",{className:"center w-full ",children:(0,i.jsx)(r.sv,{context:{handleClickForToggle:j,ticketMerged:v,handleViewClick:(e,a)=>{t(a),"LM"===a?(o(e),c(null)):"Tickets"===a&&(c(e),o(null)),s(!0)},handleDeleteLeaveStatus:g,personalInfo:D,userType:p,userID:u,statusUpdate:N,mergedData:x,loading:b}})})}),a&&(l||d)&&(0,i.jsx)(Le,{handleClickForToggle:j,leaveData:l,ticketData:d,source:e,formatDate:y,onUpdate:async(e,t,a)=>{try{await f(e,{status:t,remark:a}),o(null),s(!1)}catch(r){console.error("Error updating leave status:",r)}},userType:p,ticketRequest:v,personalInfo:D})]})};const He=a.p+"static/media/employe.d4554af3635635f26902dae2b06680f2.svg";const We=a.p+"static/media/traning.82964b9a459bea314def5330e8e9047a.svg";const ze=a.p+"static/media/Attendance.52145dae4a7775b8084778d3dedf9b85.svg";const Ye=a.p+"static/media/compensation.e309759c765c15ce416171a726ee3089.svg";const Ve=a.p+"static/media/termination.174a3bcb54bd3ff036483320ce18f0c9.svg";const Ge=a.p+"static/media/consequence.fb13728a90c51841c1bf0d69ef03d1a4.svg";var Je=a(2051),Ke=a(3237);a(2340);Je.EA.workerSrc=new URL(a(1886),a.b).toString();const Qe=()=>{const[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(!1),[s,l]=(0,n.useState)([]);(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,n.useEffect)((()=>{(async()=>{const e=["public/benefitsRewards/EmploymentPolicy.pdf","public/benefitsRewards/TrainingDevelopment.pdf","public/benefitsRewards/AttendanceWorkSchedule.pdf","public/benefitsRewards/CompensationBenefit.pdf","public/benefitsRewards/TerminationfromtheCompany.pdf","public/benefitsRewards/ConsequenceManagement.pdf"],t=[];for(const a of e){const e=await(0,f.I)({path:a});t.push(e.url.toString())}l(t)})()}),[]);const o=[{img:He,text:"Employment Policy"},{img:We,text:"Training & Development"},{img:ze,text:"Attendance & Work Schedule"},{img:Ye,text:"Compensation & Benefits"},{img:Ve,text:"Termination from the Company"},{img:Ge,text:"Consequence Management"}];return(0,i.jsxs)("section",{className:"min-h-screen bg-[#F5F6F1] p-16",children:[(0,i.jsx)("div",{className:"flex justify-start flex-wrap gap-x-20 text-black",children:o.map(((e,n)=>(0,i.jsx)(F,{img:e.img,text1:e.text,fontSize:"text_size_5",borderColor:"border-[#0AA818]",bgColor:"bg-white",onClick:()=>{var e;(e=s[n])?(t(e),r(!a)):console.error("PDF link is not available.")}},n)))}),a&&(0,i.jsx)("section",{className:"fixed top-0 left-0 w-full min-h-screen z-50 bg-grey flex justify-center",children:(0,i.jsxs)("div",{className:"w-[80%] max-h-[90vh] py-3",children:[(0,i.jsx)("p",{className:"text-xl text-dark_grey flex justify-end my-5 px-3",onClick:()=>{r(!a)},children:(0,i.jsx)("span",{className:"bg-medium_white px-3 py-1 rounded-lg font-medium cursor-pointer",children:"Close"})}),(0,i.jsx)("div",{className:"invoice-content flex justify-center  w-full h-[calc(100vh-8rem)] overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:e||""})})})]})})]})};var $e=a(397);const Ze=e=>{var t,a;let{toggleFunction:r,specificNotificationDetails:n}=e;const s=(null===n||void 0===n?void 0:n.message)||"",l=/(\d+)-([A-Za-z0-9]+)-([A-Za-z\s]+)-([A-Za-z\s]+)-(\d{2}-\d{2}-\d{4})/g,o=[];let d;for(;null!==(d=l.exec(s));)o.push({empID:d[1],badgeNo:d[2],name:d[3],position:d[4],expiryDate:d[5]});let c="";const p=(null===n||void 0===n?void 0:n.message)||"",m=p.includes("Dear");var u;m?c=(null===(u=p.split("Dear")[1])||void 0===u?void 0:u.trim())||"":c=p;let h=c?c.split(/(?<=[.!?])\s+/):[],x=[];m?(x.push("Dear"),x.push(...h)):x.push(...h);const g=x.length-1;g>=0&&x[g]&&!x[g].endsWith(".")&&(x[g]+=".");const f=null!==n&&void 0!==n&&null!==(t=n.leaveType)&&void 0!==t&&t.includes("Training Requestor")?null===n||void 0===n?void 0:n.message:"",v=f.indexOf("["),N=f.lastIndexOf("]")+1,b=-1!==v?f.slice(0,v).trim():"";let D=[];if(-1!==v&&-1!==N)try{const e=f.slice(v,N);D=JSON.parse(e)}catch(j){console.error("Failed to parse course array:",j)}return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center py-5 z-50",children:(0,i.jsx)("div",{className:"center w-full ",children:["Passport Expiry","Employment Pass Expiry","LD Expiry","Medical Expiry","Training Certificate Expiry","Probation Review Expiry","Contract Expiry"].includes(null===n||void 0===n?void 0:n.leaveType)?(0,i.jsxs)("section",{className:"bg-[#FBFBFB] p-5 gap-2 flex flex-col item-center rounded-lg shadow-md border h-full overflow-auto",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,i.jsx)($e.Ohx,{className:"text-2xl cursor-pointer",onClick:r}),(0,i.jsx)("p",{className:"text-dark_grey text-[14px] pl-5",children:n.date})]}),(0,i.jsxs)("div",{className:"grid gap-4 mt-2",children:[(0,i.jsx)("p",{className:"text-[18px] font-medium text-center",children:null===n||void 0===n?void 0:n.leaveType}),(0,i.jsx)("p",{className:"text-[16px] font-medium",children:null===n||void 0===n?void 0:n.message.split(":")[0].trim()}),(0,i.jsx)("p",{className:"text-[16px] font-bold",children:"Employee Details :"}),(0,i.jsxs)("table",{className:"min-w-full mt-3",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"border p-2",children:"S.No"}),(0,i.jsx)("th",{className:"border p-2",children:"EmpID"}),(0,i.jsx)("th",{className:"border p-2",children:"Badge No"}),(0,i.jsx)("th",{className:"border p-2",children:"Name"}),(0,i.jsx)("th",{className:"border p-2",children:"position"}),(0,i.jsx)("th",{className:"border p-2",children:"Expiry Date"})]})}),(0,i.jsx)("tbody",{children:o.map(((e,t)=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"border p-2",children:t+1}),(0,i.jsx)("td",{className:"border p-2",children:e.empID}),(0,i.jsx)("td",{className:"border p-2",children:e.badgeNo}),(0,i.jsx)("td",{className:"border p-2",children:e.name}),(0,i.jsx)("td",{className:"border p-2",children:e.position}),(0,i.jsx)("td",{className:"border p-2",children:e.expiryDate})]},t)))})]}),(0,i.jsx)("p",{className:"text-[16px] font-medium",children:null===n||void 0===n||null===(a=n.message.split(/(?=\bKindly take the necessary action\b)/)[1])||void 0===a?void 0:a.trim()})]})," "]}):null!==n&&void 0!==n&&n.leaveType.includes("Training Requestor")?(0,i.jsxs)("section",{className:"bg-[#FBFBFB] p-5 gap-2 flex flex-col item-center rounded-lg shadow-md w-[70%]",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,i.jsx)($e.Ohx,{className:"text-2xl cursor-pointer",onClick:r}),(0,i.jsx)("p",{className:"text-dark_grey text-[14px] pl-5",children:n.date})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-3",children:[(0,i.jsx)("p",{className:"text-[16px] font-bold",children:"Emp ID :"}),(0,i.jsx)("p",{className:"text-dark_grey text-[14px] font-medium pl-5",children:null===n||void 0===n?void 0:n.empID})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-2",children:[(0,i.jsx)("p",{className:"text-[16px] font-bold",children:"Subject :"}),(0,i.jsxs)("p",{className:"text-dark_grey text-[14px] font-medium pl-5",children:[" ",n.leaveType]})]}),(0,i.jsxs)("div",{className:"grid mt-2",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-2",children:[(0,i.jsx)("p",{className:" text-[16px] font-bold",children:"Description : "}),(0,i.jsx)("p",{className:"text-dark_grey text-[14px] font-medium pl-5",children:b})]}),(0,i.jsxs)("table",{className:"border my-10",children:[(0,i.jsx)("thead",{className:"border",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"border px-3 py-2",children:"S.No"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Course Code"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Course Name"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Company"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Start Date"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"End Date"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Status"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"MR No"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Fee"})]})}),(0,i.jsx)("tbody",{children:D.map(((e,t)=>{var a;return(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"border  px-2 py-1",children:t+1}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:e.courseCode}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:e.courseName}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:e.company}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:y(e.traineeSD)}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:y(e.traineeED)}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:e.traineeStatus||"-"}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:e.MRNo||"-"}),(0,i.jsx)("td",{className:"border  px-2 py-1",children:(null===(a=e.traineeCourseFee)||void 0===a?void 0:a.trim())||"-"})]},t)}))})]})]})]}):(0,i.jsxs)("section",{className:"bg-[#FBFBFB] p-5 gap-2 flex flex-col item-center rounded-lg shadow-md max-w-md  w-full",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,i.jsx)($e.Ohx,{className:"text-2xl cursor-pointer",onClick:r}),(0,i.jsx)("p",{className:"text-dark_grey text-[14px] pl-5",children:n.date})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-3",children:[(0,i.jsx)("p",{className:"text-[16px] font-bold",children:"Emp ID :"}),(0,i.jsx)("p",{className:"text-dark_grey text-[14px] font-medium pl-5",children:null===n||void 0===n?void 0:n.empID})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-2",children:[(0,i.jsx)("p",{className:"text-[16px] font-bold",children:"Subject :"}),(0,i.jsxs)("p",{className:"text-dark_grey text-[14px] font-medium pl-5",children:[" ",n.leaveType]})]}),(0,i.jsxs)("div",{className:"grid mt-2",children:[(0,i.jsx)("p",{className:" text-[16px] font-bold",children:"Description :"}),x.map(((e,t)=>(0,i.jsx)("p",{className:"text-dark_grey text-[14px] font-medium mt-2",children:e.trim()},t)))]})]})})})},Xe=()=>{const{matchingNotifications:e,handleReadMore:t}=(0,h.q)(),[a,r]=(0,n.useState)(!1),[s,l]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{void 0!==e&&null!==e&&d(!1)}),[e]),(0,i.jsxs)("section",{className:"p-10 bg-[#F7F8F4] shadow-md rounded-lg min-h-screen",children:[(0,i.jsxs)("div",{className:"bg-white rounded-2xl",children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold pt-5 pl-16 text-dark_grey",children:"Notification"}),(0,i.jsx)("p",{className:"border-b-2 border-[#959595] mt-4"})]}),o?(0,i.jsx)("div",{className:"text-center p-7 mt-20",children:(0,i.jsx)("span",{children:"Loading..."})}):e.length>0?(0,i.jsxs)("table",{className:"w-full text-sm",children:[(0,i.jsx)("thead",{className:"text-grey",children:(0,i.jsxs)("tr",{className:"uppercase bg-[#F1F1F1]",children:[(0,i.jsx)("th",{className:"p-7 text-left",children:"Date"}),(0,i.jsx)("th",{className:"p-7 text-left",children:"Subject"}),(0,i.jsx)("th",{className:"p-7 text-left",children:"Action"}),(0,i.jsx)("th",{className:"p-7 text-left",children:"Status"})]})}),(0,i.jsx)("tbody",{children:[...e].sort(((e,t)=>new Date(t.date)-new Date(e.date))).map(((e,a)=>{var n;return(0,i.jsxs)("tr",{className:"border-b last:border-b-0",children:[(0,i.jsx)("td",{className:"p-7 w-[150px]",children:e.date}),(0,i.jsxs)("td",{className:"p-7 text_size_6 text-dark_grey flex flex-col gap-y-3",children:[e.leaveType," ",(0,i.jsx)("br",{}),(0,i.jsxs)("span",{className:"text-sm text-dark_ash",children:[null===e||void 0===e||null===(n=e.message)||void 0===n?void 0:n.split(":")[0].trim(),"..."]})]}),(0,i.jsx)("td",{className:"text-center",children:(0,i.jsx)("span",{className:"border-b-2 py-1 cursor-pointer",onClick:()=>{r(!0),l(e),t(e,a)},children:"Read More"})}),(0,i.jsx)("td",{className:"px-4 text-center",children:"Read"===e.status?(0,i.jsx)("div",{className:"mt-3.5 w-[60px] label-read",children:(0,i.jsx)("span",{className:"flex justify-center items-center text-grey",children:"Seen"})}):(0,i.jsx)("div",{className:"mt-3.5 w-[60px] border label-new",children:(0,i.jsx)("span",{className:"flex justify-center items-center text-white",children:"New"})})})]},a)}))})]}):(0,i.jsx)("div",{className:"text-center p-7 mt-20",children:(0,i.jsx)("span",{children:"No Notifications Found"})})]}),a&&s&&(0,i.jsx)(Ze,{toggleFunction:()=>r(!1),specificNotificationDetails:s})]})},et=()=>(0,i.jsx)("div",{children:"Logout"});var tt=a(4858),at=a(784),rt=a(2902),nt=a(1580),st=a(3305),it=a(9722);const lt=async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=(await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result).path,i=(new Date).toISOString().split("T")[0];"number"===typeof n&&a((e=>{const a=(0,g.A)({},e);a[t]=a[t]||[],a[t][n]=a[t][n]||[];return a[t][n].find((e=>e.upload===s))||a[t][n].push({upload:s,date:i}),a})),a((e=>(0,g.A)((0,g.A)({},e),{},{[t]:s})))}}catch(s){}},ot=async(e,t,a)=>{try{if(!e)return null;const r=encodeURIComponent(e.name),n="https://gnth2qx5cf.execute-api.ap-southeast-1.amazonaws.com/fileupload/aweadininprod2024954b8-prod/public%2F".concat(t,"%2F").concat(a,"%2F").concat(r);await it.A.put(n,e).then((e=>{console.log("Full response from API:",e)})).catch((e=>{var t,a;(console.error("Error details:",e),e.response)?(console.error("Server responded with error status:",null===(t=e.response)||void 0===t?void 0:t.status),console.error("Server error data:",null===(a=e.response)||void 0===a?void 0:a.data)):e.request?console.error("No response received from server"):console.error("Error setting up the request");throw e}));const s=decodeURIComponent(r);return"https://aweadininprod2024954b8-prod.s3.ap-southeast-1.amazonaws.com/public/".concat(t,"/").concat(a,"/").concat(s)}catch(r){throw console.error("Caught error in uploadReqString:",r),console.error("Error stack:",r.stack),r}},dt=async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=(await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result).path,i=(new Date).toISOString().split("T")[0];"number"===typeof n&&a((e=>{const a=(0,g.A)({},e);a[t]||(a[t]=[]),Array.isArray(a[t][n])||(a[t][n]=[]);return a[t][n].find((e=>e.upload===s))||a[t][n].push({upload:s,date:i}),a})),a((e=>(0,g.A)((0,g.A)({},e),{},{[t]:[...e[t]||[],{upload:s,date:i}]})))}}catch(s){console.log("Error uploading ".concat(t,":, error"))}},ct=async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=(await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result).path,i=(new Date).toISOString().split("T")[0];a("number"===typeof n?e=>{const a=(0,g.A)({},e);a[t]||(a[t]=[]),Array.isArray(a[t][n])||(a[t][n]=[]);return a[t][n].find((e=>e.upload===s))||a[t][n].push({upload:s,date:i}),a}:e=>(0,g.A)((0,g.A)({},e),{},{[t]:[...e[t]||[],{upload:s,date:i}]}))}}catch(s){console.log("Error uploading ".concat(t,":"),s)}};var pt=a(3536);const mt=e=>{var t,a,r,s,l;let{label:o,name:d,type:c="text",options:p=[],register:m,value:u,errors:h,select:x,onChange:f,valueData:v,setValue:y,append:N,isArray:b,control:D,errorValue:j,arrayString:A,trackEmpID:w}=e;const[S,E]=(0,n.useState)(u||(b?[]:""));(0,n.useEffect)((()=>{if(void 0!==u){const e=Array.isArray(u)?u.map((e=>e.trim())):u.trim();E(e)}}),[u,b]);const I=null===(t=(0,pt.get)(h,d))||void 0===t?void 0:t.message,k=e=>{const t=e.target.value.toUpperCase();if(N){const a=S.includes(t)?S:[...S,t];E(a),y&&y(d,a),f&&f(e)}else E(t),y&&y(d,b?[t]:t),f&&f(e)},T=p.map((e=>(0,g.A)((0,g.A)({},e),{},{value:(null===e||void 0===e||e.value,null===e||void 0===e?void 0:e.value.trim().toUpperCase()),label:"string"===typeof(null===e||void 0===e?void 0:e.label)?null===e||void 0===e?void 0:e.label.trim().toUpperCase():null===e||void 0===e?void 0:e.label})));return(0,i.jsxs)("div",{className:"form-group w-full",children:[(0,i.jsx)("label",{className:"block text_size_6",children:o}),"selectOption"===c?(0,i.jsxs)("select",(0,g.A)((0,g.A)({className:"input-field select-custom"},m(d)),{},{value:Array.isArray(S)?S[(null===S||void 0===S?void 0:S.length)-1]||"":S||"",onChange:e=>{k(e)},children:[(0,i.jsx)("option",{value:"",children:x||" "}),T.map(((e,t)=>(0,i.jsx)("option",{value:e.value,children:e.label},t)))]})):"select"===c?(0,i.jsxs)("select",(0,g.A)((0,g.A)({className:"input-field select-custom"},m(d)),{},{onChange:k,children:[(0,i.jsx)("option",{value:"".concat(v||""),children:x}),T.map(((e,t)=>(0,i.jsx)("option",{value:e.value,children:e.label},t)))]})):A&&D?(0,i.jsx)(tt.xI,{name:d,control:D,render:e=>{let{field:t}=e;return(0,i.jsx)("div",{children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",className:"input-field border"},t),{},{value:t.value||"",onChange:e=>{const a=e.target.value;t.onChange(b?[a]:a)},disabled:w}))})}}):(0,i.jsx)("input",(0,g.A)({type:c,value:u,className:"input-field border",disabled:w},m(d))),"other"===S&&(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field border mt-2",placeholder:"Please specify",value:u,disabled:w},m("".concat(d,"Details")))),(null===j||void 0===j||null===(a=j[d])||void 0===a||null===(r=a[0])||void 0===r?void 0:r.message)&&(0,i.jsx)("p",{className:"text-[red] text-[12px] pt-2",children:null===j||void 0===j||null===(s=j[d])||void 0===s||null===(l=s[0])||void 0===l?void 0:l.message}),I&&(0,i.jsx)("p",{className:"text-[red] text-[12px] pt-2",children:I})]})};var ut=a(6833);const ht=[{value:"Male",label:"Male"},{value:"Female",label:"Female"}],xt=[{value:"Australian",label:"Australian"},{value:"Bangladeshi",label:"Bangladeshi"},{value:"Bidayuh",label:"Bidayuh"},{value:"British",label:"British"},{value:"Bisaya",label:"Bisaya"},{value:"Chinese",label:"Chinese"},{value:"Dayak",label:"Dayak"},{value:"Dusun",label:"Dusun"},{value:"Dusun Muslim",label:"Dusun Muslim"},{value:"Eurasian",label:"Eurasian"},{value:"Filipino",label:"Filipino"},{value:"Iban",label:"Iban"},{value:"Iban Chinese",label:"Iban Chinese"},{value:"Iban Dayak",label:"Iban Dayak"},{value:"Iban Muslim",label:"Iban Muslim"},{value:"Indian",label:"Indian"},{value:"Indonesian",label:"Indonesian"},{value:"Java",label:"Java"},{value:"Kadazan",label:"Kadazan"},{value:"Kayan",label:"Kayan"},{value:"Kedayan",label:"Kedayan"},{value:"Kelabit",label:"Kelabit"},{value:"Kenyah",label:"Kenyah"},{value:"Lun Bawang",label:"Lun Bawang"},{value:"Malay",label:"Malay"},{value:"Melanau",label:"Melanau"},{value:"Murut",label:"Murut"},{value:"Muslim",label:"Muslim"},{value:"Srilankan",label:"Srilankan"},{value:"Thai",label:"Thai"},{value:"Ukit",label:"Ukit"},{value:"Kiput",label:"Kiput"},{value:"Other",label:"Other"},{value:"Not Mentioned",label:"Not Mentioned"}],gt=[{value:"Islam",label:"Islam"},{value:"Christian",label:"Christian"},{value:"Hindu",label:"Hindu"},{value:"Buddhist",label:"Buddhist"},{value:"Free Thinker",label:"Free Thinker"},{value:"Not Mentioned",label:"Not Mentioned"},{value:"Others",label:"Others"}],ft=[{value:"Local",label:"Local"},{value:"Foreigner",label:"Foreigner"}],vt=[{value:"Single",label:"Single"},{value:"Married",label:"Married"},{value:"Widow",label:"Widow"},{value:"Divorce",label:"Divorce"}],yt=[{value:"Bruneian",label:"Bruneian"},{value:"Brunei PR",label:"Brunei PR"},{value:"Malaysian",label:"Malaysian"},{value:"Indonesian",label:"Indonesian"},{value:"Indian",label:"Indian"},{value:"Bangladeshi",label:"Bangladeshi"},{value:"Thai",label:"Thai"},{value:"Sri Lankan",label:"Sri Lankan"},{value:"Filipino",label:"Filipino"},{value:"Other",label:"Other"}],Nt=[{value:"Local",label:"Local"},{value:"LPA",label:"LPA"},{value:"SAWP",label:"SAWP"}],bt=[{value:"Monthly",label:"Monthly"},{value:"Daily",label:"Daily"}],Dt=[{value:"Onshore",label:"Onshore"},{value:"Offshore",label:"Offshore"}],jt=[{value:"Yellow",label:"Yellow"},{value:"Red",label:"Red"},{value:"Green",label:"Green"},{value:"Purple",label:"Purple"}],At=[{label:"Brunei IC Loc/Non-Loc",icon:(0,i.jsx)(ut.gwN,{}),title:"bwnUpload"},{label:"Malaysia IC",icon:(0,i.jsx)(ut.gwN,{}),title:"myIcUpload"},{label:"Passport Copy",icon:(0,i.jsx)(ut.gwN,{}),title:"ppUpload"},{label:"CV",icon:(0,i.jsx)(ut.gwN,{}),title:"cvCertifyUpload"},{label:"Certificates",icon:(0,i.jsx)(ut.gwN,{}),title:"qcCertifyUpload"},{label:"Application Form",icon:(0,i.jsx)(ut.gwN,{}),title:"applicationUpload"},{label:"LOI",icon:(0,i.jsx)(ut.gwN,{}),title:"loiUpload"},{label:"PAAF/CVEV Approval",icon:(0,i.jsx)(ut.gwN,{}),title:"paafCvevUpload"},{label:"Any Supporting Doc",icon:(0,i.jsx)(ut.gwN,{}),title:"supportDocUpload"}],wt=[{value:"own",label:"Own"},{value:"company",label:"Company"}],St=[{value:"Employee alone",label:"Employee alone"},{value:"Employee & Spouse",label:"Employee & Spouse"},{value:"Employee, Spouse & Children (max 2 pax below age 18)",label:"Employee, Spouse & Children (max 2 pax below age 18)"}],Et=[{value:"Accounts",label:"Accounts"},{value:"BLNG",label:"BLNG"},{value:"Corporate",label:"Corporate"},{value:"CPD",label:"CPD"},{value:"E&I",label:"E&I"},{value:"SBW",label:"SBW"},{value:"Human Resource",label:"Human Resource"},{value:"LBD",label:"LBD"},{value:"Offshore",label:"Offshore"},{value:"Purchasing",label:"Purchasing"},{value:"Other",label:"Other"}],It=[{label:"Contract",icon:(0,i.jsx)(ut.gwN,{}),title:"WIContract"},{label:"Probation",icon:(0,i.jsx)(ut.gwN,{}),title:"WIProbation"},{label:"Resignation",icon:(0,i.jsx)(ut.gwN,{}),title:"WIResignation"},{label:"Termination",icon:(0,i.jsx)(ut.gwN,{}),title:"WITermination"},{label:"Leave Entitlement",icon:(0,i.jsx)(ut.gwN,{}),title:"WILeaveEntitle"}],kt=()=>{var e,t,a;const{empPDData:l}=(0,n.useContext)(s.Y),{tempID:o}=(0,Fe.b)(),d=(0,r.zy)(),c=(0,r.Zp)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{register:p,handleSubmit:m,setValue:u,watch:h,formState:{errors:x}}=(0,tt.mN)({resolver:(0,at.t)(rt.gO),defaultValues:{}}),[y,N]=(0,n.useState)({profilePhoto:null}),[b,D]=(0,n.useState)(null),[A,w]=(0,n.useState)(""),[S,E]=(0,n.useState)(""),[I,k]=(0,n.useState)({profilePhoto:null});(0,n.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("profileStore"));e&&Object.keys(e).forEach((async t=>{if("profilePhoto"===t&&e[t])try{const a=(await(0,f.I)({path:e[t]})).url.toString();E(a),u(t,a)}catch(a){console.error("Error setting value for ".concat(t,":"),a)}else u(t,e[t])}));const t=()=>{localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore")};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[d,u]),(0,n.useEffect)((()=>{const e=["age","agent","chinese","cob","contractType","dob","email","empType","gender","marital","name","nationality","otherNation","otherRace","otherReligion","position","profilePhoto","race","religion"];if(o&&l.length>0){const t=l.find((e=>e.tempID===o));t&&(e.forEach((e=>{if("familyDetails"===e||"workExperience"===e||"eduDetails"===e){if(Array.isArray(t[e])&&"string"===typeof t[e][0]){let a=(e=>{try{let t=e.replace(/\\/g,"");t=t.replace(/'/g,'"'),t=t.replace(/([{,])(\s*)([a-zA-Z0-9_]+)(\s*):/g,'$1"$3":'),t=t.replace(/:([a-zA-Z0-9_/.\s]+)(?=\s|,|\})/g,':"$1"'),t.startsWith('"')&&t.endsWith('"')&&(t=t.slice(1,-1));const a=JSON.parse(t);return Array.isArray(a)?a:[]}catch(t){return console.error("Error parsing details:",t),[]}})(t[e][0]);a.length>0&&u(e,a)}}else t[e]&&u(e,t[e])})),t.profilePhoto&&(N((e=>(0,g.A)((0,g.A)({},e),{},{profilePhoto:t.profilePhoto}))),u("profilePhoto",t.profilePhoto)))}}),[o,u,l]);(0,n.useEffect)((()=>{y.profilePhoto&&(async e=>{const t=await(0,f.I)({path:e});w(t.url.toString())})(y.profilePhoto)}),[y.profilePhoto]);return(0,i.jsx)("section",{className:"w-full",children:(0,i.jsxs)("form",{className:"",onSubmit:m((async e=>{try{let a=null;(t=b)instanceof File||t&&"object"===typeof t&&t.type&&t.name?a=await(e=>new Promise(((t,a)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=a})))(b):console.warn("Skipping base64: profilePhoto is not a File",b);const r=(0,g.A)((0,g.A)({},e),{},{profilePhoto:a||b,uploadedFileNames:null===I||void 0===I?void 0:I.profilePhoto,profilePhotoDoc:null===y||void 0===y?void 0:y.profilePhoto,profilePhotoName:null===b||void 0===b?void 0:b.name});localStorage.setItem("applicantFormData",JSON.stringify(r));const n=(0,g.A)((0,g.A)({},e),{},{profilePhoto:y.profilePhoto});localStorage.setItem("profileStore",JSON.stringify(n)),c("/addCandidates/personalDetails",{state:{FormData:r}})}catch(a){console.log("Error in onSubmit:",a)}var t})),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center flex-wrap",children:[(0,i.jsx)("div",{className:"mt-10 mb-5 text_size_6",children:(0,i.jsx)(mt,{label:"Applying for the position of",register:p,name:"position",type:"text",errors:x})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-center items-center gap-5",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"offshore"},p("empType")),{},{value:"Offshore"})),(0,i.jsx)("label",{htmlFor:"offshore",children:"Offshore"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"onshore"},p("empType")),{},{value:"Onshore"})),(0,i.jsx)("label",{htmlFor:"onshore",children:"Onshore"})]}),x.empType&&(0,i.jsx)("p",{className:"text-[red] text-[13px] text-center mt-3",children:x.empType.message})]}),(0,i.jsxs)("div",{className:"py-2 center flex-col max-w-[160px]",children:[(0,i.jsx)("input",{type:"file",id:"fileInput",name:"profilePhoto",accept:".jpg,.jpeg,.png",onChange:async e=>{const t=e.target.files[0];if(!t)return;t.size>1048576?alert("File size exceeds the 1MB (1024KB) limit. Please upload a smaller file."):(D(t),u("profilePhoto",t),await lt(t,"profilePhoto",N,"Employee"))},className:"hidden"}),(0,i.jsxs)("div",{className:"h-[120px] max-w-[120px] relative rounded-md bg-lite_skyBlue",children:[(0,i.jsx)("img",{src:A||(b?URL.createObjectURL(b):y.profilePhoto?S:S||v),id:"previewImg",alt:"profile",className:"object-cover w-full h-full",onError:e=>e.target.src=v}),(S||b||y.profilePhoto||A)&&(0,i.jsx)("div",{className:"absolute top-24 -right-3 bg-lite_grey p-[2px] rounded-full cursor-pointer",onClick:()=>document.getElementById("fileInput").click(),children:(0,i.jsx)(j.iog,{className:"w-6 h-6 p-1"})})]}),!S&&!b&&!y.profilePhoto&&!A&&(0,i.jsx)("div",{className:"mt-1 rounded-lg text-center",children:(0,i.jsx)("button",{type:"button",className:"text_size_6",onClick:()=>document.getElementById("fileInput").click(),children:"Choose Image"})}),(0,i.jsx)("p",{className:"text-[10px] text-medium_grey mt-1 text-center",children:"Upload a JPG/PNG image under 1MB (1024KB)"}),x.profilePhoto&&(0,i.jsx)("p",{className:"text-[red] text-[13px] text-center",children:x.profilePhoto.message})]})]}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-x-12 gap-y-5 mb-4 text_size_6",children:[{label:"Contract Type",name:"contractType",type:"select",options:Nt},{label:"CV Received From",name:"agent",type:"text"},{label:"Name",name:"name",type:"text"},{label:"Chinese characters (if applicable)",name:"chinese",type:"text"},{label:"Gender",name:"gender",type:"select",options:ht},{label:"Date of Birth",name:"dob",type:"date"},{label:"Age",name:"age",type:"number",min:20,max:99},{label:"Email ID",name:"email",type:"email"},{label:"Marital Status",name:"marital",type:"select",options:vt},{label:"Country of Birth",name:"cob",type:"text"},{label:"Nationality",name:"nationality",type:"select",options:yt},{label:"Other Nationality",name:"otherNation",type:"text",disabled:"other"!==(null===(e=h("nationality"))||void 0===e?void 0:e.toLowerCase())},{label:"Race",name:"race",type:"select",options:xt},{label:"Other Race",name:"otherRace",type:"text",disabled:"other"!==(null===(t=h("race"))||void 0===t?void 0:t.toLowerCase())},{label:"Religion",name:"religion",type:"select",options:gt},{label:"Other Religion",name:"otherReligion",type:"text",disabled:"others"!==(null===(a=h("religion"))||void 0===a?void 0:a.toLowerCase())}].map(((e,t)=>{var a;return(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block",children:e.label}),"select"===e.type?(0,i.jsxs)("select",(0,g.A)((0,g.A)({},p(e.name)),{},{className:"mt-2 p-2.5 text_size_7 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full",children:[(0,i.jsx)("option",{value:""}),(e.options||[]).map(((e,t)=>(0,i.jsx)("option",{value:e.value,children:e.label},t)))]})):(0,i.jsx)("input",(0,g.A)((0,g.A)({},p(e.name)),{},{type:e.type,disabled:e.disabled,min:e.min,max:e.max,className:"mt-2 p-2 text_size_7 bg-lite_skyBlue border border-[#dedddd] text-dark_grey   outline-none rounded w-full"})),x[e.name]&&(0,i.jsx)("p",{className:"text-[red] text-[13px]",children:null===(a=x[e.name])||void 0===a?void 0:a.message})]},t)}))}),(0,i.jsx)("div",{className:"flex justify-center my-10 gap-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Next"})})]})})};var Tt=a(184),Ct=a(5051),Rt=a(1443);const Pt=()=>{var e,t;const{tempID:a}=(0,Fe.b)(),{empPDData:l}=(0,n.useContext)(s.Y),o=(0,r.zy)(),d=null===(e=o.state)||void 0===e?void 0:e.FormData;(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{register:c,handleSubmit:p,control:m,setValue:u,watch:h,formState:{errors:x}}=(0,tt.mN)({resolver:(0,at.t)((0,rt.UQ)(null===d||void 0===d?void 0:d.nationality)),defaultValues:{familyDetails:[{name:"",relationship:"",age:"",occupation:"",placeOfOccupation:""}],eduDetails:[{university:"",fromDate:"",toDate:"",degree:""}],workExperience:[{company:"",position:"",from:"",to:""}],lang:[]}}),f=(0,r.Zp)(),v=[{value:"English",label:"English"},{value:"Mandarin",label:"Mandarin"},{value:"Malay",label:"Malay"}],[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(!1),[j,A]=(0,n.useState)(""),{fields:w,append:S,remove:E}=(0,tt.jz)({control:m,name:"familyDetails"}),{fields:I,append:k,remove:T}=(0,tt.jz)({control:m,name:"eduDetails"}),{fields:C,append:R,remove:P}=(0,tt.jz)({control:m,name:"workExperience"});(0,n.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("personalFormData"));e&&Object.keys(e).forEach((t=>u(t,e[t])));const t=()=>{localStorage.removeItem("personalFormData")};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[o,u]);return(0,n.useEffect)((()=>{const e=["alternateNo","bwnIcColour","bwnIcExpiry","bwnIcNo","contactNo","driveLic","eduDetails","familyDetails","lang","otherLang","permanentAddress","ppDestinate","ppExpiry","ppIssued","ppNo","presentAddress","workExperience"];if(a&&l.length>0){const t=l.find((e=>e.tempID===a));if(t&&(e.forEach((e=>{if("familyDetails"===e||"workExperience"===e||"eduDetails"===e){if(Array.isArray(t[e])&&"string"===typeof t[e][0]){let a=(e=>{try{let t=e.replace(/\\/g,"");t=t.replace(/'/g,'"'),t=t.replace(/([{,])(\s*)([a-zA-Z0-9_]+)(\s*):/g,'$1"$3":'),t=t.replace(/:([a-zA-Z0-9_/.\s]+)(?=\s|,|\})/g,':"$1"'),t.startsWith('"')&&t.endsWith('"')&&(t=t.slice(1,-1));const a=JSON.parse(t);return Array.isArray(a)?a:[]}catch(t){return console.error("Error parsing details:",t),[]}})(t[e][0]);a.length>0&&u(e,a)}}else t[e]&&u(e,t[e])})),t.lang)){let e=Array.isArray(t.lang)?t.lang:t.lang.split(",").map((e=>e.trim()));e=e.map((e=>"string"===typeof e?e.replace(/^\[|\]$/g,""):e));const a=e.find((e=>"string"===typeof e&&e.startsWith("Other:")));a&&(D(!0),A(a.replace("Other: ","").trim())),console.log(e,"Processed Language Data"),u("lang",e)}}}),[a,u,l]),(0,i.jsxs)("form",{onSubmit:p((e=>{const t=(0,g.A)((0,g.A)({},d),e);localStorage.setItem("personalFormData",JSON.stringify(t)),f("/addCandidates/educationDetails",{state:{FormData:t}})})),className:" mx-auto py-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text_size_6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Contact Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("contactNo")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.contactNo&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.contactNo.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Alternate Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("alternateNo")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd]  text-dark_grey outline-none rounded w-full"})),x.alternateNo&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.alternateNo.message})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text_size_6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Present Address"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("presentAddress")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.presentAddress&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.presentAddress.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Permanent Address"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("permanentAddress")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:null===(t=x.permanentAddress)||void 0===t?void 0:t.message})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4 text_size_6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Driving License Class"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("driveLic")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("label",{className:"block mb-1",children:"Language Proficiency"}),(0,i.jsx)(tt.xI,{name:"lang",control:m,render:e=>{let{field:{onChange:t,value:a}}=e;const r=Array.isArray(a)?a:[],n=r.includes("Other");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"mt-2 p-2.5 text_size_9 bg-white border border-[#dedddd] text-dark_grey outline-none rounded w-full flex items-center cursor-pointer",onClick:()=>N(!y),children:[(0,i.jsx)("input",{type:"text",className:"w-full outline-none cursor-pointer bg-transparent",value:r.join(", "),readOnly:!0,placeholder:"Select options"}),(0,i.jsx)(Rt.A,{className:"w-5 h-5 text-grey"})]}),y&&(0,i.jsxs)("div",{className:"absolute left-0 w-full mt-2  bg-lite_skyBlue rounded-lg shadow-lg z-10",children:[(0,i.jsx)("div",{className:" absolute right-5 top-5 cursor-pointer",onClick:()=>N(!1),children:(0,i.jsx)(Tt.EGD,{})}),(0,i.jsxs)("ul",{className:"p-2 bg-white rounded-md",children:[v.map((e=>(0,i.jsxs)("li",{className:"flex items-center gap-2 p-2  rounded",children:[(0,i.jsx)("input",{type:"checkbox",id:"lang-".concat(e.value),checked:r.includes(e.value),onChange:()=>{let a=r.includes(e.value)?r.filter((t=>t!==e.value)):[...r,e.value];t(a)},className:"w-4 h-4"}),(0,i.jsx)("label",{htmlFor:"lang-".concat(e.value),className:"cursor-pointer",children:e.label})]},e.value))),(0,i.jsxs)("li",{className:"flex items-center gap-2 p-2 hover:bg-gray-100 rounded ",children:[(0,i.jsx)("input",{type:"checkbox",id:"lang-other",checked:n,onChange:()=>{n?(t(r.filter((e=>"Other"!==e))),A("")):t([...r,"Other"])},className:"w-4 h-4"}),(0,i.jsx)("label",{htmlFor:"lang-other",className:"cursor-pointer",children:"Other"})]})]})]}),n&&(0,i.jsx)("input",(0,g.A)((0,g.A)({},c("otherLang")),{},{type:"text",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full",placeholder:"Specify other language",value:j,onChange:e=>A(e.target.value)}))]})}}),x.lang&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.lang.message}),x.otherLang&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.otherLang.message})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4 text_size_6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Brunei I/C No"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("bwnIcNo")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.bwnIcNo&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.bwnIcNo.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Brunei I/C Colour"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},c("bwnIcColour")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full",children:[(0,i.jsx)("option",{value:""}),jt.map(((e,t)=>(0,i.jsx)("option",{value:e.value,children:e.label},t)))]})),x.bwnIcColour&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.bwnIcColour.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Brunei I/C Expiry"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},c("bwnIcExpiry")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.bwnIcExpiry&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.bwnIcExpiry.message})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-4 text_size_6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Passport Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("ppNo")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.ppNo&&(0,i.jsx)("p",{className:"text-[red] text-[12px] ",children:x.ppNo.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Passport issued date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},c("ppIssued")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.ppIssued&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.ppIssued.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Passport Expiry"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},c("ppExpiry")),{},{className:"mt-2 text_size_9 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.ppExpiry&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.ppExpiry.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block mb-1",children:"Passport issued destination"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("ppDestinate")),{},{className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"})),x.ppDestinate&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:x.ppDestinate.message})]})]}),(0,i.jsxs)("div",{className:"mb-4 relative text_size_6",children:[(0,i.jsx)("label",{className:"block mb-1",children:"Particulars of Immediate Family (Spouse, Children, Parents, Brothers & Sisters)"}),w.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-5 gap-4 mb-2",children:[(0,i.jsx)(tt.xI,{name:"familyDetails[".concat(t,"].name"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},t),{},{placeholder:"Name",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"familyDetails[".concat(t,"].relationship"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},t),{},{placeholder:"Relationship",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"familyDetails[".concat(t,"].age"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},t),{},{placeholder:"Age",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"familyDetails[".concat(t,"].occupation"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},t),{},{placeholder:"Occupation",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"familyDetails[".concat(t,"].placeOfOccupation"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},t),{},{placeholder:"Place of Occupation",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),w[t].isNew&&(0,i.jsx)("button",{type:"button",onClick:()=>{E(t)},className:"absolute top-15 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id))),(0,i.jsx)("button",{type:"button",onClick:()=>{S({name:"",relationship:"",age:"",occupation:"",placeOfOccupation:"",isNew:!0})},className:"absolute top-11 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsxs)("div",{className:"mb-4 relative text_size_6",children:[(0,i.jsx)("label",{className:"block mb-1",children:"Education Details"}),I.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-2",children:[(0,i.jsx)(tt.xI,{name:"eduDetails.".concat(t,".university"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"School / University / Professional Institute",className:"resize-none text_size_9 mt-2 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=x.eduDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.university)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:x.eduDetails[t].university.message})]})}}),(0,i.jsx)(tt.xI,{name:"eduDetails.".concat(t,".fromDate"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{type:"date",placeholder:"From Date",className:"resize-none mt-2 p-2.5 text_size_9  bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=x.eduDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.fromDate)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:x.eduDetails[t].fromDate.message})]})}}),(0,i.jsx)(tt.xI,{name:"eduDetails.".concat(t,".toDate"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{type:"date",placeholder:"To Date",className:"resize-none mt-2 p-2.5 text_size_9  bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=x.eduDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.toDate)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:x.eduDetails[t].toDate.message})]})}}),(0,i.jsx)(tt.xI,{name:"eduDetails.".concat(t,".degree"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"Highest Standard / Passed / Certificate / Degree / Professional Qualification",className:"resize-none mt-2 p-2.5  bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded text_size_9"})),(null===(a=x.eduDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.degree)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:x.eduDetails[t].degree.message})]})}}),e.isNew&&(0,i.jsx)("button",{type:"button",onClick:()=>{T(t)},className:"absolute top-15 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id))),(0,i.jsx)("button",{type:"button",onClick:()=>{k({university:"",fromDate:"",toDate:"",degree:"",isNew:!0})},className:"absolute top-12 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsxs)("div",{className:"mb-4 relative text_size_6",children:[(0,i.jsx)("label",{className:"block mb-1",children:"Previous Employment Including Temporary Work"}),C.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-6 gap-4 mb-2",children:[(0,i.jsx)(tt.xI,{name:"workExperience.".concat(t,".name"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Name and Address",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"workExperience.".concat(t,".position"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Position Held",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"workExperience.".concat(t,".from"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{type:"date",placeholder:"From",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"workExperience.".concat(t,".to"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{type:"date",placeholder:"To",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"workExperience.".concat(t,".salary"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Salary",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"workExperience.".concat(t,".reasonForLeaving"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Reason for Leaving",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),e.isNew&&(0,i.jsx)("button",{type:"button",onClick:()=>{P(t)},className:"absolute top-15 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id))),(0,i.jsx)("button",{type:"button",onClick:()=>{R({company:"",position:"",from:"",to:"",isNew:!0})},className:"absolute top-11 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsx)("div",{className:"flex justify-center mt-12 gap-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Next"})})]})},Ot=e=>{var t;let{fetchedData:a}=e;const{tempID:l}=(0,Fe.b)(),{educDetailsData:o}=(0,n.useContext)(s.Y),d=(0,r.zy)(),c=null===(t=d.state)||void 0===t?void 0:t.FormData;(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{handleSubmit:p,control:m,setValue:u,formState:{errors:h},watch:x}=(0,tt.mN)({resolver:(0,at.t)(rt.uL),defaultValues:{referees:[{name:"",address:"",phoneNumber:"",profession:""}],relatives:[{name:"",positionHeld:"",relationship:""}],emgDetails:[{name:"",relationship:"",address:"",phoneNumber:"",bloodGroup:""}],disease:"no",liquor:"no",crime:"no",diseaseDesc:"",liquorDesc:"",crimeDesc:""}});(0,n.useEffect)((()=>{a&&(u("disease",a.disease||"no"),u("liquor",a.liquor||"no"),u("crime",a.crime||"no"),u("diseaseDesc",a.diseaseDesc||""),u("liquorDesc",a.liquorDesc||""),u("crimeDesc",a.crimeDesc||""))}),[a,u]);const f=(0,r.Zp)(),{fields:v,append:y,remove:N}=(0,tt.jz)({control:m,name:"emgDetails"}),{fields:b,append:D,remove:j}=(0,tt.jz)({control:m,name:"referees"}),{fields:A,append:w,remove:S}=(0,tt.jz)({control:m,name:"relatives"});(0,n.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("educationFormData"));e&&Object.keys(e).forEach((t=>u(t,e[t])));const t=()=>{localStorage.removeItem("educationFormData")};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[d,u]);return(0,n.useEffect)((()=>{if(l&&o.length>0){const e=o.find((e=>e.tempID===l));e&&Object.keys(e).forEach((t=>{if("emgDetails"===t||"referees"===t||"relatives"===t){if(Array.isArray(e[t])&&"string"===typeof e[t][0]){let a=(e=>{try{let t=e.replace(/\\/g,"");t=t.replace(/'/g,'"'),t=t.replace(/([{,])(\s*)([a-zA-Z0-9_]+)(\s*):/g,'$1"$3":'),t=t.replace(/:([a-zA-Z0-9_/.\s]+)(?=\s|,|\})/g,':"$1"'),t.startsWith('"')&&t.endsWith('"')&&(t=t.slice(1,-1));const a=JSON.parse(t);return Array.isArray(a)?a:[]}catch(t){return console.error("Error parsing details:",t),[]}})(e[t][0]);a.length>0&&u(t,a)}}else e[t]&&u(t,e[t])}))}}),[l,u,o]),(0,i.jsxs)("form",{onSubmit:p((e=>{const t=(0,g.A)((0,g.A)({},e),c);localStorage.setItem("educationFormData",JSON.stringify(t)),f("/addCandidates/otherDetails",{state:{FormData:t}})})),className:"",children:[(0,i.jsxs)("div",{className:"relative mt-10",children:[(0,i.jsxs)("label",{className:"text_size_6 mb-3",children:["Characters Referees"," ",(0,i.jsx)("span",{className:"text-[#838383]",children:"(Names of relatives should not be given)"})]}),b.map(((e,t)=>(0,i.jsxs)("div",{className:"flex gap-2 mb-7",children:[(0,i.jsx)(tt.xI,{name:"referees.".concat(t,".name"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Name",className:"mt-2  text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))}}),(0,i.jsx)(tt.xI,{name:"referees.".concat(t,".address"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Address",className:"mt-2  text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))}}),(0,i.jsx)(tt.xI,{name:"referees.".concat(t,".phoneNumber"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Telephone",className:"mt-2 text_size_7 w-[150px] p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"}))}}),(0,i.jsx)(tt.xI,{name:"referees.".concat(t,".profession"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Profession",className:"mt-2 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))}}),e.isNew&&(0,i.jsx)("button",{type:"button",onClick:()=>j(t),className:"absolute top-15 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id))),(0,i.jsx)("button",{type:"button",onClick:()=>{D({name:"",address:"",phoneNumber:"",profession:"",isNew:!0})},className:"absolute top-11 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("label",{className:"text_size_6 mb-3",children:"Relatives Employed by the company"}),A.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-7",children:[(0,i.jsx)(tt.xI,{name:"relatives.".concat(t,".name"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Name",className:"mt-2  text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))}}),(0,i.jsx)(tt.xI,{name:"relatives.".concat(t,".positionHeld"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Position Held",className:"mt-2  text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))}}),(0,i.jsx)(tt.xI,{name:"relatives.".concat(t,".relationship"),control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{placeholder:"Relationship",className:"mt-2  text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full"}))}}),e.isNew&&(0,i.jsx)("button",{type:"button",onClick:()=>S(t),className:"absolute top-15 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id))),(0,i.jsx)("button",{type:"button",onClick:()=>{w({name:"",positionHeld:"",relationship:"",isNew:!0})},className:"absolute top-11 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_6 mb-3",children:"Brief Description of Present Duties"}),(0,i.jsx)(tt.xI,{name:"desc",control:m,render:e=>{let{field:t}=e;return(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},t),{},{className:"resize-none mt-2 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full",rows:"3"}))}})]}),(0,i.jsxs)("div",{className:"mb-4 relative text_size_6",children:[(0,i.jsx)("label",{className:"block mb-1",children:"In Case of Accident / Emergency"}),v.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-5 gap-3 mb-2",children:[(0,i.jsx)(tt.xI,{name:"emgDetails.".concat(t,".name"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"Name of Person notify",className:"resize-none text_size_9 mt-2   p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=h.emgDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.name)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:h.emgDetails[t].name.message})]})}}),(0,i.jsx)(tt.xI,{name:"emgDetails.".concat(t,".relationship"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"Relationship",className:"mt-2 p-2.5 text_size_9  bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=h.emgDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.relationship)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:h.emgDetails[t].relationship.message})]})}}),(0,i.jsx)(tt.xI,{name:"emgDetails.".concat(t,".address"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"Address",className:"mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=h.emgDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.address)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:h.emgDetails[t].address.message})]})}}),(0,i.jsx)(tt.xI,{name:"emgDetails.".concat(t,".phoneNumber"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"Contant Number",className:" mt-2 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded text_size_9"})),(null===(a=h.emgDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.phoneNumber)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:h.emgDetails[t].phoneNumber.message})]})}}),(0,i.jsx)(tt.xI,{name:"emgDetails.".concat(t,".bloodGroup"),control:m,render:e=>{var a,r;let{field:n}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({},n),{},{placeholder:"Blood Group",className:" mt-2 p-2.5 text_size_9 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded"})),(null===(a=h.emgDetails)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.bloodGroup)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:h.emgDetails[t].bloodGroup.message})]})}}),e.isNew&&(0,i.jsx)("button",{type:"button",onClick:()=>N(t),className:"absolute top-15 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id))),(0,i.jsx)("button",{type:"button",onClick:()=>{y({name:"",relationship:"",address:"",phoneNumber:"",bloodGroup:"",isNew:!0})},className:"absolute top-11 -right-7 text-medium_grey text-[18px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),[{field:"disease",label:"Have you ever suffered from any disease or received treatment?"},{field:"liquor",label:"Were you ever an alcoholic or substance abuser?"},{field:"crime",label:"Have you ever been convicted of a crime?"}].map(((e,t)=>{var a;return(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 text_size_6 mt-5",children:[(0,i.jsx)("div",{children:(0,i.jsx)("label",{htmlFor:e.field,className:"text_size_6 mb-2",children:e.label})}),(0,i.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,i.jsx)("div",{className:"flex items-center gap-4",children:["yes","no"].map((t=>(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(tt.xI,{name:e.field,control:m,render:a=>{let{field:r}=a;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"".concat(e.field,"_").concat(t)},r),{},{value:t,checked:r.value===t,onChange:()=>u(e.field,t),className:"border p-2.5 rounded"})),(0,i.jsx)("label",{htmlFor:"".concat(e.field,"_").concat(t),children:t.charAt(0).toUpperCase()+t.slice(1)})]})}})},t)))}),(0,i.jsxs)("div",{className:"items-center",children:[(0,i.jsx)("label",{htmlFor:"".concat(e.field,"Desc"),className:"text_size_7 mr-5 text-[#C7C7C7]",children:"If yes, please provide details"}),(0,i.jsx)(tt.xI,{name:"".concat(e.field,"Desc"),control:m,render:t=>{let{field:a}=t;return(0,i.jsx)("input",(0,g.A)((0,g.A)({id:"".concat(e.field,"Desc")},a),{},{className:"w-[450px] mt-2 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded ".concat(h["".concat(e.field,"Desc")]?"border-red-500":""),disabled:"yes"!==x(e.field)}))}}),h["".concat(e.field,"Desc")]&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-4",children:null===(a=h["".concat(e.field,"Desc")])||void 0===a?void 0:a.message})]})]})]},t)})),(0,i.jsx)("div",{className:"flex justify-center my-7 gap-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Next"})})]})};var _t=a(6720);const Mt=e=>{var t,a,r,n,s,l;let{label:o,register:d=()=>({}),fileKey:c,handleFileUpload:p,uploadedFileNames:m,deletedStringUpload:u,isUploadingString:h,error:x,formattedPermissions:f,requiredPermissions:v,access:y,check:N}=e;const b=null!==(t=null===h||void 0===h?void 0:h[c])&&void 0!==t&&t;null===f||void 0===f||null===(a=f.deleteAccess)||void 0===a||a[y];return(0,i.jsxs)("div",{className:"flex flex-col",children:[o&&(0,i.jsx)("label",{className:"text_size_5",children:o}),(0,i.jsxs)("label",{onClick:e=>{b&&(e.preventDefault(),alert("Please delete the previously uploaded file before uploading a new one."))},className:"flex items-center px-3 py-1.5 bg-lite_skyBlue border border-[#dedddd] rounded-md cursor-pointer mt-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file"},d(c)),{},{onChange:e=>{b||p(e,c)},className:"hidden",accept:".pdf, .jpg, .jpeg, .png"})),(0,i.jsxs)("span",{className:" w-full ml-2 flex p-1 justify-between items-center text-grey gap-10",children:[o||"Upload File"," ",(0,i.jsx)(ut.gwN,{})]})]}),(0,i.jsxs)("p",{className:"text-xs mt-1 text-grey flex justify-between items-center",children:[m[c],(null===(r=m[c])||void 0===r?void 0:r.length)>0&&null!==f&&void 0!==f&&null!==(n=f.deleteAccess)&&void 0!==n&&null!==(s=n[y])&&void 0!==s&&s.some((e=>v.includes(e)))||(null===(l=m[c])||void 0===l?void 0:l.length)>0&&b?(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none ",onClick:()=>u(c,null===m||void 0===m?void 0:m[c]),children:(0,i.jsx)(_t.uDv,{})}):""]}),x&&(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:x.message})]})},Ft=e=>{let{label:t,error:a,handleFileChange:r,uploadedFileNames:n,isUploading:s,deleteFile:l,field:o,formattedPermissions:d,requiredPermissions:c,access:p}=e;return(0,i.jsxs)("div",{className:"flex flex-col w-[400px]",children:[t&&(0,i.jsx)("label",{className:"text_size_5",children:t}),(0,i.jsxs)("label",{onClick:()=>{s[o.title]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-5 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",{type:"file",className:"hidden",accept:".pdf,image/jpeg,image/png",onChange:e=>r(e,o.title),disabled:s[null===o||void 0===o?void 0:o.title]}),(0,i.jsxs)("span",{className:"ml-2 text-[#636363] w-full font-medium flex justify-between items-center gap-10",children:[(0,i.jsx)("p",{children:"Only PDF"}),(0,i.jsx)(ut.gwN,{})]})]}),(0,i.jsx)("p",{className:"text-xs mt-1 text-grey px-1",children:null!==n&&void 0!==n&&n[o.title]?Array.isArray(n[o.title])?n[o.title].slice().reverse().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===d||void 0===d||null===(a=d.deleteAccess)||void 0===a||null===(r=a[p])||void 0===r?void 0:r.some((e=>c.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>l(o.title,e),children:(0,i.jsx)(_t.uDv,{})})]},t)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[n[o.title],(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>l(o.title,n[o.title]),children:(0,i.jsx)(_t.uDv,{})})]}):(0,i.jsx)("span",{})}),a&&(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:a.message})]})},Lt=e=>{var t,a;let{field:r,register:n,handleFileChange:s,uploadedFileNames:l,errors:o,watchedEmpID:d,isUploading:c,deleteFile:p,formattedPermissions:m,requiredPermissions:u,access:h,check:x}=e;return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_6",children:r.label}),"text"===r.type||"date"===r.type?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:r.type},n(r.name)),{},{className:"input-field"})),o[r.name]&&(0,i.jsx)("p",{className:"text-[red] text-[12px] pt-1",children:null===(t=o[r.name])||void 0===t?void 0:t.message})]}):"file"===r.type?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("label",{onClick:()=>{c[r.name]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",{type:"file",className:"hidden",accept:".pdf,image/jpeg,image/png",onChange:e=>s(e,r.name),disabled:c[r.name]}),(0,i.jsxs)("span",{className:"ml-2 text-grey w-full font-normal flex justify-between items-center gap-10 ",children:[r.label,(0,i.jsx)(ut.gwN,{})]})]}),l[r.name]&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(l[r.name])?l[r.name].slice().reverse().map(((e,t)=>{var a,n;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===m||void 0===m||null===(a=m.deleteAccess)||void 0===a||null===(n=a[h])||void 0===n?void 0:n.some((e=>u.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>p(r.name,e),children:(0,i.jsx)(_t.uDv,{})})]},t)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[l[r.name],(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>p(r.name,l[r.name]),children:(0,i.jsx)(_t.uDv,{})})]})}),o[r.name]&&(0,i.jsx)("p",{className:"text-[red] text-[12px] pt-2",children:null===(a=o[r.name])||void 0===a?void 0:a.message})]}):null]})},Ut=e=>{let{label:t,register:a,onChangeFunc:r,error:n,fileName:s,deleteFile:l,formattedPermissions:o,requiredPermissions:d,access:c,filePath:p,isUploading:m,fileType:u}=e;return(0,i.jsxs)("div",{className:"flex flex-col",children:[t&&(0,i.jsx)("label",{className:"text_size_5",children:t}),(0,i.jsxs)("label",{onClick:()=>{m&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file",className:"hidden"},a),{},{onChange:r,accept:".pdf",disabled:m})),(0,i.jsxs)("span",{className:"w-full ml-2 text-grey font-normal flex justify-between items-center gap-20 text-sm",children:["Upload File ",(0,i.jsx)(ut.gwN,{className:"text-lg"})]})]}),s?(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(s)&&s.slice().reverse().map(((e,t)=>(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{l(e)},children:(0,i.jsx)(_t.uDv,{})})]},t)))}):p&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(p)&&p.slice().reverse().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===o||void 0===o||null===(a=o.deleteAccess)||void 0===a||null===(r=a[c])||void 0===r?void 0:r.some((e=>d.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{l(e)},children:(0,i.jsx)(_t.uDv,{})})]},t)}))}),n&&(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:n.message})]})},Bt=(0,Ee.D)(),qt=()=>{const[e,t]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(async()=>{var e;const a=null===(e=localStorage.getItem("userID"))||void 0===e?void 0:e.toUpperCase();const r=await async function(e){let t=[],r=null;const n={and:[{empID:{eq:a||null}}]};do{const a=await Bt.graphql({query:e,variables:{filter:n,nextToken:r}}),s=a.data[Object.keys(a.data)[0]].items;t=[...t,...s],r=a.data[Object.keys(a.data)[0]].nextToken}while(r);return t}(Ie.ZZ),n=null===r||void 0===r?void 0:r.find((e=>e.empID===a)),[s]=[null===n||void 0===n?void 0:n.setPermissions[1]].map((e=>{if(!e||"{}"===e)return{};try{let t=e.replace(/(\w+)=/g,'"$1":').replace(/\[([^\]]+)\]/g,((e,t)=>"[".concat(t.split(", ").map((e=>'"'.concat(e,'"'))).join(", "),"]"))).replace(/"{/g,"{").replace(/}"/g,"}");return JSON.parse(t)}catch(t){return console.error("Parsing error:",t,"Original String:",e),{}}}));t(s)})()}),[]),{formattedPermissions:e}};var Ht=a(1355);const Wt=e=>{let{handleDeleteMsg:t,title1:a,path:r}=e;return(0,i.jsx)("section",{className:"fixed top-0 left-0 bg-[#433e3e50] w-full min-h-screen z-[9999] center",children:(0,i.jsxs)("div",{className:"max-w-md w-full py-10 px-5 flex flex-col gap-2 bg-white rounded-md shadow-md",children:[(0,i.jsx)("p",{className:"center text-[30px] text-[green] mt-5",children:(0,i.jsx)(Ht.FOK,{})}),(0,i.jsx)("h4",{className:"text-[blue] text-center font-semibold text-lg",children:"Deleted Successfully !"}),(0,i.jsx)("h5",{className:"text-center mb-5 font-medium",children:a||""})," ",(0,i.jsx)("div",{className:"flex items-center justify-evenly text-dark_grey",children:(0,i.jsx)("button",{className:"border px-5 py-1 rounded-md bg-primary",onClick:async()=>{await t(),r&&(window.location.href=r)},children:"Ok"})})]})})};var zt=a(9462);const Yt=(0,Ee.D)(),Vt=e=>{var t;let{fetchedData:a}=e;const{formattedPermissions:l}=qt(),{submitODFunc:o}=(()=>{const e=(0,Ee.D)();return{submitODFunc:(0,n.useCallback)((async t=>{let{reqValue:a,latestTempIDData:r}=t;if(!a||!r)throw new Error("Missing required parameters");const{crime:n,crimeDesc:s,emgDetails:i,noExperience:l,empStatement:o,desc:d,disease:c,diseaseDesc:p,liquor:m,liquorDesc:u,noticePeriod:h,perIS:x,perIDesc:g,referees:f,relatives:v,salaryExpectation:y,supportInfo:N,age:b,alternateNo:D,agent:j,bwnIcNo:A,bwnIcExpiry:w,bwnIcColour:S,contactNo:E,cob:I,contractType:k,chinese:T,dob:C,driveLic:R,email:P,empType:O,eduDetails:_,familyDetails:M,gender:F,lang:L,otherLang:U,marital:B,name:q,nationality:H,otherNation:W,otherRace:z,otherReligion:Y,ppNo:V,ppIssued:G,ppExpiry:J,ppDestinate:K,presentAddress:Q,permanentAddress:$,profilePhoto:Z,position:X,race:ee,religion:te,workExperience:ae,uploadResume:re,uploadCertificate:ne,uploadPp:se,uploadIc:ie,status:le,createdBy:oe}=a,de={tempID:r,crime:n,crimeDesc:s,emgDetails:i,noExperience:l,empStatement:o,desc:d,disease:c,diseaseDesc:p,liquor:m,liquorDesc:u,noticePeriod:h,perIS:x,perIDesc:g,referees:f,relatives:v,salaryExpectation:y,supportInfo:N,uploadResume:re,uploadCertificate:ne,uploadPp:se,uploadIc:ie,createdBy:oe},ce={tempID:r,age:b,alternateNo:D,agent:j,bwnIcNo:A,bwnIcExpiry:w,bwnIcColour:S,contactNo:E,cob:I,contractType:k,chinese:T,dob:C,driveLic:R,email:P,empType:O,eduDetails:_,familyDetails:M,gender:F,lang:L,otherLang:U,marital:B,name:q,nationality:H,otherNation:W,otherRace:z,otherReligion:Y,ppNo:V,ppIssued:G,ppExpiry:J,ppDestinate:K,presentAddress:Q,permanentAddress:$,profilePhoto:Z,position:X,race:ee,religion:te,status:le,workExperience:ae,createdBy:oe};console.log(de),console.log(ce);try{await Promise.all([e.graphql({query:ke.HT,variables:{input:ce}}),e.graphql({query:ke.Ny,variables:{input:de}})])}catch(pe){throw console.error("Error executing GraphQL requests:",pe),pe}}),[])}})(),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(""),[v,y]=(0,n.useState)([]),{candyDetails:N}=(()=>{const e=(0,Ee.D)();return{candyDetails:(0,n.useCallback)((async t=>{let{reqValue:a}=t;if(!a)throw new Error("Missing required parameters");const{tempID:r,crime:n,crimeDesc:s,emgDetails:i,noExperience:l,empStatement:o,desc:d,disease:c,diseaseDesc:p,liquor:m,liquorDesc:u,noticePeriod:h,perIS:x,perIDesc:g,referees:f,relatives:v,salaryExpectation:y,supportInfo:N,age:b,alternateNo:D,agent:j,bwnIcNo:A,bwnIcExpiry:w,bwnIcColour:S,contactNo:E,cob:I,contractType:k,chinese:T,dob:C,driveLic:R,email:P,empType:O,eduDetails:_,familyDetails:M,gender:F,lang:L,otherLang:U,marital:B,name:q,nationality:H,otherNation:W,otherRace:z,otherReligion:Y,ppNo:V,ppIssued:G,ppExpiry:J,ppDestinate:K,presentAddress:Q,permanentAddress:$,profilePhoto:Z,position:X,race:ee,religion:te,workExperience:ae,uploadResume:re,uploadCertificate:ne,uploadPp:se,uploadIc:ie,status:le,PDTableID:oe,EDTableID:de,updatedBy:ce}=a,pe={id:oe,tempID:r,age:b,alternateNo:D,agent:j,bwnIcNo:A,bwnIcExpiry:w,bwnIcColour:S,contactNo:E,cob:I,contractType:k,chinese:T,dob:C,driveLic:R,email:P,empType:O,eduDetails:_,familyDetails:M,gender:F,lang:L,otherLang:U,marital:B,name:q,nationality:H,otherNation:W,otherRace:z,otherReligion:Y,ppNo:V,ppIssued:G,ppExpiry:J,ppDestinate:K,presentAddress:Q,permanentAddress:$,profilePhoto:Z,position:X,race:ee,religion:te,status:le,workExperience:ae,updatedBy:ce},me={id:de,tempID:r,crime:n,crimeDesc:s,emgDetails:i,noExperience:l,empStatement:o,desc:d,disease:c,diseaseDesc:p,liquor:m,liquorDesc:u,noticePeriod:h,perIS:x,perIDesc:g,referees:f,relatives:v,salaryExpectation:y,supportInfo:N,uploadResume:re,uploadCertificate:ne,uploadPp:se,uploadIc:ie,updatedBy:ce};try{const[t,a]=await Promise.all([e.graphql({query:ke.yv,variables:{input:pe}}),e.graphql({query:ke.wp,variables:{input:me}})]);console.log("update Personal",t),console.log("Update Education",a)}catch(ue){throw console.error("Error executing GraphQL requests:",ue),ue}}),[])}})(),{tempID:b}=((0,r.zy)(),(0,Fe.b)()),{empPDData:D,educDetailsData:j}=(0,n.useContext)(s.Y),[A,w]=(0,n.useState)({uploadResume:!1,uploadCertificate:!1,uploadPp:!1,uploadIc:!1}),[S,E]=(0,n.useState)({uploadResume:null,uploadCertificate:null,uploadPp:null,uploadIc:null}),[I,k]=(0,n.useState)({uploadResume:null,uploadCertificate:null,uploadPp:null,uploadIc:null}),{register:T,control:C,watch:R,handleSubmit:P,setValue:O,formState:{errors:_}}=(0,tt.mN)({resolver:(0,at.t)(rt.me),defaultValues:{perIS:"no",perIDesc:""}}),M=JSON.parse(localStorage.getItem("educationFormData")),F=localStorage.getItem("userID"),L=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{a&&(O("perIS",a.perIS||"no"),O("perIDesc",a.perIDesc||""))}),[a,O]),(0,n.useEffect)((()=>{if(D.length>0&&j.length>0){const e=D.map((e=>{const t=j.find((t=>t.tempID===e.tempID));return(0,g.A)((0,g.A)({},e),t||{})}));y(e)}}),[D,j]),(0,n.useEffect)((()=>{if(b&&j.length>0){const e=j.find((e=>e.tempID===b));e&&(Object.keys(e).forEach((t=>{if("emgDetails"===t||"referees"===t||"relatives"===t){if(Array.isArray(e[t])&&"string"===typeof e[t][0]){let a=(e=>{try{let t=e.replace(/\\/g,"");t=t.replace(/'/g,'"'),t=t.replace(/([{,])(\s*)([a-zA-Z0-9_]+)(\s*):/g,'$1"$3":'),t=t.replace(/:([a-zA-Z0-9_/.\s]+)(?=\s|,|\})/g,':"$1"'),t.startsWith('"')&&t.endsWith('"')&&(t=t.slice(1,-1));const a=JSON.parse(t);return Array.isArray(a)?a:[]}catch(t){return console.error("Error parsing details:",t),[]}})(e[t][0]);a.length>0&&O(t,a)}}else e[t]&&O(t,e[t])})),e&&(E((t=>(0,g.A)((0,g.A)({},t),{},{uploadCertificate:U(e.uploadCertificate),uploadPp:U(e.uploadPp),uploadResume:U(e.uploadResume),uploadIc:U(e.uploadIc)}))),k((t=>(0,g.A)((0,g.A)({},t),{},{uploadCertificate:e.uploadCertificate,uploadPp:e.uploadPp,uploadResume:e.uploadResume,uploadIc:e.uploadIc})))))}}),[b,O,j]);const U=e=>{try{var t;if(!e||"string"!==typeof e)return"";let a=JSON.parse(e);Array.isArray(a)&&null!==(t=a[0])&&void 0!==t&&t.upload&&(e=a[0].upload)}catch(a){}return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]},B=async(e,t)=>{const a=e.target.files[0];if(!a)return;if(a.size>3670016)return void alert("File size must be less than 3.5 MB.");O(t,a);({uploadResume:"uploadResume",uploadCertificate:"uploadCertificate",uploadPp:"uploadPp",uploadIc:"uploadIc"})[t]&&(((e,t)=>{w((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),E((e=>(0,g.A)((0,g.A)({},e),{},{[t]:a.name}))))},q=()=>{c(!d)},H=async(e,t)=>{try{const a=null===M||void 0===M?void 0:M.tempID;if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(async(e,t,a)=>{if(!t)return alert("File name is missing. Please select a valid file to delete."),console.error("Missing fileName. Received parameters:",{fileType:e,tempID:a,fileName:t}),!1;try{const r="public/".concat(e,"/").concat(a,"/").concat(t);return await(0,zt.T)({path:r,bucket:"aweadininstorage20242a2fe-dev"}),!0}catch(r){return console.error("Error deleting file:",r),alert("Error processing the file deletion."),!1}})(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"DeleteUploadApplication error")}})(e,t,0,E,k,w);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));h("".concat(t)),q()}catch(a){alert("Error processing the file deletion.")}},W=async()=>{const e=(e=>{const t=e.match(/[^\d]+/),a=t?t[0]:"TEMP",r=e.match(/\d+/),n=(r?parseInt(r[0],10):0)+1,s=r?r[0].length:1,i=String(n).padStart(s,"0");return"".concat(a).concat(i)})(await(async()=>{try{let n=[],s=null;do{var e,t,a,r;const i=await Yt.graphql({query:Ie.$1,variables:{nextToken:s}}),l=((null===i||void 0===i||null===(e=i.data)||void 0===e||null===(t=e.listPersonalDetails)||void 0===t?void 0:t.items)||[]).map((e=>e.tempID));n=[...n,...l],s=null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.listPersonalDetails)||void 0===r?void 0:r.nextToken}while(s);const i=n.sort(((e,t)=>{const a=e.match(/\d+/)?parseInt(e.match(/\d+/)[0],10):0,r=t.match(/\d+/)?parseInt(t.match(/\d+/)[0],10):0,n=e.replace(/\d+/g,"")||"",s=t.replace(/\d+/g,"")||"";return n===s?a-r:n.localeCompare(s)}));return i[i.length-1]||"TEMP0"}catch(n){return console.error("Error fetching total count:",n),"TEMP0"}})());return e};var z;const Y=(null===M||void 0===M?void 0:M.profilePhotoName)||"profilePhoto.png",V=["Candidate"],G="Recruitment";return(0,i.jsxs)(i.Fragment,{children:[x&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,i.jsx)("div",{className:"p-6 text-center",children:(0,i.jsx)("p",{className:"text-darkText text-lg",children:x})}),(0,i.jsx)("div",{className:"px-6 py-3 bg-lightBg border-t border-borderGray flex justify-center",children:(0,i.jsx)("button",{className:"bg-primary px-6 py-2 rounded-lg font-semibold uppercase hover:bg-yellow transition",children:(0,i.jsx)("a",{href:"/recrutiles/candidate",children:"Okay"})})})]})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("form",{onSubmit:P((async e=>{try{var t;m(!0);const a=null===e||void 0===e?void 0:e.tempID;if(!a){const e=await W();z=e}const r=null!==e&&void 0!==e&&e.tempID?null===e||void 0===e?void 0:e.tempID:z,n=JSON.stringify(null===M||void 0===M?void 0:M.familyDetails),s=JSON.stringify(null===M||void 0===M?void 0:M.eduDetails),i=JSON.stringify(null===M||void 0===M?void 0:M.workExperience),l=JSON.stringify(null===M||void 0===M?void 0:M.emgDetails),d=JSON.stringify(null===M||void 0===M?void 0:M.referees),c=JSON.stringify(null===M||void 0===M?void 0:M.relatives),p=A.uploadResume?await ot(e.uploadResume,"uploadResume",r):null===I||void 0===I?void 0:I.uploadResume,u=A.uploadCertificate?await ot(e.uploadCertificate,"uploadCertificate",r):null===I||void 0===I?void 0:I.uploadCertificate,h=A.uploadPp?await ot(e.uploadPp,"uploadPp",r):null===I||void 0===I?void 0:I.uploadPp,x=A.uploadIc?await ot(e.uploadIc,"uploadIc",r):null===I||void 0===I?void 0:I.uploadIc;let v;const y=null===M||void 0===M?void 0:M.profilePhoto,b="string"===typeof y&&y.startsWith("data:image");let w=y;b&&(w=function(e,t){const a=e.split(","),r=a[0].match(/:(.*?);/)[1],n=atob(a[1]);let s=n.length;const i=new Uint8Array(s);for(;s--;)i[s]=n.charCodeAt(s);return new File([i],t,{type:r})}(y,Y)),v=M.profilePhotoDoc&&!M.profilePhotoDoc.includes("Employee")?M.profilePhotoDoc:await ot(w,"profilePhoto",r);const S="https://aweadininprod2024954b8-prod.s3.ap-southeast-1.amazonaws.com/",E=e=>e&&!e.includes("undefined")?e.replace(S,""):null,k=(new Date).toISOString().split("T")[0],T=e=>{const t=E(e);return t?[{upload:t,date:k}]:null},C=D.find((e=>e.tempID===r)),R=j.find((e=>e.tempID===r)),P=JSON.stringify([{userID:F,date:L}]),O=null!==C&&void 0!==C&&C.updatedBy?JSON.parse(C.updatedBy):[],_=JSON.stringify([...O,{userID:F,date:L}]),U=(0,g.A)((0,g.A)((0,g.A)({},e),M),{},{noExperience:e.noExperience,salaryExpectation:e.salaryExpectation,noticePeriod:e.noticePeriod,perIS:e.perIS,perIDesc:e.perIDesc,supportInfo:e.supportInfo,empStatement:e.empStatement,eduDetails:s,familyDetails:n,workExperience:i,emgDetails:l,referees:d,relatives:c,status:"Active",profilePhoto:E(null===(t=v)||void 0===t?void 0:t.replace(S,"")),uploadResume:A.uploadResume?JSON.stringify(T(p)):null===I||void 0===I?void 0:I.uploadResume,uploadCertificate:A.uploadCertificate?JSON.stringify(T(u)):null===I||void 0===I?void 0:I.uploadCertificate,uploadPp:A.uploadPp?JSON.stringify(T(h)):null===I||void 0===I?void 0:I.uploadPp,uploadIc:A.uploadIc?JSON.stringify(T(x)):null===I||void 0===I?void 0:I.uploadIc,createdBy:a?null:P,updatedBy:a?_:null});if(C&&R){const e=(0,g.A)((0,g.A)({},U),{},{PDTableID:C.id,EDTableID:R.id});await N({reqValue:e}).then((()=>{f("Your Application Submitted Successfully"),m(!1)})).catch((e=>{console.log("Application Details Update Call Error",e)}))}else await o({reqValue:U,latestTempIDData:z}).then((()=>{f("Your Application Submitted Successfully"),m(!1)})).catch((e=>{console.log("Application Details Create Call Error",e)}))}catch(a){console.error("Error submitting data:",a),m(!1)}})),className:"pt-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5",children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text_size_6",children:"Number of Years Experience in Applied Position"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({label:"Number of Years Experience in Applied Position"},T("noExperience")),{},{className:"input-field border",name:"noExperience",type:"text",errors:_}))]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text_size_6",children:"Salary Expected"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({label:"Salary Expected"},T("salaryExpectation")),{},{className:"input-field border",name:"salaryExpectation",type:"text",errors:_}))]})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"block text_size_6",children:"Termination Notice for Present job (month/Date)"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({label:"Termination Notice for Present job (month/Date)"},T("noticePeriod")),{},{className:"input-field border",name:"noticePeriod",type:"text",errors:_}))]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"text_size_6",children:"Have you been interviewed for a position at this company before?"}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-2 mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(tt.xI,{name:"perIS",control:C,render:e=>{let{field:t}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"yes"},t),{},{value:"yes",checked:"yes"===t.value,onChange:()=>t.onChange("yes"),className:"mr-2 p-3"})),(0,i.jsx)("label",{htmlFor:"yes",className:"mr-4 text_size_6",children:"Yes"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"no"},t),{},{value:"no",checked:"no"===t.value,onChange:()=>t.onChange("no"),className:"mr-2 p-3"})),(0,i.jsx)("label",{htmlFor:"no",className:"text_size_6",children:"No"})]})}}),_.perIS&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:_.perIS.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"w-[350px] text_size_7",children:"If yes, please give Details"}),(0,i.jsx)(tt.xI,{name:"perIDesc",control:C,render:e=>{let{field:t}=e;return(0,i.jsx)("input",(0,g.A)((0,g.A)({},t),{},{disabled:"yes"!==R("perIS"),className:"mt-2 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full ".concat(_.perIDesc?"border-[red]":"")}))}}),_.perIDesc&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-4",children:_.perIDesc.message})]})]})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"text_size_6 mb-2",children:"Any other information you wish to provide?"}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({name:"supportInfo"},T("supportInfo")),{},{className:"resize-none mt-2 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] text-dark_grey outline-none rounded w-full",rows:"4"}))]}),(0,i.jsxs)("div",{className:"my-5",children:[(0,i.jsx)("label",{className:"text_size_6",children:"Choose file"}),(0,i.jsxs)("div",{className:"grid grid-cols-3 mt-3 mb-10 gap-5 w-full",children:[(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Upload Resume",register:T,fileKey:"uploadResume",handleFileUpload:B,uploadedFileNames:S,deletedStringUpload:H,isUploadingString:A,error:_.uploadResume,formattedPermissions:l,requiredPermissions:V,access:G})}),(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Qualification Certificate",register:T,fileKey:"uploadCertificate",handleFileUpload:B,uploadedFileNames:S,deletedStringUpload:H,isUploadingString:A,error:_.uploadCertificate,formattedPermissions:l,requiredPermissions:V,access:G})}),(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Upload Passport",register:T,fileKey:"uploadPp",handleFileUpload:B,uploadedFileNames:S,deletedStringUpload:H,isUploadingString:A,error:_.uploadPp,formattedPermissions:l,requiredPermissions:V,access:G})}),(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Upload IC",register:T,fileKey:"uploadIc",handleFileUpload:B,uploadedFileNames:S,deletedStringUpload:H,isUploadingString:A,error:_.UploadIC,formattedPermissions:l,requiredPermissions:V,access:G})})]}),(0,i.jsx)("p",{className:"text-xs text-medium_grey mt-1 text-center",children:"Please note: Upload a PDF / JPG, PNG under 3.5MB (3584KB) only."})]}),(0,i.jsxs)("div",{className:"flex items-start mb-4",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"checkbox",id:"employeeStatement"},T("empStatement",{required:"This field is required"})),{},{className:"w-5 h-5 border-medium_grey rounded"})),(0,i.jsx)("label",{htmlFor:"empStatement",className:"ml-2 text-gray-700",children:"I Hereby Declare that every statement made by me in this form is true and correct and I understand and agree that any false declaration made by me may be ground for termination of my contract of employment without notice."})]}),_.empStatement&&(0,i.jsx)("p",{className:"text-[red] text-sm",children:null===_||void 0===_||null===(t=_.empStatement)||void 0===t?void 0:t.message}),(0,i.jsx)("div",{className:"text-center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",disabled:p,children:p?"Submitting...":"Submit"})})]}),d&&(0,i.jsx)(Wt,{handleDeleteMsg:q,title1:u})]})]})},Gt=()=>{(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const e=(0,r.Zp)(),t=(0,r.zy)(),{tempID:a,setTempID:s}=(0,Fe.b)(),[l,o]=(0,n.useState)(""),d=E("userID","Recruitment");(0,n.useEffect)((()=>{t.pathname.includes("/applyemployreq")?(o("/Apply Employee Requisition"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData")):t.pathname.includes("/employreq")?(o("Employee Requisition"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData")):t.pathname.includes("/candidate")?(o("Candidate"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData")):t.pathname.includes("/localcandi")?(o("Local CV"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData")):t.pathname.includes("/nonloccandi")?(o("Non Local CV"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData")):t.pathname.includes("/status")?(o("Status"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData")):t.pathname.includes("/workpasstracking")&&(o("WorkPass Tracking"),s(null),localStorage.removeItem("applicantFormData"),localStorage.removeItem("profileStore"),localStorage.removeItem("personalFormData"),localStorage.removeItem("educationFormData"))}),[t.pathname]);const c=je.filter((e=>d.includes(e.title)));return(0,i.jsxs)("section",{className:"h-full bg-[#F5F6F1]",children:[(0,i.jsx)("div",{className:"flex flex-wrap justify-center sm:justify-evenly items-center gap-4 py-10 text-black",children:c.map(((t,a)=>(0,i.jsxs)("div",{onClick:()=>{return a=t.title,r=t.path,o(a),void e(r);var a,r},className:"".concat(t.bg," rounded-3xl w-[10rem] sm:w-[11.1rem] h-40 p-4 cursor-pointer ").concat(l===t.title?"border-4 bg-white border-[#faf362]":""),children:[(0,i.jsx)("div",{className:"".concat(t.bg1," rounded-full my-4 w-16 h-16 flex justify-center items-center m-auto"),children:(0,i.jsx)("img",{className:"w-[2.2rem] h-9 object-cover",src:t.icons,alt:"".concat(a," Icon not found")})}),(0,i.jsx)("h5",{className:"text-[14px] font-semibold text-center",children:t.title})]},a)))}),(0,i.jsx)(r.sv,{})]})};const Jt=a.p+"static/media/candylist.6c1bb9f9af47827026c1f86c5b3e3561.svg";const Kt=a.p+"static/media/add-candidate.472fa9560a82e95ae4b57e094e8b2e4f.svg",Qt=()=>{const e=(0,r.Zp)(),{setTempID:t}=(0,Fe.b)();return(0,i.jsxs)("section",{className:"min-h-screen bg-[#F5F6F1]",children:[(0,i.jsxs)("div",{className:"center gap-20 m-20 text-black",children:[(0,i.jsxs)("div",{onClick:()=>e("/recrutiles/listofcandi"),className:"border-1 shadow-[0_1px_4px_1px_rgba(0,0,0,0.2)] bg-white rounded-xl w-64 h-72 p-5 cursor-pointer hover:border-4 hover:border-[#0D4B8F]",children:[(0,i.jsx)("div",{className:"bg-[#CDE4FD] rounded-full my-10 w-24 h-24 flex justify-center items-center m-auto",children:(0,i.jsx)("img",{className:"w-13 h-16 object-cover",src:Jt,alt:"Candidates List Icon"})}),(0,i.jsx)("h5",{className:"text-[18px] font-semibold text-center",children:"Candidates List"})]}),(0,i.jsxs)("div",{onClick:()=>{e("/addCandidates"),["/addCandidates","/addCandidates/personalDetails","/addCandidates/educationDetails","/addCandidates/otherDetails"]||t(null)},className:"border-1 shadow-[0_1px_4px_1px_rgba(0,0,0,0.2)] bg-white rounded-xl w-64 h-72 p-5 cursor-pointer hover:border-4 hover:border-[#0D4B8F]",children:[(0,i.jsx)("div",{className:"bg-[#CDE4FD] rounded-full my-10 w-24 h-24 flex justify-center items-center m-auto",children:(0,i.jsx)("img",{className:"w-13 h-16 object-cover",src:Kt,alt:"Add Candidate Icon"})}),(0,i.jsx)("h5",{className:"text-[18px] font-semibold text-center",children:"Add Candidate"})]})]}),(0,i.jsx)(r.sv,{})]})},$t=(0,Ee.D)(),Zt=(0,Ee.D)(),Xt=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(null);return{localMobilization:async e=>{t(!0),r(!1),i(null);try{const t=await Zt.graphql({query:ke.ZG,variables:{input:e}});console.log("API Response:",t),r(!0)}catch(a){console.error("Error during API call:",a),i(a)}finally{t(!1)}},isLoading:e,notification:a,error:s}},ea=e=>{let{searchResult:t,newFormData:a,searchIcon1:r,searchIcon2:s,placeholder:l,rounded:o,setDrpValue:d,searchedValue:c,id:p,filteredEmployees:m,setFilteredEmployees:u}=e;const[h,x]=(0,n.useState)(""),[g,f]=(0,n.useState)(!1);(0,n.useEffect)((()=>{d&&x(d)}),[d]);const v=(0,n.useCallback)((()=>{f(!g),!0===g?null===u||void 0===u||u([]):!1===g&&(null===u||void 0===u||u(a))}),[g,a]),y=(0,n.useCallback)((()=>{if(a&&a.length>0){const e=h.toString().toUpperCase(),r=a.find((t=>{var a;return null===(a=[t.empID,t.name,t.empBadgeNo,t.sapNo])||void 0===a?void 0:a.some((t=>(null===t||void 0===t?void 0:t.toString().toUpperCase())===e))}));r&&h?t(r):h?(alert("Employee not found."),t({})):alert("Your search box is empty. Enter a value to start searching.")}}),[h,a]);return(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("div",{className:"py-2 w-full text_size_5 border text-grey bg-white border-lite_grey ".concat(o," flex items-center px-2 gap-2"),children:[(0,i.jsx)("div",{className:" text-dark_grey  text-2xl ",children:r}),(0,i.jsx)("input",{type:"text",placeholder:l,className:"outline-none w-full",value:h,onChange:e=>{const t=e.target.value.toUpperCase();if(x(t),null===c||void 0===c||c(p,t),t){const e=null===a||void 0===a?void 0:a.filter((e=>{var a;return null===(a=[e.name,e.empID,e.empBadgeNo,e.sapNo])||void 0===a?void 0:a.some((e=>null===e||void 0===e?void 0:e.toUpperCase().includes(t)))})),r=null===e||void 0===e?void 0:e.sort(((e,a)=>{var r,n,s,i;const l=null===(r=e.empID)||void 0===r?void 0:r.toString().toUpperCase(),o=null===(n=a.empID)||void 0===n?void 0:n.toString().toUpperCase(),d=null===(s=e.name)||void 0===s?void 0:s.toUpperCase(),c=null===(i=a.name)||void 0===i?void 0:i.toUpperCase(),p=l===t||d===t,m=o===t||c===t,u=(null===l||void 0===l?void 0:l.startsWith(t))||(null===d||void 0===d?void 0:d.startsWith(t)),h=(null===o||void 0===o?void 0:o.startsWith(t))||(null===c||void 0===c?void 0:c.startsWith(t));return p&&!m?-1:!p&&m?1:u&&!h?-1:!u&&h?1:0}));null===u||void 0===u||u(r)}else null===u||void 0===u||u(a)},onClick:v}),(0,i.jsx)("div",{className:" text-dark_grey  text-2xl cursor-pointer",onClick:()=>{y()},children:s})]}),(null===m||void 0===m?void 0:m.length)>0&&(0,i.jsx)("ul",{className:" absolute right-0 overflow-x-hidden  mt-2 w-full ml-auto max-h-36 overflow-y-auto rounded-lg shadow-lg bg-white z-10",children:m.map(((e,a)=>(0,i.jsx)("li",{className:"m-2 p-1 hover:bg-grey hover:text-white cursor-pointer flex justify-between items-center transition-all duration-200",onClick:()=>{(e.empID||e.name)&&(x("".concat(e.empID," - ").concat(e.name||"")),t(e),x("")),f(!1),null===u||void 0===u||u([])},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:" text-sm",children:null===e||void 0===e?void 0:e.empID}),(0,i.jsxs)("span",{className:" text-sm",children:[" ",null===e||void 0===e?void 0:e.name]}),(0,i.jsx)("span",{className:" text-sm",children:null===e||void 0===e?void 0:e.JOBCODE}),(0,i.jsx)("span",{className:" text-sm",children:null===e||void 0===e?void 0:e.location})]})},a)))})]})},ta=()=>{const e=(0,Ee.D)();return{interviewDetails:(0,n.useCallback)((async t=>{let{InterviewValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const{id:t,interDate:r,interTime:n,venue:s,interType:i,bagdeNo:l,message:o,manager:d,candidateStatus:c,status:p,department:m,otherDepartment:u,updatedBy:h}=a,x={id:t,interDate:r,interTime:n,venue:s,interType:i,bagdeNo:l,message:o,manager:d,candidateStatus:c,status:p,department:m,otherDepartment:u,updatedBy:h},g=await e.graphql({query:ke.sK,variables:{input:x}});console.log("Data successfully updated:",g)}catch(r){throw console.error("Error updating data:",r),r}}),[])}},aa=e=>{let{candidate:t,onClose:a}=e;const[r,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)({interview:{empID:"",manager:"",venue:"",interType:"",managerEmail:"",managerName:"",candyEmail:"",hrEmail:"Hr-notification@adininworks.com",candyName:"",candyPosition:""}}),{empPIData:h}=(0,n.useContext)(s.Y),{localMobilization:x}=Xt(),{register:f,handleSubmit:v,setValue:y,formState:{errors:N}}=(0,tt.mN)({resolver:(0,at.t)(rt.mB)}),{IVSSDetails:b}=(0,n.useContext)(s.Y),{createSchedule:D}=(()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(null);return{createSchedule:async e=>{t(!0),r(!1),i(null);try{await $t.graphql({query:ke.Vw,variables:{input:e}}),r(!0)}catch(a){console.error("Error during API call:",a),i(a)}finally{t(!1)}},isLoading:e,notification:a,error:s}})(),{interviewDetails:A}=ta();(0,n.useEffect)((()=>{if(b.length>0&&null!==t&&void 0!==t&&t.tempID){const a=b.find((e=>e.tempID===t.tempID));var e;if(a)y("interDate",null===(e=a.interDate)||void 0===e?void 0:e.split("T")[0]),y("interTime",a.interTime),y("manager",a.manager),y("message",a.message),y("interType",a.interType),y("venue",a.venue)}}),[b,null===t||void 0===t?void 0:t.tempID]);const w=v((async e=>{const a=(0,g.A)((0,g.A)({},e),{},{interDate:new Date(e.interDate),tempID:t.tempID,candidateStatus:"pending",status:"interviewscheduled"}),r={tempID:t.tempID};try{if(p(!0),b.length>0&&null!==t&&void 0!==t&&t.tempID){const r=b.find((e=>e.tempID===t.tempID));r?await A({InterviewValue:(0,g.A)((0,g.A)({},e),{},{id:r.id,interDate:new Date(e.interDate),tempID:t.tempID,candidateStatus:"pending",status:"interviewscheduled"})}):await D(a)}await x(r),await S(e),p(!1),setTimeout((()=>{l(!0)}),200)}catch(n){p(!1)}})),S=async e=>{const t="hr_no-reply@adininworks.com",a=m.interview.managerName,r=m.interview.candyName,n=new Date(e.interDate),s=String(n.getDate()).padStart(2,"0"),i=String(n.getMonth()+1).padStart(2,"0"),l=n.getFullYear(),o="".concat(s,"/").concat(i,"/").concat(l);let d=parseInt(e.interTime.split(":")[0],10);const c=String(parseInt(e.interTime.split(":")[1],10)).padStart(2,"0"),p=d>=12?"PM":"AM";d%=12,d=d||12;const u="".concat(d,":").concat(c," ").concat(p),h="\n    <html>\n      <body>\n        <p>Subject: Interview Notification</p>\n        \n        <p>Dear ".concat(a,",</p>\n        \n        <p>This is to notify you that an interview has been scheduled for ").concat(r," the <strong> ").concat(m.interview.candyPosition," </strong> position.</p>      \n        <p><strong>Date:</strong> ").concat(o,"</p>\n        <p><strong>Time:</strong> ").concat(u,"</p>\n        <p><strong>Mode:</strong> ").concat(e.interType||"Not specified","</p>\n        <p><strong>Venue:</strong> ").concat(e.venue||"Not provided",'</p>\n        \n        <p>Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the form.</p>\n      </body>\n    </html>\n  '),x="\n  <html>\n    <body>\n      <p>Subject: Interview Notification</p>\n      \n      <p>Dear ".concat(r,",</p>\n      \n      <p>This is to notify you that an interview has been scheduled for the <strong> ").concat(m.interview.candyPosition," </strong> position.</p>      \n      <p><strong>Date:</strong> ").concat(o,"</p>\n      <p><strong>Time:</strong> ").concat(u,"</p>\n      <p><strong>Mode:</strong> ").concat(e.interType||"Not specified","</p>\n      <p><strong>Venue:</strong> ").concat(e.venue||"Not provided","</p>\n    </body>\n  </html>\n");try{m&&(await Me("Interview Scheduled",h,t,m.interview.managerEmail),await Me("Interview Scheduled",h,t,m.interview.hrEmail),await Me("Interview Scheduled",x,t,m.interview.candyEmail))}catch(g){console.error("Error sending emails:",g)}};return(0,i.jsx)("section",{className:"min-h-screen bg-opacity-80 w-full center",children:(0,i.jsxs)("div",{onClick:()=>{d([])},className:"bg-white rounded-lg shadow-lg w-full max-w-[500px] overflow-y-auto",children:[(0,i.jsxs)("div",{className:"text-xl relative text-dark_grey text-center font-semibold p-3 rounded-t-lg bg-yellow",children:[(0,i.jsx)("p",{children:"Schedule Interview"}),(0,i.jsx)("button",{className:"border absolute right-4 top-3 rounded-full px-2 center",onClick:a,children:"\xd7"})]}),(0,i.jsxs)("div",{className:"p-5",children:[(0,i.jsxs)("div",{className:"flex flex-row justify-between space-x-8",children:[(0,i.jsx)(mt,{name:"interDate",type:"date",label:"Date",register:f,errors:N}),(0,i.jsx)(mt,{name:"interTime",type:"time",label:"Time",register:f,errors:N})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text-dark_grey text-[16px] underline font-semibold block mb-2",children:"Interview Type :"}),(0,i.jsxs)("div",{className:"flex justify-start items-center gap-5 my-4",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"Offline"},f("interType")),{},{value:"Offline"})),(0,i.jsx)("label",{htmlFor:"Offline",children:"Offline"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",id:"Online"},f("interType")),{},{value:"Online"})),(0,i.jsx)("label",{htmlFor:"Online",children:"Online"})]}),N.interType&&(0,i.jsx)("p",{className:"text-[red] text-[13px] text-center mt-3",children:N.interType.message})]}),(0,i.jsx)("label",{className:"text-dark_grey text-[16px] underline font-semibold block mb-2",children:"Venue :"}),(0,i.jsx)(mt,{name:"venue",type:"text",placeholder:"Enter Venue",className:"input-field border mb-2",register:f,errors:N,onChange:e=>{return t="venue",a=e.target.value,void u((e=>(0,g.A)((0,g.A)({},e),{},{interview:(0,g.A)((0,g.A)({},e.interview),{},{[t]:a})})));var t,a}}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("label",{className:"text-dark_grey text-[16px] underline font-semibold block mb-2",children:"Assign Interviewer :"}),(0,i.jsx)("div",{className:"flex-1 mt-2 mb-2",children:(0,i.jsx)(ea,{searchResult:e=>{y("manager",null===e||void 0===e?void 0:e.name),y("empID",null===e||void 0===e?void 0:e.empID),u({interview:{managerName:null===e||void 0===e?void 0:e.name,managerName:null===e||void 0===e?void 0:e.name,empID:null===e||void 0===e?void 0:e.empID,managerEmail:null===e||void 0===e?void 0:e.officialEmail,candyEmail:null===t||void 0===t?void 0:t.email,hrEmail:"hr-recruitment@adininworks.com",candyName:null===t||void 0===t?void 0:t.name,candyPosition:null===t||void 0===t?void 0:t.position}})},newFormData:h,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Search Employee Id",rounded:"rounded-lg",filteredEmployees:o,setFilteredEmployees:d})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsx)(mt,{name:"empID",type:"text",label:"Employee ID",placeholder:"Enter EmpID",className:"input-field border",register:f,errors:N}),(0,i.jsx)(mt,{name:"manager",type:"text",label:"Manager Name",placeholder:"Enter Manager Name",className:"input-field border",register:f,errors:N})]})]}),(0,i.jsx)(mt,{name:"message",type:"textarea",label:"Message",placeholder:"Enter Message",className:"input-field border",register:f,errors:N}),(0,i.jsx)("div",{className:"text-center mt-1 center",children:(0,i.jsx)("button",{className:"border-2 border-[#F7EC3D] text-dark_grey font-medium hover:bg-yellow py-1 px-2 rounded w-32",onClick:()=>w(),disabled:c,children:c?"Loading...":"Send"})}),r&&(0,i.jsx)(Pe,{text:"Interview scheduled notification sent to HRD & Manager successfully",notification:r,path:"/recrutiles/listofcandi"})]})]})})},ra=a.p+"static/media/defaultAvatar.32980c0bea502f187727.jpg";Je.EA.workerSrc=new URL(a(1886),a.b).toString();const na=(0,Ee.D)(),sa=e=>{let{candidate:t,onClose:a,showDecisionButtons:r}=e;const{IVSSDetails:l,empPDData:o,educDetailsData:d}=(0,n.useContext)(s.Y),[c,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""),[g,v]=(0,n.useState)(""),[N,b]=(0,n.useState)(""),[D,j]=(0,n.useState)(""),[A,w]=(0,n.useState)(!1),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)(""),[T,C]=(0,n.useState)(!1),R=d.find((e=>e.tempID===t.tempID)),P=async e=>{var t,a,r,n,s,i,d;const c="Candidate Rejection Notification:",p="\n    <html>\n      <body>\n        <p>Subject: Candidate Rejection Update Position:\u2013 ".concat(null===(t=e[0])||void 0===t?void 0:t.position,"</p>    \n        <p>Dear HR,</p>    \n        <p>After careful evaluation, the following candidates have been rejected for the position: <strong>").concat(null===(a=e[0])||void 0===a?void 0:a.position,"</strong>.</p>\n        <p>Candidate name: <strong>").concat(null===(r=e[0])||void 0===r?void 0:r.name,".</strong></p>\n        <p>Best regards,<br>HR Team.</p>\n      </body>\n    </html>\n    "),m="\n    <html>\n      <body>\n         <p>Subject: Candidate Rejection Update Position:\u2013 ".concat(null===(n=e[0])||void 0===n?void 0:n.position,"</p>    \n         <p>Dear ").concat(null===(s=e[0])||void 0===s?void 0:s.name,",</p>    \n         <p>After careful evaluation, we regret to inform you that you have not been selected for <br/> the position: <strong>").concat(null===(i=e[0])||void 0===i?void 0:i.position,"</strong>.</p>\n         <p>Best regards,<br>HR Team.</p>\n     </body>\n   </html>\n"),h="hr_no-reply@adininworks.com",x="Hr-notification@adininworks.com",g=null===(d=e[0])||void 0===d?void 0:d.email;try{if(!Array.isArray(e))throw new Error("dataCandi must be an array.");const t=e.map((e=>{const t=null===l||void 0===l?void 0:l.find((t=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),a=null===o||void 0===o?void 0:o.find((t=>e.tempID===(null===t||void 0===t?void 0:t.tempID)));return t||a})).filter((e=>null===e||void 0===e?void 0:e.id));if(0===t.length)return void console.error("No matching candidates found.");for(const e of t){const t={id:e.id,candidateStatus:"Rejected",status:"Rejected"};if(e.tempID&&null!==l&&void 0!==l&&l.some((t=>t.tempID===e.tempID)))try{v("Rejected");await na.graphql({query:ke.sK,variables:{input:t}});await Me(c,p,h,x),await Me(c,m,h,g),v(""),b("Canditate Rejected Successfully."),j("/recrutiles/status"),setTimeout((()=>{u(!0)}),300)}catch(f){console.error("Error updating candidate ID in interviewSchedule:",e.id,":",f),v("")}else if(e.tempID&&null!==o&&void 0!==o&&o.some((t=>t.tempID===e.tempID)))try{v("Rejected");await na.graphql({query:ke.yv,variables:{input:{id:e.id,status:"Inactive"}}});await Me(c,p,h,x),await Me(c,m,h,g),v(""),b("Canditate Rejected Successfully."),j("/recrutiles/listofcandi"),setTimeout((()=>{u(!0)}),300)}catch(f){console.error("Error updating candidate ID in personalDetails:",e.id,":",f),v("")}}}catch(f){console.error("Error in handleRejected function:",f),v("")}},O=async e=>{var t,a,r,n,s;const i="Candidate Selected Notification:",o="\n      <html>\n        <body>\n          <p>Subject: Selected Candidates Notification:</p> \n          <p>Dear HR,</p>    \n          <p>We have completed the selection process, and \n          the following candidates have been selected for the position: <strong>".concat(null===(t=e[0])||void 0===t?void 0:t.position,"</strong>.</p>\n          <p>Candidate name: <strong>").concat(null===(a=e[0])||void 0===a?void 0:a.name,".</strong></p>\n          <p>Best regards,<br>HR Team.</p>\n        </body>\n      </html>\n    "),d="\n    <html>\n      <body>\n        <p>Subject: Congratulations on Your Selection!</p>\n        <p>Dear ".concat(null===(r=e[0])||void 0===r?void 0:r.name,",</p>\n        <p>We are pleased to inform you that you have been selected for <br/> the position of <strong>").concat(null===(n=e[0])||void 0===n?void 0:n.position,"</strong> with our company.</p>\n        <p>We are excited to have you join our team, and we will be in <br/> touch shortly with further details about the next steps in the hiring process.</p>\n        <p>Best regards,<br>HR Team.</p>\n      </body>\n    </html>\n    "),c="hr_no-reply@adininworks.com",p=null===(s=e[0])||void 0===s?void 0:s.email;try{if(!Array.isArray(e))throw new Error("dataCandi must be an array.");const t=l,a=e.map((e=>null===e||void 0===e?void 0:e.tempID)),r=t.filter((e=>a.includes(null===e||void 0===e?void 0:e.tempID)));if(r.length>0){v("Selected");const e={id:r[0].id,status:"Selected",candidateStatus:"pending"};try{await na.graphql({query:ke.sK,variables:{input:e}});await Me(i,o,c,"Hr-notification@adininworks.com"),await Me(i,d,c,p)}catch(m){}}else{const e={tempID:a[0],status:"Selected"};try{await na.graphql({query:ke.Vw,variables:{input:e}})}catch(m){console.log("Error during create call: ",m)}}v(""),b("Candidate Selected Successfully"),j("/recrutiles/listofcandi"),setTimeout((()=>{u(!0)}),300)}catch(m){console.error("Error in handleSelected function:",m),v("")}};(0,n.useEffect)((()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""})),[]);(0,n.useEffect)((()=>{null!==t&&void 0!==t&&t.profilePhoto?(async e=>{try{const t=(await(0,f.I)({path:e})).url.toString();t&&!t.includes("undefined")?x(t):x(ra)}catch(t){console.error("Error fetching image URL:",t),x(ra)}})(t.profilePhoto):x(ra)}),[null===t||void 0===t?void 0:t.profilePhoto]),(0,n.useEffect)((()=>{const e=new Image;e.src=h,e.onload=()=>{w(!0)},e.onerror=()=>{w(!1)}}),[h]);const _=e=>{try{return JSON.parse(e)}catch(t){return[]}},M=_(null===t||void 0===t?void 0:t.workExperience),F=_(null===t||void 0===t?void 0:t.eduDetails),L=_(null===t||void 0===t?void 0:t.familyDetails),U=_(null===R||void 0===R?void 0:R.emgDetails),B=_(null===R||void 0===R?void 0:R.referees),q=_(null===R||void 0===R?void 0:R.relatives),H=e=>{if(!e)return[];if(Array.isArray(e)&&"string"===typeof e[0]&&e[0].trim().startsWith("[{"))try{const t=JSON.parse(e[0]);if(Array.isArray(t))return t.filter((e=>e.upload&&!e.upload.includes("undefined")))}catch(t){return[]}if("string"===typeof e&&e.trim().startsWith("[{"))try{const t=JSON.parse(e);if(Array.isArray(t))return t.filter((e=>e.upload&&!e.upload.includes("undefined")))}catch(t){return[]}return"string"!==typeof e||e.includes("undefined")?Array.isArray(e)?e.filter((e=>e&&"string"===typeof e&&!e.includes("undefined"))).map((e=>({upload:e}))):[]:[{upload:e}]},W=()=>{E(null)},z=e=>(0,i.jsx)(i.Fragment,{children:null===e||void 0===e?void 0:e.map(((e,t)=>{var a,r;return(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:[(0,i.jsx)("div",{className:"flex justify-center items-center",children:(0,i.jsx)("button",{onClick:()=>(async e=>{if(e)try{const t=await(0,f.I)({path:e});k(t.url.href),E(e),C(!1)}catch(t){console.error("Error fetching the file URL:",t),C(!1)}else console.error("No URL provided for the file.")})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})}),S===(null===e||void 0===e?void 0:e.upload)&&(null===e||void 0===e||null===(a=e.upload)||void 0===a?void 0:a.endsWith(".pdf"))&&(0,i.jsx)("div",{className:"py-6 fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-[40vw] max-h-full flex flex-col",children:[(0,i.jsx)("div",{className:"flex-grow overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:I||""})})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:W,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsx)("div",{className:"flex items-center justify-center gap-6 py-4",children:(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:I,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})})})]})}),S===(null===e||void 0===e?void 0:e.upload)&&!(null!==e&&void 0!==e&&null!==(r=e.upload)&&void 0!==r&&r.endsWith(".pdf"))&&(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsxs)("div",{className:"relative invoice-content bg-white max-w-3xl mx-auto p-6 rounded-lg shadow-lg",children:[(0,i.jsx)("div",{children:(0,i.jsx)("img",{src:I,alt:"Document Preview",className:"w-full h-auto"})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:()=>E(null),className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})})]}),(0,i.jsx)("div",{className:"flex items-center justify-center gap-6 py-4",children:(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:I,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})})})]})]},t)}))}),Y=(e,t)=>{let a=[];return e&&e.length>0&&(a=H(e)),(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),a.length>0?z(a):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available"})]})};return(0,i.jsxs)("section",{children:[(0,i.jsx)("div",{className:"fixed top-0 left-0 inset-0 bg-grey bg-opacity-80 center z-50",children:(0,i.jsxs)("div",{className:"bg-white w-full max-w-[700px] max-h-[90vh] p-6 rounded-lg relative overflow-y-auto",children:[(0,i.jsx)("button",{className:"absolute top-2 right-4 w-8 h-8 border rounded-full text-xl",onClick:a,children:"\xd7"}),(0,i.jsxs)("div",{className:"flex items-center gap-20",children:[(0,i.jsx)("img",{src:Se.A,alt:"Logo",className:"max-w-[180px] w-full"}),(0,i.jsx)("h2",{className:"text-xl font-bold underline",children:"Employee Application Review"})]}),(0,i.jsxs)("div",{className:"mt-6 relative",children:[(0,i.jsx)("div",{className:"flex justify-end absolute right-0 top-0 mt-4 mr-4",children:A?(0,i.jsx)("img",{src:h,alt:"".concat(t.name,"'s photo"),className:"w-32 h-36 border-2 border-lite_grey shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)]"}):(0,i.jsx)("img",{src:ra,alt:"".concat(t.name,"'s photo"),className:"w-32 h-36 border-2 border-lite_grey shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)]"})}),(0,i.jsx)("div",{className:"mt-6",children:[{label:"Applying For The Position",value:t.position},{label:"Type",value:t.empType},{label:"Contract",value:t.contractType},{label:"CV Received From",value:t.agent},{label:"Name",value:t.name},{label:"Chinese characters",value:t.chinese},{label:"Gender",value:t.gender},{label:"Date of Birth",value:y(t.dob)},{label:"Age",value:t.age},{label:"Email",value:t.email},{label:"Marital Status",value:t.marital},{label:"Country of Birth",value:t.cob},{label:"Nationality",value:t.nationality},{label:"Other Nationality",value:t.otherNation},{label:"Race",value:t.race},{label:"Other Race",value:t.otherRace},{label:"Religion",value:t.religion},{label:"Other Religion",value:t.otherReligion},{label:"Contact Number",value:t.contactNo},{label:"Alternate Number",value:t.alternateNo},{label:"Present Address",value:t.presentAddress},{label:"Permanent Address",value:t.permanentAddress},{label:"Driving License Class",value:t.driveLic},{label:"Language Proficiency",value:t.lang?"string"===typeof t.lang?t.lang.replace(/\[|\]/g,""):t.lang.join(", "):"N/A"},{label:"Other Language",value:t.otherLang},{label:"Brunei IC No.",value:t.bwnIcNo},{label:"Brunei IC Colour",value:t.bwnIcColour},{label:"Brunei IC Expiry",value:y(t.bwnIcExpiry)},{label:"Passport No.",value:t.ppNo},{label:"Passport Issued Date",value:y(t.ppIssued)},{label:"Passport Expiry Date",value:y(t.ppExpiry)},{label:"Passport Issued Destination",value:t.ppDestinate},{label:"Brief Description of Present Duties",value:R.desc},{label:"Have you ever suffered from any disease or received treatment",value:R.disease},{label:"If yes, Details ",value:R.diseaseDesc},{label:"Were you ever an alcoholic or substance abuser",value:R.liquor},{label:"If yes, Details",value:R.liquorDesc},{label:"Have you ever been convicted of a crime",value:R.crime},{label:"If yes, Details",value:R.crimeDesc},{label:"Number of Years Experience",value:R.noExperience},{label:"Salary Expected",value:R.salaryExpectation},{label:"Termination Notice For Present\xa0Job",value:R.noticePeriod},{label:"Have you been interviewed for a position at this company before",value:R.perIS},{label:"If yes, Details",value:R.perIDesc},{label:"Any other information you wish to provide",value:R.supportInfo}].map(((e,t)=>(0,i.jsxs)("div",{className:"center  mb-4 leading-relaxed",children:[(0,i.jsx)("strong",{className:"w-full max-w-[200px]",children:e.label}),(0,i.jsx)("span",{className:"w-[50px] text-center",children:":"}),(0,i.jsx)("span",{className:"w-full",children:e.value||"N/A"})]},t)))}),(null===L||void 0===L?void 0:L.length)>0&&(0,i.jsx)("div",{className:"mt-6",children:L.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-6 border rounded p-4",children:[(0,i.jsxs)("h3",{className:"font-bold underline mb-4",children:["Family Details ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Name"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.name||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Relationship"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.relationship||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Age"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.age||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Place of Occupation"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.placeOfOccupation||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Occupation"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.occupation||"N/A"]})]})]},t)))}),(null===F||void 0===F?void 0:F.length)>0&&(0,i.jsx)("div",{className:"mt-6",children:F.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-6 border rounded p-4",children:[(0,i.jsxs)("h3",{className:"font-bold underline mb-4",children:["Education Details ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"University"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.university||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Degree"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.degree||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"From - To"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.fromDate||"N/A"," -"," ",e.toDate||"N/A"]})]})]},t)))}),(null===M||void 0===M?void 0:M.length)>0&&(0,i.jsx)("div",{className:"mt-6",children:M.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-6 border rounded p-4",children:[(0,i.jsxs)("h3",{className:"font-bold underline mb-4",children:["Work Experience ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Company"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.name||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Position"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.position||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"From"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",y(e.from)||"N/A"," -"," ",y(e.to)||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Salary"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.salary||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Reason For Leaving"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.reasonForLeaving||"N/A"]})]})]},t)))}),(null===B||void 0===B?void 0:B.length)>0&&(0,i.jsx)("div",{className:"mt-6",children:B.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-6 border rounded p-4",children:[(0,i.jsxs)("h3",{className:"font-bold underline mb-4",children:["Referees Details ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Name"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.name||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Address"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.address||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Phone Number"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.phoneNumber||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Profession"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.profession||"N/A"]})]})]},t)))}),(null===q||void 0===q?void 0:q.length)>0&&(0,i.jsx)("div",{className:"mt-6",children:q.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-6 border rounded p-4",children:[(0,i.jsxs)("h3",{className:"font-bold underline mb-4",children:["Relatives Employed by the company Details ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Name"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.name||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Position Held"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.positionHeld||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Relationship"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.relationship||"N/A"]})]})]},t)))}),(null===U||void 0===U?void 0:U.length)>0&&(0,i.jsx)("div",{className:"mt-6",children:U.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-6 border rounded p-4",children:[(0,i.jsxs)("h3",{className:"font-bold underline mb-4",children:["Emergency Details ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Name"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.name||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Relationship"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.relationship||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Address"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.address||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Phone Number"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.phoneNumber||"N/A"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:"Blood Group"}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.bloodGroup||"N/A"]})]})]},t)))}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5  my-3",children:"Uploaded Documents:"}),Y([R.uploadResume],"Resume"),Y([R.uploadCertificate],"Qualification Certificate"),Y([R.uploadPp],"Passport"),Y([R.uploadIc],"IC")]})]}),(0,i.jsxs)("div",{className:"",children:[void 0!==r&&(0,i.jsxs)(i.Fragment,{children:[!r&&(0,i.jsxs)("div",{className:"flex justify-between space-x-4 py-12 px-14",children:[(0,i.jsx)("button",{className:"hover:bg-rejectHover bg-rejectRed text-white font-semibold shadow-xl rounded-md px-4 py-2 min-w-[140px] max-w-[140px]",onClick:()=>{P([t])},disabled:g,children:"Rejected"===g?"Loading...":"Reject"}),(0,i.jsx)("button",{className:"hover:bg-[#3f4a54] bg-blue text-white  font-semibold shadow-xl rounded-md px-4 py-2",onClick:()=>{p(!0)},children:"Schedule Interview"}),(0,i.jsx)("button",{className:"hover:bg-selectGreenHover bg-selectGreen text-white  font-semibold shadow-xl rounded-md px-4 py-2 min-w-[140px] max-w-[140px]",onClick:()=>{O([t])},disabled:g,children:"Selected"===g?"Loading...":"Selected"})]}),r&&(0,i.jsxs)("div",{className:"flex justify-between space-x-4 mt-4 py-12 px-36",children:[(0,i.jsx)("button",{className:"hover:bg-rejectHover bg-rejectRed  font-semibold shadow-xl rounded-md px-4 py-2 min-w-[140px] max-w-[140px]",onClick:()=>{P([t])},disabled:g,children:"Rejected"===g?"Loading...":"Reject"}),(0,i.jsx)("button",{className:"hover:bg-selectGreenHover bg-selectGreen  font-semibold shadow-xl rounded-md px-4 py-2 min-w-[140px] max-w-[140px]",onClick:()=>{O([t])},disabled:g,children:"Selected"===g?"Loading...":"Selected"})]})]}),m&&(0,i.jsx)(Pe,{text:N,notification:m,path:D})]})]})}),c&&(0,i.jsx)("div",{className:"fixed top-0 left-0 inset-0 bg-black bg-opacity-50 w-full z-50",children:(0,i.jsx)(aa,{candidate:t,onClose:()=>{p(!1)}})})]})};var ia=a(7196),la=a(3156);const oa=e=>{let{currentPage:t,totalPages:a,onPageChange:r}=e;const n=(()=>{const e=[];if(a<=4)for(let t=1;t<=a;t++)e.push(t);else{let r=Math.max(t-1,1),n=r+3;n>a&&(n=a,r=Math.max(n-3,1));for(let t=r;t<=n;t++)e.push(t)}return e})();return(0,i.jsxs)("div",{className:"flex justify-between gap-6 w-3/5 items-center",children:[(0,i.jsxs)("button",{onClick:()=>r(t-1),disabled:1===t,className:"flex items-center gap-2 border border-[#5A5858] text-sm text-dark_grey rounded-lg hover:bg-gray-200 px-5 py-2 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200",children:[(0,i.jsx)(la.QVr,{className:"text-[16px]"}),(0,i.jsx)("span",{children:"Previous"})]}),n.map(((e,a)=>(0,i.jsx)("button",{onClick:()=>r(e),className:"w-8 h-8 p-4 flex items-center justify-center text-sm font-medium rounded-full ".concat(t===e?"bg-[indigo] shadow-md text-white":"bg-gray-200 text-dark_grey"),children:e},a))),(0,i.jsxs)("button",{onClick:()=>r(t+1),disabled:t===a,className:"flex items-center gap-2 border border-[#5A5858] text-sm text-dark_grey rounded-lg  px-5 py-2 ",children:[(0,i.jsx)("span",{children:"Next"}),(0,i.jsx)(Tt.Z0P,{className:"text-[16px]"})]})]})},da=e=>{let{columns:t,rowClickHandler:a,selectedRows:r,onRowSelect:s,showCheckboxes:l=!0,currentPage:o,selectedTable:d,edited:c,showEditIcon:p,data:m,rowsPerPage:u=30}=e;const[h,x]=(0,n.useState)(r||[]),[f,v]=(0,n.useState)({}),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(null),[j,A]=(0,n.useState)(1),w=(0,n.useRef)(null),S=m.filter((e=>"Inactive"!==e.status)),E=S.sort(((e,t)=>e.tempID-t.tempID)),I=Math.ceil(S.length/u),k=(j-1)*u,T=j*u,C=E.slice(k,T);(0,n.useEffect)((()=>{A(1)}),[S.length]),(0,n.useEffect)((()=>{j>I&&A(I>0?I:1)}),[I]);const R={TempID:"tempID",Name:"name",Gender:"gender",Nationality:"nationality",Position:"position",Experience:"noExperience",Email:"email",Contact:"contactNo",Contract:"contractType",Type:"empType",Interviewer:"interviewer",Date:"date",Time:"time",Venue:"venue",Status:"status"};return(0,n.useEffect)((()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&v({})};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),S?0===S.length?(0,i.jsx)("div",{className:"text-center text-grey py-10",children:"No data available."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",ref:w,children:[(0,i.jsxs)("table",{className:"w-full text-center",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsxs)("tr",{children:[l&&(0,i.jsx)("th",{className:"pl-4 py-4",children:(0,i.jsx)("input",{className:"w-6 h-6",type:"checkbox",onClick:e=>e.stopPropagation(),onChange:e=>{if(e.target.checked){const e=C.map(((e,t)=>k+t));x(e),s&&s(e)}else x([]),s&&s([])},checked:h.length===C.length&&C.length>0})}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"S.No"}),t.map(((e,t)=>(0,i.jsx)("th",{className:"pl-4 py-4",children:e},t))),("status"===o||"workpasstracking"===o)&&(0,i.jsx)("th",{})]})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer",children:C.map(((e,a)=>(0,i.jsxs)("tr",{className:"border-b-2 hover:bg-medium_blue bg-white border-[#C7BCBC] text-[15px] text-[#303030] ".concat(h.includes(k+a)?"bg-medium_blue":""),onClick:()=>((e,t,a)=>{v((e=>(0,g.A)((0,g.A)({},e),{},{[t]:(null===e||void 0===e?void 0:e[t])===a?null:a}))),D(e),N(!0)})(e,d,a),children:[l&&(0,i.jsx)("td",{className:"pl-4 py-4",children:(0,i.jsx)("input",{className:"w-5 h-6",type:"checkbox",onClick:t=>{t.stopPropagation(),c(e)},checked:h.includes(k+a),onChange:()=>(e=>{const t=k+e,a=h.includes(t)?h.filter((e=>e!==t)):[...h,t];x(a),s&&s(a)})(a)})}),(0,i.jsx)("td",{className:"pl-4 py-4",children:k+a+1}),t.map(((t,a)=>(0,i.jsx)("td",{className:"pl-4 py-4",children:e[R[t]]||"-"},a))),("status"===o||"workpasstracking"===o)&&p&&(0,i.jsx)("td",{className:"px-4 py-4 text-[#835c1d]",children:(0,i.jsx)(ia.GQd,{className:"text-2xl cursor-pointer",onClick:t=>{t.stopPropagation(),c(e)}})})]},a)))})]}),y&&b&&(0,i.jsx)(sa,{candidate:b,onClose:()=>{N(!1)},showDecisionButtons:"status"===o})]}),C.length>0&&(0,i.jsx)("div",{className:"flex justify-center mt-10",children:(0,i.jsx)(oa,{currentPage:j,totalPages:I,onPageChange:e=>{e>0&&e<=I&&(A(e),x([]))}})})]}):(0,i.jsx)("div",{children:"Loading..."})},ca=e=>{let{allEmpDetails:t,searchUserList:a,searchIcon1:l,searchIcon2:o,placeholder:d,border:c,searchFields:p=["name","tempID","position","nationality"]}=e;const[m,u]=(0,n.useState)(""),h=(0,r.zy)(),{IVSSDetails:x,empPDData:g}=(0,n.useContext)(s.Y);(0,n.useEffect)((()=>{u("")}),[t,h]);var f=null===x||void 0===x?void 0:x.filter((e=>null===g||void 0===g?void 0:g.some((t=>t.tempID===e.tempID))));const v=(0,n.useCallback)((()=>{if(t&&t.length>0){const e=m.toLowerCase(),r=t.filter((e=>"Bruneian"===e.nationality||"Brunei PR"===e.nationality)).filter((e=>{const t=null===f||void 0===f?void 0:f.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!x.some((t=>t.tempID===e.tempID))&&"Inactive"!==e.status||a})),n=r.find((t=>p.some((a=>t[a]&&"string"===typeof t[a]&&t[a].toLowerCase().includes(e)))));n?a([n]):(alert("Employee not found."),a([]))}}),[t,m,p]);return(0,i.jsx)("div",{className:"relative",children:(0,i.jsxs)("div",{className:"py-[9px] w-full text_size_5 bg-white border text-grey border-lite_grey ".concat(c," flex items-center px-3 gap-2"),children:[(0,i.jsx)("div",{className:"text-dark_grey text-2xl mr-1 ",children:l}),(0,i.jsx)("input",{type:"text",placeholder:d,className:"outline-none w-full text-sm",value:m,onChange:e=>{const r=e.target.value.toLowerCase();if(u(r),r.trim()){const e=t.filter((e=>"Bruneian"===e.nationality||"Brunei PR"===e.nationality)).filter((e=>{const t=null===f||void 0===f?void 0:f.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!x.some((t=>t.tempID===e.tempID))&&"Inactive"!==e.status||a})),n=e.filter((e=>p.some((t=>e[t]&&"string"===typeof e[t]&&e[t].toLowerCase().includes(r))))),s=null===n||void 0===n?void 0:n.sort(((e,t)=>{const a=p.some((t=>{var a;return(null===(a=e[t])||void 0===a?void 0:a.toString().toLowerCase())===r})),n=p.some((e=>{var a;return(null===(a=t[e])||void 0===a?void 0:a.toString().toLowerCase())===r}));return a&&!n?-1:!a&&n?1:0}));a(s)}else{const e=t.filter((e=>"Bruneian"===e.nationality||"Brunei PR"===e.nationality)).filter((e=>{const t=null===f||void 0===f?void 0:f.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!x.some((t=>t.tempID===e.tempID))&&"Inactive"!==e.status||a}));a(e)}}}),o&&(0,i.jsx)("div",{className:"text-dark_grey text-2xl cursor-pointer",onClick:()=>{v()},children:o})]})})},pa=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(null),s=(0,Ee.D)();return{loading:e,error:a,handleDeletePDDetails:async e=>{t(!0);try{await s.graphql({query:ke.yv,variables:{input:{id:e,status:"Inactive"}}}).then((e=>{console.log(e)})).catch((e=>{console.log(e)}))}catch(a){r(a),console.error("Error deleting personal details:",a)}finally{t(!1)}}}},ma=()=>{var e,t;const[a,l]=(0,n.useState)(""),[o,d]=(0,n.useState)(!0),{formattedPermissions:c}=qt(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,g]=(0,n.useState)(!1),[f,v]=(0,n.useState)([]),[y,N]=(0,n.useState)([]),[b,D]=(0,n.useState)(null),{empPDData:A,IVSSDetails:w}=(0,n.useContext)(s.Y),{setTempID:S}=(0,Fe.b)(),E=(0,r.Zp)(),[I,k]=(0,n.useState)([]),{handleDeletePDDetails:T}=pa(),C=null===w||void 0===w?void 0:w.filter((e=>null===A||void 0===A?void 0:A.some((t=>t.tempID===e.tempID))));(0,n.useEffect)((()=>{const e=A.filter((e=>"Bruneian"===e.nationality||"Brunei PR"===e.nationality)).filter((e=>{const t=null===C||void 0===C?void 0:C.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!w.some((t=>t.tempID===e.tempID))&&"Inactive"!==e.status||a}));v(e),d(!1)}),[A,w,a]);const R=()=>{m(!p)},P=["Local CV"];return(0,i.jsxs)("section",{className:"screen-size min-h-screen w-full my-5",children:[(0,i.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("button",{className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold",children:"Local CV Candidates"})}),(0,i.jsx)("div",{className:" flex-1 flex justify-end ",children:(0,i.jsx)(ca,{type:"text",allEmpDetails:A,searchUserList:v,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Search",border:"rounded-full",shadow:"shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",onChange:e=>l(e.target.value)})})]}),(0,i.jsxs)("div",{className:"flex relative mb-3 gap-3 justify-end",children:[(0,i.jsx)("div",{className:"text-2xl hover:text-3xl flex items-center cursor-pointer",onClick:()=>{1===y.length?((()=>{if(1===y.length){var e;const t=null===(e=f[y[0]])||void 0===e?void 0:e.tempID;S(t)}})(),E("/addCandidates",{})):y.length>1?alert("Please select only one row to edit."):alert("Please select a row before editing.")},disabled:0===y.length,children:(0,i.jsx)(Tt.uO9,{className:"mr-2"})}),(null===c||void 0===c||null===(e=c.deleteAccess)||void 0===e||null===(t=e.Recruitment)||void 0===t?void 0:t.some((e=>P.includes(e))))&&(0,i.jsx)("div",{className:"text-3xl hover:text-4xl cursor-pointer text-[#f42232cc] flex items-center",onClick:async()=>{const e=y.map((e=>f[e]));await e.forEach((async(e,t)=>{await T(e.id)}));h("".concat(e.length," candidates.")),await R(),N([])},children:(0,i.jsx)(_t.b6i,{className:"mr-2"})})]}),o?(0,i.jsx)("div",{className:"text-center py-10",children:"Loading..."}):x?(0,i.jsx)("div",{className:"text-center py-10",children:"No data available."}):(0,i.jsx)(da,{columns:["Name","Gender","Nationality","TempID","Position","Type","Email","Contact"],rowClickHandler:e=>{D(e)},data:f,selectedRows:y,onRowSelect:e=>{N(e)},edited:e=>{k(e)}}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:R,title1:u,path:"/recrutiles/localcandi"})]})},ua=e=>{let{allEmpDetails:t,searchUserList:a,searchIcon1:l,searchIcon2:o,placeholder:d,border:c,searchFields:p=["name","tempID","position","nationality"]}=e;const[m,u]=(0,n.useState)(""),h=(0,r.zy)(),{IVSSDetails:x,empPDData:g}=(0,n.useContext)(s.Y);(0,n.useEffect)((()=>{u("")}),[t,h]);const f=null===x||void 0===x?void 0:x.filter((e=>null===g||void 0===g?void 0:g.some((t=>t.tempID===e.tempID)))),v=(0,n.useCallback)((()=>{if(t&&t.length>0){const e=m.toLowerCase(),r=t.filter((e=>"Bruneian"!==e.nationality&&"Brunei PR"!==e.nationality)).filter((e=>{const t=null===f||void 0===f?void 0:f.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!x.some((t=>t.tempID===e.tempID&&"Inactive"!==e.status))||a})),n=r.find((t=>p.some((a=>t[a]&&"string"===typeof t[a]&&t[a].toLowerCase().includes(e)))));n?a([n]):(alert("Employee not found."),a([]))}}),[t,m,p]);return(0,i.jsx)("div",{className:"relative",children:(0,i.jsxs)("div",{className:"py-[9px] w-full text_size_5 bg-white border text-grey border-lite_grey ".concat(c," flex items-center px-3 gap-2"),children:[(0,i.jsx)("div",{className:"text-dark_grey text-2xl mr-1 ",children:l}),(0,i.jsx)("input",{type:"text",placeholder:d,className:"outline-none w-full text-sm",value:m,onChange:e=>{const r=e.target.value.toLowerCase();if(u(r),r.trim()){const e=t.filter((e=>"Bruneian"!==e.nationality&&"Brunei PR"!==e.nationality)).filter((e=>{const t=null===f||void 0===f?void 0:f.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!x.some((t=>t.tempID===e.tempID&&"Inactive"!==e.status))||a})),n=e.filter((e=>p.some((t=>e[t]&&"string"===typeof e[t]&&e[t].toLowerCase().includes(r))))),s=null===n||void 0===n?void 0:n.sort(((e,t)=>{const a=p.some((t=>{var a;return(null===(a=e[t])||void 0===a?void 0:a.toString().toLowerCase())===r})),n=p.some((e=>{var a;return(null===(a=t[e])||void 0===a?void 0:a.toString().toLowerCase())===r}));return a&&!n?-1:!a&&n?1:0}));a(s)}else{const e=t.filter((e=>"Bruneian"!==e.nationality&&"Brunei PR"!==e.nationality)).filter((e=>{const t=null===f||void 0===f?void 0:f.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!x.some((t=>t.tempID===e.tempID&&"Inactive"!==e.status))||a}));a(e)}}}),o&&(0,i.jsx)("div",{className:"text-dark_grey text-2xl cursor-pointer",onClick:()=>{v()},children:o})]})})},ha=()=>{var e,t;const{formattedPermissions:a}=qt(),{handleDeletePDDetails:l}=pa(),[o,d]=(0,n.useState)(""),[c,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""),[g,f]=(0,n.useState)(""),[v,y]=(0,n.useState)([]),[N,b]=(0,n.useState)(null),[D,A]=(0,n.useState)([]),[w,S]=(0,n.useState)([]),[E,I]=(0,n.useState)(!0),[k,T]=(0,n.useState)(!1),{setTempID:C}=(0,Fe.b)(),{empPDData:R,IVSSDetails:P,educDetailsData:O}=(0,n.useContext)(s.Y),_=(0,r.Zp)(),M=null===P||void 0===P?void 0:P.filter((e=>null===R||void 0===R?void 0:R.some((t=>t.tempID===e.tempID))));(0,n.useEffect)((()=>{const e=R.filter((e=>"Bruneian"!==e.nationality&&"Brunei PR"!==e.nationality)).filter((e=>{const t=null===M||void 0===M?void 0:M.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!P.some((t=>t.tempID===e.tempID&&"Inactive"!==e.status))||a}));S(e),I(!1)}),[R,P,o]);const F=()=>{u(!m)},L=e=>{f("Show All"===e?"":e),p(!1)},U=["Non Local CV"];return(0,i.jsxs)("section",{className:"screen-size min-h-screen w-full my-5",children:[(0,i.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"relative ",children:[(0,i.jsxs)("button",{onClick:()=>{p(!c)},className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold flex items-center",children:["Non Local CV Candidates",c?(0,i.jsx)(Tt.Ucs,{className:"ml-2"}):(0,i.jsx)(Tt.Vr3,{className:"ml-2"})]}),c&&(0,i.jsxs)("div",{className:"absolute mt-2 bg-white border-2 border-grey rounded-lg shadow-lg",children:[(0,i.jsx)("button",{onClick:()=>L("LPA"),className:"block px-4 py-2 hover:bg-[#f8a595cc] rounded-lg text-left w-full",children:"LPA"}),(0,i.jsx)("button",{onClick:()=>L("SAWP"),className:"block px-4 py-2 hover:bg-[#f8a595cc] rounded-lg text-left w-full",children:"SAWP"}),(0,i.jsx)("button",{onClick:()=>L("Show All"),className:"block px-4 py-2 hover:bg-[#f8a595cc] rounded-lg text-left w-full",children:"Show All"})]})]}),(0,i.jsx)("div",{className:" flex-1 flex justify-end ",children:(0,i.jsx)(ua,{type:"text",allEmpDetails:R,searchUserList:S,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Search",border:"rounded-full",shadow:"shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",onChange:e=>d(e.target.value)})})]}),(0,i.jsxs)("div",{className:"flex mb-3 gap-3 justify-end",children:[(0,i.jsx)("div",{className:"text-2xl hover:text-3xl flex items-center cursor-pointer",onClick:()=>{1===v.length?((()=>{if(1===v.length){var e;const t=null===(e=w[v[0]])||void 0===e?void 0:e.tempID;C(t)}})(),_("/addCandidates",{state:{editingData:v[0]}})):v.length>1?alert("Please select only one row to edit."):alert("Please select a row before editing.")},disabled:0===v.length,children:(0,i.jsx)(Tt.uO9,{className:"mr-2"})}),(null===a||void 0===a||null===(e=a.deleteAccess)||void 0===e||null===(t=e.Recruitment)||void 0===t?void 0:t.some((e=>U.includes(e))))&&(0,i.jsx)("div",{className:"text-3xl hover:text-4xl cursor-pointer text-[#f42232cc] flex items-center",onClick:async()=>{const e=v.map((e=>w[e]));await e.forEach((async(e,t)=>{await l(e.id)}));x("".concat(e.length," candidates.")),await F(),y([])},children:(0,i.jsx)(_t.b6i,{className:"mr-2"})})]}),g&&(0,i.jsx)("div",{className:"mb-3 text-[18px] w-20 py-1 text-center rounded-lg font-bold bg-medium_red",children:g}),E?(0,i.jsx)("div",{className:"text-center py-10",children:"Loading..."}):k?(0,i.jsx)("div",{className:"text-center py-10",children:k}):(0,i.jsx)(da,{columns:["Name","Gender","Nationality","TempID","Position","Contract","Type","Email","Contact"],rowClickHandler:e=>{b(e)},data:w,selectedRows:v,onRowSelect:e=>{y(e)},edited:e=>{A(e)}}),m&&(0,i.jsx)(Wt,{handleDeleteMsg:F,title1:h,path:"/recrutiles/nonloccandi"})]})},xa=()=>{(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const[e,t]=(0,n.useState)("applicantDetails"),a=(0,r.Zp)(),s=(0,r.zy)(),{tempID:l}=s.state||{},o=(e,r)=>{t(e),a(r)};return(0,n.useEffect)((()=>{const e=s.pathname;e.includes("/personalDetails")?t("personalDetails"):e.includes("/educationDetails")?t("educationExperience"):e.includes("/otherDetails")?t("otherDetails"):t("applicantDetails")}),[s]),(0,i.jsx)("section",{className:"w-full bg-[#F5F6F1] ",children:(0,i.jsxs)("div",{className:"w-11/12 relative mx-auto p-6",children:[(0,i.jsxs)("div",{className:" flex items-center mb-4",children:[(0,i.jsx)(r.N_,{to:"/recrutiles/candidate",className:"text-xl text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("h2",{className:"text-[20px] font-bold flex-1 text-center",children:"Application Form"})]}),(0,i.jsxs)("div",{className:"flex justify-between border-b mb-4 text-[14px] font-semibold",children:[(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("applicantDetails"===e?"border-b-8 border-yellow":""),onClick:()=>o("applicantDetails","/addCandidates"),children:"Applicant Details"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("personalDetails"===e?"border-b-8 border-yellow":""),onClick:()=>o("personalDetails","/addCandidates/personalDetails"),children:"Personal Details"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("educationExperience"===e?"border-b-8 border-yellow":""),onClick:()=>o("educationExperience","/addCandidates/educationDetails"),children:"Reference Details"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("otherDetails"===e?"border-b-8 border-yellow":""),onClick:()=>o("otherDetails","/addCandidates/otherDetails"),children:"Other Details"})]}),(0,i.jsx)("div",{children:(0,i.jsx)(r.sv,{context:{activeTab:e,handleNext:()=>{switch(e){case"applicantDetails":a("/addCandidates/personalDetails"),t("personalDetails");break;case"personalDetails":a("/addCandidates/educationDetails"),t("educationExperience");break;case"educationExperience":a("/addCandidates/otherDetails"),t("otherDetails")}},tempID:l}})})]})})},ga=e=>{let{allEmpDetails:t,searchUserList:a,searchIcon1:s,searchIcon2:l,placeholder:o,border:d}=e;const[c,p]=(0,n.useState)(""),m=(0,r.zy)();(0,n.useEffect)((()=>{p("")}),[t,m]);const u=(0,n.useCallback)((()=>{if(t&&t.length>0){const e=c.toString().toUpperCase(),r=t.find((t=>{var a;return null===(a=[t.empID,t.empBadgeNo,t.sapNo,t.name])||void 0===a?void 0:a.some((t=>(null===t||void 0===t?void 0:t.toString().toUpperCase())===e))}));r&&c?a([r]):c?(alert("Employee not found."),a([])):alert("Your search box is empty. Enter a value to start searching.")}}),[t,c]);return(0,i.jsx)("div",{className:"relative",children:(0,i.jsxs)("div",{className:"py-[9px] w-full text_size_5 bg-white border text-grey border-lite_grey ".concat(d," flex items-center px-3 gap-2"),children:[(0,i.jsx)("div",{className:"text-dark_grey text-2xl mr-1 ",children:s}),(0,i.jsx)("input",{type:"text",placeholder:o,className:"outline-none w-full text-sm",value:c,onChange:e=>{const r=e.target.value.toUpperCase();if(p(r),r.trim()){const e=t.filter((e=>e.empID&&"string"===typeof e.empID&&e.empID.toUpperCase().includes(r.toUpperCase())||e.name&&"string"===typeof e.name&&e.name.toUpperCase().includes(r.toUpperCase())||e.empName&&"string"===typeof e.empName&&e.empName.toUpperCase().includes(r.toUpperCase())||e.position&&"string"===typeof e.position&&e.position.toUpperCase().includes(r.toUpperCase())||e.empBadgeNo&&"string"===typeof e.empBadgeNo&&e.empBadgeNo.toUpperCase().includes(r.toUpperCase())||e.sapNo&&"string"===typeof e.sapNo&&e.sapNo.toUpperCase().includes(r.toUpperCase()))),n=null===e||void 0===e?void 0:e.sort(((e,t)=>{var a,n,s,i,l,o,d,c,p,m;const u=null===(a=e.empID)||void 0===a?void 0:a.toString().toUpperCase(),h=null===(n=t.empID)||void 0===n?void 0:n.toString().toUpperCase(),x=null===(s=e.name)||void 0===s?void 0:s.toUpperCase(),g=null===(i=t.name)||void 0===i?void 0:i.toUpperCase(),f=null===(l=e.empBadgeNo)||void 0===l?void 0:l.toString().toUpperCase(),v=null===(o=t.empBadgeNo)||void 0===o?void 0:o.toString().toUpperCase(),y=u===r||x===r||(null===(d=e.empBadgeNo)||void 0===d?void 0:d.toString().toUpperCase())===r||(null===(c=e.sapNo)||void 0===c?void 0:c.toString().toUpperCase())===r,N=h===r||g===r||(null===(p=t.empBadgeNo)||void 0===p?void 0:p.toString().toUpperCase())===r||(null===(m=t.sapNo)||void 0===m?void 0:m.toString().toUpperCase())===r,b=(null===u||void 0===u?void 0:u.startsWith(r))||(null===x||void 0===x?void 0:x.startsWith(r))||(null===f||void 0===f?void 0:f.startsWith(r)),D=(null===h||void 0===h?void 0:h.startsWith(r))||(null===g||void 0===g?void 0:g.startsWith(r))||(null===v||void 0===v?void 0:v.startsWith(r));return y&&!N?-1:!y&&N?1:b&&!D?-1:!b&&D?1:0}));a(n)}else a(t)}}),l&&(0,i.jsx)("div",{className:"text-dark_grey text-2xl  cursor-pointer",onClick:()=>{u()},children:l})]})})},fa=e=>{let{data:t,onclose:a}=e;const[r,s]=(0,n.useState)(!1),l=()=>{s(!r)};return(0,i.jsx)("section",{className:"fixed top-0 left-0 inset-0 bg-black bg-opacity-80 center w-full h-screen z-[60]",children:(0,i.jsx)("div",{className:"bg-white w-full max-w-xl max-h-[90vh]  rounded-lg relative overflow-y-auto",children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"relative center mb-8",children:[" ",(0,i.jsx)("h6",{className:"text-xl font-bold underline text-dark_grey",children:"View Form"}),(0,i.jsx)("button",{className:"absolute top-0 right-4 w-8 h-8 border rounded-full text-xl",onClick:a,children:"\xd7"})]}),[{label:"UserID",value:t.empID},{label:"Name",value:t.name},{label:"Type",value:t.selectType},{label:"Official Email",value:t.officialEmail},{label:"Password",value:r?t.password:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",isPassword:!0}].map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:e.label}),(0,i.jsxs)("span",{className:"flex items-center gap-3 col-span-2",children:[": \xa0",e.value,e.isPassword&&(0,i.jsxs)("div",{className:" center",children:[" ",(0,i.jsx)("button",{type:"button",className:" text-dark_grey underline text-xl",onClick:l,children:r?(0,i.jsx)(Tt.Ny1,{}):(0,i.jsx)(Tt.mx3,{})})]})]})," "]},t))),(0,i.jsx)("div",{className:"center mt-7",children:(0,i.jsx)("button",{className:"primary_btn text_size_4",onClick:a,children:"Okay"})})]})})})},va=()=>{(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{empPIData:e,userData:t,workInfoData:a}=(0,n.useContext)(s.Y),{SubmitDeletedUser:l}=(()=>{const e=(0,Ee.D)();return{SubmitDeletedUser:(0,n.useCallback)((async t=>{let{deleteUserData:a}=t;if(!a)throw new Error("Missing required parameters");const{id:r}=a,n={id:r,status:"InActive"};console.log(r);try{await e.graphql({query:ke.TK,variables:{input:n,limit:2e4}}).then((e=>{window.location.href="/user"}))}catch(s){console.log("Error deleting user:",s)}}),[e])}})(),{formattedPermissions:o}=qt(),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)(""),[u,h]=(0,n.useState)([]),[x,f]=(0,n.useState)([]),[v,y]=(0,n.useState)(!1),[N,b]=(0,n.useState)([]),[D,A]=(0,n.useState)([]),[w,S]=(0,n.useState)([]),E=(0,r.Zp)(),[I,k]=(0,n.useState)(1),[T,C]=(0,n.useState)(30),[R,P]=(0,n.useState)([]);(0,n.useEffect)((()=>{const e=(I-1)*T,t=(R.length>0?R:x).sort(((e,t)=>{const a=/\d+$/,r=e.empID.match(a)?e.empID.match(a)[0].padStart(5,"0"):"",n=t.empID.match(a)?t.empID.match(a)[0].padStart(5,"0"):"",s=e.empID.replace(a,"").toLowerCase(),i=t.empID.replace(a,"").toLowerCase();return s!==i?s.localeCompare(i):r.localeCompare(n)})).slice(e,e+T);A(t)}),[I,T,x,R]);const O=Math.ceil((R.length>0?R.length:x.length)/T),_=()=>{y(!v)};(0,n.useEffect)((()=>{(async()=>{try{const r=t.map((t=>{const r=e.find((e=>e.empID===t.empID)),n=a?a.find((e=>e.empID===t.empID)):{};return r?(0,g.A)((0,g.A)((0,g.A)({},t),r),n):null})).filter(Boolean).filter((e=>"Active"===e.status));h(r),f(r)}catch(r){console.log(r)}})()}),[t,e]);const M=()=>{c(!d)},F=(I-1)*T,L=["User"];return(0,i.jsxs)("section",{className:" flex justify-center px-10 py-20 bg-[#F8F8F8] min-h-screen relative",onClick:()=>{S([])},children:[(0,i.jsxs)("div",{className:"bg-white flex flex-col gap-10 rounded-b-lg shadow-lg max-w-[99%] w-full",children:[(0,i.jsx)("article",{className:"bg-[#E1E1E2] py-3 shadow-md rounded-t-lg text-center",children:(0,i.jsx)("h1",{className:"text-dark_grey text-2xl font-semibold",children:"User List"})}),(0,i.jsx)("section",{children:(0,i.jsxs)("div",{className:"flex items-center justify-between  px-14",children:[(0,i.jsxs)("div",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2",onClick:()=>{E("/addNewForm",{state:{addUserData:{userValue:t,employeeValue:e,workValue:a}}})},children:[" ",(0,i.jsx)("span",{className:"text-2xl",children:"+"})," Add"]}),(0,i.jsx)(ga,{allEmpDetails:x,searchUserList:e=>{P(e),k(1)},searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee ID",border:"rounded-lg",filteredEmployees:w,setFilteredEmployees:S})]})}),(0,i.jsxs)("div",{className:"flex flex-col flex-grow",children:[(0,i.jsx)("div",{className:"leaveManagementTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto  px-5",children:D&&D.length>0?(0,i.jsxs)("table",{className:"w-full mx-auto bg-white pt-10",children:[(0,i.jsx)("thead",{className:"px-5 bg-[#939393] text-white sticky top-0 left-0",children:(0,i.jsxs)("tr",{className:"text_size_5  px-5",children:[(0,i.jsx)("th",{className:"px-5 text-start py-3",children:"S.No"}),(0,i.jsx)("th",{className:"px-5 text-start py-3",children:"EMP ID"}),(0,i.jsx)("th",{className:"px-5 text-start  py-3",children:"Name"}),(0,i.jsx)("th",{className:"px-5 text-start py-3",children:"Type"}),(0,i.jsx)("th",{className:"px-5 text-start py-3",children:"Official Email Id"}),(0,i.jsx)("th",{className:"px-5 text-start py-3",children:"Password"}),(0,i.jsx)("th",{className:"px-5 text-center py-3",children:"ViewForm"}),(0,i.jsx)("th",{className:"px-5 text-start py-3",children:"Actions"})]})}),(0,i.jsx)("tbody",{children:D&&D.length>0?D.map(((r,n)=>{var s,d;const c=F+n+1;return(0,i.jsxs)("tr",{className:"shadow-lg ",children:[(0,i.jsx)("td",{className:"px-5 py-3 ",children:c}),(0,i.jsx)("td",{className:"px-5 py-3 ",children:r.empID}),(0,i.jsx)("td",{className:"px-5 py-3 break-words overflow-hidden ",children:r.name}),(0,i.jsx)("td",{className:"px-5 py-3 ",children:r.selectType}),(0,i.jsx)("td",{className:"px-5 py-3 break-words overflow-hidden ",children:r.officialEmail}),(0,i.jsx)("td",{className:"py-3 text-center break-words overflow-hidden",children:(0,i.jsx)("input",{type:"password",className:"outline-none w-full text-center  ",value:r.password,readOnly:!0})}),(0,i.jsx)("td",{className:" py-3",children:(0,i.jsx)("span",{className:" text-[blue] underline flex justify-center",onClick:()=>{_(),b(r)},children:"View"})}),(0,i.jsx)("td",{className:"px-5 py-2",children:(0,i.jsxs)("div",{className:"flex gap-5 justify-center",children:[(0,i.jsx)("span",{onClick:()=>{(async r=>{E("/addNewForm",{state:{editUserData:{storedValue:{data:r,title:"Edit User"},userValue:t,employeeValue:e,workValue:a}}})})(r)},children:(0,i.jsx)(ia.Ics,{})}),(null===o||void 0===o||null===(s=o.deleteAccess)||void 0===s||null===(d=s.User)||void 0===d?void 0:d.some((e=>L.includes(e))))&&(0,i.jsx)("span",{onClick:()=>{(async e=>{const a=t.find((t=>t.empID===e.empID));await l({deleteUserData:a}),m("".concat(a.empID," deleted successfully.")),M()})(r)},children:(0,i.jsx)(ia.Ku6,{})})]})})]},n)})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"6",className:"px-6 py-6 text-center text-dark_ash text_size_5",children:"No User List Available Here"})})})]}):(0,i.jsx)("p",{className:"px-6 py-6 text-center text-dark_ash text_size_5",children:"Loading Data..."})}),(0,i.jsx)("div",{className:"flex justify-end items-end  ",children:D&&D.length>0&&(0,i.jsx)("div",{className:" flex px-5 py-8 ",children:(0,i.jsx)(oa,{currentPage:I,totalPages:O,onPageChange:e=>{e>=1&&e<=O&&k(e)}})})})]})]}),v&&(0,i.jsx)(fa,{data:N,onclose:_}),d&&(0,i.jsx)(Wt,{handleDeleteMsg:M,title1:p})]})},ya=e=>{let{allEmpDetails:t,searchUserList:a,searchIcon1:l,searchIcon2:o,placeholder:d,border:c,searchFields:p=["name","tempID","position","nationality"]}=e;const[m,u]=(0,n.useState)(""),h=(0,r.zy)(),{empPDData:x,IVSSDetails:g}=(0,n.useContext)(s.Y);(0,n.useEffect)((()=>{u("")}),[t,h]);const f=null===x||void 0===x?void 0:x.map((e=>e.tempID)),v=null===g||void 0===g?void 0:g.map((e=>e.tempID)),y=null===f||void 0===f?void 0:f.filter((e=>null===v||void 0===v?void 0:v.includes(e))),N=null===g||void 0===g?void 0:g.filter((e=>null===x||void 0===x?void 0:x.some((t=>t.tempID===e.tempID)))),b=(0,n.useCallback)((()=>{if(t&&t.length>0){const e=m.toLowerCase(),t=null===x||void 0===x?void 0:x.filter((e=>{const t=null===N||void 0===N?void 0:N.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!y.includes(e.tempID)&&"Inactive"!==e.status||a})),r=t.find((t=>p.some((a=>t[a]&&"string"===typeof t[a]&&t[a].toLowerCase().includes(e)))));r?a([r]):(alert("Employee not found."),a([]))}}),[t,m,p]);return(0,i.jsx)("div",{className:"relative",children:(0,i.jsxs)("div",{className:"py-[9px] w-full text_size_5 bg-white border text-grey border-lite_grey ".concat(c," flex items-center px-3 gap-2"),children:[(0,i.jsx)("div",{className:"text-dark_grey text-2xl mr-1 ",children:l}),(0,i.jsx)("input",{type:"text",placeholder:d,className:"outline-none w-full text-sm",value:m,onChange:e=>{const t=e.target.value.toLowerCase();if(u(t),t.trim()){const e=null===x||void 0===x?void 0:x.filter((e=>{const t=null===N||void 0===N?void 0:N.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!y.includes(e.tempID)&&"Inactive"!==e.status||a})),r=e.filter((e=>p.some((a=>e[a]&&"string"===typeof e[a]&&e[a].toLowerCase().includes(t))))),n=null===r||void 0===r?void 0:r.sort(((e,a)=>{const r=p.some((a=>{var r;return(null===(r=e[a])||void 0===r?void 0:r.toString().toLowerCase())===t})),n=p.some((e=>{var r;return(null===(r=a[e])||void 0===r?void 0:r.toString().toLowerCase())===t}));return r&&!n?-1:!r&&n?1:0}));a(n)}else{const e=null===x||void 0===x?void 0:x.filter((e=>{const t=null===N||void 0===N?void 0:N.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status;return!y.includes(e.tempID)&&"Inactive"!==e.status||a}));a(e)}}}),o&&(0,i.jsx)("div",{className:"text-dark_grey text-2xl cursor-pointer",onClick:()=>{b()},children:o})]})})},Na=async e=>{let{requestId:t,newStatus:a,newRemark:r}=e;if(!t)throw new Error("Missing required parameter: requestId");if(void 0===a&&void 0===r)throw new Error("At least one of newStatus or newRemark must be provided.");const n=(0,Ee.D)(),s=(0,g.A)((0,g.A)({id:t},void 0!==a&&{status:a}),void 0!==r&&{remarkReq:r});try{return await n.graphql({query:ke.uF,variables:{input:s}})}catch(i){throw console.error("Error updating requisition data:",i),i}},ba=(0,Ee.D)(),Da=e=>{let{isVisible:t,onClose:a,selectedRequest:r,onStatusChange:s}=e;const[l,o]=(0,n.useState)([]),[d,c]=(0,n.useState)(null),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,g]=(0,n.useState)(!1),{hrManagerMail:f,gmPosition:v}=(localStorage.getItem("userType"),(0,Fe.b)()),y={reqName:"",department:"",position:"",project:"",quantity:"",reasonForReq:"",justification:"",replacementFor:"",qualification:"",tentativeDate:new Date,status:"Pending"},N=r||y,b="hr-recruitment@adininworks.com";(0,n.useEffect)((()=>{if(t){(async()=>{try{let n=[],s=null;do{var e,t,a,r;const i=await ba.graphql({query:Ie.Kc,variables:{nextToken:s}}),l=null===i||void 0===i||null===(e=i.data)||void 0===e||null===(t=e.listEmpRequisitions)||void 0===t?void 0:t.items.map((e=>({id:e.id,requestorID:e.requestorID,approverID:e.approverID,reqName:e.reqName,department:e.department,position:e.position,project:e.project,quantity:e.quantity,reasonForReq:e.reasonForReq,justification:e.justification,replacementFor:e.replacementFor||"N/A",qualification:e.qualification,tentativeDate:e.tentativeDate,status:e.status,remarkReq:e.remarkReq,date:e.createdAt})));n=[...n,...l],s=null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.listEmpRequisitions)||void 0===r?void 0:r.nextToken}while(s);o(n),c(null)}catch(n){c("Error fetching requisition data")}})()}}),[t]);const j=async e=>{try{g(!0),await Na({requestId:r.id,newStatus:e}),s&&s({id:r.id,status:e});const{reqName:t,position:a,approverID:n}=N;if(n&&await Me("Employee Requisition Request ".concat(e),"<html>\n    <body>\n      <p>\n       Dear ".concat(t,",<br/><br/>\n        Your requisition request for the position of ").concat(a," \n        has been <strong>").concat(e,"</strong> by the General Manager.<br/><br/>\n        Click here https://hr.adininworks.co to view the Status.\n       </p>\n       </body>\n    </html>"),"hr_no-reply@adininworks.com",n),f&&Array.isArray(f))for(const r of f)await Me("Requisition ".concat(e),"<html>\n                <body>\n                  <p>\n                    Dear HR,<br/><br/>\n                    The requisition request for the position of ".concat(a," \n                    submitted by ").concat(t," has been <strong>").concat(e,'</strong> \n                    by the General Manager.<br/><br/>\n                    Please proceed with the necessary actions.<br/><br/>\n                    Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the Status Update.\n                  </p>\n                </body>\n              </html>'),"hr_no-reply@adininworks.com",r);b&&await Me("Requisition ".concat(e),'<html>\n            <body style="font-family: Arial, sans-serif; margin: 0; padding: 0; text-align: center;">\n              <div style="max-width: 600px; margin: 0 auto; padding: 20px;">\n                <p style="font-size: 16px; line-height: 1.5;">\n                  Dear HR,<br/><br/>\n                  The requisition request for the position of <strong>'.concat(a,"</strong> \n                  submitted by <strong>").concat(t,"</strong> has been <strong>").concat(e,'</strong> \n                  by the General Manager.<br/><br/>\n                  Please proceed with the necessary actions.<br/><br/>\n                  <a href="https://hr.adininworks.co" style="color: #007bff; text-decoration: none;">Click here to view the Status Update</a>.\n                </p>\n              </div>\n            </body>\n          </html>'),"hr_no-reply@adininworks.com",b),g(!1),x||(m(!0),h("Form Status Updated Successfully"))}catch(t){g(!1)}},w=e=>"Rejected"===e?"text-[red]":"Approved"===e?"text-[#339933]":"text-[#ff8b3d]";return(0,i.jsx)("div",{className:"fixed inset-0 ".concat(t?"flex":"hidden"," bg-grey bg-opacity-75 flex items-center justify-center z-50"),children:(0,i.jsx)("div",{className:"center",children:(0,i.jsxs)("header",{className:"bg-white w-full max-w-[600px] rounded-lg relative p-5 overflow-y-auto max-h-[90vh] min-h-[90vh] reqScroll",children:[(0,i.jsxs)("div",{className:"text-center p-2",children:[(0,i.jsx)("img",{src:Se.A,alt:"Logo",className:"max-w-[250px] w-full mx-40 mb-3"}),(0,i.jsx)("h2",{className:"text-xl font-bold underline my-2",children:"Employee Requisition Form"}),(0,i.jsx)("button",{onClick:a,className:"absolute top-5 right-6 border rounded-full p-1",children:(0,i.jsx)(A.RQJ,{size:20})})]}),(0,i.jsxs)("form",{className:"px-5 bg-white",children:[[{label:"Requested Manager",value:N.reqName},{label:"Department",value:N.department},{label:"Position",value:N.position},{label:"Project",value:N.project},{label:"Quantity",value:N.quantity},{label:"Reason for Request",value:N.reasonForReq},{label:"Justification",value:N.justification},{label:"Replacement For",value:N.replacementFor||"N/A"},{label:"Qualification",value:N.qualification},{label:"Tentative Date To Mobilize",value:(0,D.GP)(new Date(N.tentativeDate),"dd-MM-yyyy")}].map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,i.jsx)("strong",{className:"w-full",children:e.label}),(0,i.jsxs)("span",{className:"w-full col-span-2",children:[": \xa0",e.value]})]},t))),"GENERAL MANAGER"===v&&(0,i.jsx)(i.Fragment,{children:"Approved"!==N.status&&"Rejected"!==N.status?(0,i.jsxs)("div",{className:"flex justify-evenly pb-5",children:[(0,i.jsx)("button",{className:"hover:bg-medium_red hover:border-medium_red border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:()=>j("Rejected"),disabled:x,children:x?"Loading...":"Reject"}),(0,i.jsx)("button",{className:"hover:bg-[#faf362] border-2 border-yellow px-4 py-1 shadow-xl rounded-lg",onClick:()=>j("Approved"),disabled:x,children:x?"Loading...":"Approve"})]}):(0,i.jsxs)("div",{className:"mx-20 border center gap-3 rounded-lg bg-gradient-to-r from-[#f5ee6ad7] via-[#faf362] to-[#f5ee6ad7] shadow-[0_4px_6px_rgba(255,250,150,0.5)]",children:[(0,i.jsx)("h3",{className:"text-lg text-[#6a2b2b] p-1.5 font-bold",children:"Requisition Status :"}),(0,i.jsx)("p",{className:"text-xl font-semibold ".concat(w(N.status)),children:N.status||"Pending"})]})}),!v&&(0,i.jsxs)("div",{className:"mx-20 border center gap-3 rounded-lg bg-gradient-to-r from-[#f5ee6ad7] via-[#faf362] to-[#f5ee6ad7] shadow-[0_4px_6px_rgba(255,250,150,0.5)]",children:[(0,i.jsx)("h3",{className:"text-lg text-[#6a2b2b] p-1.5 font-bold",children:"Requisition Status :"}),(0,i.jsx)("p",{className:"text-xl font-semibold ".concat(w(N.status)),children:N.status||"Pending"})]}),p&&(0,i.jsx)(Pe,{text:u,notification:p,path:"/recrutiles/employreq"})]})]})})})},ja=e=>{let{isOpen:t,onClose:a,requestId:r,initialRemarks:s,onRemarkUpdated:l}=e;const[o,d]=(0,n.useState)(""),[c,p]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&d(s||"")}),[t,s]);return t?(0,i.jsx)("div",{className:"fixed inset-0 bg-grey bg-opacity-75 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-sm w-full",children:[(0,i.jsx)("h3",{className:"mb-4 text-xl font-semibold",children:"Remarks"}),(0,i.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),rows:"4",className:"w-full p-2 border rounded-md resize-y",placeholder:"Enter your remarks here...","aria-label":"Remarks"}),(0,i.jsxs)("div",{className:"mt-4 flex justify-center",children:[(0,i.jsx)("button",{className:"hover:bg-grey border-2 border-grey hover:text-white px-4 py-1 mr-2 rounded-lg",onClick:()=>{d(""),a()},children:"Cancel"}),(0,i.jsx)("button",{className:"hover:bg-[#faf362] border-2 border-yellow px-4 py-1 rounded-lg ".concat(c?"opacity-50 cursor-not-allowed":""),onClick:async()=>{p(!0);try{await Na({requestId:r,newRemark:o});l&&l(r,o)}catch(e){console.error("Error updating remark:",e)}finally{p(!1),d(""),a()}},disabled:c,children:c?"Saving...":"Save"})]})]})}):null},Aa=(0,Ee.D)(),wa=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!1),[s,l]=(0,n.useState)(null),[o,d]=(0,n.useState)(null),[c,p]=(0,n.useState)(null),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)({}),[f,v]=(0,n.useState)(10),[y,N]=(0,n.useState)(1);(0,n.useEffect)((()=>{(async()=>{try{let s=[],i=null;do{var e,a,r,n;const t=await Aa.graphql({query:Ie.Kc,variables:{nextToken:i}}),l=(null===t||void 0===t||null===(e=t.data)||void 0===e||null===(a=e.listEmpRequisitions)||void 0===a?void 0:a.items)||[];s=[...s,...l],i=null===t||void 0===t||null===(r=t.data)||void 0===r||null===(n=r.listEmpRequisitions)||void 0===n?void 0:n.nextToken}while(i);t(s),l(null)}catch(s){l("Failed to fetch requisition data"),t([])}})()}),[]);(0,n.useEffect)((()=>(document.body.style.overflow=a?"hidden":"auto",()=>{document.body.style.overflow="auto"})),[a]);const b=e.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))),A=m.length>0?m:b,w=Math.ceil(A.length/f),S=(y-1)*f,E=y*f,I=A.slice(S,E);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("section",{className:"screen-size w-full mt-5 mb-1",children:[(0,i.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,i.jsx)("button",{className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold",children:"Employee Requisition Review"}),(0,i.jsx)(ya,{allEmpDetails:e,searchUserList:u,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Search by Position"})]}),s&&(0,i.jsx)("div",{className:"text-[red] text-center mb-4",children:s}),I.length>0?(0,i.jsx)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-lg",children:(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0 rounded-lg",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"py-4",children:"S.No"}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"Manager"}),(0,i.jsx)("th",{className:"py-4",children:"Position"}),(0,i.jsx)("th",{className:"py-4",children:"Quantity"}),(0,i.jsx)("th",{className:"py-4",children:"Received Date"}),(0,i.jsx)("th",{className:"py-4",children:"Form"}),(0,i.jsx)("th",{className:"py-4",children:"Status"}),(0,i.jsx)("th",{className:"py-4",children:"Remarks"})]})}),(0,i.jsx)("tbody",{className:"bg-white text-center",children:I.map(((e,t)=>{return(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-4",children:S+t+1}),(0,i.jsx)("td",{className:"py-4 pl-4 max-w-[200px] text-ellipsis overflow-hidden",children:e.reqName}),(0,i.jsx)("td",{className:"py-4 max-w-[200px] text-ellipsis overflow-hidden",children:e.position}),(0,i.jsx)("td",{className:"py-4",children:e.quantity}),(0,i.jsx)("td",{className:"py-4",children:(0,D.GP)(new Date(e.createdAt),"dd-MM-yyyy")}),(0,i.jsx)("td",{className:"py-4 px-2",children:(0,i.jsx)("a",{href:"#",className:"text-[blue] font-semibold border-b-2 cursor-pointer",onClick:()=>(p(e),void r(!0)),children:"View"})}),(0,i.jsx)("td",{className:"py-4 font-semibold ".concat((a=e.status,"Rejected"===a?"text-[red]":"Approved"===a?"text-[#339933]":"Pending"===a?"text-dark_grey":"text-[#E8A317]")),children:e.status?e.status:"Pending"}),(0,i.jsxs)("td",{className:"py-4 center gap-2",children:[(0,i.jsx)("span",{className:"max-w-[200px] text-ellipsis overflow-hidden",children:e.remarkReq}),(0,i.jsx)("div",{className:"w-6 h-6 flex justify-center items-center",children:"Manager"===localStorage.getItem("userType")&&!e.remarkReq&&(0,i.jsx)(Tt.Mbp,{className:"text-[brown] cursor-pointer",onClick:()=>d(e)})})]})]},e.id);var a}))})]})}):(0,i.jsx)("p",{className:"text-center py-4",children:"No Requisitions Found"}),(0,i.jsx)(Da,{isVisible:a,onClose:()=>{p(null),r(!1)},selectedRequest:c,onStatusChange:e=>{t((t=>t.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{status:e.status}):t))))}}),(0,i.jsx)(ja,{isOpen:!!o,onClose:()=>{d(null)},requestId:null===o||void 0===o?void 0:o.id,initialRemarks:(null===o||void 0===o?void 0:o.remarkReq)||"",onRemarkUpdated:async(e,a)=>{t((t=>t.map((t=>t.id===e?(0,g.A)((0,g.A)({},t),{},{remarkReq:a}):t)))),x((t=>{const a=(0,g.A)((0,g.A)({},t),{},{[e]:!0});return localStorage.setItem("remarksSubmitted",JSON.stringify(a)),a}))}})]}),I.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center py-10",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:y,totalPages:w,onPageChange:e=>{e>0&&e<=w&&N(e)}})})})]})};var Sa=a(9698),Ea=a(1462);const Ia=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{interviewDetails:r}=ta(),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)({interview:{date:"",time:"",venue:"",interviewType:"",interviewer:"",message:""}}),p=localStorage.getItem("userID"),m=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(a.length>0&&null!==t&&void 0!==t&&t.tempID){const e=a.find((e=>e.tempID===t.tempID));if(e){const t=(e=>{if(!e||isNaN(new Date(e).getTime()))return"";const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(n,"-").concat(r,"-").concat(a)})(e.interDate);c({interview:{date:t,time:e.interTime,venue:e.venue,interviewType:e.interType,interviewer:e.manager,message:e.message}})}}}),[a,null===t||void 0===t?void 0:t.tempID]);const u=(e,t)=>{c((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID)));if(!n)return void alert("No interview data found for the selected candidate.");const s=null===n||void 0===n?void 0:n.id;if(!s)return void alert("Interview schedule ID not found.");const i=n,l=[...null!==i&&void 0!==i&&i.updatedBy?JSON.parse(null===i||void 0===i?void 0:i.updatedBy):[],{userID:p,date:m}].map((e=>({userID:e.userID,date:e.date})));try{await r({InterviewValue:{id:s,interDate:d.interview.date,interTime:d.interview.time,venue:d.interview.venue,interType:d.interview.interviewType,message:d.interview.message,manager:d.interview.interviewer,updatedBy:JSON.stringify(l)}}),o(!0)}catch(c){alert("Failed to update interview details. Please try again.")}},children:[(0,i.jsx)("div",{className:"p-4 grid grid-cols-2 gap-5",children:[{field:"date",label:"Date",type:"date"},{field:"time",label:"Time",type:"time"},{field:"venue",label:"Venue",type:"text"},{field:"interviewType",label:"Interview Type",type:"text"},{field:"interviewer",label:"Interviewer",type:"text"},{field:"message",label:"Message",type:"textarea"}].map((e=>{var t;return(0,i.jsxs)("label",{className:"block mb-4",children:[e.label,":","file"!==e.type&&"textarea"!==e.type?(0,i.jsx)("input",{type:e.type,className:"w-full border p-2 rounded mt-1",value:d.interview[e.field]||"",onChange:t=>u(e.field,t.target.value)}):"textarea"===e.type?(0,i.jsx)("textarea",{className:"w-full border p-2 rounded mt-1 h-[42px]",value:d.interview[e.field]||"",onChange:t=>u(e.field,t.target.value)}):(0,i.jsxs)("div",{className:"flex items-center mt-1",children:[(0,i.jsx)("input",{type:"file",className:"hidden",id:e.field,onChange:t=>{return a=e.field,r=t.target.files[0],void c((e=>(0,g.A)((0,g.A)({},e),{},{interview:(0,g.A)((0,g.A)({},e.interview),{},{[a]:r})})));var a,r}}),(0,i.jsxs)("label",{htmlFor:e.field,className:"flex items-center cursor-pointer text-grey",children:[(0,i.jsx)(Ea.Kh2,{className:"mr-2 text-lg text-[#ab1234]"}),(null===(t=d.interview[e.field])||void 0===t?void 0:t.name)||"Upload PDF"]})]})]},e.field)}))}),(0,i.jsx)("div",{className:"center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})}),l&&(0,i.jsx)(Pe,{text:"Candidate Selected Successfully",notification:l,path:"/recrutiles/status"})]})};var ka=a(899);const Ta=(0,Ee.D)(),Ca=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[l,o]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(async()=>{i(!0),o(null);let e=[],a=[],n=[],s=null,l=null,d=null;try{do{const t=await Ta.graphql({query:Ie.c2,variables:{nextToken:s}});t.data&&t.data.listInterviewSchedules,e=[...e,...t.data.listInterviewSchedules.items],s=t.data.listInterviewSchedules.nextToken}while(s);do{const e=await Ta.graphql({query:Ie.$1,variables:{nextToken:l}});e.data&&e.data.listPersonalDetails,a=[...a,...e.data.listPersonalDetails.items],l=e.data.listPersonalDetails.nextToken}while(l);do{const e=await Ta.graphql({query:Ie.g,variables:{nextToken:d}});e.data&&e.data.listLocalMobilizations,n=[...n,...e.data.listLocalMobilizations.items],d=e.data.listLocalMobilizations.nextToken}while(d);r(e);const i=e.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),o=n.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),c=a.map((e=>(0,g.A)((0,g.A)({},e),{},{interviewSchedules:i[e.tempID]||{},localMobilization:o[e.tempID]||{}})));t(c)}catch(c){o("Error fetching data."),console.error("Error fetching data:",c)}finally{i(!1)}})()}),[]),{mergedInterviewData:e,interviewSchedules:a,loading:s,error:l}},Ra=e=>{let{candidate:t}=e;const{mergedInterviewData:a}=Ca(),{interviewDetails:r}=ta(),[s,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)({interview:{position:"",department:"",otherDepartment:""}}),{register:c,formState:{errors:p},watch:m}=(0,tt.mN)({resolver:(0,at.t)(ka.Ik().shape({position:ka.Yj().required("Position is required"),department:ka.Yj().required("Department is required"),otherDepartment:ka.Yj().when("department",{is:"Other",then:ka.Yj().required("Please specify the department")})})),defaultValues:{position:"",department:"",otherDepartment:""}}),u=localStorage.getItem("userID"),h=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(a.length>0&&null!==t&&void 0!==t&&t.tempID){const n=a.find((e=>e.tempID===t.tempID));var e,r;if(n)d({interview:{position:n.position,department:null===(e=n.interviewSchedules)||void 0===e?void 0:e.department,otherDepartment:null===(r=n.interviewSchedules)||void 0===r?void 0:r.otherDepartment}})}}),[a,null===t||void 0===t?void 0:t.tempID]);const x=(e,t)=>{d((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)("form",{onSubmit:async e=>{var n;e.preventDefault();const s=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID)));if(!s)return console.error("No interview data found for the selected candidate."),void alert("No interview data found for the selected candidate.");const i=null===s||void 0===s||null===(n=s.interviewSchedules)||void 0===n?void 0:n.id;if(!i)return void alert("Interview schedule ID not found.");const d=null===s||void 0===s?void 0:s.interviewSchedules,c=[...null!==d&&void 0!==d&&d.updatedBy?JSON.parse(null===d||void 0===d?void 0:d.updatedBy):[],{userID:u,date:h}].map((e=>({userID:e.userID,date:e.date})));try{await r({InterviewValue:{id:i,department:o.interview.department,otherDepartment:o.interview.otherDepartment,updatedBy:JSON.stringify(c)}}),l(!0)}catch(p){console.error("Error submitting interview details:",p),alert("Failed to update interview details. Please try again.")}},className:"p-4",children:[(0,i.jsx)("div",{className:"mb-4 max-w-[400px]",children:(0,i.jsxs)("label",{className:"block mb-2",children:["Selected Position",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("position")),{},{className:"w-full p-2 border rounded mt-1",value:o.interview.position,onChange:e=>x("position",e.target.value)})),p.position&&(0,i.jsx)("p",{className:"text-[red]",children:p.position.message})]})}),(0,i.jsx)("div",{className:"mb-4 max-w-[400px]",children:(0,i.jsxs)("label",{className:"block mb-2",children:["Selected Department:",(0,i.jsxs)("select",(0,g.A)((0,g.A)({},c("department")),{},{className:"w-full p-2 border rounded mt-1",value:o.interview.department,onChange:e=>x("department",e.target.value),children:[(0,i.jsx)("option",{value:""}),Et.map(((e,t)=>(0,i.jsx)("option",{value:e.value,children:e.label},t)))]})),p.department&&(0,i.jsx)("p",{className:"text-[red]",children:p.department.message})]})}),"Other"===m("department")&&(0,i.jsx)("div",{className:"mb-4 max-w-[400px]",children:(0,i.jsxs)("label",{className:"block mb-2",children:["Other Department:",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},c("otherDepartment")),{},{className:"w-full p-2 border rounded mt-1",placeholder:"Enter the department name",value:o.interview.otherDepartment,onChange:e=>x("otherDepartment",e.target.value)})),p.otherDepartment&&(0,i.jsx)("p",{className:"text-[red]",children:p.otherDepartment.message})]})}),(0,i.jsx)("div",{className:"center mt-10",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})}),s&&(0,i.jsx)(Pe,{text:"Candidate Updated Successfully",notification:s,path:"/recrutiles/status"})]})},Pa=()=>{const e=(0,Ee.D)();return{loiDetails:(0,n.useCallback)((async t=>{let{LoiValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const{id:t,mobSignDate:r,mobFile:n,paafApproveDate:s,paafFile:i,loiIssueDate:l,loiAcceptDate:o,loiDeclineDate:d,declineReason:c,loiFile:p,cvecApproveDate:m,cvecFile:u,updatedBy:h}=a,x={id:t,mobSignDate:r,mobFile:n,paafApproveDate:s,paafFile:i,loiIssueDate:l,loiAcceptDate:o,loiDeclineDate:d,declineReason:c,loiFile:p,cvecApproveDate:m,cvecFile:u,updatedBy:h},g=await e.graphql({query:ke.c4,variables:{input:x}});console.log("Data successfully updated:",g)}catch(r){throw console.error("Error updating data:",r),r}}),[])}},Oa=["Select status","LOI","CVEV","PAAF","MOBILIZATION","SAWP","DOE","NLMS","Bank Guarantee","JITPA","Labour Deposit","Immigration","Air Ticket","NonLocal Mobilization","Candidate List"];var _a=a(2759);const Ma=(e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:""})})))}catch(l){console.log(l,"deletedarrayUpload in employe info")}},Fa=e=>{let{candidate:t,formattedPermissions:a}=e;const{localMobilization:r,isLoading:l,error:o}=Xt(),{IVSSDetails:d}=(0,n.useContext)(s.Y),{loiDetails:c}=Pa(),{interviewDetails:p}=ta(),{mergedInterviewData:m}=Ca(),[u,h]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),[N,b]=(0,n.useState)({loiFile:!1}),[D,j]=(0,n.useState)({loiFile:null}),[A,w]=(0,n.useState)({loiFile:null}),{register:S,setValue:E,formState:{errors:I}}=(0,tt.mN)(),[k,T]=(0,n.useState)({interview:{loiIssueDate:"",loiAcceptDate:"",loiDeclineDate:"",declineReason:"",loiFile:"",tempID:"",status:""}}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0],P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{f(!x)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null;(0,n.useEffect)((()=>{if(m.length>0){const e=m.find((e=>e.tempID===t.tempID));e&&(T({interview:{loiIssueDate:e.localMobilization.loiIssueDate,loiAcceptDate:e.localMobilization.loiAcceptDate,loiDeclineDate:e.localMobilization.loiDeclineDate,declineReason:e.localMobilization.declineReason,loiFile:e.localMobilization.loiFile,status:e.interviewSchedules.status,tempID:e.tempID}}),e.localMobilization.loiFile&&j((t=>(0,g.A)((0,g.A)({},t),{},{loiFile:P(e.localMobilization.loiFile)}))))}}),[m,t.tempID]);const F=(e,t)=>{T((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)("form",{children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"loiIssueDate",children:"Date of Issue"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"loiIssueDate"},S("loiIssueDate",{required:"Date of Issue is required"})),{},{value:k.interview.loiIssueDate,onChange:e=>F("loiIssueDate",e.target.value)})),I.loiIssueDate&&(0,i.jsx)("p",{className:"text-[red] text-xs",children:I.loiIssueDate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"loiAcceptDate",children:"Date of Acceptance"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"loiAcceptDate"},S("loiAcceptDate")),{},{value:k.interview.loiAcceptDate,onChange:e=>F("loiAcceptDate",e.target.value)})),I.loiAcceptDate&&(0,i.jsx)("p",{className:"text-[red] text-xs",children:I.loiAcceptDate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"loiDeclineDate",children:"Date of Decline"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"loiDeclineDate"},S("loiDeclineDate")),{},{value:k.interview.loiDeclineDate,onChange:e=>F("loiDeclineDate",e.target.value)})),I.loiDeclineDate&&(0,i.jsx)("p",{className:"text-[red] text-xs",children:I.loiDeclineDate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"declineReason",children:"Decline Reason"}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[44px]",id:"declineReason",rows:"2"},S("declineReason")),{},{value:k.interview.declineReason,onChange:e=>F("declineReason",e.target.value)})),I.declineReason&&(0,i.jsx)("p",{className:"text-[red] text-xs",children:I.declineReason.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 outline-none h-[44px]",id:"status"},S("status")),{},{value:k.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"loiFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(E(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID,n=await(0,_a.k)(e,a,r),s=await Ma(e,a,0,j,w,b,T);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));y("".concat(a)),O()}catch(o){console.error("Error deleting file:",o),alert("Error processing the file deletion.")}},isUploadingString:N,error:I.loiFile,formattedPermissions:a,requiredPermissions:["Status"],access:"Recruitment",check:N.loiFile})})})})]}),(0,i.jsxs)("div",{className:"center mt-5",children:[(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",disabled:l,onClick:async e=>{e.preventDefault();const a=m.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=d.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=a.localMobilization.id,i=null===n||void 0===n?void 0:n.id,l=null===a||void 0===a?void 0:a.localMobilization,u=null===a||void 0===a?void 0:a.interviewSchedules,x=[...null!==l&&void 0!==l&&l.updatedBy?JSON.parse(null===l||void 0===l?void 0:l.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),g=[...null!==u&&void 0!==u&&u.updatedBy?JSON.parse(null===u||void 0===u?void 0:u.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),f={id:s,loiIssueDate:k.interview.loiIssueDate,loiAcceptDate:k.interview.loiAcceptDate,loiDeclineDate:k.interview.loiDeclineDate,declineReason:k.interview.declineReason,loiFile:N.loiFile?JSON.stringify(M(A.loiFile)):k.interview.loiFile,tempID:t.tempID,updatedBy:JSON.stringify(x)},v={id:i,department:k.interview.department,otherDepartment:k.interview.otherDepartment,status:k.interview.status,updatedBy:JSON.stringify(g)},y={loiIssueDate:k.interview.loiIssueDate,loiAcceptDate:k.interview.loiAcceptDate,loiDeclineDate:k.interview.loiDeclineDate,declineReason:k.interview.declineReason,loiFile:N.loiFile?JSON.stringify(M(A.loiFile)):k.interview.loiFile,tempID:t.tempID,createdBy:JSON.stringify([{userID:C,date:R}])};try{s?(await c({LoiValue:f}),await p({InterviewValue:v}),h(!0)):(await r(y),await p({InterviewValue:v}),h(!0))}catch(o){console.error("Error updating LOI:",o),alert("Failed to update LOI. Please try again.")}},children:l?"Submitting...":"Submit"}),o&&(0,i.jsx)("p",{className:"text-red-500",children:o.message})]}),u&&(0,i.jsx)(Pe,{text:"LOI Updated Successfully",notification:u,path:"/recrutiles/status"}),x&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:v})]})},La=ka.Ik().shape({cvecApproveDate:ka.p6().notRequired(),cvecFile:ka.gl().nullable().required("File is required").test("fileType","Only PDF files are allowed",(e=>!!e&&"application/pdf"===e.type))}),Ua=e=>{let{candidate:t,formattedPermissions:a}=e;const{localMobilization:r}=Xt(),{IVSSDetails:l}=(0,n.useContext)(s.Y),{mergedInterviewData:o}=Ca(),{loiDetails:d}=Pa(),{interviewDetails:c}=ta(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",cvecApproveDate:"",cvecFile:[],status:""}}),[N,b]=(0,n.useState)({cvecFile:!1}),[D,j]=(0,n.useState)({cvecFile:null}),[A,w]=(0,n.useState)({cvecFile:null}),{register:S,formState:{errors:E},setValue:I}=(0,tt.mN)({resolver:(0,at.t)(La)}),k=localStorage.getItem("userID"),T=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(o.length>0&&null!==t&&void 0!==t&&t.tempID){const e=o.find((e=>e.tempID===t.tempID));e&&y({interview:{cvecApproveDate:e.localMobilization.cvecApproveDate,cvecFile:e.localMobilization.cvecFile,status:e.interviewSchedules.status}}),e.localMobilization.cvecFile&&j((t=>(0,g.A)((0,g.A)({},t),{},{cvecFile:C(e.localMobilization.cvecFile)})))}}),[o,null===t||void 0===t?void 0:t.tempID]);const C=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},R=()=>{m(!p)},P=(new Date).toISOString().split("T")[0],O=e=>e?[{upload:e,date:P}]:null,_=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)("form",{onSubmit:async e=>{var a;e.preventDefault();const n=o.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),i=null===n||void 0===n||null===(a=n.localMobilization)||void 0===a?void 0:a.id,p=null===s||void 0===s?void 0:s.id,m=null===n||void 0===n?void 0:n.localMobilization,u=null===n||void 0===n?void 0:n.interviewSchedules,h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),x=[...null!==u&&void 0!==u&&u.updatedBy?JSON.parse(null===u||void 0===u?void 0:u.updatedBy):[],{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),g={cvecApproveDate:v.interview.cvecApproveDate,cvecFile:N.cvecFile?JSON.stringify(O(A.cvecFile)):v.interview.cvecFile,tempID:t.tempID,createdBy:JSON.stringify([{userID:k,date:T}])};try{i?await d({LoiValue:{id:i,cvecApproveDate:v.interview.cvecApproveDate,cvecFile:N.cvecFile?JSON.stringify(O(A.cvecFile)):v.interview.cvecFile,updatedBy:JSON.stringify(h)}}):await r(g),await c({InterviewValue:{id:p,status:v.interview.status,updatedBy:JSON.stringify(x)}}),f(!0)}catch(y){console.error("Error submitting interview details:",y),alert("Failed to update interview details. Please try again.")}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"cvecApproveDate",children:"Approval Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"cvecApproveDate"},S("cvecApproveDate")),{},{value:v.interview.cvecApproveDate,onChange:e=>_("cvecApproveDate",e.target.value)}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"cvecFile",handleFileUpload:async(e,a)=>{const r=t.tempID;let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(I(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID,n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"DeleteUploadCVEV error")}})(e,a,0,j,w,b);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),R()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:E.cvecFile,className:"p-4",formattedPermissions:a,requiredPermissions:["Status"],access:"Recruitment",check:N.cvecFile})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[44px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>_("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})}),x&&(0,i.jsx)(Pe,{text:"CVEV Updated Successfully",notification:x,path:"/recrutiles/status"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:R,title1:u})]})},Ba=ka.Ik().shape({paafApproveDate:ka.p6().notRequired(),paafFile:ka.gl().nullable().required("File is required").test("fileType","Only PDF files are allowed",(e=>!!e&&"application/pdf"===e.type))}),qa=e=>{let{candidate:t,formattedPermissions:a}=e;const{localMobilization:r}=Xt(),{IVSSDetails:l}=(0,n.useContext)(s.Y),{loiDetails:o}=Pa(),{mergedInterviewData:d}=Ca(),{interviewDetails:c}=ta(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",paafApproveDate:"",paafFile:"",status:""}}),[N,b]=(0,n.useState)({paafFile:!1}),[D,j]=(0,n.useState)({paafFile:null}),[A,w]=(0,n.useState)({paafFile:null}),{register:S,formState:{errors:E},setValue:I}=(0,tt.mN)({resolver:(0,at.t)(Ba)}),k=localStorage.getItem("userID"),T=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(d.length>0){const e=d.find((e=>e.tempID===t.tempID));e&&(y({interview:{paafApproveDate:e.localMobilization.paafApproveDate,paafFile:e.localMobilization.paafFile,status:e.interviewSchedules.status}}),e.localMobilization.paafFile&&j((t=>(0,g.A)((0,g.A)({},t),{},{paafFile:C(e.localMobilization.paafFile)}))))}}),[d,t.tempID]);const C=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},R=()=>{m(!p)},P=(new Date).toISOString().split("T")[0],O=e=>e?[{upload:e,date:P}]:null,_=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=d.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===a||void 0===a?void 0:a.localMobilization.id,i=null===n||void 0===n?void 0:n.id,p=null===a||void 0===a?void 0:a.localMobilization,m=null===a||void 0===a?void 0:a.interviewSchedules,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),x={paafApproveDate:v.interview.paafApproveDate,paafFile:N.paafFile?JSON.stringify(O(A.paafFile)):v.interview.paafFile,tempID:t.tempID,createdBy:JSON.stringify([{userID:k,date:T}])};try{s?await o({LoiValue:{id:s,paafApproveDate:v.interview.paafApproveDate,paafFile:N.paafFile?JSON.stringify(O(A.paafFile)):v.interview.paafFile,updatedBy:JSON.stringify(u)}}):await r(x),await c({InterviewValue:{id:i,status:v.interview.status,updatedBy:JSON.stringify(h)}}),f(!0)}catch(g){alert("Failed to update interview details. Please try again.")}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"paafApproveDate",children:"Approval Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"paafApproveDate"},S("paafApproveDate")),{},{value:v.interview.paafApproveDate,onChange:e=>_("paafApproveDate",e.target.value)}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"paafFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(I(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"DeleteUploadPAAF in error")}})(e,a,0,j,w,b);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),R()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:E.paafFile,formattedPermissions:a,requiredPermissions:["Status"],access:"Recruitment",check:N.paafFile})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[44px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>_("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})}),x&&(0,i.jsx)(Pe,{text:"PAAF Updated Successfully",notification:x,path:"/recrutiles/status"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:R,title1:u})]})},Ha=ka.Ik().shape({mobSignDate:ka.p6().notRequired(),mobFile:ka.gl().nullable().required("File is required").test("fileType","Only PDF files are allowed",(e=>!!e&&"application/pdf"===e.type))}),Wa=e=>{let{candidate:t,formattedPermissions:a}=e;const{localMobilization:r}=Xt(),{IVSSDetails:l}=(0,n.useContext)(s.Y),{loiDetails:o}=Pa(),{mergedInterviewData:d}=Ca(),{interviewDetails:c}=ta(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",mobSignDate:"",mobFile:"",status:""}}),[N,b]=(0,n.useState)({mobFile:!1}),[D,j]=(0,n.useState)({mobFile:null}),[A,w]=(0,n.useState)({mobFile:null}),{register:S,formState:{errors:E},setValue:I}=(0,tt.mN)({resolver:(0,at.t)(Ha)}),k=localStorage.getItem("userID"),T=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(d.length>0){const e=d.find((e=>e.tempID===t.tempID));e&&(y({interview:{mobSignDate:e.localMobilization.mobSignDate,mobFile:e.localMobilization.mobFile,status:e.interviewSchedules.status}}),e.localMobilization.mobFile&&j((t=>(0,g.A)((0,g.A)({},t),{},{mobFile:C(e.localMobilization.mobFile)}))))}}),[d,t.tempID]);const C=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},R=()=>{m(!p)},P=(new Date).toISOString().split("T")[0],O=e=>e?[{upload:e,date:P}]:null,_=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=d.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=a.localMobilization.id,i=null===n||void 0===n?void 0:n.id,p=null===a||void 0===a?void 0:a.localMobilization,m=null===a||void 0===a?void 0:a.interviewSchedules,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),x={mobSignDate:v.interview.mobSignDate,mobFile:N.mobFile?JSON.stringify(O(A.mobFile)):v.interview.mobFile,tempID:t.tempID,createdBy:JSON.stringify([{userID:k,date:T}])};try{s?await o({LoiValue:{id:s,mobSignDate:v.interview.mobSignDate,mobFile:N.mobFile?JSON.stringify(O(A.mobFile)):v.interview.mobFile,updatedBy:JSON.stringify(u)}}):await r(x),await c({InterviewValue:{id:i,status:v.interview.status,updatedBy:JSON.stringify(h)}}),f(!0)}catch(g){alert("Failed to update interview details. Please try again.")}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"mobSignDate",children:"Date of Mobilize"}),(0,i.jsx)("input",{className:"w-full border p-2 rounded mt-1",type:"date",id:"mobSignDate",value:v.interview.mobSignDate,onChange:e=>_("mobSignDate",e.target.value)})]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"mobFile",handleFileUpload:async(e,a)=>{const r=t.tempID;let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(I(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await Ma(e,a,0,j,w,b);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),R()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:E.mobFile,formattedPermissions:a,requiredPermissions:["Status"],access:"Recruitment",check:N.mobFile})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",{className:"w-full border p-2 rounded mt-1 h-[44px]",id:"status",value:v.interview.status,onChange:e=>_("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))})]})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})}),x&&(0,i.jsx)(Pe,{text:"Mobilization Updated Successfully",notification:x,path:"/recrutiles/status"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:R,title1:u})]})},za=e=>{let{candidate:t,onClose:a,onSave:r}=e;const{formattedPermissions:s}=qt(),[l,o]=(0,n.useState)(0);return(0,i.jsx)("div",{className:"fixed inset-0 bg-grey bg-opacity-80 z-50 center",children:(0,i.jsxs)("div",{className:"bg-white p-10 rounded-lg w-full max-w-[700px] overflow-hidden relative",children:[(0,i.jsx)("button",{onClick:a,className:" absolute top-2 right-2 border rounded-full p-1",children:(0,i.jsx)(A.RQJ,{size:20})}),(0,i.jsx)("div",{className:"p-4 shadow-md bg-[#FBFCFF]",children:(0,i.jsxs)("div",{className:"flex gap-4 text-[13px] font-semibold",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"TEMP ID:"})," ",null===t||void 0===t?void 0:t.tempID]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Name:"})," ",null===t||void 0===t?void 0:t.name]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Contract Type:"})," ",null===t||void 0===t?void 0:t.contractType]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Employee Type:"})," ",null===t||void 0===t?void 0:t.empType]})]})}),(0,i.jsxs)("article",{className:"flex-1 flex gap-5 text-black mt-5",children:[(0,i.jsx)("h1",{className:"  px-3 py-1 rounded whitespace-nowrap  ".concat(0===l?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>o(0),children:"Interview"}),(0,i.jsx)("h2",{className:"  px-3 py-1 rounded whitespace-nowrap  ".concat(1===l?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>o(1),children:"Candidate"}),(0,i.jsx)("h3",{className:"  px-3 py-1 rounded whitespace-nowrap  ".concat(2===l?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>o(2),children:"LOI"}),"Offshore"===(null===t||void 0===t?void 0:t.empType)&&(0,i.jsx)("h4",{className:" px-3 py-1 rounded whitespace-nowrap  ".concat(3===l?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>o(3),children:"CVEV"}),"Onshore"===(null===t||void 0===t?void 0:t.empType)&&(0,i.jsx)("h5",{className:"  px-3 py-1 rounded whitespace-nowrap  ".concat(4===l?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>o(4),children:"PAAF"}),"Local"===(null===t||void 0===t?void 0:t.contractType)&&(0,i.jsx)("h6",{className:"px-3 py-1 rounded whitespace-nowrap  ".concat(5===l?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>o(5),children:"Mobilization"})]}),0===l&&(0,i.jsx)(Ia,{candidate:t}),1===l&&(0,i.jsx)(Ra,{candidate:t}),2===l&&(0,i.jsx)(Fa,{candidate:t,formattedPermissions:s}),3===l&&(0,i.jsx)(Ua,{candidate:t,formattedPermissions:s}),4===l&&(0,i.jsx)(qa,{candidate:t,formattedPermissions:s}),"Local"===(null===t||void 0===t?void 0:t.contractType)&&5===l&&(0,i.jsx)(Wa,{candidate:t,formattedPermissions:s})]})})},Ya=e=>{let{data:t,formatDate:a}=e;const[r,s]=(0,n.useState)(!1),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)(10),[u,h]=(0,n.useState)(1),x=Math.ceil(t.length/p),g=(u-1)*p,f=u*p,v=t.slice(g,f),y=e=>{c(e),s(!r)},N=e=>{c(e),o(!l)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[v&&v.length>0?(0,i.jsxs)("table",{className:"w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Interview Date","Time","Venue","Interviewer","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:v&&v.length>0?v.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center bg-white border-b-2 border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:g+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:a(e.interviewDetails_interDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_interTime||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_venue||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_manager||"N/A"}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>N(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>y(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),l&&(0,i.jsx)(sa,{candidate:d,onClose:N,showDecisionButtons:!0}),r&&(0,i.jsx)(za,{candidate:d,onClose:y})]}),v.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:u,totalPages:x,onPageChange:e=>{e>0&&e<=x&&h(e)}})})})]})},Va=e=>{let{data:t}=e;const[a,r]=(0,n.useState)(!1),[s,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(10),[m,u]=(0,n.useState)(1),h=Math.ceil(t.length/c),x=(m-1)*c,g=m*c,f=t.slice(x,g);(0,n.useEffect)((()=>{}),[t]);const v=e=>{d(e),r(!a)},y=e=>{d(e),l(!s)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[f&&f.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Selected Department","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:f&&f.length>0?f.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:x+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_department||"N/A"}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>y(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>v(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsxs)("div",{className:"text-center mt-6 py-20",children:[" ",(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})]}),s&&(0,i.jsx)(sa,{candidate:o,onClose:y}),a&&(0,i.jsx)(za,{candidate:o,onClose:v})]}),f.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:m,totalPages:h,onPageChange:e=>{e>0&&e<=h&&u(e)}})})})]})},Ga=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,y=x*u,N=t.slice(v,y),b=e=>{m(e),o(!l)},D=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[N&&N.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Issue Date","Accept Date","LOI PDF","Decline Date","Decline Reason","Status","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:N&&N.length>0?N.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:a(e.mobilizationDetails_loiIssueDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:a(e.mobilizationDetails_loiAcceptDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.mobilizationDetails_loiFile?(0,i.jsx)("a",{href:s,onClick:t=>{e.mobilizationDetails_loiFile?r(e.mobilizationDetails_loiFile):t.preventDefault()},download:!0,className:e.mobilizationDetails_loiFile?"border-b-2 border-[orange] text-[orange]":"",children:e.mobilizationDetails_loiFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3",children:e.mobilizationDetails_loiDeclineDate||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.mobilizationDetails_declineReason||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_status||"N/A"}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>D(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>b(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{className:"text-center py-4 text-dark_grey",children:"No Data Available"})})]}):(0,i.jsxs)("div",{className:"text-center mt-6 py-20",children:[" ",(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})]}),d&&(0,i.jsx)(sa,{candidate:p,onClose:D}),l&&(0,i.jsx)(za,{candidate:p,onClose:b})]}),N.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},Ja=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,y=x*u,N=t.slice(v,y),b=e=>{m(e),o(!l)},D=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[N&&N.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Approved Date","CVEV PDF","Status","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:N&&N.length>0?N.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:a(e.mobilizationDetails_cvecApproveDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.mobilizationDetails_cvecFile?(0,i.jsx)("a",{href:s,onClick:t=>{e.mobilizationDetails_cvecFile?r(e.mobilizationDetails_cvecFile):t.preventDefault()},download:!0,className:e.mobilizationDetails_cvecFile?"border-b-2 border-[orange] text-[orange]":"",children:e.mobilizationDetails_cvecFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_status||"N/A"}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>D(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>b(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsxs)("div",{className:"text-center mt-6 py-20",children:[" ",(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})]}),d&&(0,i.jsx)(sa,{candidate:p,onClose:D}),l&&(0,i.jsx)(za,{candidate:p,onClose:b})]}),N.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},Ka=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,y=x*u,N=t.slice(v,y),b=e=>{m(e),o(!l)},D=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[N&&N.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Approved Date","PAAF PDF","Status","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:N&&N.length>0?N.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:a(e.mobilizationDetails_paafApproveDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.mobilizationDetails_paafFile?(0,i.jsx)("a",{href:s,onClick:t=>{e.mobilizationDetails_paafFile?r(e.mobilizationDetails_paafFile):t.preventDefault()},download:!0,className:e.mobilizationDetails_paafFile?"border-b-2 border-[orange] text-[orange]":"",children:e.mobilizationDetails_paafFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3",children:e.interviewDetails_status||"N/A"}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>D(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>b(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsxs)("div",{className:"text-center mt-6 py-20",children:[" ",(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})]}),d&&(0,i.jsx)(sa,{candidate:p,onClose:D}),l&&(0,i.jsx)(za,{candidate:p,onClose:b})]}),N.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},Qa=async e=>{let{storedData:t}=e;const a=(0,Ee.D)();if(!t)throw new Error("Missing required parameters");const r=(new Date).toISOString().split("T")[0],n=e=>{return e?"string"===typeof e&&(e=>{try{var t;const a=JSON.parse(e);return Array.isArray(a)&&(null===(t=a[0])||void 0===t?void 0:t.upload)}catch(a){return!1}})(e)?[e]:[JSON.stringify((t=e,t?[{upload:t,date:r}]:null))]:[];var t},s={empID:t.empID,age:t.age||null,aTQualify:t.aTQualify||"",alternateNo:t.alternateNo||"",agent:t.agentname?[t.agentname]:t.agent?[t.agent]:[],bankName:t.bankName||"",bankAccNo:t.bankAccNo||"",contactNo:t.contactNo?[t.contactNo]:[],cob:t.cob||"",contractType:t.contractType?[t.contractType]:[],ctryOfOrigin:t.ctryOfOrigin||"",chinese:t.chinese||"",dob:t.dob||"",educLevel:t.educLevel||"",email:t.email||"",eduDetails:t.eduDetails?t.eduDetails:[],empBadgeNo:t.empBadgeNo||"",empType:t.empType?[t.empType]:[],familyDetails:t.familyDetails?t.familyDetails:[],gender:t.gender||"",lang:t.lang||"",marital:t.marital||"",name:t.name,officialEmail:t.officialEmail||"",oCOfOrigin:t.oCOfOrigin||"",profilePhoto:t.profilePhoto||"",permanentAddress:t.permanentAddress?[t.permanentAddress]:[],position:t.position?[t.position]:[],sapNo:t.sapNo||"",otherLang:t.otherLang||""},i={empID:t.empID,bwnIcColour:t.bwnIcColour||"",bwnIcExpiry:t.bwnIcExpiry?[t.bwnIcExpiry]:[],bwnIcNo:t.bwnIcNo||"",driveLic:t.driveLic||"",nationality:t.nationality||"",otherNation:t.otherNation||"",otherRace:t.otherRace||"",otherReligion:t.otherReligion||"",ppDestinate:t.ppDestinate?[t.ppDestinate]:[],ppExpiry:t.ppExpiry?[t.ppExpiry]:[],ppIssued:t.ppIssued?[t.ppIssued]:[],ppNo:t.ppNo?[t.ppNo]:[],race:t.race||"",religion:t.religion||"",cvCertifyUpload:n(t.uploadResume),qcCertifyUpload:n(t.uploadCertificate),ppUpload:n(t.uploadPp),bwnUpload:n(t.uploadIc),loiUpload:t.loiFile?n(t.loiFile):n(t.mobilizationDetails_loiFile),paafCvevUpload:t.cvecFile?n(t.cvecFile):t.paafFile?n(t.paafFile):t.mobilizationDetails_cvecFile?n(t.mobilizationDetails_cvecFile):n(t.mobilizationDetails_paafFile)},l={empID:t.empID,crime:t.crime||"",crimeDesc:t.crimeDesc||"",emgDetails:t.emgDetails?t.emgDetails:[],empStatement:t.empStatement||"",noExperience:t.noExperience||"",desc:t.desc||"",disease:t.disease||"",diseaseDesc:t.diseaseDesc||"",liquor:t.liquor||"",liquorDesc:t.liquorDesc||"",perID:t.perIDesc||"",perIS:t.perIS||"",referees:t.referees?t.referees:[],relatives:t.relatives?t.relatives:[],salaryExpectation:t.salaryExpectation||"",supportInfo:t.supportInfo||"",workExperience:t.workExperience?t.workExperience:[],mobFile:t.mobilizationDetails_mobFile||"",mobSignDate:t.mobilizationDetails_mobSignDate||"",paafApproveDate:t.mobilizationDetails_paafApproveDate||"",paafFile:t.mobilizationDetails_paafFile||"",cvecApproveDate:t.mobilizationDetails_cvecApproveDate||"",cvecFile:t.mobilizationDetails_cvecFile||"",declineReason:t.mobilizationDetails_declineReason||"",loiAcceptDate:t.mobilizationDetails_loiAcceptDate||"",loiDeclineDate:t.mobilizationDetails_loiDeclineDate||"",loiFile:t.loiFile?n(t.loiFile):t.mobilizationDetails_loiFile?n(t.mobilizationDetails_loiFile):[],loiIssueDate:t.mobilizationDetails_loiIssueDate||"",uploadCertificate:t.uploadCertificate?n(t.uploadCertificate):[],pcNoticePeriod:t.noticePeriod||"",venue:t.interviewDetails_venue||"",message:t.interviewDetails_message||"",managerBadgeNo:t.interviewDetails_bagdeNo||"",interDate:t.interviewDetails_interDate||"",interTime:t.interviewDetails_interTime||"",interType:t.interviewDetails_interType||""},o={empID:t.empID,department:t.interviewDetails_department?[t.interviewDetails_department]:[],otherDepartment:t.interviewDetails_otherDepartment?[t.interviewDetails_otherDepartment]:[],position:t.position?[t.position]:[]},d={empID:t.empID,sawpEmpLtrReq:t.WPTrackDetails_sawpDate?[t.WPTrackDetails_sawpDate]:[],sawpEmpLtrReci:t.WPTrackDetails_sawpRecivedDate?[t.WPTrackDetails_sawpRecivedDate]:[],sawpEmpUpload:t.WPTrackDetails_sawpFile?n(t.WPTrackDetails_sawpFile):[]},c={empID:t.empID,doeEmpSubmit:t.WPTrackDetails_doesubmitdate?[t.WPTrackDetails_doesubmitdate]:[],doeEmpApproval:t.WPTrackDetails_doeapprovedate?[t.WPTrackDetails_doeapprovedate]:[],doeEmpValid:t.WPTrackDetails_doeexpirydate?[t.WPTrackDetails_doeexpirydate]:[],doeEmpRefNo:t.WPTrackDetails_doerefno?[t.WPTrackDetails_doerefno]:[],doeEmpUpload:t.WPTrackDetails_doefile?n(t.WPTrackDetails_doefile):[],nlmsEmpSubmit:t.WPTrackDetails_nlmssubmitdate?[t.WPTrackDetails_nlmssubmitdate]:[],nlmsEmpSubmitRefNo:t.WPTrackDetails_submissionrefrenceno?[t.WPTrackDetails_submissionrefrenceno]:[],nlmsEmpApproval:t.WPTrackDetails_nlmsapprovedate?[t.WPTrackDetails_nlmsapprovedate]:[],nlmsRefNo:t.WPTrackDetails_ldreferenceno?[t.WPTrackDetails_ldreferenceno]:[],nlmsEmpValid:t.WPTrackDetails_nlmsexpirydate?[t.WPTrackDetails_nlmsexpirydate]:[],nlmsEmpUpload:t.WPTrackDetails_nlmsfile?n(t.WPTrackDetails_nlmsfile):[],permitType:[]},p={empID:t.empID,bankSubmit:t.WPTrackDetails_bgsubmitdate?[t.WPTrackDetails_bgsubmitdate]:[],bankRece:t.WPTrackDetails_bgreceivedate?[t.WPTrackDetails_bgreceivedate]:[],bankRefNo:t.WPTrackDetails_referenceno?[t.WPTrackDetails_referenceno]:[],bankAmt:t.WPTrackDetails_bgamount?[t.WPTrackDetails_bgamount]:[],bankValid:t.WPTrackDetails_bgexpirydate?[t.WPTrackDetails_bgexpirydate]:[],bankEndorse:t.WPTrackDetails_bgendorsedate?[t.WPTrackDetails_bgendorsedate]:[],bankEmpUpload:t.WPTrackDetails_bgfile?n(t.WPTrackDetails_bgfile):[],tbaPurchase:t.WPTrackDetails_tbapurchasedate?[t.WPTrackDetails_tbapurchasedate]:[],jitpaAmt:t.WPTrackDetails_jitpaamount?[t.WPTrackDetails_jitpaamount]:[],jpValid:t.WPTrackDetails_jitpaexpirydate?[t.WPTrackDetails_jitpaexpirydate]:[],jpEndorse:t.WPTrackDetails_submitdateendorsement?[t.WPTrackDetails_submitdateendorsement]:[],jpEmpUpload:t.WPTrackDetails_jitpafile?n(t.WPTrackDetails_jitpafile):[],lbrReceiptNo:t.WPTrackDetails_lbrDepoNum?[t.WPTrackDetails_lbrDepoNum]:[],lbrDepoAmt:t.WPTrackDetails_lbrDepoAmount?[t.WPTrackDetails_lbrDepoAmount]:[],lbrDepoSubmit:t.WPTrackDetails_lbrEndroseDate?[t.WPTrackDetails_lbrEndroseDate]:[],lbrDepoUpload:t.WPTrackDetails_lbrFile?n(t.WPTrackDetails_lbrFile):[]},m={empID:t.empID,immigEmpUpload:t.WPTrackDetails_visaFile?n(t.WPTrackDetails_visaFile):[],immigRefNo:t.WPTrackDetails_immbdno||"",ppSubmit:t.WPTrackDetails_docsubmitdate?[t.WPTrackDetails_docsubmitdate]:[],immigApproval:t.WPTrackDetails_visaapprovedate?[t.WPTrackDetails_visaapprovedate]:[]};return a.graphql({query:ke.p4,variables:{input:s}}).then((e=>(console.log("createEmpPersonalInfo response:",e),a.graphql({query:ke.ky,variables:{input:i}})))).then((e=>(console.log("createIDDetails response:",e),a.graphql({query:ke.v0,variables:{input:l}})))).then((e=>(console.log("createCandIToEMP response:",e),a.graphql({query:ke.Gk,variables:{input:o}})))).then((e=>(console.log("createEmpWorkInfo response:",e),a.graphql({query:ke.MT,variables:{input:d}})))).then((e=>(console.log("createSawpDetails response:",e),a.graphql({query:ke.vW,variables:{input:c}})))).then((e=>(console.log("createDNDetails response:",e),a.graphql({query:ke.Pu,variables:{input:p}})))).then((e=>(console.log("createBJLDetails response:",e),a.graphql({query:ke.zY,variables:{input:m}})))).then((e=>(console.log("createPassportValid response:",e),{success:!0,message:"All operations completed successfully"}))).catch((e=>(console.error("CandiToEmp Error:",e),{success:!1,message:"An error occurred during submission",error:e.message})))},$a=()=>{const e=(0,Ee.D)();return{submitMobilization:(0,n.useCallback)((async t=>{let{mob:a}=t;if(!a)throw new Error("Missing required parameters");try{const t={id:a.interviewDetails_id,empID:a.empID,status:"Employee"};console.log(t);await e.graphql({query:ke.sK,variables:{input:t}})}catch(r){throw console.error("Error executing GraphQL requests:",r),r}}),[])}},Za=(0,Ee.D)(),Xa=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const{submitMobilization:l}=$a(),[o,d]=(0,n.useState)(!1),[c,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)(""),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(10),[b,D]=(0,n.useState)(1),[j,A]=(0,n.useState)({}),[w,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)(!1),[k,T]=(0,n.useState)(null),C=Math.ceil(t.length/y),R=(b-1)*y,P=b*y,O=t.slice(R,P),_=e=>{u(e),d(!o)},M=e=>{u(e),p(!c)};return(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,i.jsx)("div",{className:"p-6 text-center",children:(0,i.jsx)("p",{className:"text-darkText text-lg",children:f})}),(0,i.jsx)("div",{className:"px-6 py-3 bg-lightBg border-t border-borderGray flex justify-center",children:(0,i.jsx)("button",{className:"bg-primary px-6 py-2 rounded-lg font-semibold uppercase hover:bg-yellow transition",children:(0,i.jsx)("a",{href:"/recrutiles/status",children:"Okay"})})})]})}),(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[w&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,i.jsxs)("div",{className:"px-6 py-4 flex justify-between items-center bg-[#939393] uppercase",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Employee Conversion"}),(0,i.jsx)("button",{onClick:()=>S(!1),className:"text-white hover:text-borderGray transition-colors",children:(0,i.jsx)(ia.Qks,{size:24})})]}),(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"mb-6 space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-full font-medium text-labelText uppercase",children:"Candidate Name:"}),(0,i.jsx)("span",{className:"text-darkText",children:null===k||void 0===k?void 0:k.name})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-full font-medium text-labelText uppercase",children:"Temp ID:"}),(0,i.jsx)("span",{className:"font-mono text-darkText",children:null===k||void 0===k?void 0:k.tempID})]})]}),(0,i.jsxs)("div",{className:"mb-6 p-4 rounded-lg border border-borderGray bg-lightBg uppercase",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-mutedText mb-1",children:"Employee ID"}),h?(0,i.jsx)("p",{className:"text-xl font-bold font-mono text-mutedText",children:h}):(0,i.jsx)("p",{className:"text-placeholderText italic",children:"Not generated yet"})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[!h&&(0,i.jsxs)("button",{onClick:async()=>{I(!0);try{const e=(e=>{const t=e.match(/[^\d]+/),a=t?t[0]:"",r=e.match(/\d+/),n=(r?parseInt(r[0],10):0)+1;return"".concat(a).concat(n)})(await(async()=>{try{let n=[],s=null;do{var e,t,a,r;const i=await Za.graphql({query:Ie.it,variables:{nextToken:s}}),l=((null===i||void 0===i||null===(e=i.data)||void 0===e||null===(t=e.listEmpPersonalInfos)||void 0===t?void 0:t.items)||[]).map((e=>e.empID));n=[...n,...l],s=null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.listEmpPersonalInfos)||void 0===r?void 0:r.nextToken}while(s);const i=n.sort(((e,t)=>{const a=e.match(/\d+/)?parseInt(e.match(/\d+/)[0],10):0,r=t.match(/\d+/)?parseInt(t.match(/\d+/)[0],10):0,n=e.replace(/\d+/g,"")||"",s=t.replace(/\d+/g,"")||"";return n===s?a-r:n.localeCompare(s)}));return i[i.length-1]}catch(n){return console.error("Error fetching total count:",n),0}})());x(e)}catch(e){console.error("Error generating employee ID:",e),alert("Error generating employee ID")}finally{I(!1)}},disabled:E,className:"flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center uppercase ".concat(E?"bg-disabledBg text-mutedText cursor-not-allowed":"bg-primary hover:hover:bg-yellow"),children:[E&&(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-white mr-2"}),E?"Generating...":"Generate EmpID"]}),h&&(0,i.jsxs)("button",{onClick:async()=>{if(k){A((e=>(0,g.A)((0,g.A)({},e),{},{[k.id]:!0})));try{const e=(0,g.A)((0,g.A)({},k),{},{empID:h});if(!e.empID)return void alert("Error: Missing employee ID.");if(e.empID&&e.interviewDetails_id){await l({mob:e});const{success:t,message:a}=await Qa({storedData:e});console.log("Mobilizatioon : ",t,a),t?(v("Candidate conversion to employee has been completed successfully."),S(!1)):(S(!1),v("Candidate conversion to employee has been failed."))}}catch(e){A((e=>(0,g.A)((0,g.A)({},e),{},{[k.id]:!1}))),S(!1),console.error("Error during conversion:",e),v("Candidate conversion to employee has been failed.")}finally{A((e=>(0,g.A)((0,g.A)({},e),{},{[k.id]:!1}))),S(!1)}}else alert("Error: No candidate selected.")},disabled:!h||j[null===k||void 0===k?void 0:k.id],className:"flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center uppercase ".concat(!h||j[null===k||void 0===k?void 0:k.id]?"bg-disabledBg text-mutedText cursor-not-allowed":"bg-primary hover:hover:bg-yellow"),children:[j[null===k||void 0===k?void 0:k.id]&&(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-white mr-2"}),j[null===k||void 0===k?void 0:k.id]?"Converting...":"Convert to employee"]})]})]}),(0,i.jsx)("div",{className:"px-6 py-3 bg-lightBg border-t border-borderGray",children:(0,i.jsx)("p",{className:"text-xs text-mutedText text-center",children:"Generate an Employee ID before conversion"})})]})}),O&&O.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Signed Date","Mobilization PDF","Form","Edit Form","Status"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:O&&O.length>0?O.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:R+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:a(e.mobilizationDetails_mobSignDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.mobilizationDetails_mobFile?(0,i.jsx)("a",{href:s,onClick:t=>{e.mobilizationDetails_mobFile?r(e.mobilizationDetails_mobFile):t.preventDefault()},download:!0,className:e.mobilizationDetails_mobFile?"border-b-2 border-[orange] text-[orange]":"",children:e.mobilizationDetails_mobFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>M(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>_(e),children:(0,i.jsx)(ia.GQd,{})}),(0,i.jsx)("td",{className:"text-sm cursor-pointer py-3",onClick:()=>(T(e),S(!0),void x("")),disabled:j[e.id],children:j[e.id]?"Loading...":"Convert Employee"})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsxs)("div",{className:"text-center mt-6 py-20",children:[" ",(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})]}),c&&(0,i.jsx)(sa,{candidate:m,onClose:M}),o&&(0,i.jsx)(za,{candidate:m,onClose:_})]}),O.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:b,totalPages:C,onPageChange:e=>{e>0&&e<=C&&D(e)}})})})]})},er=(0,Ee.D)(),tr=["Interview Scheduled","Selected Candidate","LOI","CVEV_OffShore","PAAF_OnShore","Mobilization"],ar=()=>{const[e,t]=(0,n.useState)(!0),[a,r]=(0,n.useState)(null),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),[x,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)([]),[b,D]=(0,n.useState)("Interview Scheduled"),[A,w]=(0,n.useState)("Interview Scheduled"),S=(0,n.useRef)(null),[E,I]=(0,n.useState)([]),[k,T]=(0,n.useState)(""),[C,R]=(0,n.useState)(),[P,O]=(0,n.useState)(""),{empPDData:_,educDetailsData:M,IVSSDetails:F}=(0,n.useContext)(s.Y),L=e=>{const t=(0,g.A)({},e);return t.interviewDetails&&(Object.entries(t.interviewDetails).forEach((e=>{let[a,r]=e;t["interviewDetails_".concat(a)]=r})),delete t.interviewDetails),t.mobilizationDetails&&(Object.entries(t.mobilizationDetails).forEach((e=>{let[a,r]=e;t["mobilizationDetails_".concat(a)]=r})),delete t.mobilizationDetails),t};(0,n.useEffect)((()=>{(async()=>{try{const e=async()=>{let e=[],t=null;do{var a,r,n,s;const i=await er.graphql({query:Ie.c2,variables:{nextToken:t}}),l=(null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.listInterviewSchedules)||void 0===r?void 0:r.items)||[];e=[...e,...l],t=null===i||void 0===i||null===(n=i.data)||void 0===n||null===(s=n.listInterviewSchedules)||void 0===s?void 0:s.nextToken}while(t);return e},a=async()=>{let e=[],t=null;do{var a,r,n,s;const i=await er.graphql({query:Ie.g,variables:{nextToken:t}}),l=(null===i||void 0===i||null===(a=i.data)||void 0===a||null===(r=a.listLocalMobilizations)||void 0===r?void 0:r.items)||[];e=[...e,...l],t=null===i||void 0===i||null===(n=i.data)||void 0===n||null===(s=n.listLocalMobilizations)||void 0===s?void 0:s.nextToken}while(t);return e},[r,n]=await Promise.all([e(),a()]),s=r||[],i=n||[];if(_&&M&&F){const e=((e,t)=>e.map((e=>{const a=t.find((t=>t.tempID===e.tempID))||{};return(0,g.A)((0,g.A)({},e),a)})))(_.filter((e=>F.some((t=>t.tempID===e.tempID)))),M),a=s.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),r=i.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),n=e.map((e=>{const t=a[e.tempID]||{},n=r[e.tempID]||{};return(0,g.A)((0,g.A)({},e),{},{interviewDetails:t,mobilizationDetails:n})})),l=n.map(L);I(l);const o=l.filter((e=>{var t;return"interviewscheduled"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toLowerCase())}));N(o),R(o),t(!1)}}catch(e){r(e.message),t(!1)}})()}),[_,M,F]),(0,n.useEffect)((()=>{const e=e=>{!e.target.closest(".cvTypeDropdown")&&l&&o(!1),S.current&&!S.current.contains(e.target)&&x&&v(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[l,x]);const U=e=>{const t=e.target.value;D(t),w(t)};(0,n.useEffect)((()=>{if(!E)return void N([]);let e=[...E];e=(e=>{if(!P)return e;const t=P.toLowerCase();return e.filter((e=>e.tempID&&e.tempID.toLowerCase().includes(t)||e.firstName&&e.firstName.toLowerCase().includes(t)||e.lastName&&e.lastName.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)||e.phoneNumber&&e.phoneNumber.includes(t)))})(e),b&&(e=e.filter((e=>{var t,a,r,n,s,i;switch(b){case"Interview Scheduled":return"interviewscheduled"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toLowerCase());case"Selected Candidate":return"Selected"===(null===e||void 0===e?void 0:e.interviewDetails_status);case"LOI":return"LOI"===(null===e||void 0===e||null===(a=e.interviewDetails_status)||void 0===a?void 0:a.toUpperCase());case"CVEV_OffShore":return"CVEV"===(null===e||void 0===e||null===(r=e.interviewDetails_status)||void 0===r?void 0:r.toUpperCase())&&"Offshore"===(null===e||void 0===e?void 0:e.empType);case"PAAF_OnShore":return"PAAF"===(null===e||void 0===e||null===(n=e.interviewDetails_status)||void 0===n?void 0:n.toUpperCase());case"Mobilization":return"Local"===(null===e||void 0===e?void 0:e.contractType)&&"mobilization"===(null===e||void 0===e||null===(s=e.interviewDetails_status)||void 0===s?void 0:s.toLowerCase());default:return"pending"===(null===e||void 0===e||null===(i=e.interviewDetails_status)||void 0===i?void 0:i.toLowerCase())}}))),d.length>0&&(e=e.filter((e=>d.every((t=>{switch(t){case"LOCAL":return"Local"===e.contractType;case"NON LOCAL":return"Non Local"===e.contractType;case"ONSHORE":return"Onshore"===e.empType;case"OFFSHORE":return"Offshore"===e.empType;case"LPA":return"LPA"===e.contractType;case"SAWP":return"SAWP"===e.contractType;default:return!0}}))))),N(e)}),[b,d,E,P]);const B=e=>!(!d.includes("LOCAL")||"NON LOCAL"!==e&&"LPA"!==e&&"SAWP"!==e)||!(!d.includes("NON LOCAL")||"LOCAL"!==e),q=e=>{if(!e||isNaN(new Date(e).getTime()))return"";const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},H=async e=>{try{if("string"===typeof e){let t=e.replace(/=/g,":").replace(/([{,])(\s*[a-zA-Z0-9_]+)(?=\s*:)/g,'$1"$2"').replace(/:\s*([^",}\]]+)/g,': "$1"').replace(/"\s*[^"]+"\s*$/g,(e=>e.trim())).replace(/(\w)(,|})/g,"$1$2");const a=JSON.parse(t),r=a[a.length-1].upload,n=await(0,f.I)({path:r});return T(n.url.toString())}return console.error("Input must be a string."),null}catch(a){return console.error("Error parsing files:",a.message),null}};return(0,i.jsxs)("section",{className:"screen-size min-h-screen mb-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start flex-wrap gap-4 py-4",children:[(0,i.jsxs)("div",{className:"flex gap-4 items-start",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("button",{className:"font-semibold py-2 px-6 rounded-lg flex items-center ".concat(d.length>0?"bg-[#faf362]":"bg-[#8d8f9036]"),onClick:()=>o(!l),children:[d.length>0?d.join(" + "):"CV TYPE",l?(0,i.jsx)(Tt.Ucs,{className:"ml-2"}):(0,i.jsx)(Tt.Vr3,{className:"ml-2"})]}),l&&(0,i.jsx)("div",{className:"absolute bg-white border shadow-lg rounded-lg z-20 mt-2",children:["LOCAL","NON LOCAL","LPA","SAWP","ONSHORE","OFFSHORE"].map((e=>(0,i.jsxs)("label",{className:"block w-full text-left px-4 py-2",children:[(0,i.jsx)("input",{type:"checkbox",className:"mr-2",checked:d.includes(e),onChange:()=>(e=>{c((t=>t.includes(e)?t.filter((t=>t!==e)):"LOCAL"===e?["LOCAL",...t.filter((e=>"NON LOCAL"!==e&&"LPA"!==e&&"SAWP"!==e))]:"NON LOCAL"===e?["NON LOCAL",...t.filter((e=>"LOCAL"!==e))]:"ONSHORE"===e||"OFFSHORE"===e?[e,...t.filter((e=>"ONSHORE"!==e&&"OFFSHORE"!==e))]:"LPA"===e||"SAWP"===e?[e,...t.filter((e=>"LPA"!==e&&"SAWP"!==e))]:[...t,e]))})(e),disabled:B(e)}),e]},e)))})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("button",{onClick:e=>{null===e||void 0===e||e.stopPropagation(),v((e=>!e))},className:"px-6 py-2 font-semibold rounded-lg flex items-center ".concat(b.length?"bg-[#faf362]":"bg-[#8d8f9036]"),children:[(0,i.jsx)(Sa.y_E,{className:"mr-2"}),(0,i.jsx)("span",{children:A})]}),x&&(0,i.jsx)("div",{ref:S,className:"absolute z-50 bg-white shadow-lg rounded-lg p-4 mt-2 w-48",children:tr.map((e=>(0,i.jsxs)("label",{className:"flex items-center font-semibold space-x-2 hover:font-bold hover:text-[#c7bd03] p-2 rounded-md ".concat(b===e?"text-[#faf362]":"text-lite_grey"),children:[(0,i.jsx)("input",{type:"radio",className:"w-5 h-6",name:"status",value:e,checked:b===e,onChange:U}),(0,i.jsx)("span",{children:e})]},e)))})]})]}),(0,i.jsx)("div",{className:"flex-1 flex justify-end",children:(0,i.jsx)("div",{className:"relative w-full max-w-sm",children:(0,i.jsxs)("div",{className:"py-[9px] w-full text_size_5 bg-white border text-grey border-lite_grey rounded-lg flex items-center px-3 gap-2",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search",className:"outline-none w-full text-sm",value:P,onChange:e=>O(e.target.value)}),(0,i.jsx)("div",{className:"text-dark_grey text-2xl cursor-pointer",children:(0,i.jsx)(j.zfp,{})})]})})})]}),e?(0,i.jsx)("p",{children:"Loading..."}):a?(0,i.jsx)("p",{children:a}):(0,i.jsxs)(i.Fragment,{children:[(()=>{switch(b){case"Interview Scheduled":return(0,i.jsx)(Ya,{data:y,formatDate:q,fileUpload:H,urlValue:k});case"Selected Candidate":return(0,i.jsx)(Va,{data:y,formatDate:q,fileUpload:H,urlValue:k});case"LOI":return(0,i.jsx)(Ga,{data:y,formatDate:q,fileUpload:H,urlValue:k});case"CVEV_OffShore":return(0,i.jsx)(Ja,{data:y,formatDate:q,fileUpload:H,urlValue:k});case"PAAF_OnShore":return(0,i.jsx)(Ka,{data:y,formatDate:q,fileUpload:H,urlValue:k});case"Mobilization":return(0,i.jsx)(Xa,{data:y,formatDate:q,fileUpload:H,urlValue:k});default:return(0,i.jsx)(Ya,{data:y,formatDate:q,fileUpload:H})}})(),p&&(0,i.jsx)(za,{candidate:u,onSave:e=>{const t=t=>t.map((t=>t.tempID===e.tempID?(0,g.A)((0,g.A)({},t),e):t));I((e=>t(e))),N((e=>t(e))),m(!1)},onClose:()=>{m(!1),h(null)}})]})]})},rr=()=>{const e=(0,Ee.D)();return{createWPTrackingHandler:(0,n.useCallback)((async t=>{let{reqValue:a}=t;if(!a)throw new Error("Missing required parameters");const{tempID:r,sawpDate:n,sawpRecivedDate:s,sawpFile:i,doerefno:l,supportletterReqDate:o,lbrDepoNum:d,lbrEndroseDate:c,lbrDepoAmount:p,lbrFile:m,supportletterReceiveDate:u,letterfile:h,doesubmitdate:x,doeapprovedate:g,doeexpirydate:f,doefile:v,nlmssubmitdate:y,submissionrefrenceno:N,nlmsapprovedate:b,ldreferenceno:D,nlmsexpirydate:j,nlmsfile:A,bgsubmitdate:w,bgreceivedate:S,referenceno:E,bgamount:I,bgexpirydate:k,bgfile:T,tbapurchasedate:C,jitpaamount:R,jitpaexpirydate:P,receiptno:O,depositamount:_,submitdateendorsement:M,jitpafile:F,immbdno:L,docsubmitdate:U,visaapprovedate:B,visareferenceno:q,visaFile:H,departuredate:W,arrivaldate:z,cityname:Y,airfare:V,airticketfile:G,agentname:J,mobSignDate:K,mobFile:Q,remarkNLMob:$}=a,Z={tempID:r,sawpDate:n,sawpRecivedDate:s,sawpFile:i,doerefno:l,supportletterReqDate:o,lbrDepoNum:d,lbrEndroseDate:c,lbrDepoAmount:p,lbrFile:m,supportletterReceiveDate:u,letterfile:h,doesubmitdate:x,doeapprovedate:g,doeexpirydate:f,doefile:v,nlmssubmitdate:y,submissionrefrenceno:N,nlmsapprovedate:b,ldreferenceno:D,nlmsexpirydate:j,nlmsfile:A,bgsubmitdate:w,bgreceivedate:S,referenceno:E,bgamount:I,bgexpirydate:k,bgfile:T,tbapurchasedate:C,jitpaamount:R,jitpaexpirydate:P,receiptno:O,depositamount:_,submitdateendorsement:M,jitpafile:F,immbdno:L,docsubmitdate:U,visaapprovedate:B,visareferenceno:q,visaFile:H,departuredate:W,arrivaldate:z,cityname:Y,airfare:V,airticketfile:G,agentname:J,mobSignDate:K,mobFile:Q,remarkNLMob:$};try{const t=await Promise.all([e.graphql({query:ke.Tm,variables:{input:Z}})]);console.log("Response",t)}catch(X){throw console.error("Error executing GraphQL requests:",X),X}}),[])}},nr=(0,Ee.D)(),sr=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[s,i]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(async()=>{r(!0);let e=[],a=[],n=null,s=null;try{do{var l,o,d,c;const t=await nr.graphql({query:Ie.op,variables:{nextToken:n}}),a=(null===t||void 0===t||null===(l=t.data)||void 0===l||null===(o=l.listWPTrackings)||void 0===o?void 0:o.items)||[];e=[...e,...a],n=null===t||void 0===t||null===(d=t.data)||void 0===d||null===(c=d.listWPTrackings)||void 0===c?void 0:c.nextToken}while(n);do{var p,m,u,h;const e=await nr.graphql({query:Ie.c2,variables:{nextToken:s}}),t=(null===e||void 0===e||null===(p=e.data)||void 0===p||null===(m=p.listInterviewSchedules)||void 0===m?void 0:m.items)||[];a=[...a,...t],s=null===e||void 0===e||null===(u=e.data)||void 0===u||null===(h=u.listInterviewSchedules)||void 0===h?void 0:h.nextToken}while(s);e.reduce(((e,t)=>(e[t.tempID]=t,e)),{});const r=a.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),i=e.map((e=>(0,g.A)((0,g.A)({},e),{},{IDDetails:r[e.tempID]||{}})));t(i)}catch(x){i(x),console.error("Error fetching data:",x)}finally{r(!1)}})()}),[]),{interviewSchedules:e,loading:a,error:s}},ir=()=>{const e=(0,Ee.D)();return{wpTrackingDetails:(0,n.useCallback)((async t=>{let{WPTrackingValue:a}=t;if(!a)throw new Error("Missing required parameters or WPTrackingValue");try{const{id:t,tempID:r,sawpDate:n,sawpRecivedDate:s,sawpFile:i,remarkNLMob:l,supportletterReqDate:o,supportletterReceiveDate:d,letterfile:c,doesubmitdate:p,doerefno:m,doeapprovedate:u,doeexpirydate:h,doefile:x,nlmssubmitdate:g,submissionrefrenceno:f,nlmsapprovedate:v,ldreferenceno:y,nlmsexpirydate:N,nlmsfile:b,bgsubmitdate:D,bgreceivedate:j,referenceno:A,bgamount:w,bgexpirydate:S,bgfile:E,tbapurchasedate:I,jitpaamount:k,jitpaexpirydate:T,receiptno:C,depositamount:R,submitdateendorsement:P,jitpafile:O,immbdno:_,docsubmitdate:M,visaapprovedate:F,visareferenceno:L,visaFile:U,departuredate:B,arrivaldate:q,cityname:H,airfare:W,airticketfile:z,agentname:Y,mobSignDate:V,mobFile:G,lbrDepoNum:J,lbrEndroseDate:K,lbrDepoAmount:Q,lbrFile:$}=a,Z={id:t,tempID:r,sawpDate:n,sawpRecivedDate:s,sawpFile:i,remarkNLMob:l,supportletterReqDate:o,supportletterReceiveDate:d,letterfile:c,doerefno:m,doesubmitdate:p,doeapprovedate:u,doeexpirydate:h,doefile:x,nlmssubmitdate:g,submissionrefrenceno:f,nlmsapprovedate:v,ldreferenceno:y,nlmsexpirydate:N,nlmsfile:b,bgsubmitdate:D,bgreceivedate:j,referenceno:A,bgamount:w,bgexpirydate:S,bgfile:E,tbapurchasedate:I,jitpaamount:k,jitpaexpirydate:T,receiptno:C,depositamount:R,submitdateendorsement:P,jitpafile:O,immbdno:_,docsubmitdate:M,visaapprovedate:F,visareferenceno:L,visaFile:U,departuredate:B,arrivaldate:q,cityname:H,airfare:W,airticketfile:z,agentname:Y,mobSignDate:V,mobFile:G,lbrDepoNum:J,lbrEndroseDate:K,lbrDepoAmount:Q,lbrFile:$};await e.graphql({query:ke.u9,variables:{input:Z}})}catch(r){console.error("Error updating WPTracking data:",r)}}),[])}},lr=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{wpTrackingDetails:o}=ir(),{interviewDetails:d}=ta(),{createWPTrackingHandler:c}=rr(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",tempID:"",sawpDate:"",sawpRecivedDate:"",sawpFile:"",status:""}}),[N,b]=(0,n.useState)({sawpFile:!1}),[D,j]=(0,n.useState)({sawpFile:null}),[A,w]=(0,n.useState)({sawpFile:null}),{register:S,watch:E,formState:{errors:I},setValue:k}=(0,tt.mN)({resolver:(0,at.t)(rt.Fh)}),T=localStorage.getItem("userID"),C=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{sawpDate:e.sawpDate,sawpRecivedDate:e.sawpRecivedDate,sawpFile:e.sawpFile,status:e.IDDetails.status}}),e.sawpFile){const t=R(e.sawpFile);j((e=>(0,g.A)((0,g.A)({},e),{},{sawpFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const R=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},P=()=>{m(!p)},O=(new Date).toISOString().split("T")[0],_=e=>e?[{upload:e,date:O}]:null,M=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===t.tempID)),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===n||void 0===n?void 0:n.id,i=r,p=n,m=[...null!==i&&void 0!==i&&i.updatedBy?JSON.parse(null===i||void 0===i?void 0:i.updatedBy):[],{userID:T,date:C}].map((e=>({userID:e.userID,date:e.date}))),u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:T,date:C}].map((e=>({userID:e.userID,date:e.date}))),h={reqValue:(0,g.A)((0,g.A)({},v.interview),{},{sawpFile:N.sawpFile?JSON.stringify(_(A.sawpFile)):v.interview.sawpFile,tempID:t.tempID,sawpDate:v.interview.sawpDate,sawpRecivedDate:v.interview.sawpRecivedDate,tempID:t.tempID,createdBy:JSON.stringify([{userID:T,date:C}])})};try{r?await o({WPTrackingValue:{id:r.id,sawpDate:v.interview.sawpDate,sawpRecivedDate:v.interview.sawpRecivedDate,sawpFile:N.sawpFile?JSON.stringify(_(A.sawpFile)):v.interview.sawpFile,tempID:t.tempID,updatedBy:JSON.stringify(m)}}):await c(h);const e={id:s,status:v.interview.status,updatedBy:JSON.stringify(u)};await d({InterviewValue:e}),f(!0),console.log("Form submitted successfully!")}catch(x){console.error("Error submitting form",x)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"sawpDate",children:"SAWP Request Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"sawpDate"},S("sawpDate")),{},{value:v.interview.sawpDate,onChange:e=>M("sawpDate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"sawpRecivedDate",children:"SAWP Recieved Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"sawpRecivedDate"},S("sawpRecivedDate")),{},{value:v.interview.sawpRecivedDate,onChange:e=>M("sawpRecivedDate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>M("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"sawpFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(k(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:""})})))}catch(l){console.log(l,"DeleteUploadSawp in error")}})(e,a,0,j,w,b,y);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),P()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:I.sawpFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:P,title1:u})]})},or=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{interviewDetails:o}=ta(),{createWPTrackingHandler:d}=rr(),{wpTrackingDetails:c}=ir(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",doesubmitdate:"",doerefno:"",doeapprovedate:"",doeexpirydate:"",doefile:"",status:""}}),[N,b]=(0,n.useState)({doeFile:!1}),[D,j]=(0,n.useState)({doeFile:null}),[A,w]=(0,n.useState)({doeFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt.CF)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{doesubmitdate:e.doesubmitdate,doerefno:e.doerefno,doeapprovedate:e.doeapprovedate,doeexpirydate:e.doeexpirydate,doefile:e.doefile||v.interview.doefile,status:e.IDDetails.status}}),e.doefile){const t=P(e.doefile);j((e=>(0,g.A)((0,g.A)({},e),{},{doeFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null,F=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{className:"p-5",onSubmit:async e=>{var r;e.preventDefault();const n=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),i=null===n||void 0===n?void 0:n.id,p=null===s||void 0===s?void 0:s.id,m=n,u=s,h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),x=[...null!==u&&void 0!==u&&u.updatedBy?JSON.parse(null===u||void 0===u?void 0:u.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(null===v||void 0===v||null===(r=v.interview)||void 0===r||!r.status)return void console.error("Missing interview status in formData.");const g={tempID:t.tempID,doesubmitdate:v.interview.doesubmitdate,doerefno:v.interview.doerefno,doeapprovedate:v.interview.doeapprovedate,doeexpirydate:v.interview.doeexpirydate,doefile:N.doeFile?JSON.stringify(M(A.doeFile)):v.interview.doefile,createdBy:JSON.stringify([{userID:C,date:R}])};try{if(i){await c({WPTrackingValue:{id:i,doesubmitdate:v.interview.doesubmitdate,doerefno:v.interview.doerefno,doeapprovedate:v.interview.doeapprovedate,doeexpirydate:v.interview.doeexpirydate,doefile:N.doeFile?JSON.stringify(M(A.doeFile)):v.interview.doefile,updatedBy:JSON.stringify(h)}})}else await d({reqValue:g});const e={id:p,status:v.interview.status,updatedBy:JSON.stringify(x)};await o({InterviewValue:e}),f(!0)}catch(D){var y,b;null!==D&&void 0!==D&&null!==(y=D.response)&&void 0!==y&&null!==(b=y.data)&&void 0!==b&&b.errors?console.error("API Errors:",D.response.data.errors):console.error("Unexpected error:",D)}},children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"doesubmitdate",children:"Date of Submission"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"doesubmitdate"},S("doesubmitdate")),{},{value:v.interview.doesubmitdate,onChange:e=>F("doesubmitdate",e.target.value)})),k.doesubmitdate&&(0,i.jsx)("span",{children:k.doesubmitdate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"doeapprovedate",children:"Date of Approval"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"doeapprovedate"},S("doeapprovedate")),{},{value:v.interview.doeapprovedate,onChange:e=>F("doeapprovedate",e.target.value)})),k.doeapprovedate&&(0,i.jsx)("span",{children:k.doeapprovedate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"doeexpirydate",children:"Valid Until"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"doeexpirydate"},S("doeexpirydate")),{},{value:v.interview.doeexpirydate,onChange:e=>F("doeexpirydate",e.target.value)})),k.doeexpirydate&&(0,i.jsx)("span",{children:k.doeexpirydate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"doerefno",children:"DOE Reference Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"doerefno"},S("doerefno")),{},{value:v.interview.doerefno,onChange:e=>F("doerefno",e.target.value)})),k.doerefno&&(0,i.jsx)("span",{children:k.doerefno.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"doeFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s)=>{try{a((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),r((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),n((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),s((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:"",doefile:""})})))}catch(i){console.log(i,"DeleteUploadDoe in error")}})(e,a,j,w,b,y);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),O()}catch(r){alert("Error processing the file deletion.")}},isUploadingString:N,error:k.doeFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},dr=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{interviewDetails:o}=ta(),{createWPTrackingHandler:d}=rr(),{wpTrackingDetails:c,isLoading:p,error:m}=ir(),[u,h]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),[N,b]=(0,n.useState)({interview:{id:"",nlmssubmitdate:"",submissionrefrenceno:"",nlmsapprovedate:"",nlmsexpirydate:"",ldreferenceno:"",nlmsfile:"",status:""}}),[D,j]=(0,n.useState)({nlmsFile:!1}),[A,w]=(0,n.useState)({nlmsFile:null}),[S,E]=(0,n.useState)({nlmsFile:null}),{register:I,handleSubmit:k,watch:T,formState:{errors:C},setValue:R}=(0,tt.mN)({resolver:(0,at.t)(rt.s8)}),P=localStorage.getItem("userID"),O=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(b({interview:{nlmssubmitdate:e.nlmssubmitdate,submissionrefrenceno:e.submissionrefrenceno,nlmsapprovedate:e.nlmsapprovedate,nlmsexpirydate:e.nlmsexpirydate,ldreferenceno:e.ldreferenceno,nlmsfile:e.nlmsfile,status:e.IDDetails.status}}),e.nlmsfile){const t=_(e.nlmsfile);w((e=>(0,g.A)((0,g.A)({},e),{},{nlmsFile:t})))}}else b({interview:{status:r.status}})}}),[l,t.tempID]);const _=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},M=()=>{f(!x)},F=(e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))},L=(new Date).toISOString().split("T")[0],U=e=>e?[{upload:e,date:L}]:null;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===r||void 0===r?void 0:r.id,i=null===n||void 0===n?void 0:n.id,p=r,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:P,date:O}].map((e=>({userID:e.userID,date:e.date}))),x=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:P,date:O}].map((e=>({userID:e.userID,date:e.date})));if(null===N||void 0===N||!N.interview)return void console.error("Error: formData.interview is undefined.");const g={tempID:t.tempID,nlmssubmitdate:N.interview.nlmssubmitdate,submissionrefrenceno:N.interview.submissionrefrenceno,nlmsapprovedate:N.interview.nlmsapprovedate,nlmsexpirydate:N.interview.nlmsexpirydate,ldreferenceno:N.interview.ldreferenceno,nlmsfile:D.nlmsFile?JSON.stringify(U(S.nlmsFile)):N.interview.nlmsfile,createdBy:JSON.stringify([{userID:P,date:O}])};try{if(s){await c({WPTrackingValue:{id:s,nlmssubmitdate:N.interview.nlmssubmitdate,submissionrefrenceno:N.interview.submissionrefrenceno,nlmsapprovedate:N.interview.nlmsapprovedate,nlmsexpirydate:N.interview.nlmsexpirydate,ldreferenceno:N.interview.ldreferenceno,nlmsfile:D.nlmsFile?JSON.stringify(U(S.nlmsFile)):N.interview.nlmsfile,updatedBy:JSON.stringify(u)}})}else await d({reqValue:g});const e={id:i,status:N.interview.status,updatedBy:JSON.stringify(x)};await o({InterviewValue:e}),h(!0)}catch(f){console.error("Error submitting interview details:",f)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"nlmssubmitdate",children:"Date of Submission"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"nlmssubmitdate"},I("nlmssubmitdate")),{},{value:N.interview.nlmssubmitdate,onChange:e=>F("nlmssubmitdate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"submissionrefrenceno",children:"Submission Reference Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"submissionrefrenceno"},I("submissionrefrenceno")),{},{value:N.interview.submissionrefrenceno,onChange:e=>F("submissionrefrenceno",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"nlmsapprovedate",children:"Date of Approval"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"nlmsapprovedate"},I("nlmsapprovedate")),{},{value:N.interview.nlmsapprovedate,onChange:e=>F("nlmsapprovedate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"nlmsexpirydate",children:"Valid Until"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"nlmsexpirydate"},I("nlmsexpirydate")),{},{value:N.interview.nlmsexpirydate,onChange:e=>F("nlmsexpirydate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"ldreferenceno",children:"LD Reference Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"ldreferenceno"},I("ldreferenceno")),{},{value:N.interview.ldreferenceno,onChange:e=>F("ldreferenceno",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},I("status")),{},{value:N.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:I,fileKey:"nlmsFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(R(a,n),n&&(((e,t)=>{j((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,E,r),w((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:A,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:"",nlmsfile:""})})))}catch(m){console.log(m,"DeleteUploadNlms in error")}})(e,a,0,w,E,j,b);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));y("".concat(a)),M()}catch(m){console.error("Error deleting file:",m),alert("Error processing the file deletion.")}},isUploadingString:D,error:C.nlmsFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),p&&(0,i.jsx)("div",{children:"Loading..."}),u&&(0,i.jsx)("div",{children:"Data updated successfully!"}),m&&(0,i.jsxs)("div",{children:["Error: ",m.message]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),u&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:u,path:"/recrutiles/workpasstracking"}),x&&(0,i.jsx)(Wt,{handleDeleteMsg:M,title1:v})]})},cr=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{createWPTrackingHandler:o}=rr(),{wpTrackingDetails:d}=ir(),{interviewDetails:c}=ta(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",bgsubmitdate:"",bgreceivedate:"",bgexpirydate:"",referenceno:"",bgamount:"",bgfile:"",status:""}}),[N,b]=(0,n.useState)({bgFile:!1}),[D,j]=(0,n.useState)({bgFile:null}),[A,w]=(0,n.useState)({bgFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt._j)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{bgsubmitdate:e.bgsubmitdate,bgreceivedate:e.bgreceivedate,bgexpirydate:e.bgexpirydate,referenceno:e.referenceno,bgamount:e.bgamount,bgfile:e.bgfile||A.bgFile,status:e.IDDetails.status}}),e.bgfile){const t=P(e.bgfile);j((e=>(0,g.A)((0,g.A)({},e),{},{bgFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null,F=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===r||void 0===r?void 0:r.id,i=null===n||void 0===n?void 0:n.id,p=r,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(!s)return void console.error("Error: No interview schedule found for this candidate.");const x={tempID:t.tempID,bgsubmitdate:v.interview.bgsubmitdate,bgreceivedate:v.interview.bgreceivedate,bgexpirydate:v.interview.bgexpirydate,referenceno:v.interview.referenceno,bgamount:v.interview.bgamount,bgfile:N.bgFile?JSON.stringify(M(A.bgFile)):v.interview.bgfile,createdBy:JSON.stringify([{userID:C,date:R}])};let g;try{s?g=await d({WPTrackingValue:{id:s,bgsubmitdate:v.interview.bgsubmitdate,bgreceivedate:v.interview.bgreceivedate,bgexpirydate:v.interview.bgexpirydate,referenceno:v.interview.referenceno,bgamount:v.interview.bgamount,bgfile:N.bgFile?JSON.stringify(M(A.bgFile)):v.interview.bgfile,updatedBy:JSON.stringify(u)}}):await o({reqValue:x});const e={id:i,status:v.interview.status,updatedBy:JSON.stringify(h)};await c({InterviewValue:e}),f(!0),g.errors&&g.errors.length>0&&console.error("Response errors:",g.errors)}catch(y){console.error("Error submitting interview details:",y)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"bgsubmitdate",children:"Date of Submission"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"bgsubmitdate"},S("bgsubmitdate")),{},{value:v.interview.bgsubmitdate,onChange:e=>F("bgsubmitdate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"bgreceivedate",children:"Date Received"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"bgreceivedate"},S("bgreceivedate")),{},{value:v.interview.bgreceivedate,onChange:e=>F("bgreceivedate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"bgexpirydate",children:"Valid Until"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1",type:"date",id:"bgexpirydate"},S("bgexpirydate")),{},{value:v.interview.bgexpirydate,onChange:e=>F("bgexpirydate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"bgamount",children:"Bank Guarantee Amount"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[44px]",type:"text",id:"bgamount"},S("bgamount")),{},{value:v.interview.bgamount,onChange:e=>F("bgamount",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"referenceno",children:[" ","Bank Guarantee Reference Number"]}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[44px]",type:"text",id:"referenceno"},S("referenceno")),{},{value:v.interview.referenceno,onChange:e=>F("referenceno",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[44px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"bgFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s)=>{try{a((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),r((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),n((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),s((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:"",bgfile:""})})))}catch(i){console.log("error",i)}})(e,a,j,w,b,y);if(!n||s)return;h("".concat(a)),O()}catch(r){console.log("error",r)}},isUploadingString:N,error:k.bgFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},pr=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{interviewDetails:o}=ta(),{createWPTrackingHandler:d}=rr(),{wpTrackingDetails:c}=ir(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",tbapurchasedate:"",submitdateendorsement:"",jitpaexpirydate:"",jitpaamount:"",jitpafile:"",status:""}}),[N,b]=(0,n.useState)({jitpaFile:!1}),[D,j]=(0,n.useState)({jitpaFile:null}),[A,w]=(0,n.useState)({jitpaFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt.gm)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{tbapurchasedate:e.tbapurchasedate,submitdateendorsement:e.submitdateendorsement,jitpaexpirydate:e.jitpaexpirydate,jitpaamount:e.jitpaamount,jitpafile:e.jitpafile,status:e.IDDetails.status}}),e.jitpafile){const t=P(e.jitpafile);j((e=>(0,g.A)((0,g.A)({},e),{},{jitpaFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null,F=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===r||void 0===r?void 0:r.id,i=null===n||void 0===n?void 0:n.id,p=r,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(!s)return void console.error("Error: No interview schedule found for this candidate.");const x={tempID:t.tempID,tbapurchasedate:v.interview.tbapurchasedate,submitdateendorsement:v.interview.submitdateendorsement,jitpaexpirydate:v.interview.jitpaexpirydate,jitpaamount:v.interview.jitpaamount,jitpafile:N.jitpaFile?JSON.stringify(M(A.jitpaFile)):v.interview.jitpafile,createdBy:JSON.stringify([{userID:C,date:R}])};let g;try{s?g=await c({WPTrackingValue:{id:s,tbapurchasedate:v.interview.tbapurchasedate,submitdateendorsement:v.interview.submitdateendorsement,jitpaexpirydate:v.interview.jitpaexpirydate,jitpaamount:v.interview.jitpaamount,jitpafile:N.jitpaFile?JSON.stringify(M(A.jitpaFile)):v.interview.jitpafile,updatedBy:JSON.stringify(u)}}):await d({reqValue:x});const e={id:i,status:v.interview.status,updatedBy:JSON.stringify(h)};await o({InterviewValue:e}),f(!0)}catch(y){console.error("Error submitting interview details:",y)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"tbapurchasedate",children:"Date of Purchase"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"tbapurchasedate"},S("tbapurchasedate")),{},{value:v.interview.tbapurchasedate,onChange:e=>F("tbapurchasedate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"submitdateendorsement",children:"Date of Endrosement"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"submitdateendorsement"},S("submitdateendorsement")),{},{value:v.interview.submitdateendorsement,onChange:e=>F("submitdateendorsement",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"jitpaexpirydate",children:"Valid Until"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"jitpaexpirydate"},S("jitpaexpirydate")),{},{value:v.interview.jitpaexpirydate,onChange:e=>F("jitpaexpirydate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"jitpaamount",children:"JITPA Amount"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"jitpaamount"},S("jitpaamount")),{},{value:v.interview.jitpaamount,onChange:e=>F("jitpaamount",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"jitpaFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:"",jitpafile:""})})))}catch(l){console.log(l,"DeleteUploadJitpa in error")}})(e,a,0,j,w,b,y);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),O()}catch(r){alert("Error processing the file deletion.")}},isUploadingString:N,error:k.jitpaFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},mr=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{interviewDetails:o}=ta(),{createWPTrackingHandler:d}=rr(),{wpTrackingDetails:c}=ir(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",lbrDepoNum:"",lbrEndroseDate:"",lbrDepoAmount:"",lbrFile:"",status:""}}),[N,b]=(0,n.useState)({lbrFile:!1}),[D,j]=(0,n.useState)({lbrFile:null}),[A,w]=(0,n.useState)({lbrFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt.iR)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{lbrDepoNum:e.lbrDepoNum,lbrEndroseDate:e.lbrEndroseDate,lbrDepoAmount:e.lbrDepoAmount,lbrFile:e.lbrFile,status:e.status,status:e.IDDetails.status}}),e.lbrFile){const t=P(e.lbrFile);j((e=>(0,g.A)((0,g.A)({},e),{},{lbrFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null,F=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===r||void 0===r?void 0:r.id,i=null===n||void 0===n?void 0:n.id,p=r,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(!s)return void console.error("Error: No interview schedule found for this candidate.");const x={tempID:t.tempID,lbrDepoNum:v.interview.lbrDepoNum,lbrEndroseDate:v.interview.lbrEndroseDate,lbrDepoAmount:v.interview.lbrDepoAmount,lbrFile:N.lbrFile?JSON.stringify(M(A.lbrFile)):v.interview.lbrFile,createdBy:JSON.stringify([{userID:C,date:R}])};let g;try{s?g=await c({WPTrackingValue:{id:s,lbrDepoNum:v.interview.lbrDepoNum,lbrEndroseDate:v.interview.lbrEndroseDate,lbrDepoAmount:v.interview.lbrDepoAmount,lbrFile:N.lbrFile?JSON.stringify(M(A.lbrFile)):v.interview.lbrFile,updatedBy:JSON.stringify(u)}}):await d({reqValue:x});const e={id:i,status:v.interview.status,updatedBy:JSON.stringify(h)};await o({InterviewValue:e}),f(!0)}catch(y){console.error("Error submitting interview details:",y)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"lbrDepoNum",children:"Labour Deposit Receipt Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"lbrDepoNum"},S("lbrDepoNum")),{},{value:v.interview.lbrDepoNum,onChange:e=>F("lbrDepoNum",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"lbrEndroseDate",children:"Date Endrosement Of Labour Deposit"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"lbrEndroseDate"},S("lbrEndroseDate")),{},{value:v.interview.lbrEndroseDate,onChange:e=>F("lbrEndroseDate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"lbrDepoAmount",children:"Deposit Amount"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"lbrDepoAmount"},S("lbrDepoAmount")),{},{value:v.interview.lbrDepoAmount,onChange:e=>F("lbrDepoAmount",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"lbrFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:""})})))}catch(l){console.log(l,"DeleteUploadLabourDep in error")}})(e,a,0,j,w,b,y);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),O()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:k.lbrFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},ur=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{createWPTrackingHandler:o}=rr(),{wpTrackingDetails:d}=ir(),{interviewDetails:c}=ta(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",immbdno:"",docsubmitdate:"",visaapprovedate:"",visareferenceno:"",visaFile:"",status:""}}),[N,b]=(0,n.useState)({visaFile:!1}),[D,j]=(0,n.useState)({visaFile:null}),[A,w]=(0,n.useState)({visaFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt.UB)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{immbdno:e.immbdno,docsubmitdate:e.docsubmitdate,visaapprovedate:e.visaapprovedate,visareferenceno:e.visareferenceno,visaFile:e.visaFile||A.visaFile,status:e.status,status:e.IDDetails.status}}),e.visaFile){const t=P(e.visaFile);j((e=>(0,g.A)((0,g.A)({},e),{},{visaFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null,F=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===r||void 0===r?void 0:r.id,i=null===n||void 0===n?void 0:n.id,p=r,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(!s)return void console.error("Error: No interview schedule found for this candidate.");const x={tempID:t.tempID,immbdno:v.interview.immbdno,docsubmitdate:v.interview.docsubmitdate,visaapprovedate:v.interview.visaapprovedate,visareferenceno:v.interview.visareferenceno,visaFile:N.visaFile?JSON.stringify(M(A.visaFile)):v.interview.visaFile,createdBy:JSON.stringify([{userID:C,date:R}])};let g;try{s?g=await d({WPTrackingValue:{id:s,immbdno:v.interview.immbdno,docsubmitdate:v.interview.docsubmitdate,visaapprovedate:v.interview.visaapprovedate,visareferenceno:v.interview.visareferenceno,visaFile:N.visaFile?JSON.stringify(M(A.visaFile)):v.interview.visaFile,updatedBy:JSON.stringify(u)}}):await o({reqValue:x});const e={id:i,status:v.interview.status,updatedBy:JSON.stringify(h)};await c({InterviewValue:e}),f(!0)}catch(y){console.error("Error submitting interview details:",y)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"docsubmitdate",children:"Date of Submission"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"docsubmitdate"},S("docsubmitdate")),{},{value:v.interview.docsubmitdate,onChange:e=>F("docsubmitdate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"immbdno",children:"Immigration Reference Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"immbdno"},S("immbdno")),{},{value:v.interview.immbdno,onChange:e=>F("immbdno",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"visaapprovedate",children:"Date of Approval"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:" visaapprovedate"},S(" visaapprovedate")),{},{value:v.interview.visaapprovedate,onChange:e=>F("visaapprovedate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"visareferenceno",children:"Visa Reference Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"visareferenceno"},S("visareferenceno")),{},{value:v.interview.visareferenceno,onChange:e=>F("visareferenceno",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"visaFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:""})})))}catch(l){console.log(l,"DeleteUploadImmi in error")}})(e,a,0,j,w,b,y);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),O()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:k.visaFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},hr=e=>{let{candidate:t}=e;const{IVSSDetails:a}=(0,n.useContext)(s.Y),{formattedPermissions:r}=qt(),{interviewSchedules:l}=sr(),{wpTrackingDetails:o}=ir(),{interviewDetails:d}=ta(),{createWPTrackingHandler:c}=rr(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",departuredate:"",arrivaldate:"",cityname:"",airfare:"",airticketfile:"",status:""}}),[N,b]=(0,n.useState)({airTktFile:!1}),[D,j]=(0,n.useState)({airTktFile:null}),[A,w]=(0,n.useState)({airTktFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt.Rr)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(l.length>0){const e=l.find((e=>e.tempID===t.tempID)),r=a.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{departuredate:e.departuredate,arrivaldate:e.arrivaldate,cityname:e.cityname,airfare:e.airfare,airticketfile:e.airticketfile||A.airTktFile,status:e.IDDetails.status}}),e.airticketfile){const t=P(e.airticketfile);j((e=>(0,g.A)((0,g.A)({},e),{},{airTktFile:t})))}}else y({interview:{status:r.status}})}}),[l,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(new Date).toISOString().split("T")[0],M=e=>e?[{upload:e,date:_}]:null,F=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=l.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=a.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),s=null===r||void 0===r?void 0:r.id,i=null===n||void 0===n?void 0:n.id,p=r,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(!s)return void console.error("Error: No interview schedule found for this candidate.");const x={tempID:t.tempID,departuredate:v.interview.departuredate,arrivaldate:v.interview.arrivaldate,cityname:v.interview.cityname,airfare:v.interview.airfare,airticketfile:N.airTktFile?JSON.stringify(M(A.airTktFile)):v.interview.airticketfile,createdBy:JSON.stringify([{userID:C,date:R}])};let g;try{s?g=await o({WPTrackingValue:{id:s,departuredate:v.interview.departuredate,arrivaldate:v.interview.arrivaldate,cityname:v.interview.cityname,airfare:v.interview.airfare,airticketfile:N.airTktFile?JSON.stringify(M(A.airTktFile)):v.interview.airticketfile,updatedBy:JSON.stringify(u)}}):await c({reqValue:x});const e={id:i,status:v.interview.status,updatedBy:JSON.stringify(h)};await d({InterviewValue:e}),f(!0)}catch(y){console.error("Error submitting interview details:",y)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"departuredate",children:"Date of Departure"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"departuredate"},S("departuredate")),{},{value:v.interview.departuredate,onChange:e=>F("departuredate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"arrivaldate",children:"Date of Arrival"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"arrivaldate"},S("arrivaldate")),{},{value:v.interview.arrivaldate,onChange:e=>F("arrivaldate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"cityname",children:"City of Departure"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"cityname"},S("cityname")),{},{value:v.interview.cityname,onChange:e=>F("cityname",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"airfare",children:"AirFare"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"airfare"},S("airfare")),{},{value:v.interview.airfare,onChange:e=>F("airfare",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>F("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"airTktFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:"",airticketfile:""})})))}catch(l){console.log(l,"DeleteUploadAirTicket in error")}})(e,a,0,j,w,b,y);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),O()}catch(r){alert("Error processing the file deletion.")}},isUploadingString:N,error:k.airTktFile,formattedPermissions:r,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},xr=e=>{let{candidate:t}=e;const{formattedPermissions:a}=qt(),{interviewSchedules:r}=sr(),{IVSSDetails:l}=(0,n.useContext)(s.Y),{createWPTrackingHandler:o}=rr(),{wpTrackingDetails:d}=ir(),{interviewDetails:c}=ta(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)({interview:{id:"",mobSignDate:"",agentname:"",remarkNLMob:"",mobFile:"",status:""}}),[N,b]=(0,n.useState)({mobFile:!1}),[D,j]=(0,n.useState)({mobFile:null}),[A,w]=(0,n.useState)({mobFile:null}),{register:S,handleSubmit:E,watch:I,formState:{errors:k},setValue:T}=(0,tt.mN)({resolver:(0,at.t)(rt.Io)}),C=localStorage.getItem("userID"),R=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(r.length>0){const e=r.find((e=>e.tempID===t.tempID)),a=l.find((e=>e.tempID===t.tempID));if(e){if(y({interview:{mobSignDate:e.mobSignDate,agentname:e.agentname,remarkNLMob:e.remarkNLMob,mobFile:e.mobFile,status:e.IDDetails.status}}),e.mobFile){const t=P(e.mobFile);j((e=>(0,g.A)((0,g.A)({},e),{},{mobFile:t})))}}else y({interview:{status:a.status}})}}),[r,t.tempID]);const P=e=>{if("string"===typeof e&&e){return decodeURIComponent(e).split("/").pop().split("?")[0].split(",")[0].split("#")[0]}return""},O=()=>{m(!p)},_=(e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{interview:(0,g.A)((0,g.A)({},a.interview),{},{[e]:t})})))},M=(new Date).toISOString().split("T")[0],F=e=>e?[{upload:e,date:M}]:null;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=r.find((e=>e.tempID===(null===t||void 0===t?void 0:t.tempID))),n=l.find((e=>(null===e||void 0===e?void 0:e.tempID)===(null===t||void 0===t?void 0:t.tempID))),s=null===a||void 0===a?void 0:a.id,i=null===n||void 0===n?void 0:n.id,p=a,m=n,u=[...null!==p&&void 0!==p&&p.updatedBy?JSON.parse(null===p||void 0===p?void 0:p.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date}))),h=[...null!==m&&void 0!==m&&m.updatedBy?JSON.parse(null===m||void 0===m?void 0:m.updatedBy):[],{userID:C,date:R}].map((e=>({userID:e.userID,date:e.date})));if(null===v||void 0===v||!v.interview)return void console.error("Error: formData.interview is undefined.");if(!s)return void console.error("Error: No interview schedule found for this candidate.");const x={tempID:t.tempID,mobSignDate:v.interview.mobSignDate,agentname:v.interview.agentname,remarkNLMob:v.interview.remarkNLMob,mobFile:N.mobFile?JSON.stringify(F(A.mobFile)):v.interview.mobFile,createdBy:JSON.stringify([{userID:C,date:R}])};try{s?await d({WPTrackingValue:{id:s,mobSignDate:v.interview.mobSignDate,agentname:v.interview.agentname,remarkNLMob:v.interview.remarkNLMob,mobFile:N.mobFile?JSON.stringify(F(A.mobFile)):v.interview.mobFile,updatedBy:JSON.stringify(u)}}):await o({reqValue:x});const e={id:i,status:v.interview.status,updatedBy:JSON.stringify(h)};await c({InterviewValue:e}),f(!0)}catch(g){console.error("Error submitting interview details:",g)}},className:"p-5",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"mobSignDate",children:"Date of Mobilization"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"date",id:"mobSignDate"},S("mobSignDate")),{},{value:v.interview.mobSignDate,onChange:e=>_("mobSignDate",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"agentname",children:"Agent Name"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"agentname"},S("agentname")),{},{value:v.interview.agentname,onChange:e=>_("agentname",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"remarkNLMob",children:"Recruitment Remarks"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",type:"text",id:"remarkNLMob"},S("remarkNLMob")),{},{value:v.interview.remarkNLMob,onChange:e=>_("remarkNLMob",e.target.value)}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"status",children:"Status"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({className:"w-full border p-2 rounded mt-1 h-[46px]",id:"status"},S("status")),{},{value:v.interview.status,onChange:e=>_("status",e.target.value),children:Oa.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t)))}))]}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Mt,{label:"Upload File",register:S,fileKey:"mobFile",handleFileUpload:async(e,a)=>{const r=t.tempID;if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let n=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type)?(T(a,n),n&&(((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(a,!0),await lt(n,a,w,r),j((e=>(0,g.A)((0,g.A)({},e),{},{[a]:n.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:D,deletedStringUpload:async(e,a)=>{try{const r=t.tempID;if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,a,r),s=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:""})})))}catch(l){console.log(l,"DeleteUploadNonLocal in error")}})(e,a,0,j,w,b);if(!n||s)return void console.error("Failed to delete file: ".concat(a,", skipping UI update."));h("".concat(a)),O()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}},isUploadingString:N,error:k.mobFile,formattedPermissions:a,requiredPermissions:["WorkPass Tracking"],access:"Recruitment"})})})]}),(0,i.jsx)("div",{className:"mt-5 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"py-2 px-12 font-medium rounded shadow-lg bg-yellow hover:bg-yellow",children:"Submit"})})]}),x&&(0,i.jsx)(Pe,{text:"Candidate details updated successfully",notification:x,path:"/recrutiles/workpasstracking"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:O,title1:u})]})},gr=e=>{let{candidate:t,onClose:a,onSave:r}=e;const[s,l]=(0,n.useState)(0);return(0,i.jsx)("div",{className:"fixed inset-0 bg-grey bg-opacity-80 z-50 center",children:(0,i.jsxs)("div",{className:"bg-white p-10 rounded-lg w-full max-w-[700px] overflow-hidden relative",children:[(0,i.jsx)("button",{onClick:a,className:"absolute top-2 right-2 border rounded-full p-1",children:(0,i.jsx)(A.RQJ,{size:20})}),(0,i.jsx)("div",{className:"p-4 shadow-md bg-[#FBFCFF]",children:(0,i.jsxs)("div",{className:"flex gap-4 text-[13px] font-semibold",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"TEMP ID:"})," ",null===t||void 0===t?void 0:t.tempID]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Name:"})," ",null===t||void 0===t?void 0:t.name]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Contract Type:"})," ",null===t||void 0===t?void 0:t.contractType]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-semibold",children:"Employee Type:"})," ",null===t||void 0===t?void 0:t.empType]})]})}),(0,i.jsx)("article",{className:"flex gap-5 text-black mt-5 overflow-x-auto leaveManagementTable",children:["SAWP","DOE","NLMS","Bank Guarantee","JITPA","Labour Deposit","Immigration","Air Ticket","Non Local Mobilization"].map(((e,t)=>(0,i.jsx)("h1",{className:"px-3 py-1 whitespace-nowrap ".concat(s===t?"border-2 border-[#EEEBEB] bg-[#F9F9F9]":"bg-[#F9F9F9]"),onClick:()=>(e=>{l(e)})(t),children:e},t)))}),0===s&&(0,i.jsx)(lr,{candidate:t}),1===s&&(0,i.jsx)(or,{candidate:t}),2===s&&(0,i.jsx)(dr,{candidate:t}),3===s&&(0,i.jsx)(cr,{candidate:t}),4===s&&(0,i.jsx)(pr,{candidate:t}),5===s&&(0,i.jsx)(mr,{candidate:t}),6===s&&(0,i.jsx)(ur,{candidate:t}),7===s&&(0,i.jsx)(hr,{candidate:t}),8===s&&(0,i.jsx)(xr,{candidate:t})]})})},fr=e=>{let{data:t,fileUpload:a,urlValue:r}=e;const[s,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)(10),[h,x]=(0,n.useState)(1),g=Math.ceil(t.length/m),f=(h-1)*m,v=h*m,N=t.slice(f,v),b=e=>{p(e),l(!s)},D=e=>{p(e),d(!o)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[N&&N.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","SAWP Request Date","Sawp Recieved Date","SAWP PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:N&&N.length>0?N.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:f+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_sawpDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_sawpRecivedDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_sawpFile?(0,i.jsx)("a",{href:r,onClick:t=>{e.WPTrackDetails_sawpFile?a(e.WPTrackDetails_sawpFile):t.preventDefault()},download:!0,className:e.WPTrackDetails_sawpFile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_sawpFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>D(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>b(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No candidate Available"})}),o&&(0,i.jsx)(sa,{candidate:c,onClose:D}),s&&(0,i.jsx)(gr,{candidate:c,onClose:b})]}),N.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:h,totalPages:g,onPageChange:e=>{e>0&&e<=g&&x(e)}})})})]})},vr=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","DOE Date of Submission","DOE Date of Approval","DOE Valid Until","DOE DOE Reference Number","DOE PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_doesubmitdate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_doeapprovedate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_doeexpirydate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_doerefno||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_doefile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_doefile?r(e.WPTrackDetails_doefile):t.preventDefault()},download:!0,className:e.WPTrackDetails_doefile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_doefile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},yr=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","NLMS Date of Submission","NLMS Submission Reference Number","NLMS Date of Approval","NLMS Valid Until","NLMS LD Reference Number","NLMS PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_nlmssubmitdate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_referenceno||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_nlmsapprovedate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_nlmsexpirydate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_ldreferenceno||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_nlmsfile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_nlmsfile?r(e.WPTrackDetails_nlmsfile):t.preventDefault()},download:!0,className:e.WPTrackDetails_nlmsfile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_nlmsfile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},Nr=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Date of Submission","Date Received","Valid Until","Bank Guarantee Amount","Bank Guarantee Reference Number","Bank Guarantee PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_bgsubmitdate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_bgreceivedate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_bgexpirydate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_bgamount||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_referenceno||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_bgfile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_bgfile?r(e.WPTrackDetails_bgfile):t.preventDefault()},download:!0,className:e.WPTrackDetails_bgfile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_bgfile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},br=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Date of Purchase","Date of Endorsement","Valid Until","JITPA Amount","JIPTA PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_tbapurchasedate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_submitdateendorsement)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_jitpaexpirydate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_jitpaamount||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_jitpafile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_jitpafile?r(e.WPTrackDetails_jitpafile):t.preventDefault()},download:!0,className:e.WPTrackDetails_jitpafile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_jitpafile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},Dr=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Labour Deposit Receipt Number","Date Endorsement Of Labour Deposit","Deposit Amount","Labour PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_lbrDepoNum||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_lbrEndroseDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_lbrDepoAmount||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_lbrFile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_lbrFile?r(e.WPTrackDetails_lbrFile):t.preventDefault()},download:!0,className:e.WPTrackDetails_lbrFile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_lbrFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},jr=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Date of Submission","Date of Approval","Immigration Reference Number","Visa Reference Number","Immigration PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_docsubmitdate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_visaapprovedate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_immbdno||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_visareferenceno||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_visaFile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_visaFile?r(e.WPTrackDetails_visaFile):t.preventDefault()},download:!0,className:e.WPTrackDetails_visaFile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_visaFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},Ar=e=>{let{data:t,formatDate:a,fileUpload:r,urlValue:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(10),[x,g]=(0,n.useState)(1),f=Math.ceil(t.length/u),v=(x-1)*u,N=x*u,b=t.slice(v,N),D=e=>{m(e),o(!l)},j=e=>{m(e),c(!d)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:[b&&b.length>0?(0,i.jsxs)("table",{className:" w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Date of Departure","Date of Arrival","City of Departure","AirFare","Air Ticket PDF","Form","Edit Form"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:b&&b.length>0?b.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:v+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_departuredate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_arrivaldate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_cityname||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_airfare||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_airticketfile?(0,i.jsx)("a",{href:s,onClick:t=>{e.WPTrackDetails_airticketfile?r(e.WPTrackDetails_airticketfile):t.preventDefault()},download:!0,className:e.WPTrackDetails_airticketfile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_airticketfile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>j(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl text-[#EA4F4F] cursor-pointer py-3 center",onClick:()=>D(e),children:(0,i.jsx)(ia.GQd,{})})]},t))):(0,i.jsx)("tr",{})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),d&&(0,i.jsx)(sa,{candidate:p,onClose:j}),l&&(0,i.jsx)(gr,{candidate:p,onClose:D})]}),b.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:x,totalPages:f,onPageChange:e=>{e>0&&e<=f&&g(e)}})})})]})},wr=e=>{let{data:t,fileUpload:a,urlValue:r}=e;const s=(0,Ee.D)(),{submitMobilization:l}=$a(),[o,d]=(0,n.useState)(!1),[c,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)(""),[f,v]=(0,n.useState)(""),[N,b]=(0,n.useState)(10),[D,j]=(0,n.useState)(1),[A,w]=(0,n.useState)({}),[S,E]=(0,n.useState)(!1),[I,k]=(0,n.useState)(!1),[T,C]=(0,n.useState)(null),R=Math.ceil(t.length/N),P=(D-1)*N,O=D*N,_=t.slice(P,O),M=e=>{u(e),d(!o)},F=e=>{u(e),p(!c)};return(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,i.jsx)("div",{className:"p-6 text-center",children:(0,i.jsx)("p",{className:"text-darkText text-lg",children:f})}),(0,i.jsx)("div",{className:"px-6 py-3 bg-lightBg border-t border-borderGray flex justify-center",children:(0,i.jsx)("button",{className:"bg-primary px-6 py-2 rounded-lg font-semibold uppercase hover:bg-yellow transition",children:(0,i.jsx)("a",{href:"/recrutiles/workpasstracking",children:"Okay"})})})]})}),(0,i.jsxs)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl relative",children:[S&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,i.jsxs)("div",{className:"px-6 py-4 flex justify-between items-center bg-[#939393] uppercase",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Employee Conversion"}),(0,i.jsx)("button",{onClick:()=>E(!1),className:"text-white hover:text-borderGray transition-colors",children:(0,i.jsx)(ia.Qks,{size:24})})]}),(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"mb-6 space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-full font-medium text-labelText uppercase",children:"Candidate Name:"}),(0,i.jsx)("span",{className:"text-darkText",children:null===T||void 0===T?void 0:T.name})]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-full font-medium text-labelText uppercase",children:"Temp ID:"}),(0,i.jsx)("span",{className:"font-mono text-darkText",children:null===T||void 0===T?void 0:T.tempID})]})]}),(0,i.jsxs)("div",{className:"mb-6 p-4 rounded-lg border border-borderGray bg-lightBg uppercase",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-mutedText mb-1",children:"Employee ID"}),h?(0,i.jsx)("p",{className:"text-xl font-bold font-mono text-mutedText",children:h}):(0,i.jsx)("p",{className:"text-placeholderText italic",children:"Not generated yet"})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[!h&&(0,i.jsxs)("button",{onClick:async()=>{k(!0);try{const e=(e=>{const t=e.match(/[^\d]+/),a=t?t[0]:"",r=e.match(/\d+/),n=(r?parseInt(r[0],10):0)+1;return"".concat(a).concat(n)})(await(async()=>{try{let n=[],i=null,l=0;do{var e,t,a,r;const o=await s.graphql({query:Ie.it,variables:{nextToken:i}}),d=((null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.listEmpPersonalInfos)||void 0===t?void 0:t.items)||[]).map((e=>e.empID));n=[...n,...d],i=null===o||void 0===o||null===(a=o.data)||void 0===a||null===(r=a.listEmpPersonalInfos)||void 0===r?void 0:r.nextToken,l++}while(i);const o=n.sort(((e,t)=>{const a=e.match(/\d+/)?parseInt(e.match(/\d+/)[0],10):0,r=t.match(/\d+/)?parseInt(t.match(/\d+/)[0],10):0,n=e.replace(/\d+/g,"")||"",s=t.replace(/\d+/g,"")||"";return n===s?a-r:n.localeCompare(s)}));return o[o.length-1]}catch(n){return console.error("Error fetching total count:",n),0}})());x(e)}catch(e){console.error("Error generating employee ID:",e),alert("Error generating employee ID")}finally{k(!1)}},disabled:I,className:"flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center uppercase ".concat(I?"bg-disabledBg text-mutedText cursor-not-allowed":"bg-primary hover:hover:bg-yellow"),children:[I&&(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-white mr-2"}),I?"Generating...":"Generate EmpID"]}),h&&(0,i.jsxs)("button",{onClick:async()=>{if(T){w((e=>(0,g.A)((0,g.A)({},e),{},{[T.id]:!0})));try{const e=(0,g.A)((0,g.A)({},T),{},{empID:h});if(!e.empID)return void alert("Error: Missing employee ID.");if(e.empID&&e.interviewDetails_id){await l({mob:e});const{success:t,message:a}=await Qa({storedData:e});console.log("NonLocalMobTable : ",t,a),t?(v("Candidate conversion to employee has been completed successfully."),E(!1)):(E(!1),v("Candidate conversion to employee has been failed."))}}catch(e){w((e=>(0,g.A)((0,g.A)({},e),{},{[T.id]:!1}))),E(!1),console.error("Error during conversion:",e),v("Candidate conversion to employee has been failed.")}finally{w((e=>(0,g.A)((0,g.A)({},e),{},{[T.id]:!1}))),E(!1)}}else alert("Error: No candidate selected.")},disabled:!h||A[null===T||void 0===T?void 0:T.id],className:"flex-1 py-2 px-4 rounded-lg font-medium transition-all flex items-center justify-center uppercase ".concat(!h||A[null===T||void 0===T?void 0:T.id]?"bg-disabledBg text-mutedText cursor-not-allowed":"bg-primary hover:hover:bg-yellow"),children:[A[null===T||void 0===T?void 0:T.id]&&(0,i.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-white mr-2"}),A[null===T||void 0===T?void 0:T.id]?"Converting...":"Convert to employee"]})]})]}),(0,i.jsx)("div",{className:"px-6 py-3 bg-lightBg border-t border-borderGray",children:(0,i.jsx)("p",{className:"text-xs text-mutedText text-center",children:"Generate an Employee ID before conversion"})})]})}),_&&_.length>0?(0,i.jsxs)("table",{className:"w-full rounded-lg",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:["S.No","TempID","Name","Nationality","Position","Date of Mobilization","Agent Name","Recruitment Remarks","Non Local Mobilization PDF","Form","Edit Form","Status"].map(((e,t)=>(0,i.jsx)("th",{className:"py-4 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:_.map(((e,t)=>(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:P+t+1}),(0,i.jsx)("td",{className:"py-3",children:e.tempID}),(0,i.jsx)("td",{className:"py-3",children:e.name||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.nationality||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.position||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.WPTrackDetails_mobSignDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_agentname||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_remarkNLMob||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.WPTrackDetails_mobFile?(0,i.jsx)("a",{href:r,onClick:t=>{e.WPTrackDetails_mobFile?a(e.WPTrackDetails_mobFile):t.preventDefault()},download:!0,className:e.WPTrackDetails_mobFile?"border-b-2 border-[orange] text-[orange]":"",children:e.WPTrackDetails_mobFile?"Download":"N/A"}):(0,i.jsx)("p",{children:"N/A"})}),(0,i.jsx)("td",{className:"py-3 text-center",onClick:()=>F(e),children:"View"}),(0,i.jsx)("td",{className:"text-2xl cursor-pointer py-3 center",onClick:()=>M(e),children:(0,i.jsx)(ia.GQd,{})}),(0,i.jsx)("td",{className:"text-sm cursor-pointer py-3",onClick:()=>(C(e),E(!0),void x("")),disabled:A[e.id],children:A[e.id]?"Loading...":"Convert Employee"})]},t)))})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-lg text-dark_grey mt-2",children:"No Data Available"})}),c&&(0,i.jsx)(sa,{candidate:m,onClose:F}),o&&(0,i.jsx)(gr,{candidate:m,onClose:M})]}),_.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:D,totalPages:R,onPageChange:e=>{e>0&&e<=R&&j(e)}})})})]})},Sr=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)([]),u=(0,n.useRef)(null),[h,x]=(0,n.useState)("SAWP"),[v,y]=(0,n.useState)("SAWP"),[N,b]=(0,n.useState)([]),[D,A]=(0,n.useState)(""),[w,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)(""),{WPTrackings:k,empPDData:T,IVSSDetails:C,educDetailsData:R,localMobiliz:P}=(0,n.useContext)(s.Y);(0,n.useEffect)((()=>{const e=R.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),a=T.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),r=C.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),n=k.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),s=P.reduce(((e,t)=>(e[t.tempID]=t,e)),{}),i=Object.values(a).filter((e=>r[e.tempID])).map((t=>{const a=r[t.tempID]||{},i=n[t.tempID]||null,l=e[t.tempID]||{},o=s[t.tempID]||{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)({},t),l),o),{},{interviewDetails:a,WPTrackDetails:i})})).map((e=>{const t=(0,g.A)({},e);return t.interviewDetails&&(Object.entries(t.interviewDetails).forEach((e=>{let[a,r]=e;t["interviewDetails_".concat(a)]=r})),delete t.interviewDetails),t.WPTrackDetails&&(Object.entries(t.WPTrackDetails).forEach((e=>{let[a,r]=e;t["WPTrackDetails_".concat(a)]=r})),delete t.WPTrackDetails),t}));if(i&&i.length>0){const e=i.filter((e=>"SAWP"===(null===e||void 0===e?void 0:e.interviewDetails_status)));m(e),t(i)}else t([])}),[k,T,C,R,P]),(0,n.useEffect)((()=>{if(!e||0===e.length)return;let t=O(v,e);N.length>0&&(t=t.filter((e=>N.some((t=>"SAWP"===t?"SAWP"===e.contractType:"LPA"===t?"LPA"===e.contractType&&("Onshore"===e.empType||"Offshore"===e.empType):"OnShore"===t?"Onshore"===e.empType&&"SAWP"!==e.contractType:"OffShore"!==t||"Offshore"===e.empType&&"SAWP"!==e.contractType))))),m(t),c(!1)}),[D,v,N,e]);const O=(e,t)=>{let a=t;switch(e){case"SAWP":a=a.filter((e=>{var t;return"SAWP"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toUpperCase())}));break;case"DOE":a=a.filter((e=>{var t;return"DOE"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toUpperCase())}));break;case"NLMS":a=a.filter((e=>{var t;return"NLMS"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toUpperCase())}));break;case"Bank Guarantee":a=a.filter((e=>"Bank Guarantee"===(null===e||void 0===e?void 0:e.interviewDetails_status)));break;case"JITPA":a=a.filter((e=>{var t;return"JITPA"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toUpperCase())}));break;case"Labour Deposit":a=a.filter((e=>"Labour Deposit"===(null===e||void 0===e?void 0:e.interviewDetails_status)));break;case"Immigration":a=a.filter((e=>{var t;return"immigration"===(null===e||void 0===e||null===(t=e.interviewDetails_status)||void 0===t?void 0:t.toLowerCase())}));break;case"Air Ticket":a=a.filter((e=>"Air Ticket"===(null===e||void 0===e?void 0:e.interviewDetails_status)));break;case"NonLocal Mobilization":a=a.filter((e=>"NonLocal Mobilization"===(null===e||void 0===e?void 0:e.interviewDetails_status)))}return(e=>{if(!D)return e;const t=D.toLowerCase();return e.filter((e=>e.tempID&&e.tempID.toLowerCase().includes(t)||e.firstName&&e.firstName.toLowerCase().includes(t)||e.lastName&&e.lastName.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)||e.phoneNumber&&e.phoneNumber.includes(t)))})(a)},_=e=>{const t=e.target.value;y(t),x(t),c(!1)};(0,n.useEffect)((()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&c(!1),e.target.closest(".candidateTypeDropdown")||S(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const M=e=>{if(!e||isNaN(new Date(e).getTime()))return"";const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},F=async e=>{try{if("string"===typeof e){let t=e.replace(/=/g,":").replace(/([{,])(\s*[a-zA-Z0-9_]+)(?=\s*:)/g,'$1"$2"').replace(/:\s*([^",}\]]+)/g,': "$1"').replace(/"\s*[^"]+"\s*$/g,(e=>e.trim())).replace(/(\w)(,|})/g,"$1$2");const a=JSON.parse(t),r=a[a.length-1].upload,n=await(0,f.I)({path:r});return I(n.url.toString())}return console.error("Input must be a string."),null}catch(t){return console.error("Error parsing files:",t.message),null}};return(0,i.jsx)("section",{className:"screen-size min-h-screen mb-4",children:(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-start gap-4 flex-wrap",children:[(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("button",{className:"font-semibold py-2 px-6 rounded-lg flex items-center ".concat(N.length>0?"bg-[#faf362]":"bg-[#8d8f9036]"),onClick:()=>S(!w),children:[N.length>0?N.join(" + "):"CANDIDATE TYPE",w?(0,i.jsx)(Tt.Ucs,{className:"ml-10"}):(0,i.jsx)(Tt.Vr3,{className:"ml-10"})]}),w&&(0,i.jsx)("div",{className:"absolute mt-2 bg-white border shadow-lg rounded-lg z-20 w-48",children:["SAWP","LPA","OnShore","OffShore"].map((e=>(0,i.jsxs)("label",{className:"block w-full text-left px-4 py-2",children:[(0,i.jsx)("input",{type:"checkbox",className:"mr-2",checked:N.includes(e),onChange:()=>(e=>{let t=[...N];"SAWP"!==e||t.includes("SAWP")?"LPA"!==e||t.includes("LPA")?"OnShore"===e||"OffShore"===e?(t.includes("OnShore")&&"OffShore"===e?t=t.filter((e=>"OnShore"!==e)):t.includes("OffShore")&&"OnShore"===e&&(t=t.filter((e=>"OffShore"!==e))),t.includes(e)||t.push(e)):t.includes(e)?t=t.filter((t=>t!==e)):t.push(e):(t.includes("SAWP")&&(t=t.filter((e=>"SAWP"!==e))),t.push("LPA")):(t.includes("LPA")&&(t=t.filter((e=>"LPA"!==e))),t.push("SAWP")),b(t)})(e)}),e]},e)))})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("button",{onClick:e=>{null===e||void 0===e||e.stopPropagation(),c((e=>!e))},className:"px-6 py-2 font-semibold rounded-lg flex items-center ".concat(v.length?"bg-[#faf362]":"bg-[#8d8f9036]"),children:[(0,i.jsx)(Sa.y_E,{className:"mr-2"}),(0,i.jsx)("span",{children:h})]}),d&&(0,i.jsx)("div",{ref:u,className:"absolute mt-2 w-60 bg-white shadow-lg rounded-lg p-4 z-50 flex flex-col space-y-2",children:["SAWP","DOE","NLMS","Bank Guarantee","JITPA","Labour Deposit","Immigration","Air Ticket","NonLocal Mobilization"].map((e=>(0,i.jsxs)("label",{className:"flex items-center font-semibold space-x-2 hover:font-bold hover:text-[#c7bd03] p-2 rounded-md ".concat(v===e?"text-[#faf362]":"text-lite_grey"),children:[(0,i.jsx)("input",{type:"radio",className:"w-5 h-6",name:"workpasstracking",value:e,checked:v===e,onChange:_}),(0,i.jsx)("span",{children:e})]},e)))})]})]}),(0,i.jsx)("div",{className:"flex-1 flex justify-end",children:(0,i.jsx)("div",{className:"relative w-full max-w-sm",children:(0,i.jsxs)("div",{className:"py-[9px] w-full text_size_5 bg-white border text-grey border-lite_grey rounded-lg flex items-center px-3 gap-2",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search",className:"outline-none w-full text-sm",value:D,onChange:e=>A(e.target.value)}),(0,i.jsx)("div",{className:"text-dark_grey text-2xl cursor-pointer",children:(0,i.jsx)(j.zfp,{})})]})})})]}),(0,i.jsx)("div",{className:"mt-6",children:(()=>{switch(v){case"SAWP":return(0,i.jsx)(fr,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"DOE":return(0,i.jsx)(vr,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"NLMS":return(0,i.jsx)(yr,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"Bank Guarantee":return(0,i.jsx)(Nr,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"JITPA":return(0,i.jsx)(br,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"Labour Deposit":return(0,i.jsx)(Dr,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"Immigration":return(0,i.jsx)(jr,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"Air Ticket":return(0,i.jsx)(Ar,{data:p,formatDate:M,fileUpload:F,urlValue:E});case"NonLocal Mobilization":return(0,i.jsx)(wr,{data:p,formatDate:M,fileUpload:F,urlValue:E});default:return(0,i.jsx)(fr,{data:p,formatDate:M,fileUpload:F})}})()}),a&&l&&(0,i.jsx)(gr,{candidate:l,onClose:()=>r(!1),onSave:t=>{const a=e.map((e=>e.tempid===l.tempid?(0,g.A)((0,g.A)({},e),t):e));m(a),r(!1)}})]})})},Er=e=>{let{activeTab:t,handleTabClick:a}=e;const r=["Personal Details","Family Details","Work Info","Work Pass","Medical Details","Insurance Details","Non-Local Accommodation Details"];return(0,i.jsx)("div",{className:"sticky top-11 bg-white flex justify-between items-center z-40",children:(0,i.jsx)("p",{className:"text_size_5 font-semibold",children:r.map(((e,n)=>(0,i.jsxs)("span",{className:"relative after:absolute after:-bottom-2 after:left-0 after:w-[100%] after:h-1 cursor-pointer px-2 ".concat(t===n&&"after:bg-primary"),onClick:()=>a(n),children:[e," ",n<r.length-1]},n)))})})};var Ir=a(3141);Je.EA.workerSrc=new URL(a(1886),a.b).toString();const kr=e=>{let{personalDetails:t,educationalDetails:a,profilePhoto:r,applicationUpload:s,bwnUpload:l,cvCertifyUpload:o,loiUpload:d,myIcUpload:c,paafCvevUpload:p,ppUpload:m,supportDocUpload:u,inducBriefUp:h,invoiceRef:x,formatDate:g,mainRef:v,qcCertifyUpload:y}=e;const[N,b]=(0,n.useState)(null),[D,j]=(0,n.useState)(""),[A,w]=(0,n.useState)(""),S=(0,n.useRef)();console.log("PersonalDetails",t);(async e=>{if(!e)return void console.error("No URL provided for the file.");const t=await(0,f.I)({path:e});w(t.url.toString())})(r);const E=()=>{b(null)},I=(0,Ir.useReactToPrint)({content:()=>S.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete"),pageStyle:"\n        @page {    \n          height:  714px;\n          padding: 22px, 0px, 22px, 0px;    \n        }\n      "}),k=e=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",g(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{if(e)try{const t=await(0,f.I)({path:e});j(t.url.href),b(e)}catch(t){console.error("Error fetching the file URL:",t)}else console.error("No URL provided for the file.")})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),N===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"py-6 fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-[40vw] max-h-full flex flex-col",children:[(0,i.jsx)("div",{ref:S,className:"flex-grow overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:D||""})})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:E,className:"text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:D,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:I,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})}),N===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsxs)("div",{className:"relative mt-4",children:[(0,i.jsx)("div",{ref:x,children:(0,i.jsx)("img",{src:D,alt:"Document Preview",className:"w-full h-auto"})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:E,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:D,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:I,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})]},t)))}),T=(e,t)=>{let a=[];return e&&e.length>0&&(a="Induction Briefing"===t?"string"===typeof e?[{upload:e}]:[{upload:e[0]}]:(e=>{if(!e||"undefined"===e||"null"===e)return[];try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(t){return console.error("Error parsing document data:",t),[]}})(e[0])),(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),a.length>0?k(a):(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available"})})]})},C=e=>{const t=e=>{const t=(e=>{if("number"===typeof e)return e.toString();if(null===e||void 0===e||""===e)return"N/A";if(Array.isArray(e))return 0===e.length?"N/A":1===e.length?e[0]:e.join(", ").trim();if("string"===typeof e){const t=e.replace(/[\]"]/g,"").trim();return"N/A"===t||""===t?"N/A":t}return e.toString()})(e);return"N/A"===t?"N/A":isNaN(t)?t.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):t};return(0,i.jsx)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:Object.entries(e).map(((e,a)=>{let[r,s]=e;return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("span",{className:"text-dark_grey",children:r}),(0,i.jsx)("span",{className:"text-center",children:":"}),"Education Details"===r?(0,i.jsx)("span",{className:"text-dark_grey col-span-1",children:(()=>{if(!s||"null"===s||"N/A"===s)return"N/A";if("string"===typeof s&&!s.trim().startsWith("[")&&!s.trim().startsWith("{"))return"N/A";const e=(e=>{if(null===e||void 0===e)return null;if("string"!==typeof e&&(e=String(e)),!e||"null"===e||"N/A"===e)return null;if(!e.trim().startsWith("[")&&!e.trim().startsWith("{"))return null;try{let a;try{a=JSON.parse(e)}catch(t){const r=e.replace(/^\[+/,"[").replace(/\]+$/,"]").replace(/\\"/g,'"').trim();a=JSON.parse(r)}return Array.isArray(a)&&a.length>0&&Array.isArray(a[0])?a[0]:Array.isArray(a)?a:[a]}catch(a){return console.error("Error parsing education details:",a),null}})(s);return e&&0!==e.length?e.map(((e,t)=>{const a="object"===typeof e?e:{};return(0,i.jsxs)("div",{className:"mb-2 last:mb-0",children:[(0,i.jsxs)("div",{className:"font-bold",children:["Education ",t+1]}),(0,i.jsxs)("div",{children:["\u2022 University: ",a.university||"N/A"]}),(0,i.jsxs)("div",{children:["\u2022 Degree: ",a.degree||"N/A"]}),(0,i.jsxs)("div",{children:["\u2022 Period: ",a.fromDate||"N/A"," to"," ",a.toDate||"N/A"]})]},t)})):"N/A"})()}):(0,i.jsx)("span",{className:"text-dark_grey",children:null===s||void 0===s||""===s?"N/A":t(s)})]},a)}))})};return(0,i.jsxs)("section",{ref:v,className:"page py-8 px-10 bg-gray-50 rounded-lg",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Personal Details:"}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row items-start justify-between gap-8",children:[(0,i.jsx)("div",{className:"flex-1",children:C(t)}),(0,i.jsx)("div",{className:"w-[138px] h-[177px] rounded-lg overflow-hidden border border-gray-200 shadow-md",children:(0,i.jsx)("img",{src:A||ra,alt:"Profile",className:"object-cover w-full h-full"})})]}),(0,i.jsxs)("section",{className:"py-8 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Education Details:"}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row items-start justify-between gap-8",children:[(0,i.jsx)("div",{className:"flex-1",children:C(a)}),(0,i.jsx)("div",{className:"w-[138px] rounded-lg overflow-hidden",children:" "})]})]})]}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Uploaded Documents:"}),T(h,"Induction Briefing")]}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Uploaded Documents:"}),T([l],"Brunei IC"),T([c],"Malaysian IC"),T([m],"Passport Copy"),T([o],"CV"),T([y],"Certificates"),T([s],"Application Form"),T([d],"LOI"),T([p],"PAAF/CVEV Approval"),T([u],"Supporting Documents")]})]})},Tr=e=>{let{familyDetails:t,mainRef:a}=e,r=[];const n=e=>{try{if(Array.isArray(e))return e;if("object"===typeof e&&null!==e)return[e];if("string"!==typeof e)try{e=JSON.stringify(e)}catch(t){return console.error("Could not stringify data:",e),[]}let r=e.replace(/\\/g,"");try{const e=JSON.parse(r);return Array.isArray(e)?e:[e]}catch(t){}(r.startsWith('"')&&r.endsWith('"')||r.startsWith("'")&&r.endsWith("'"))&&(r=r.slice(1,-1)),r=r.replace(/'/g,'"'),r=r.replace(/([{,]\s*)([a-zA-Z_][a-zA-Z0-9_]*)(\s*:)/g,'$1"$2"$3'),r=r.replace(/:\s*([^"{\[\d][^,}\]\s]*)([,\]}])/g,((e,t,a)=>/^(true|false|null|\d+\.?\d*)$/.test(t)?": ".concat(t).concat(a):': "'.concat(t.trim(),'"').concat(a))),r=r.replace(/,\s*([}\]])/g,"$1");try{const e=JSON.parse(r);return Array.isArray(e)?e:[e]}catch(a){return console.error("Final parsing attempt failed:",a),console.error("Problematic data:",r),[]}}catch(r){return console.error("Unexpected error in parseFamilyDetails:",r),[]}};return t&&(Array.isArray(t)?t.length>0&&"string"===typeof t[0]?r=n(t[0]):t.length>0&&"object"===typeof t[0]&&(r=t):("string"===typeof t||"object"===typeof t&&null!==t)&&(r=n(t))),(0,i.jsxs)("section",{ref:a,className:"py-8 px-10 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"text_size_5 mb-6",children:"Family Details:"}),(0,i.jsx)("div",{className:"space-y-6",children:r.length>0?r.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,i.jsxs)("h6",{className:"font-semibold uppercase text_size_5 my-3 mb-4",children:["Family Member ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-y-2 items-center font-semibold text-sm",children:[(0,i.jsx)("span",{className:"text-dark_grey",children:"Name"}),(0,i.jsx)("span",{className:"text-gray-500 text-center",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.name)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey pr-2",children:"Relationship"}),(0,i.jsx)("span",{className:"text-gray-500 text-center",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.relationship)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey pr-2",children:"Contact"}),(0,i.jsx)("span",{className:"text-gray-500 text-center",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.contact)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey pr-2",children:"Address"}),(0,i.jsx)("span",{className:"text-gray-500 text-center",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.address)||"N/A"})]})]},t))):(0,i.jsx)("p",{className:"text-gray-500",children:"No family details available."})})]})};Je.EA.workerSrc=new URL(a(1886),a.b).toString();const Cr=e=>{let{medicalInfo:t,uploadFitness:a,uploadBwn:r,uploadRegis:s,invoiceRef:l,dependPass:o,handlePrint:d,formatDate:c,mainRef:p}=e;const[m,u]=(0,n.useState)(null),[h,x]=(0,n.useState)(""),g=()=>{u(null)},v=e=>{try{return"string"===typeof e&&(e=JSON.parse(e)),Array.isArray(e)?e.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(t){return console.error("Error parsing document data:",t),[]}};let y=[];if(Array.isArray(o)&&o.length>0)if("string"===typeof o[0])try{const e=JSON.parse(o[0]);y=JSON.parse(e)}catch(S){console.error("Error parsing dependPass:",S)}else y=o[0];if(!Array.isArray(y))return(0,i.jsx)("p",{children:"There was an error processing the dependent data."});const N=v(a),b=v(r),D=v(s),j=()=>{u(null)},A=(e,t)=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",c(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});x(t.url.href),u(e)}catch(S){console.error("Error fetching the file URL:",S)}})(e.upload),className:" text-dark_grey font-semibold text-sm",children:"View Document"})]}),m===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"py-6 fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-[40vw] max-h-full flex flex-col",children:[(0,i.jsx)("div",{ref:l,className:"flex-grow overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:h||""})})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:j,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:h,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:d,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})}),m===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsxs)("div",{className:"relative mt-4",children:[(0,i.jsx)("div",{ref:l,children:(0,i.jsx)("img",{src:h,alt:"Document Preview",className:"w-full h-auto"})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:g,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:h,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:d,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})]},t)))}),w=(e,t)=>{const a=e.length>0?v(e[0]):[],r=Array.isArray(a)&&a.length>0;return(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),r?A(a):(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available"})})]})};return(0,i.jsxs)("section",{ref:p,className:"py-8 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3 mb-6",children:"Medical Info"}),(0,i.jsx)("div",{className:"flex flex-col md:flex-row items-start justify-between gap-8",children:(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("div",{className:"flex-1",children:(()=>{const e=e=>"string"!==typeof e||"N/A"===e?"N/A":e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" ");return(0,i.jsx)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:Object.entries(t).map(((t,a)=>{let[r,s]=t;return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("span",{className:"text-dark_grey",children:r}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:Array.isArray(s)?s.length>0?s.map(((e,t,a)=>{var r;return null===e||void 0===e||""===e?"N/A":e.toLowerCase()===(null===(r=a[t-1])||void 0===r?void 0:r.toLowerCase())?null:e})).filter(((e,t,a)=>null!==e)).reduce(((e,t)=>("N/A"===t&&"N/A"!==e[e.length-1]?e.push("N/A"):"N/A"!==t&&e.push(t),e)),[]).reverse().map(((t,a,r)=>(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:"".concat(r.length>1&&0===a?"rounded-md font-black italic":""),children:e(t)}),a<r.length-1&&(0,i.jsx)("span",{children:",\xa0"})]},a))):"N/A":null===s||void 0===s||""===s?"N/A":e(s)})]},a)}))})})()})})}),(0,i.jsxs)("div",{className:"mt-8",children:[w(N,"Overseas Medical Fitness"),w(D,"Registration"),w(b,"Brunei Medical Fitness")]}),(0,i.jsxs)("section",{className:"py-8 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Dependent Pass info:"}),0===y.length?(0,i.jsx)("p",{children:"No dependent data available."}):y.map(((e,t)=>(0,i.jsxs)("div",{className:"depend-detail mb-6 p-4 border rounded-lg shadow-md bg-white",children:[(0,i.jsxs)("h3",{className:"uppercase text_size_5  my-3",children:[" ","Dependent ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm capitalize",children:[(0,i.jsx)("span",{className:"text-dark_grey",children:"Dependent Name"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.dependName||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Passport Number"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.dependPpNo||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Date of birth"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:c(e.dependPpE)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Relation"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.relation||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Labour Deposit By"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.labourDPBy||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Labour deposit received No"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.labourDRNo||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Labour Deposit Amount"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.labourDAmount||"N/A"})]}),(0,i.jsxs)("div",{className:"uploads mt-6",children:[(0,i.jsx)("h4",{className:"uppercase text_size_5  my-3",children:"Dependent pass:"}),e.uploadDp&&e.uploadDp.length>0?A(e.uploadDp):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents and images available"})]}),(0,i.jsxs)("div",{className:"uploads mt-6",children:[(0,i.jsx)("h4",{className:"uppercase text_size_5  my-3",children:"Dependent passport:"}),e.uploadDr&&e.uploadDr.length>0?A(e.uploadDr):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents and images available"})]})]},t)))]})]})},Rr=e=>{let{accommodationInfo:t,mainRef:a}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("section",{ref:a,className:"py-8 px-10 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Accommodation Details:"}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:Object.entries(t).map(((e,t)=>{let[a,r]=e,s="N/A";return Array.isArray(r)?s=r.filter((e=>null!==e&&""!==e&&void 0!==e)).join(", ")||"N/A":null!==r&&""!==r&&void 0!==r&&(s=r),(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("span",{className:"text-dark_grey",children:a}),(0,i.jsx)("span",{className:"text-gray-500 text-center",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s})]},t)}))})})]})})};Je.EA.workerSrc=new URL(a(1886),a.b).toString();const Pr=e=>{let{insuranceInfo:t,depInsurance:a,invoiceRef:r,formatDate:s,empInsUpload:l,mainRef:o,InsuranceClaim:d}=e;const[c,p]=(0,n.useState)(null),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)([]),[g,v]=(0,n.useState)(""),y=(0,n.useRef)();console.log("WK",t),(0,n.useEffect)((()=>{if(Array.isArray(a)&&a.length>0)if("string"===typeof a[0])try{const e=JSON.parse(a[0]);u(e)}catch(e){console.error("Error parsing depInsurance:",e)}else u(a)}),[a]),(0,n.useEffect)((()=>{if(Array.isArray(d)&&d.length>0)if("string"===typeof d[0])try{const e=JSON.parse(d[0]);x(e)}catch(e){console.error("Error parsing depInsurance:",e)}else x(d)}),[d]);const N=e=>{e.preventDefault(),p(null)},b=()=>{p(null)},D=(0,Ir.useReactToPrint)({content:()=>y.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete"),pageStyle:"\n          @page {    \n            height:  714px;\n            padding: 22px, 0px, 22px, 0px;    \n          }\n        "}),j=e=>Array.isArray(e)?(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",s(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});v(t.url.href),p(e)}catch(t){console.error("Error fetching the file URL:",t)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),c===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"py-6 fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-[40vw] max-h-full flex flex-col",children:[(0,i.jsx)("div",{ref:y,className:"flex-grow overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:g||""})})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:b,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:g,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:D,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})}),c===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsxs)("div",{className:"relative mt-4",children:[(0,i.jsx)("div",{ref:r,children:(0,i.jsx)("img",{src:g,alt:"Document Preview",className:"w-full h-auto"})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:N,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:g,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:D,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})]},t)))}):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available."});return(0,i.jsxs)("section",{ref:o,className:"py-3 px-10",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Insurance Details:"}),(0,i.jsx)("div",{className:"flex flex-col md:flex-row items-start justify-between gap-8",children:(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("div",{className:"flex-1",children:(()=>{const e=e=>e&&"N/A"!==e?e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):"N/A";return(0,i.jsx)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:Object.entries(t).map(((t,a)=>{let[r,s]=t;return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("span",{className:"text-dark_grey",children:r}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:Array.isArray(s)?s.length>0?s.map(((e,t,a)=>{var r;return null===e||void 0===e||""===e?"N/A":e.toLowerCase()===(null===(r=a[t-1])||void 0===r?void 0:r.toLowerCase())?null:e})).filter(((e,t,a)=>null!==e)).reduce(((e,t)=>("N/A"===t&&"N/A"!==e[e.length-1]?e.push("N/A"):"N/A"!==t&&e.push(t),e)),[]).reverse().map(((t,a,r)=>(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:"".concat(r.length>1&&0===a?"rounded-md font-black italic":""),children:e(t)}),a<r.length-1&&(0,i.jsx)("span",{children:",\xa0"})]},a))):"N/A":null===s||void 0===s||""===s?"N/A":e(s)})]},a)}))})})()})})}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5  my-3",children:"Uploaded Documents:"}),((e,t)=>{const a=e&&e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(t){return console.error("Error parsing document data:",t),[]}})(e[0]):[];return(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text-xl font-semibold text-dark_grey ",children:t}),a.length>0?j(a):(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available"})})]})})(l,"Employee Insurance Details")]}),(0,i.jsx)("div",{className:"flex flex-col gap-8 mt-6",children:m.map(((e,t)=>{var a;return(0,i.jsxs)("div",{className:"depend-detail mb-6 p-4 border rounded-lg shadow-md bg-white mt-4",children:[(0,i.jsxs)("h3",{className:"uppercase text_size_5  my-3",children:["Dependent ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:[(0,i.jsx)("span",{className:"text-dark_grey",children:"Insurance Type"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenInsType)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Dependent Name"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenName)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Relation"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenRelation)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Gender"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenGender)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Date of Birth"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenDob)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Nationality"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenNation)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Other Nation"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenotherNation)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Birth Certificate No"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenBcNo)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Brunei I/C Number"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenIcNumber)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Passport Number for Non-Local"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:(null===e||void 0===e?void 0:e.depenPpNo)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Group Insurance Effective Date"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenGroupInsEffect)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Group Insurance End Date"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenGroupInsEnd)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Travel Insurance Effective Date"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenTravelInsEffect)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Travel Insurance End Date"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenTravelInsEnd)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Person Insurance Effective Date"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenPersonInsEffect)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Person Insurance End Date"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(null===e||void 0===e?void 0:e.depenPersonInsEnd)||"N/A"})]}),(0,i.jsxs)("div",{className:"uploads mt-6",children:[(0,i.jsx)("h4",{className:"uppercase text_size_5  my-3",children:"Uploaded Documents:"}),null!==e&&void 0!==e&&e.depenInfUpload&&(null===e||void 0===e||null===(a=e.depenInfUpload)||void 0===a?void 0:a.length)>0?j(JSON.parse(null===e||void 0===e?void 0:e.depenInfUpload)):(0,i.jsx)("p",{children:"No documents uploaded."})]})]},t)}))}),(0,i.jsx)("div",{className:"flex flex-col gap-8 mt-6",children:h.map(((e,t)=>(0,i.jsxs)("div",{className:"depend-detail mb-6 p-4 border rounded-lg shadow-md bg-white mt-4",children:[(0,i.jsxs)("h3",{className:"uppercase text_size_5  my-3",children:["Insurance claim ",t+1]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:[(0,i.jsx)("span",{className:"text-dark_grey",children:"Type of Insurance Claim"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.claimType||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Insurance Claim For"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.claimInfo||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Clainmant Name"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:e.claimantName||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Date Reported to Insurance Company"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(e.dateReported)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Date of Payment Received"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(e.datePaid)||"N/A"}),(0,i.jsx)("span",{className:"text-dark_grey",children:"Date Paid to Employee"}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:s(e.paymentReceived)||"N/A"})]}),(0,i.jsxs)("div",{className:"uploads mt-6",children:[(0,i.jsx)("h4",{className:"uppercase text_size_5  my-3",children:"Uploaded Documents:"}),e.claimUpload&&e.claimUpload.length>0?j(JSON.parse(e.claimUpload)):(0,i.jsx)("p",{children:"No documents uploaded."})]})]},t)))})]})};Je.EA.workerSrc=new URL(a(1886),a.b).toString();const Or=e=>{let{workInfo:t,WIContract:a,WILeaveEntitle:r,WIProbation:s,WIResignation:l,WITermination:o,uploadAL:d,uploadDep:c,uploadLP:p,uploadPR:m,uploadSP:u,invoiceRef:h,formatDate:x,mainRef:g}=e;const[v,y]=(0,n.useState)(null),[N,b]=(0,n.useState)(""),D=(0,n.useRef)(),j=e=>{e.preventDefault(),y(null)},A=()=>{y(null)},w=(0,Ir.useReactToPrint)({content:()=>D.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete"),pageStyle:"\n        @page {    \n          height:  714px;\n          padding: 22px, 0px, 22px, 0px;    \n        }\n      "}),S=(e,t)=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",x(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});b(t.url.href),y(e)}catch(t){console.error("Error fetching the file URL:",t)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),v===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"py-6 fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-[40vw] max-h-full flex flex-col",children:[(0,i.jsx)("div",{ref:D,className:"flex-grow overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:N||""})})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:A,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:N,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:w,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})}),v===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsxs)("div",{className:"relative mt-4",children:[(0,i.jsx)("div",{ref:h,children:(0,i.jsx)("img",{src:N,alt:"Document Preview",className:"w-full h-auto"})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:j,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:N,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:w,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})]},t)))}),E=(e,t)=>{const a=e&&e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(t){return console.error("Error parsing document data:",t),[]}})(e[0]):[];return(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3 ",children:t}),a.length>0?S(a):(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available"})})]})},I=e=>{const t=e=>"string"!==typeof e||"N/A"===e?"N/A":e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" ");return(0,i.jsx)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:Object.entries(e).map(((e,a)=>{let[r,s]=e;return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("span",{className:"text-dark_grey",children:r}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:Array.isArray(s)?s.length>0?s.map(((e,t,a)=>{var r;return null===e||void 0===e||""===e?"N/A":e.toLowerCase()===(null===(r=a[t-1])||void 0===r?void 0:r.toLowerCase())?null:e})).filter(((e,t,a)=>null!==e)).reduce(((e,t)=>("N/A"===t&&"N/A"!==e[e.length-1]?e.push("N/A"):"N/A"!==t&&e.push(t),e)),[]).reverse().map(((e,a,r)=>(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:"".concat(r.length>1&&0===a?"rounded-md font-black italic":""),children:t(e)}),a<r.length-1&&(0,i.jsx)("span",{children:",\xa0"})]},a))):"N/A":null===s||void 0===s||""===s?"N/A":t(s)})]},a)}))})};return(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{ref:g,className:"py-8 px-10 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 mb-6",children:"Work Info Details:"}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Employee Info"}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"flex-1",children:I(t.employeeDetails)})})]}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Employee Leave Info"}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"flex-1",children:I(t.LeaveDetails)})})]}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Employee Exit Info"}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"flex-1",children:I(t.TerminateDetails)})})]}),(0,i.jsxs)("div",{className:"mt-8",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5  my-3",children:"Employee Service Record"}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"flex-1",children:I(t.ServiceRoad)})})]})]}),(0,i.jsxs)("div",{className:"mt-8 px-10",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5  my-3",children:"Employee Exit Info Documents"}),E(a,"Contract"),E(r,"Probation"),E(l,"Resignation"),E(o,"Termination"),E(s,"Leave Entitlement")]}),(0,i.jsxs)("div",{className:"mt-8 px-10",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:"Service Record Documents"}),E(m,"Position Revision"),E(u,"Salary Package Revision"),E(p,"Leave Passage Revision"),E(d,"Annual Revision"),E(c,"Change of Department")]})]})};Je.EA.workerSrc=new URL(a(1886),a.b).toString();const _r=e=>{let{workPass:t,doeEmpUpload:a,lbrDepoUpload:r,sawpEmpUpload:s,nlmsEmpUpload:l,bankEmpUpload:o,jpEmpUpload:d,handleCloseViewer:c,formatDate:p,arrivStampUpload:m,immigEmpUpload:u,reEntryUpload:h,mainRef:x}=e;const[g,v]=(0,n.useState)(null),[y,N]=(0,n.useState)(""),b=(0,n.useRef)(),D=[{name:"SAWP",data:t.swap},{name:"Doe",data:t.doe},{name:"NLMS",data:t.national},{name:"Bank Guarantee",data:t.bank},{name:"JITPA",data:t.jitpa},{name:"Labour Deposit",data:t.labourDeposit},{name:"Immigration",data:t.immigration}],j=()=>{v(null)},A=(0,Ir.useReactToPrint)({content:()=>b.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete"),pageStyle:"\n          @page {    \n            height:  714px;\n            padding: 22px, 0px, 22px, 0px;    \n          }\n        "}),w=e=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",p(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});N(t.url.href),v(e)}catch(t){console.error("Error fetching the file URL:",t)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),g===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"py-6 fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg shadow-lg w-[40vw] max-h-full flex flex-col",children:[(0,i.jsx)("div",{ref:b,className:"flex-grow overflow-y-auto",children:(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:y||""})})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:j,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:y,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:A,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})}),g===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsxs)("div",{className:"relative mt-4",children:[(0,i.jsx)("div",{ref:b,children:(0,i.jsx)("img",{src:y,alt:"Document Preview",className:"w-full h-auto"})}),(0,i.jsx)("div",{className:"absolute top-2 right-2",children:(0,i.jsx)("button",{onClick:c,className:"bg-red-600 text-black px-3 py-1 rounded-full text-sm hover:bg-red-800",children:(0,i.jsx)(Tt.QCr,{})})}),(0,i.jsxs)("div",{className:"flex items-center justify-center gap-6 py-4",children:[(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:[(0,i.jsx)("a",{href:y,download:!0,children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]})}),(0,i.jsx)("div",{className:"mt-2 flex",children:(0,i.jsxs)("button",{onClick:A,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})]},t)))}),S=(e,t)=>{const a=e&&e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(t){return console.error("Error parsing document data:",t),[]}})(e[0]):[];return(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),a.length>0?w(a):(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4 border border-gray-200",children:(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents available"})})]})},E=e=>{const t=e=>"string"!==typeof e||"N/A"===e?"N/A":e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" ");return(0,i.jsx)("div",{className:"grid grid-cols-3 gap-y-4 items-center font-semibold text-sm",children:Object.entries(e).map(((e,a)=>{let[r,s]=e;return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("span",{className:"text-dark_grey",children:r}),(0,i.jsx)("span",{className:"text-center text-gray-700",children:":"}),(0,i.jsx)("span",{className:"text-dark_grey",children:Array.isArray(s)?s.length>0?s.map(((e,t,a)=>{var r;return null===e||void 0===e||""===e?"N/A":e.toLowerCase()===(null===(r=a[t-1])||void 0===r?void 0:r.toLowerCase())?null:e})).filter(((e,t,a)=>null!==e)).reduce(((e,t)=>("N/A"===t&&"N/A"!==e[e.length-1]?e.push("N/A"):"N/A"!==t&&e.push(t),e)),[]).reverse().map(((e,a,r)=>(0,i.jsxs)("span",{children:[(0,i.jsxs)("span",{className:"".concat(r.length>1&&0===a?"rounded-md font-black italic":""),children:[t(e)," "]}),a<r.length-1&&(0,i.jsx)("span",{children:",\xa0"})," "]},a))):"N/A":null===s||void 0===s||""===s?"N/A":t(s)})]},a)}))})};return(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{ref:x,className:"py-8 px-10 bg-gray-50 rounded-lg",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 mb-6",children:"WorkPass Details:"}),(0,i.jsx)("div",{className:"space-y-6",children:D.map(((e,t)=>{let{name:a,data:r}=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:a}),(0,i.jsx)("div",{className:"",children:E(r)})]},t)}))})]}),(0,i.jsxs)("div",{className:"mt-8 px-10",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5  my-3",children:"Uploaded Documents:"}),S(s,"SAWP"),S(a,"DOE"),S(l,"NLMS"),S(o,"Bank Guarantee"),S(d,"JITPA"),S(r,"Labour Deposit Upload"),S(m,"Immigration Arrival"),S(u,"Immigration Approval"),S(h,"Immigration Re-Entry Visa")]})]})},Mr=e=>{var t,a,r,s;let{passingValue:l,handleFormShow:o}=e;const[d,c]=(0,n.useState)(0),[p,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),[f,v]=(0,n.useState)(1),y=(0,n.useRef)(),N=(0,n.useRef)(),b=(0,Ir.useReactToPrint)({content:()=>y.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete"),pageStyle:"\n      @page {       \n        height:  874px;\n        padding: 22px, 0px, 22px, 0px;     \n      }\n    "}),D=(0,Ir.useReactToPrint)({content:()=>N.current,onBeforePrint:()=>console.log("Preparing print for Item 2..."),onAfterPrint:()=>console.log("Print complete for Item 2"),pageStyle:"\n      @page {\n        margin: 500mm;\n      }\n      body {\n        \n      }\n      .page {\n        page-break-after: always;\n      }\n    "}),j=e=>{if(!e||!Array.isArray(e)||"string"!==typeof e[0])return{};let t=e[0];t.startsWith("{")&&t.endsWith("}")&&(t=t.slice(1,-1));return t.split(",").map((e=>e.trim())).reduce(((e,t)=>{const[a,r]=t.split("=").map((e=>e.trim()));return a&&r&&(e[a]=decodeURIComponent(r)),e}),{})},A=e=>{m(e),h(!0),v(1)},w=()=>{h(!1),m(null)},S=e=>{let{numPages:t}=e;g(t)},E=e=>{if(null===e||void 0===e)return"N/A";if(Array.isArray(e))return e.map((e=>{if(null===e||void 0===e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"N/A";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)}));const t=new Date(e);if(isNaN(t.getTime()))return"N/A";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},{empStatusType:I,bankAccNo:k,bankName:T,insuranceClaims:C,age:R,email:P,aTQualify:O,agent:_,alternateNo:M,accidentIns:F,accommodation:L,accommodationAddress:U,bankAmt:B,bankEmpUpload:q,bankEndorse:H,bankRece:W,bankRefNo:z,bankSubmit:Y,bankValid:V,bruhimsRD:G,bruhimsRNo:J,bruneiMAD:K,bruneiME:Q,bwnIcColour:$,bwnIcExpiry:Z,bwnIcNo:X,chinese:ee,cob:te,otherLang:ae,contactNo:re,contractType:ne,ctryOfOrigin:se,dependPass:ie,dob:le,doeEmpApproval:oe,doeEmpRefNo:de,doeEmpSubmit:ce,doeEmpUpload:pe,doeEmpValid:me,driveLic:ue,eduDetails:he,educLevel:xe,empBadgeNo:ge,empID:fe,empType:ve,empUpDocs:ye,familyDetails:Ne,gender:be,inducBrief:De,inducBriefUp:je,jitpaAmt:Ae,jpEmpUpload:we,jpEndorse:Ee,jpValid:Ie,lang:ke,lbrDepoAmt:Te,lbrDepoSubmit:Ce,lbrDepoUpload:Re,lbrReceiptNo:Pe,marital:Oe,myIcNo:_e,name:Me,nationalCat:Fe,nationality:Le,nlmsEmpApproval:Ue,nlmsEmpSubmit:Be,nlmsEmpSubmitRefNo:qe,nlmsEmpUpload:He,nlmsEmpValid:We,nlmsRefNo:ze,oCOfOrigin:Ye,officialEmail:Ve,otherNation:Ge,otherRace:Je,otherReligion:Ke,overMD:Qe,overME:$e,permanentAddress:Ze,permitType:Xe,ppDestinate:et,ppExpiry:tt,ppIssued:at,ppNo:rt,preEmp:nt,preEmpPeriod:st,profilePhoto:it,race:lt,religion:ot,sawpEmpLtrReci:dt,sawpEmpLtrReq:ct,sawpEmpUpload:pt,tbaPurchase:mt,uploadBwn:ut,uploadFitness:ht,uploadRegis:xt,contractEnd:gt,contractPeriod:ft,contractStart:vt,department:yt,doj:Nt,hr:bt,jobCat:Dt,jobDesc:jt,manager:At,otherDepartment:wt,otherJobCat:St,otherPosition:Et,position:It,probationEnd:kt,probationStart:Ct,relationship:Rt,salaryType:Pt,sapNo:Ot,skillPool:_t,supervisor:Mt,upgradeDate:Ft,upgradePosition:Lt,workHrs:Ut,workMonth:Bt,workStatus:qt,workWeek:Ht,annualLeave:Wt,annualLeaveDate:zt,dateLeavePass:Yt,destinateLeavePass:Vt,durLeavePass:Gt,leavePass:Jt,materLeave:Kt,mrageLeave:Qt,paterLeave:$t,sickLeave:Zt,sickLeaveDate:Xt,otherResignNotConf:ea,otherResignNotProb:ta,otherTermiNotConf:aa,otherTermiNotProb:ra,reasonResign:na,reasonTerminate:sa,resignDate:ia,resignNotConf:la,resignNotProb:oa,termiDate:da,termiNotConf:ca,termiNotProb:pa,workInfoUploads:ma,depEmp:ua,depEmpDate:ha,positionRev:xa,positionRevDate:ga,remarkWI:fa,revALD:va,revAnnualLeave:ya,revLeaveDate:Na,revLeavePass:ba,revSalary:Da,revSalaryDate:ja,uploadAL:Aa,uploadDep:wa,uploadLP:Sa,uploadPR:Ea,uploadSP:Ia,applicationUpload:ka,bwnUpload:Ta,cvCertifyUpload:Ca,qcCertifyUpload:Ra,loiUpload:Pa,myIcUpload:Oa,paafCvevUpload:_a,ppUpload:Ma,supportDocUpload:Fa,WIContract:La,WILeaveEntitle:Ua,WIProbation:Ba,WIResignation:qa,WITermination:Ha,groupIns:Wa,groupInsEffectDate:za,groupInsEndDate:Ya,travelIns:Va,empInsUpload:Ga,depInsurance:Ja,airTktStatus:Ka,reEntryVisa:Qa,immigApproval:$a,reEntryVisaExp:Za,remarkImmig:Xa,ppLocation:er,arrivStampExp:tr,immigRefNo:ar,ppSubmit:rr,empPassExp:nr,empPassStatus:sr,arrivStampUpload:ir,immigEmpUpload:lr,reEntryUpload:or,probDuration:dr,hospLeave:cr,pervAnnualLeaveBal:pr,workmenCompNo:mr,workExperience:ur}=l,hr=e=>e&&"N/A"!==e?Array.isArray(e)?e.filter((e=>e&&e.trim())).join(", "):"string"===typeof e?e.replace(/[\[\]]/g,"").split(",").map((e=>e.trim())).filter((e=>e&&"N/A"!==e)).join(", "):"N/A":"N/A";let xr=[];try{xr=Array.isArray(ur)?JSON.parse(ur[0]):[]}catch(Ur){console.error("Failed to parse workExperience:",Ur)}const gr=nt||(null!==(t=null===(a=xr[0])||void 0===a?void 0:a.name)&&void 0!==t?t:"Not Available"),fr=st||(null!==(r=xr[0])&&void 0!==r&&r.from?"".concat(E(xr[0].from)," To ").concat(null!==(s=xr[0])&&void 0!==s&&s.to?E(xr[0].to):"Present"):"Not Available");const vr={Name:Me,"Chinese character":ee,"Employee ID":fe,"Employee Badge Number":ge,"Sap Number":Ot,"Contract Type":ne,"Employee Type":function(e){if(!Array.isArray(e)||0===e.length)return"Employee type not available";const t=[...new Set(e.map((e=>e.toUpperCase())))];return 1===t.length?t[0]:t.join(", ")}(ve),Position:Array.isArray(It)&&It.length>0?It[0]:"Position not available","Date Of Birth":E(le),Age:R,Gender:be,"Marital Status":Oe,"Country of birth":te,"Country of Origin":se,"Other country of origin":Ye,"National Category":Fe,Nationality:Le,"Other Nationality":Ge,Religion:ot,"Other Religion":Ke,Race:lt,"Other Race":Je,"Brunei IC Number":X,"Brunei IC Colour":$,"Brunei IC Expiry":E(Z),"Malaysian IC Number":_e,"Passport number":rt,"Passport Issue Date":E(at),"Passport Expiry":E(tt),"Passport issued destination":et,Email:P,"Official Email":Ve,Address:Ze,"Contact No":re,"Alternate Number":M,Language:hr(ke),"Other Language":ae,"Driving License":ue,"Agent Name":(yr=_,null===yr||void 0===yr||""===yr||Array.isArray(yr)&&(0===yr.length||""===yr[0])?"N/A":yr),"Company Name of Previous Employment":gr,"Previous Employment Period":fr,"Date of Induction Briefing":E(De),"Bank name":T,"Bank account number":k};var yr;const Nr={"Education Level":xe,"Academic / Technical qualification":O},br={"Overseas Medical Fitness issued date":Qe,"Overseas Medical Fitness Expiry":$e,"Date submitted of BruHims Registration":G,"BruHims Registration Number":J,"Brunei Medical Appointment Date":K,"Brunei Medical Fitness Expiry":Q},Dr={DependPass:ie},jr={Accommodation:L,"Accommodation Address":U},Ar={"Group H&S Insurance":Wa,"Group H&S Insurance Enrollment Effective Date":E(za),"Group H&S Insurance Enrollment End Date":E(Ya),"Workmen Compensation Insurance":I,"Workmen compensation insurance policy\xa0number":mr,"Personal Accident Insurance":F,"Travelling Insurance":Va},wr={"Dependent Insurance":Ja},Sr={employeeDetails:{Department:yt,"Other Department":wt,Position:It,"Other Position":Et,"Job Category":Dt,"Other Job Category":St,"Date of Joining":E(Nt),"Job Description":jt,"Skill Pool":_t,HR:bt,Manager:At,Supervisor:Mt,"Employee Status":Rt,"Upgrade Position":Lt,"Position Upgrade Effective date":E(Ft),"Contract Period Status":ft,"Contract Start Date":E(vt),"Contract End Date":E(gt),"Probation Start Date":E(Ct),"Probation End Date":E(kt),"Probation Duration":dr,"Normal Working Hours Per Day":Ut,"Normal Working Day per Week":Ht,"Normal Working Day per Month":Bt,"Employment Work Status":qt,"Type of Salary Pay":Pt},LeaveDetails:{"Leave Passage Entitlement for Non-Local":Jt,"Date of Leave Passage Entitlement After Contract":E(Yt),"Duration Period of Leave Passage Entitlement":Gt,"Destination of Leave Passage Entitlement":Vt,"Annual Leave Entitlement":Wt,"Annual Leave Effective Date":E(zt),"Sick Leave Entitlement":Zt,"Sick Leave Effective Date":E(Xt),"Maternity Leave Entitlement":Kt,"Paternity Leave Entitlement":$t,"Marriage Leave Entitlement":Qt,"Hospitalisation Leave Entitlement":cr,"Previous Year Annual Leave Balance":pr},TerminateDetails:{"Date of Resignation":E(ia),"Resignation Notice during Probation":oa,"Other Resignation Notice Probation":ta,"Resignation Notice after Confirmation":la,"Other Resignation Notice Confirmation":ea,"Reason of Resignation":na,"Date of Termination":E(da),"Termination Notice during Probation":pa,"Other Termination Not Probation":ra,"Termination Notice after Confirmation":ca,"Other Termination Not Confirmed":aa,"Reason of Termination":sa},ServiceRoad:{"Position Revision":xa,"Position Revision Effective Date":E(ga),"Salary Package Revision":Da,"Salary Package Revision Effective Date":E(ja),"Leave Passage Revision":ba,"Leave Passage Revision Effective Date":E(Na),"Annual Leave Revison":ya,"Annual Leave Revison Effective Date":E(va),"Change of Department":ua,"Change of Department Effective Date":E(ha),"Remarks for Work Info":fa}},Mr={doe:{"Date Of Submission":E(ce),"Date Of Approval":E(oe),"Valid Until":E(me),"DOE Reference Number":de},labourDeposit:{"Labour Deposit Receipt Number":Pe,"Deposit Amount":Te,"Date Endorsement Of Labour Deposit":E(Ce)},swap:{"Client Support Letter Requested Date":E(ct),"Client Support Letter Received Date":E(dt)},national:{"Type of Work Permit Application":Xe,"Date Of Submission":E(Be),"Submission Reference Number":qe,"Date Of Approval":E(Ue),"LD Reference Number":ze,"Valid Until":E(We)},bank:{"Date Of Submission":E(Y),"Date Received":E(W),"BG Reference Number":z,"Bank Guarantee Amount":B,"Bank Guarantee Valid Until":E(V),"Date Endorsement Of BG":E(H)},jitpa:{"TBA Purchase Date":E(mt),"JITPA Amount":Ae,"Valid Until":E(Ie),"Date Endorsement Of JITPA":E(Ee)},immigration:{"Original Passport Location":er,"Date Of Arrival Stamping Expiry":E(tr),"Immigration Reference Number":hr(ar),"Passport Submit Date To Immigration Dept":E(rr),"Employment Pass Expiry":E(nr),"Employment Pass Status":sr,"Air Ticket Status":Ka,"Re-entry Visa Application":Qa,"Date Approved by Immigration Dept":E($a),"Re-Entry Visa Expiry":E(Za),"Remarks for Immigration":Xa}},Fr=j(l.uploadBwn),Lr=j(l.workInfoUploads);return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("section",{className:"bg-white flex flex-col fixed top-0 left-0 bg-grey w-full h-full z-[9999] center",children:(0,i.jsx)("div",{className:"bg-white py-10 px-10 h-screen w-[85%]",children:(0,i.jsxs)("div",{className:"empScroll border bg-white px-10 overflow-y-auto h-[90vh] space-y-5 rounded-lg w-full",children:[(0,i.jsxs)("div",{className:"bg-white mt-6 sticky top-0 flex justify-between items-center z-40",children:[(0,i.jsx)("div",{className:"max-w-[200px] w-full",children:(0,i.jsx)("img",{src:Se.A,alt:"Logo not found"})}),(0,i.jsx)("h6",{className:"text-center text-2xl font-medium text-dark_grey",children:"Employee Details"}),(0,i.jsx)("p",{onClick:o,className:"text-2xl text-dark_grey",children:(0,i.jsx)(Tt.yyx,{})})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(Er,{activeTab:d,handleTabClick:e=>{c(e)}}),(0,i.jsxs)("div",{className:"mt-5",children:[0===d&&(0,i.jsx)(kr,{personalDetails:vr,profilePhoto:it,isPdfOpen:u,viewingDocument:p,pageNumber:f,numPages:x,handleViewDocument:A,handleCloseViewer:w,onDocumentLoadSuccess:S,setPageNumber:v,inducBriefUp:je,applicationUpload:ka,bwnUpload:Ta,cvCertifyUpload:Ca,qcCertifyUpload:Ra,loiUpload:Pa,myIcUpload:Oa,paafCvevUpload:_a,ppUpload:Ma,supportDocUpload:Fa,handlePrint:b,invoiceRef:y,educationalDetails:Nr,formatDate:E,mainRef:N}),1===d&&(0,i.jsx)(Tr,{familyDetails:Ne,handlePrint:b,invoiceRef:y,formatDate:E,mainRef:N}),2===d&&(0,i.jsx)(Or,{workInfo:Sr,documentThree:Lr,isPdfOpen:u,viewingDocument:p,setViewingDocument:m,pageNumber:f,numPages:x,handleViewDocument:A,handleCloseViewer:w,onDocumentLoadSuccess:S,setPageNumber:v,uploadAL:Aa,uploadDep:wa,uploadLP:Sa,uploadPR:Ea,uploadSP:Ia,handlePrint:b,invoiceRef:y,WIContract:La,WILeaveEntitle:Ua,WIProbation:Ba,WIResignation:qa,WITermination:Ha,formatDate:E,mainRef:N}),3===d&&(0,i.jsx)(_r,{workPass:Mr,doeEmpUpload:pe,lbrDepoUpload:Re,sawpEmpUpload:pt,nlmsEmpUpload:He,bankEmpUpload:q,jpEmpUpload:we,isPdfOpen:u,viewingDocument:p,pageNumber:f,numPages:x,handleViewDocument:A,handleCloseViewer:w,onDocumentLoadSuccess:S,setPageNumber:v,inducBriefUp:je,handlePrint:b,invoiceRef:y,formatDate:E,arrivStampUpload:ir,immigEmpUpload:lr,reEntryUpload:or,mainRef:N}),4===d&&(0,i.jsx)(Cr,{medicalInfo:br,dependenPass:Dr,uploadFitness:ht,uploadBwn:ut,documentsTwo:Fr,uploadRegis:xt,handlePrint:b,invoiceRef:y,dependPass:ie,formatDate:E,mainRef:N}),5===d&&(0,i.jsx)(Pr,{insuranceInfo:Ar,DependentInsurance:wr,InsuranceClaim:C,handlePrint:b,invoiceRef:y,depInsurance:Ja,empInsUpload:Ga,formatDate:E,mainRef:N}),6===d&&(0,i.jsx)(Rr,{accommodationInfo:jr,handlePrint:b,invoiceRef:y,mainRef:N})]}),(0,i.jsx)("div",{className:"flex justify-center py-6",children:(0,i.jsxs)("button",{onClick:D,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2 ",children:["Print",(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})})]})]})})})})};var Fr=a(5200);const Lr=()=>{const{userData:e,empLeaveStatusData:t,educDetailsData:a,empPDData:r,empPIData:l,IDData:o,workInfoData:d,terminateData:c,leaveDetailsData:p,SRData:m,DNData:u,BJLData:h,PPValidsData:x,LMIData:f,EmpInsuranceData:v,depInsuranceData:y,NLAData:N,SawpDetails:b,insuranceClaimsData:D,candyToEmp:A}=(0,n.useContext)(s.Y),[w,S]=(0,n.useState)([]),[E,I]=(0,n.useState)([]),[k,T]=(0,n.useState)(!0),[C,R]=(0,n.useState)(null),[P,O]=(0,n.useState)(!1),[_,M]=(0,n.useState)([]),[F,L]=(0,n.useState)(!0),[U,B]=(0,n.useState)(1),[q,H]=(0,n.useState)(30),[W,z]=(0,n.useState)([]),[Y,V]=(0,n.useState)([]),G=e=>Array.isArray(e)?e[e.length-1]:e;(0,n.useEffect)((()=>{if(e&&t&&a&&r&&l&&o&&d&&c&&p&&m&&u&&h&&x&&f&&v&&y&&N&&b&&D&&A){const n=l.map((n=>{const s=o.find((e=>e.empID===n.empID))||{},i=r.find((e=>e.empID===n.empID))||{},l=u.find((e=>e.empID===n.empID))||{},j=h.find((e=>e.empID===n.empID))||{},w=x.find((e=>e.empID===n.empID))||{},S=f.find((e=>e.empID===n.empID))||{},E=v.find((e=>e.empID===n.empID))||{},I=y.find((e=>e.empID===n.empID))||{},k=N.find((e=>e.empID===n.empID))||{},T=c.find((e=>e.empID===n.empID))||{},C=p.find((e=>e.empID===n.empID))||{},R=m.find((e=>e.empID===n.empID))||{},P=t.find((e=>e.empID===n.empID))||{},O=a.find((e=>e.empID===n.empID))||{},_=d.find((e=>e.empID===n.empID))||{},M=e.find((e=>e.empID===n.empID))||{},F=b.find((e=>e.empID===n.empID))||{},L=D.find((e=>e.empID===n.empID))||{},U=A.find((e=>e.empID===n.empID))||{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},s),i),l),j),w),S),E),I),k),T),C),R),P),O),_),M),F),L),n),U),{},{position:_.position})})).filter((e=>null===e||void 0===e?void 0:e.empID)).reduce(((e,t)=>(e.some((e=>e.empID===t.empID))||e.push(t),e)),[]).sort(((e,t)=>e.empID.localeCompare(t.empID)));S(n),I(n),n.length>0?(T(!1),R(null)):T(!0)}else R("No data found.")}),[e,t,a,o,d,c,p,m,u,h,x,f,v,y,N,b,D,r,l,A]);if((0,n.useEffect)((()=>{const e=(U-1)*q,t=E.slice(e,e+q);z(t),t.length>0&&L(!1)}),[E,U,q]),F)return(0,i.jsx)("div",{className:"flex items-center justify-center h-[82vh] bg-transparent",children:(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading "}),(0,i.jsx)("p",{children:(0,i.jsx)(Fr.TwU,{className:"animate-spin mt-[4px]",size:15})})]})});const J=e=>{O(!P),M(e)},K=e=>{const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)};return(0,i.jsxs)("section",{className:"bg-[#F5F6F1CC] w-full flex items-center flex-col h-screen pt-14",children:[(0,i.jsxs)("div",{className:"w-full px-10 flex justify-between items-center mb-10",children:[(0,i.jsx)("div",{className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold",children:"All Employee Details"}),(0,i.jsxs)("div",{className:"flex items-center space-x-4 ",children:[(0,i.jsx)("div",{className:"relative",children:(0,i.jsx)(ga,{type:"text",placeholder:"Emp ID or Badge No or Name",allEmpDetails:w,searchUserList:I,className:"py-2 px-4",searchIcon2:(0,i.jsx)(j.zfp,{})})}),(0,i.jsxs)("select",{className:"py-2.5 px-2 border border-lite_grey focus:outline-none focus:ring-0",onChange:e=>{const t=e.target.value.toLowerCase();if("all"===t)I(w);else{const e=w.filter((e=>{var a,r,n,s;const i=null===(a=G(e.contractType))||void 0===a?void 0:a.toLowerCase(),l=null===(r=G(e.empType))||void 0===r?void 0:r.toLowerCase(),o=null===(n=G(e.workStatus))||void 0===n?void 0:n.toLowerCase(),d=null===(s=G(e.nationality))||void 0===s?void 0:s.toLowerCase();switch(t){case"local":return["bruneian","brunei pr"].includes(d);case"foreigner":return d&&!["bruneian","brunei pr"].includes(d);case"lpa":return"lpa"===i;case"sawp":return"sawp"===i;case"onshore":return"onshore"===l;case"offshore":return"offshore"===l;case"active":case"probationary":case"resignation":case"termination":return o===t;default:return!1}}));I(e)}},children:[(0,i.jsx)("option",{value:"All",children:"All"}),(0,i.jsx)("option",{value:"Local",children:"Local"}),(0,i.jsx)("option",{value:"Foreigner",children:"Foreigner"}),(0,i.jsx)("option",{value:"LPA",children:"LPA"}),(0,i.jsx)("option",{value:"SAWP",children:"SAWP"}),(0,i.jsx)("option",{value:"OnShore",children:"OnShore"}),(0,i.jsx)("option",{value:"OffShore",children:"OffShore"}),(0,i.jsx)("option",{value:"Active",children:"Active"}),(0,i.jsx)("option",{value:"Probationary",children:"Probationary"}),(0,i.jsx)("option",{value:"Resignation",children:"Resignation"}),(0,i.jsx)("option",{value:"Termination",children:"Termination"})]})]})]}),(0,i.jsx)("div",{className:"overflow-x-auto mt-8 max-w-[100%] px-6",children:(0,i.jsx)("div",{className:"allEmployeeTable w-full max-h-[calc(70vh-7rem)] overflow-y-auto rounded-xl",children:(0,i.jsxs)("table",{className:"w-full rounded-xl table-auto",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-center text-white sticky top-0",children:(0,i.jsxs)("tr",{className:"",children:[(0,i.jsx)("th",{className:"py-4 px-2",children:"S.No"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Employee ID"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Badge No"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Name"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"DOB"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Nationality"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Contract"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Type"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Email"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Contact No"}),(0,i.jsx)("th",{className:"py-4 px-2",children:"Status"})]})}),(0,i.jsx)("tbody",{className:"bg-white text-center text-sm font-semibold text-dark_grey cursor-pointer",children:W.length>0?W.map(((e,t)=>{var a,r,n,s;const l=(U-1)*q+t+1;return(0,i.jsxs)("tr",{className:"border-b-2 bg-white border-[#C7BCBC] text-[13px] text-[#303030] hover:bg-medium_blue",onClick:()=>{J(e)},children:[(0,i.jsx)("td",{className:"py-4 px-4 max-w-[50px] min-w-[50px]  overflow-hidden",children:l}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:(null===e||void 0===e?void 0:e.empID)||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:(null===e||void 0===e?void 0:e.empBadgeNo)||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px] break-words overflow-hidden ",children:(null===e||void 0===e?void 0:e.name)||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:K((null===e||void 0===e?void 0:e.dob)||"N/A")}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:(null===e||void 0===e?void 0:e.nationality)||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:(null===e||void 0===e||null===(a=e.contractType)||void 0===a?void 0:a[e.contractType.length-1])||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:(null===e||void 0===e||null===(r=e.empType)||void 0===r?void 0:r[e.empType.length-1])||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px] break-words  overflow-hidden",children:(null===e||void 0===e?void 0:e.email)||"N/A"}),(0,i.jsx)("td",{className:"py-4 px-4 max-w-[150px] min-w-[150px]  overflow-hidden",children:(null===e||void 0===e?void 0:e.contactNo)||"N/A"}),(0,i.jsx)("td",{className:"uppercase py-4 px-4 font-bold max-w-[150px] min-w-[150px] ".concat((o=(null===e||void 0===e||null===(n=e.workStatus)||void 0===n?void 0:n[(null===e||void 0===e?void 0:e.workStatus.length)-1])||"N/A",{active:"text-[green]",probationary:"text-[#E8A317]",resignation:"text-red",termination:"text-[red]"}[null===o||void 0===o?void 0:o.toLowerCase()]||"text-medium_grey")),children:(null===e||void 0===e||null===(s=e.workStatus)||void 0===s?void 0:s[(null===e||void 0===e?void 0:e.workStatus.length)-1])||"N/A"})]},t);var o})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"11",className:"py-4 px-4 text-center",children:"No data available"})})})]})})}),P&&(0,i.jsx)(Mr,{passingValue:_,handleFormShow:J}),(0,i.jsx)("div",{className:"flex justify-center items-center w-full",children:W.length>0&&(0,i.jsx)("div",{className:"flex mt-12 px-8",children:(0,i.jsx)(oa,{currentPage:U,totalPages:Math.ceil(E.length/q),onPageChange:e=>{e>=1&&e<=Math.ceil(E.length/q)&&B(e)}})})})]})},Ur=e=>new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e),Br=ka.Ik().shape({name:ka.Yj().required("Name is mandatory"),relationship:ka.Yj().required("Relationship is mandatory"),contact:ka.Yj().required("Contact Number is mandatory"),address:ka.Yj().required("Address is mandatory")}),qr=ka.Ik().shape({depenInsType:ka.Yj().required("Insurance type is required"),depenInfo:ka.Yj().required("Dependent information is required"),depenName:ka.Yj().required("Name is required"),depenRelation:ka.Yj().required("Relationship is required"),depenGender:ka.Yj().required("Gender is required"),depenIcNumber:ka.Yj().notRequired(),depenDob:ka.Yj().required("Date of Birth is required"),depenNation:ka.Yj().required("Nationality is required"),depenPpNo:ka.Yj().notRequired(),depenBcNo:ka.Yj().required("Birth Certificate number is required for non-locals"),depenGroupInsEffect:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),depenGroupInsEnd:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),depenTravelInsEffect:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),depenTravelInsEnd:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),depenPersonInsEffect:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),depenPersonInsEnd:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),depenotherNation:ka.Yj().when("depenNation",{is:"Other",then:ka.Yj().required("Other nationality is required"),otherwise:ka.Yj().notRequired()}),depenInfUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),Hr=e=>ka.gl().test("is-valid-family-details","Invalid family details",(e=>{if("string"===typeof e)try{const t=JSON.parse(e);return!!Array.isArray(t)&&t.every((e=>qr.isValidSync(e)))}catch(t){return!1}else if(Array.isArray(e))return ka.YO().of(Br).isValidSync(e);return!1})),Wr=(ka.Yj().matches(/^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[0-2])-\d{4}$/,"Date must be in the format dd-mm-yyyy").notRequired().test("is-valid-date","Invalid date format",(e=>{if(!e)return!0;const[t,a,r]=e.split("-"),n=new Date("".concat(r,"-").concat(a,"-").concat(t));return!isNaN(n.getTime())})),ka.Ik().shape({empID:ka.Yj().required("Employee ID Number is mandatory"),empBadgeNo:ka.Yj().notRequired(),name:ka.Yj().notRequired(),accommodation:ka.Yj().notRequired(),accommodationAddress:ka.Yj().notRequired()})),zr=ka.Ik().shape({empID:ka.Yj().required("Employee ID is mandatory"),overMD:ka.Yj().notRequired(),overME:ka.Yj().notRequired(),bruhimsRD:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),bruhimsRNo:ka.Yj().notRequired(),bruneiMAD:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),bruneiME:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),uploadFitness:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),uploadRegis:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),uploadBwn:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(null===e||void 0===e?void 0:e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),dependPass:ka.YO().of(ka.Ik().shape({dependName:ka.Yj().notRequired(),dependPpNo:ka.Yj().notRequired(),dependPpE:ka.Yj().notRequired(),relation:ka.Yj().notRequired(),labourDPBy:ka.Yj().notRequired(),labourDRNo:ka.Yj().notRequired(),labourDAmount:ka.Yj().notRequired().test("is-number","Only numbers are allowed",(e=>!e||/^[0-9]+$/.test(e))),uploadDp:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e)))).notRequired(),uploadDr:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e)))).notRequired()}))}),Yr=ka.Ik().shape({empID:ka.Yj().required("Employee ID is mandatory"),department:ka.Yj().required("Department is mandatory"),otherDepartment:ka.Yj().notRequired(),position:ka.Yj().required("Position is mandatory"),otherPosition:ka.Yj().notRequired(),jobCat:ka.Yj().required("Job Category is mandatory"),otherJobCat:ka.Yj().notRequired(),doj:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("Date of Join is mandatory").max(new Date,"Date of Join cannot be in the future").test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),jobDesc:ka.Yj().required("Job Description is mandatory"),skillPool:ka.Yj().required("Skill Pool is mandatory"),hr:ka.Yj().notRequired(),manager:ka.Yj().required("Manager is mandatory"),supervisor:ka.Yj().notRequired(),relationship:ka.Yj().required("Employee Status is mandatory"),upgradePosition:ka.Yj().notRequired(),upgradeDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),contractPeriod:ka.Yj().notRequired(),contractStart:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),contractEnd:ka.Yj().notRequired().test("is-after-contractStart","Contract End date must be after Contract Start date",(function(e){const{contractStart:t}=this.parent;if(!t||!e)return!0;const a=new Date(t);return new Date(e)>a})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),workStatus:ka.Yj().required("Employment Work Status is required").notOneOf([""],"Employment Work Status is mandatory"),probationStart:ka.Yj().notRequired().test("is-on-or-after-doj-or-contract-start","Probation Start date must be the same as or after Date of Joining ",(function(e){const{doj:t}=this.parent;if(!t||!e)return!0;const a=new Date(t);return new Date(e)>=a})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),probationEnd:ka.Yj().notRequired().test("is-after-probationStart","Probation End date must be after Probation Start date",(function(e){const{probationStart:t}=this.parent;if(!t||!e)return!0;const a=new Date(t);return new Date(e)>a})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),probDuration:ka.Yj().notRequired(),workHrs:ka.Yj().required("Normal Working Hours mandatory"),workWeek:ka.Yj().required("Normal Working Week mandatory"),workMonth:ka.Yj().required("Normal Working Month mandatory"),salaryType:ka.Yj().required("Type of Salary Pay is mandatory").notOneOf([""],"Type of Salary Pay is mandatory"),pervAnnualLeaveBal:ka.Yj().notRequired(),resignDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),termiDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),resignNotProb:ka.Yj().notRequired(),otherResignNotProb:ka.Yj().notRequired(),termiNotProb:ka.Yj().notRequired(),otherTermiNotProb:ka.Yj().notRequired(),resignNotConf:ka.Yj().notRequired(),otherResignNotConf:ka.Yj().notRequired(),termiNotConf:ka.Yj().notRequired(),otherTermiNotConf:ka.Yj().notRequired(),reasonResign:ka.Yj().notRequired(),reasonTerminate:ka.Yj().notRequired(),leavePass:ka.Yj().notRequired(),dateLeavePass:ka.Yj().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),destinateLeavePass:ka.Yj().notRequired(),durLeavePass:ka.Yj().notRequired(),annualLeave:ka.Yj().notRequired(),annualLeaveDate:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),sickLeave:ka.Yj().notRequired(),sickLeaveDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),materLeave:ka.Yj().notRequired(),paterLeave:ka.Yj().notRequired(),mrageLeave:ka.Yj().notRequired(),WIProbation:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),WIResignation:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),WITermination:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),WILeaveEntitle:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),WIContract:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),positionRev:ka.Yj().notRequired(),positionRevDate:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),revSalary:ka.Yj().notRequired(),revSalaryDate:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),revLeavePass:ka.Yj().notRequired(),revLeaveDate:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),revAnnualLeave:ka.Yj().notRequired(),revALD:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),depEmp:ka.Yj().notRequired(),depEmpDate:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),remarkWI:ka.Yj().notRequired(),uploadPR:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),uploadSP:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),uploadLP:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),uploadAL:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),uploadDep:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),Vr=ka.Ik().shape({empID:ka.Yj().required("Employee ID Number is mandatory"),profilePhoto:ka.Yj().required("Upload Photo is mandatory"),contractType:ka.Yj().required("Contract Type is mandatory"),empType:ka.Yj().required("Employee Type is mandatory"),name:ka.Yj().min(3,"Name must be at least 3 characters").matches(/[A-Za-z\s]/,"Name cannot contain numbers or special characters").required("Name is mandatory"),gender:ka.Yj().required("Gender is mandatory"),dob:ka.Yj().required("Date of Birth is mandatory").test("age","You must be at least 15 years old",(e=>{if(!e)return!1;const t=new Date,a=new Date(e),r=t.getFullYear()-a.getFullYear(),n=t.getMonth()-a.getMonth(),s=t.getDate()-a.getDate();return r>15||15===r&&(n>0||0===n&&s>=0)})),email:ka.Yj().email("Please enter a valid email").matches(/^[^\s]+@[^\s]+\.[^\s]{2,}$/,"Email must not contain whitespace or invalid characters").matches(/^[^.@]+(\.[^.@]+)*@[^.]+(\.[^.]+)*\.[a-z]{2,}$/,"Email must not contain consecutive dots").matches(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"Email must conform to standard email format").matches(/^[^\\/]+$/,"Email must not contain forward or backward slashes").matches(/^[^\s]+$/,"Email must not contain whitespace").required("Email is required"),officialEmail:ka.Yj().email("Please enter a valid email").notRequired().matches(/^[^\s]+@[^\s]+\.[^\s]{2,}$/,"Email must not contain whitespace or invalid characters").matches(/^[^.@]+(\.[^.@]+)*@[^.]+(\.[^.]+)*\.[a-z]{2,}$/,"Email must not contain consecutive dots").matches(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"Email must conform to standard email format").matches(/^[^\\/]+$/,"Email must not contain forward or backward slashes").matches(/^[^\s]+$/,"Email must not contain whitespace"),nationality:ka.Yj().required("Nationality is mandatory"),otherNation:ka.Yj().notRequired(),religion:ka.Yj().required("Religion is mandatory"),marital:ka.Yj().required("Marital status is mandatory"),race:ka.Yj().required("Race is mandatory"),otherRace:ka.Yj().notRequired(),bwnIcNo:ka.Yj().notRequired(),bwnIcColour:ka.Yj().notRequired(),bwnIcExpiry:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired(),myIcNo:ka.Yj().notRequired(),ppNo:ka.Yj().notRequired(),ppIssued:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-not-future-date","Future Date Not Allowed",(function(e){return!e||new Date(e)<=new Date})),ppExpiry:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-future-date","Only Future Dates Allowed",(function(e){return!e||new Date(e)>new Date})),ppDestinate:ka.Yj().notRequired(),contactNo:ka.Yj().required("Contact Number is mandatory"),permanentAddress:ka.Yj().required("Address is mandatory"),empBadgeNo:ka.Yj().required("Employee Badge Number is mandatory"),sapNo:ka.Yj().notRequired(),nationalCat:ka.Yj().required("National Category is mandatory"),ctryOfOrigin:ka.Yj().required("Country of Origin is mandatory"),oCOfOrigin:ka.Yj().notRequired(),educLevel:ka.Yj().required("Education Level is mandatory"),aTQualify:ka.Yj().required("Academic / Technical qualification is mandatory"),familyDetails:ka.gl().test("is-valid-family-details","Invalid family details",(function(e){const{path:t,createError:a}=this;return!!ka.gl().test("is-valid-family-details","Invalid family details",(e=>{if("string"===typeof e)try{const t=JSON.parse(e);return!!Array.isArray(t)&&t.every((e=>Br.isValidSync(e)))}catch(t){return!1}else if(Array.isArray(e))return ka.YO().of(Br).isValidSync(e);return!1}))||a({path:t,message:"Invalid family details format or content"})})),inducBrief:ka.Yj().required("Induction Briefing Date is mandatory").test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),inducBriefUp:ka.Yj().notRequired(),preEmp:ka.Yj().notRequired(),preEmpPeriod:ka.Yj().notRequired(),bankName:ka.Yj().notRequired(),bankAccNo:ka.Yj().notRequired(),bwnUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),applicationUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),cvCertifyUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),loiUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),myIcUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),paafCvevUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),ppUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),supportDocUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),Gr=ka.Ik().shape({empID:ka.Yj().required("Employee ID Number is mandatory"),empBadgeNo:ka.Yj().required("Employee Badge is required"),name:ka.Yj().required("Employee Name is required"),department:ka.Yj().required("Department is required"),groupInsEffectDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),groupInsEndDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),empInsUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),Jr=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),depInsurance:ka.gl().test("is-valid-family-details","Invalid family details",(function(e){const{path:t,createError:a}=this;return!!Hr()||a({path:t,message:"Invalid family details format or content"})}))}),Kr=ka.Ik().shape({typeIns:ka.Yj().required("Type Insurance is required"),insDetails:ka.YO().of(ka.Ik().shape({company:ka.Yj().required("Insurance company is required")}))}),Qr=ka.Ik().shape({groupHSNo:ka.Yj().required("Group HS Number is required"),groupHSExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),groupHSUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),$r=ka.Ik().shape({empStatusType:ka.Yj().required("Employee Status Type is required"),workmenCompNo:ka.Yj().notRequired(),workmenCompExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),workmenComUp:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),Zr=ka.Ik().shape({travelNo:ka.Yj().required("Travelling Number is required"),travelExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),travelUp:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),Xr=ka.Ik().shape({perAccNo:ka.Yj().required("Personal Number is required"),perAccExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),perAccUp:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),en=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),insuranceClaims:ka.gl().test("is-valid-family-details","Invalid family details",(function(e){const{path:t,createError:a}=this;return!!Hr()||a({path:t,message:"Invalid family details format or content"})}))}),tn=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),sawpEmpLtrReq:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("Requested Date is required").test("is-not-future-date","Future Date Not Allowed",(e=>!e||e<=new Date)).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),sawpEmpLtrReci:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-requested-date","Received Date cannot be before the Requested Date",(function(e){const{sawpEmpLtrReq:t}=this.parent;return!e||!t||e>=t})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),sawpEmpUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),an=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),doeEmpSubmit:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("Submission Date is required").test("is-not-future-date","Future Date Not Allowed",(function(e){return!e||new Date(e)<=new Date})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),doeEmpApproval:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-submission-date","Approval Date Must Be After Submitted Date",(function(e){const{doeEmpSubmit:t}=this.parent;return!e||!t||new Date(e)>=new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),doeEmpValid:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-approval-date","Expiry Date Must Be After Approval Date",(function(e){const{doeEmpApproval:t}=this.parent;return!e||!t||new Date(e)>=new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),doeEmpRefNo:ka.Yj().notRequired(),doeEmpUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),rn=ka.Ik().shape({empID:ka.Yj().required("Employee ID is Required"),permitType:ka.Yj().required("Permit Type Required"),nlmsEmpSubmit:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("Submission Date is Required").test("is-not-future-date","Future Date Not Allowed",(e=>!e||new Date(e)<=new Date)).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),nlmsEmpSubmitRefNo:ka.Yj().notRequired(),nlmsEmpApproval:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-submission","Approval Date Must Be After Submitted Date",(function(e){const{nlmsEmpSubmit:t}=this.parent;return!e||!t||new Date(e)>=new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),nlmsRefNo:ka.Yj().notRequired(),nlmsEmpValid:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-approval","Expiry Date Must Be After Approval Date",(function(e){const{nlmsEmpApproval:t}=this.parent;return!e||!t||new Date(e)>=new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),nlmsEmpUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),nn=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),bankSubmit:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("Submission Date is required").test("is-not-future-date","Future Date Not Allowed",(function(e){return!e||new Date(e)<=new Date})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),bankRece:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-submission-date","Approval Date Must Be After Submission Date",(function(e){const{bankSubmit:t}=this.parent;return!e||!t||new Date(e)>=new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),bankRefNo:ka.Yj().notRequired(),bankAmt:ka.Yj().notRequired(),bankValid:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-approval-date","Valid Until Date Must Be After Approval Date",(function(e){const{bankRece:t}=this.parent;return!e||!t||new Date(e)>=new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),bankEndorse:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-submission-date","Endorsement Date must be after Submission Date",(function(e){const{bankSubmit:t}=this.parent;return!e||!t||new Date(e)>new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),bankEmpUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),sn=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),tbaPurchase:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("TBA Purchase Date is required").test("is-not-future-date","Future Date Not Allowed",(e=>!e||new Date(e)<=new Date)).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),jitpaAmt:ka.Yj().notRequired(),jpValid:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-not-past-date","Valid Until Date must be in the future",(e=>!e||new Date(e)>new Date)).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),jpEndorse:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-after-purchase-date","Endorsement Date must be after TBA Purchase Date",(function(e){const{tbaPurchase:t}=this.parent;return!e||!t||new Date(e)>new Date(t)})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),jpEmpUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),ln=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),lbrReceiptNo:ka.Yj().required("Labour Deposit Receipt Number is required"),lbrDepoAmt:ka.Yj().required("Deposit Amount is required").min(0,"Deposit Amount must be greater than or equal to 0"),lbrDepoSubmit:ka.p6().nullable().transform(((e,t)=>""===t?null:e)).required("Submit Date is required").test("is-not-future-date","Future Date Not Allowed",(function(e){return!e||new Date(e)<=new Date})).test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),lbrDepoUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),on=ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),ppLocation:ka.Yj().oneOf(["HRD","Immigration","Employee","Vacation"],"Invalid passport location").required("Passport location is required"),arrivStampUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),immigEmpUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),reEntryUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired(),arrivStampExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),immigRefNo:ka.Yj().nullable().transform(((e,t)=>""===t?null:e)),ppSubmit:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),empPassExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),empPassStatus:ka.Yj().nullable().transform(((e,t)=>""===t?null:e)),airTktStatus:ka.Yj().oneOf(["Company","Own"],"Invalid air ticket status").nullable().transform(((e,t)=>""===t?null:e)),reEntryVisa:ka.Yj().oneOf(["Single","Multiple"],"Invalid re-entry visa type").nullable().transform(((e,t)=>""===t?null:e)),immigApproval:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),reEntryVisaExp:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;const t=e instanceof Date?e.toISOString().split("T")[0]:e;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const[a,r,n]=t.split("-");if(4!==a.length)return!1;if(a.startsWith("0")&&"0000"!==a)return!1;const s=parseInt(r,10),i=parseInt(n,10);return!(s<1||s>12||i<1||i>31)})),remarkImmig:ka.Yj().max(500,"Remarks can't exceed 500 characters").nullable().transform(((e,t)=>""===t?null:e))}),dn=async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=(await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result).path,i=(new Date).toISOString().split("T")[0];"number"===typeof n&&a((e=>{const a=(0,g.A)({},e);a[t]=a[t]||[],a[t][n]=a[t][n]||[];return a[t][n].find((e=>e.upload===s))||a[t][n].push({upload:s,date:i}),a})),a((e=>(0,g.A)((0,g.A)({},e),{},{[t]:[...e[t]||[],{upload:s,date:i}]})))}}catch(s){}},cn=e=>{let{register:t,errors:a,watch:r,setValue:n,control:s}=e;const l=r("sapNo"),o=r("empBadgeNo");r("contractType"),r("empType");return(0,i.jsxs)("div",{className:"form-group grid grid-cols-1 md:grid-cols-4 gap-5",children:[(0,i.jsx)(mt,{label:"Badge Number",register:t,watch:o,name:"empBadgeNo",errors:a}),(0,i.jsx)(mt,{label:"SAP Number",register:t,watch:l,name:"sapNo",errors:a}),(0,i.jsx)(mt,{label:"Contract Type",register:t,name:"contractType",type:"select",options:Nt,errors:a}),(0,i.jsx)(mt,{label:"Employee Type",register:t,name:"empType",type:"select",options:Dt,errors:a})]})},pn=e=>{let{register:t,errors:a}=e;return(0,i.jsxs)("div",{className:"form-group grid grid-cols-1 md:grid-cols-3 gap-5",children:[(0,i.jsx)(mt,{label:"Name",register:t,name:"name",type:"text",errors:a}),(0,i.jsx)(mt,{label:"Gender",register:t,name:"gender",type:"select",options:ht,errors:a}),(0,i.jsx)(mt,{label:"Date of Birth",register:t,name:"dob",type:"date",errors:a})]})},mn=e=>{var t,a;let{register:r,errors:n,handleRaceChange:s,handleRelegianChange:l,selectedRace:o,selectedReligion:d,watch:c,dropDownVal:p}=e;const m=null===(t=p[0])||void 0===t?void 0:t.religionDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),u=null===(a=p[0])||void 0===a?void 0:a.raceDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),h=c("race"),x=c("religion"),g=c("otherRace"),f=c("otherReligion");return(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 form-group",children:[(0,i.jsxs)("div",{className:"flex items-center gap-5",children:[(0,i.jsx)(mt,{label:"Religion",register:r,name:"religion",type:"select",options:m,onChange:l,errors:n}),("OTHERS"===d||f&&"OTHERS"===x)&&(0,i.jsx)(mt,{label:"Other Religion",register:r,name:"otherReligion",type:"text",watch:f,errors:n,placeholder:"Enter Other Religion"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-5",children:[(0,i.jsx)(mt,{label:"Race",register:r,name:"race",type:"select",watch:h,options:u,errors:n,onChange:s}),("OTHER"===o||g&&"OTHER"===h)&&(0,i.jsx)(mt,{label:"Other Race",register:r,name:"otherRace",type:"text",watch:g,errors:n,placeholder:"Enter Race"})]})]})},un=e=>{let{register:t,errors:a,dropDownVal:r}=e;return(0,i.jsxs)("div",{className:"form-group grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,i.jsx)(mt,{label:"National Category",register:t,name:"nationalCat",type:"select",options:ft,errors:a}),(0,i.jsx)(mt,{label:"Marital Status",register:t,name:"marital",type:"select",options:vt,errors:a})]})},hn=e=>{var t,a;let{register:r,errors:n,handleNationalityChange:s,handleCountryChange:l,selectedNationality:o,selectedCountry:d,watch:c,dropDownVal:p}=e;const m=c("oCOfOrigin"),u=c("otherNation"),h=c("nationality"),x=c("ctryOfOrigin"),g=null===(t=p[0])||void 0===t?void 0:t.nationalityDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),f=null===(a=p[0])||void 0===a?void 0:a.countryORDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})));return(0,i.jsxs)("div",{className:"flex gap-5 form-group",children:[(0,i.jsxs)("div",{className:"flex flex-1 gap-7",children:[(0,i.jsx)(mt,{label:"Nationality",register:r,name:"nationality",type:"select",options:g,errors:n,onChange:s}),("OTHER"===o||u&&"OTHER"===h)&&(0,i.jsx)(mt,{label:"Other Nationality",register:r,name:"otherNation",type:"text",errors:n})]}),(0,i.jsxs)("div",{className:"flex flex-1 gap-7",children:[(0,i.jsx)(mt,{label:"Country of Origin",register:r,name:"ctryOfOrigin",type:"select",options:f,errors:n,onChange:l}),("OTHER"===d||m&&"OTHER"===x)&&(0,i.jsx)(mt,{label:"Other Country of Origin",register:r,name:"oCOfOrigin",type:"text",errors:n})]})]})},xn=e=>{let{register:t,errors:a}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-4 gap-5 form-group",children:[(0,i.jsx)(mt,{label:"Brunei IC Number",register:t,name:"bwnIcNo",type:"text",errors:a}),(0,i.jsx)(mt,{label:"Brunei IC Colour",register:t,name:"bwnIcColour",type:"select",options:jt,errors:a}),(0,i.jsx)(mt,{label:"Brunei IC Expiry",register:t,name:"bwnIcExpiry",type:"date",errors:a}),(0,i.jsx)(mt,{label:"Malaysian IC Number",register:t,name:"myIcNo",type:"text",errors:a})]})},gn=e=>{let{register:t,errors:a}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-4 gap-5 form-group",children:[(0,i.jsx)(mt,{label:"Passport Number",register:t,name:"ppNo",type:"text",errors:a}),(0,i.jsx)(mt,{label:"Passport Issue Date",register:t,name:"ppIssued",type:"date",errors:a}),(0,i.jsx)(mt,{label:"Passport Expiry",register:t,name:"ppExpiry",type:"date",errors:a}),(0,i.jsx)(mt,{label:"Passport issued destination",register:t,name:"ppDestinate",type:"text",errors:a})]})},fn=e=>{var t;let{register:a,errors:r,dropDownVal:n}=e;const s=null===(t=n[0])||void 0===t?void 0:t.educLevelDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})));return(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-5 form-group",children:[(0,i.jsx)(mt,{label:"Academic / Technical qualification",register:a,name:"aTQualify",type:"text",errors:r}),(0,i.jsx)(mt,{label:"Education Level",register:a,name:"educLevel",type:"select",options:s,errors:r}),(0,i.jsx)(mt,{label:"Contact Number",register:a,name:"contactNo",type:"text",errors:r})]})},vn=e=>{let{register:t,errors:a}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-5 form-group",children:[(0,i.jsx)(mt,{label:"Email Address",type:"email",name:"email",register:t,errors:a}),(0,i.jsx)(mt,{label:"Official Email Address",type:"email",name:"officialEmail",register:t,errors:a}),(0,i.jsx)(mt,{label:"Home Address",type:"textarea",name:"permanentAddress",register:t,errors:a})]})},yn=e=>{let{register:t,errors:a,control:r,value:s,watch:l,setValue:o}=e;const{fields:d,append:c,remove:p,replace:m}=(0,tt.jz)({control:r,name:"familyDetails"}),u=(0,n.useRef)(!0),h=l("familyDetails");(0,n.useEffect)((()=>{if(u.current){if(s&&s.length>0){let t;console.log("Received value:",s);try{if("string"===typeof s){const e=s.replace(/\\"/g,'"');console.log("Cleaned value:",e),t=JSON.parse(e)}else t=s;m(t),o("familyDetails",t)}catch(e){console.error("Error parsing value:",e)}}else c({name:"",relationship:"",contact:"",address:"",isNew:!1});u.current=!1}else if(s&&s.length>0){let t;try{if("string"===typeof s){const e=s.replace(/\\"/g,'"');console.log("Cleaned value (on update):",e),t=JSON.parse(e)}else t=s;m(t),o("familyDetails",t)}catch(e){console.error("Error parsing value (on update):",e)}}}),[s,c,m,o]);return(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("label",{className:"block text_size_5",children:"Employee Next of Kin Info"}),d.map(((e,r)=>{var n;return(0,i.jsxs)("div",{className:"grid grid-cols-4 form-group gap-5 mt-4 relative",children:[(0,i.jsx)(mt,{label:"Name",type:"text",name:"familyDetails.".concat(r,".name"),register:t,errors:a}),(0,i.jsx)(mt,{label:"Relationship",type:"text",name:"familyDetails.".concat(r,".relationship"),register:t,errors:a}),(0,i.jsx)(mt,{label:"Contact number",type:"text",inputmode:"numeric",name:"familyDetails.".concat(r,".contact"),register:t,errors:a}),(0,i.jsx)(mt,{label:"Home address",type:"text",name:"familyDetails.".concat(r,".address"),register:t,errors:a,value:(null===h||void 0===h||null===(n=h[r])||void 0===n?void 0:n.address)||""}),e.isNew&&(0,i.jsxs)("button",{type:"button",onClick:()=>p(r),className:"absolute top-2 -right-8 text-medium_grey text-[18px]",children:[(0,i.jsx)(Tt.vli,{})," "]})]},e.id)})),(0,i.jsx)("button",{type:"button",onClick:()=>{c({name:"",relationship:"",contact:"",address:"",isNew:!0})},className:"mt-4 flex items-center text-medium_grey text-[20px] absolute -right-8 top-16",children:(0,i.jsx)(Ct.Oh0,{className:"mr-2"})})]})},Nn=e=>{let{register:t,errors:a}=e;return(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(mt,{label:"Company Name of Previous Employment",type:"text",name:"preEmp",register:t,errors:a}),(0,i.jsx)(mt,{label:"Previous Employment Period",type:"text",name:"preEmpPeriod",register:t,errors:a}),(0,i.jsx)(mt,{label:"Date of Induction Briefing",type:"date",name:"inducBrief",register:t,errors:a})]})},bn=()=>{const e=(0,Ee.D)();return{SubmitEIData:(0,n.useCallback)((async t=>{let{empValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,aTQualify:n,alternateNo:s,agent:i,contactNo:l,cob:o,contractType:d,ctryOfOrigin:c,chinese:p,dob:m,educLevel:u,email:h,empBadgeNo:x,empType:f,familyDetails:v,gender:y,officialEmail:N,lang:b,marital:D,name:j,oCOfOrigin:A,permanentAddress:w,position:S,sapNo:E,bankName:I,bankAccNo:k,profilePhoto:T,createdBy:C}=a,R={empID:r,aTQualify:n,alternateNo:s,agent:i,contactNo:l,cob:o,contractType:d,ctryOfOrigin:c,chinese:p,dob:m,educLevel:u,email:h,officialEmail:N,empBadgeNo:x,empType:f,familyDetails:v,gender:y,lang:b,marital:D,name:j,oCOfOrigin:A,profilePhoto:T,permanentAddress:w,position:S,sapNo:E,bankName:I,bankAccNo:k,createdBy:C};console.log("Create Call Recived TotalData EmpInfo",R);try{const t=await Promise.all([e.graphql({query:ke.p4,variables:{input:(0,g.A)({},R)}})]);console.log("Create Call EmpInfo Server Response",t)}catch(P){throw console.error("Error executing GraphQL requests:",P),P}}),[e])}},Dn=()=>{const e=(0,Ee.D)();return{UpdateEIValue:(0,n.useCallback)((async t=>{let{collectValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,PITableID:n,profilePhoto:s,aTQualify:i,alternateNo:l,agent:o,contactNo:d,cob:c,contractType:p,ctryOfOrigin:m,chinese:u,dob:h,educLevel:x,email:g,empBadgeNo:f,empType:v,familyDetails:y,officialEmail:N,gender:b,lang:D,marital:j,name:A,oCOfOrigin:w,permanentAddress:S,position:E,sapNo:I,bankName:k,bankAccNo:T,updatedBy:C}=a,R={id:n,empID:r,aTQualify:i,alternateNo:l,agent:o,contactNo:d,cob:c,contractType:p,ctryOfOrigin:m,chinese:u,dob:h,educLevel:x,email:g,empBadgeNo:f,empType:v,familyDetails:y,officialEmail:N,gender:b,lang:D,marital:j,name:A,oCOfOrigin:w,profilePhoto:s,permanentAddress:S,position:E,sapNo:I,bankName:k,bankAccNo:T,updatedBy:C};console.log("Update Call Recived TotalData EmpInfo",R);try{const t=await Promise.all([e.graphql({query:ke.CD,variables:{input:R}})]);console.log("Update Call EmpInfo Server Response",t)}catch(P){throw console.error("Error executing GraphQL requests:",P),P}}),[])}},jn=e=>{let{register:t,errors:a}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(mt,{label:"Bank Name",type:"text",name:"bankName",register:t,errors:a}),(0,i.jsx)(mt,{label:"Bank Account Number",type:"text",name:"bankAccNo",register:t,errors:a})]})},An=()=>{var e;(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{formattedPermissions:t}=qt(),{SubmitEIData:a}=bn(),{SubmitIDData:l}=(()=>{const e=(0,Ee.D)();return{SubmitIDData:(0,n.useCallback)((async t=>{let{empValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,bwnIcNo:n,bwnIcColour:s,bwnIcExpiry:i,driveLic:l,inducBrief:o,inducBriefUp:d,myIcNo:c,nationality:p,nationalCat:m,otherNation:u,otherRace:h,otherReligion:x,ppNo:g,ppIssued:f,ppExpiry:v,ppDestinate:y,preEmp:N,preEmpPeriod:b,race:D,religion:j,bwnUpload:A,applicationUpload:w,cvCertifyUpload:S,loiUpload:E,myIcUpload:I,paafCvevUpload:k,ppUpload:T,supportDocUpload:C,qcCertifyUpload:R,createdBy:P}=a,O={empID:r,bwnIcNo:n,bwnIcColour:s,bwnIcExpiry:i,driveLic:l,inducBrief:o,inducBriefUp:d,myIcNo:c,nationality:p,nationalCat:m,otherNation:u,otherRace:h,otherReligion:x,ppNo:g,ppIssued:f,ppExpiry:v,ppDestinate:y,preEmp:N,preEmpPeriod:b,race:D,religion:j,bwnUpload:A,applicationUpload:w,cvCertifyUpload:S,loiUpload:E,myIcUpload:I,paafCvevUpload:k,ppUpload:T,supportDocUpload:C,qcCertifyUpload:R,createdBy:P};try{await Promise.all([e.graphql({query:ke.ky,variables:{input:O}})])}catch(_){throw console.error("Error executing GraphQL requests:",_),_}}),[e])}})(),{UpdateEIValue:o}=Dn(),{UpdateIDValue:d}=(()=>{const e=(0,Ee.D)();return{UpdateIDValue:(0,n.useCallback)((async t=>{let{collectValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,IDTable:n,bwnIcNo:s,bwnIcColour:i,bwnIcExpiry:l,driveLic:o,inducBrief:d,inducBriefUp:c,myIcNo:p,nationality:m,nationalCat:u,otherNation:h,otherRace:x,otherReligion:g,ppNo:f,ppIssued:v,ppExpiry:y,ppDestinate:N,preEmp:b,preEmpPeriod:D,race:j,religion:A,bwnUpload:w,applicationUpload:S,cvCertifyUpload:E,loiUpload:I,myIcUpload:k,paafCvevUpload:T,ppUpload:C,supportDocUpload:R,qcCertifyUpload:P,updatedBy:O}=a,_={id:n,empID:r,bwnIcNo:s,bwnIcColour:i,bwnIcExpiry:l,driveLic:o,inducBrief:d,inducBriefUp:c,myIcNo:p,nationality:m,nationalCat:u,otherNation:h,otherRace:x,otherReligion:g,ppNo:f,ppIssued:v,ppExpiry:y,ppDestinate:N,preEmp:b,preEmpPeriod:D,race:j,religion:A,bwnUpload:w,applicationUpload:S,cvCertifyUpload:E,loiUpload:I,myIcUpload:k,paafCvevUpload:T,ppUpload:C,supportDocUpload:R,qcCertifyUpload:P,updatedBy:O};try{await Promise.all([e.graphql({query:ke.TH,variables:{input:_}})])}catch(M){throw console.error("Error executing GraphQL requests:",M),M}}),[])}})(),{empPIData:c,IDData:p,dropDownVal:m,candyToEmp:u}=(0,n.useContext)(s.Y),[h,x]=(0,n.useState)(!1),[N,b]=(0,n.useState)(""),[D,A]=(0,n.useState)([]),[w,S]=(0,n.useState)(""),[E,I]=(0,n.useState)(""),[k,T]=(0,n.useState)(""),[C,R]=(0,n.useState)(""),[P,O]=(0,n.useState)([]),[_,M]=(0,n.useState)(!1),[F,L]=(0,n.useState)({bwnUpload:!1,applicationUpload:!1,cvCertifyUpload:!1,myIcUpload:!1,paafCvevUpload:!1,ppUpload:!1,supportDocUpload:!1,loiUpload:!1,qcCertifyUpload:!1}),[U,B]=(0,n.useState)({uploadProfilePhoto:!1,inducBriefUp:!1}),[q,H]=(0,n.useState)({bwnUpload:[],applicationUpload:[],cvCertifyUpload:[],myIcUpload:[],paafCvevUpload:[],ppUpload:[],supportDocUpload:[],loiUpload:[],qcCertifyUpload:[]}),[W,z]=(0,n.useState)({uploadProfilePhoto:null,inducBriefUp:null}),[Y,V]=(0,n.useState)({profilePhoto:null,inducBriefUp:null}),[G,J]=(0,n.useState)(null),[K,Q]=(0,n.useState)(null),[$,Z]=(0,n.useState)([]),[X,ee]=(0,n.useState)(""),[te,ae]=(0,n.useState)({}),[re,ne]=(0,n.useState)(!1),{register:se,handleSubmit:ie,setValue:le,watch:oe,control:de,formState:{errors:ce}}=(0,tt.mN)({resolver:(0,at.t)(Vr),mode:"onChange",defaultValues:{familyDetails:JSON.stringify([])}}),pe=oe("profilePhoto");(0,n.useEffect)((()=>{(async()=>{try{const e=c.map((e=>{const t=p?p.find((t=>t.empID===e.empID)):{},a=(null===u||void 0===u?void 0:u.find((t=>t.empID===e.empID)))||{};return(0,g.A)((0,g.A)((0,g.A)({},e),t),a)})).filter(Boolean);A(e)}catch(e){console.log(e)}})()}),[c,p,u]);const me=async(e,t)=>{const a=oe("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");let r=e.target.files[0];["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type)?(le(t,r),r&&(((e,t)=>{B((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await(async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=(await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result).path,i=(new Date).toISOString().split("T")[0];"number"===typeof n&&a((e=>{const a=(0,g.A)({},e);return a[t]=a[t]||[],a[t][n]=a[t][n]||[],a[t][n].find((e=>e.upload===s))||a[t][n].push({upload:s,date:i}),a})),a((e=>(0,g.A)((0,g.A)({},e),{},{[t]:s})))}}catch(s){}})(r,t,V,a),z((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name}))))):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},ue=()=>{x(!h)},he=async(e,t)=>{var a;const r=oe("empID");if(!r)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const n=e.target.files[0];if(!n)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const s=oe(t)||[];if(s.some((e=>e.name===n.name)))alert("This file has already been uploaded.");else if(null!==(a=te[t])&&void 0!==a&&a.includes(n.name))alert("This file was previously deleted and cannot be re-added.");else{le(t,[...s,n]);try{((e,t)=>{L((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dn(n,t,H,r),z((e=>(0,g.A)((0,g.A)({},e),{},{[t]:n.name})))}catch(i){console.error(i)}}},xe=async(e,t)=>{try{const a=oe("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,z,H,L);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));b("".concat(t)),ue()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}};(0,n.useEffect)((()=>{if(null!==Y&&void 0!==Y&&Y.profilePhoto||null!==Y&&void 0!==Y&&Y.inducBriefUp&&Y.inducBriefUp.length>0){if(Y.profilePhoto){(async e=>{var t;const a=await(0,f.I)({path:e});return J(null===a||void 0===a||null===(t=a.url)||void 0===t?void 0:t.toString())})(Y.profilePhoto)}if(Y.inducBriefUp&&Y.inducBriefUp.length>0){const e=Y.inducBriefUp[Y.inducBriefUp.length-1].upload;Q(e)}}}),[Y,pe]);const ge=e=>{const t=new Date(e);return!isNaN(t.getTime())},fe=e=>{if(!e)return"";const t=new Date(e),a=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(n)},ve=e=>{if(!e||"string"!==typeof e)return"";return e.split("/").pop()};return(0,i.jsxs)("section",{className:"bg-[#F5F6F1CC] mx-auto p-10",onClick:()=>{O([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/employee",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("h5",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Employee Info"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(ea,{searchResult:async e=>{var t,a;["empID","email","officialEmail","bankAccNo","empBadgeNo","sapNo"].forEach((t=>{const a=e[t]||"";le(t,"string"===typeof a?a:"")})),e.empID&&ne(!0);if(["driveLic","inducBrief","myIcNo","nationality","nationalCat","otherNation","otherRace","otherReligion","preEmp","preEmpPeriod","race","religion","age","aTQualify","alternateNo","agent","dob","cob","ctryOfOrigin","chinese","educLevel","eduDetails","bankName","lang","marital","name","oCOfOrigin","position","bwnIcColour","gender"].forEach((t=>{let a=e[t]||"";if("string"===typeof a)le(t,a?a.trim().toUpperCase():"");else if(Array.isArray(a)&&a.length>0){const e=a[a.length-1];le(t,[e?e.trim().toUpperCase():""])}else le(t,a)})),Array.isArray(e.workExperience)&&e.workExperience.length>0)try{const t=e.workExperience[e.workExperience.length-1],a=JSON.parse(t);if(Array.isArray(a)&&a.length>0){const e=a[a.length-1],t=(e.name||"").trim().toUpperCase(),r=(e.from||"").trim(),n=(e.to||"").trim(),s=r&&n?"".concat(y(r)," to ").concat(y(n)):"";le("preEmp",t),le("preEmpPeriod",s)}}catch(r){console.warn("Failed to parse workExperience:",r)}["bwnIcExpiry","ppExpiry","ppIssued"].forEach((t=>le(t,(e=>{const t=Array.isArray(e)?e[e.length-1]:e;return ge(t)?fe(t):t})(e[t]))));["empType","contractType"].forEach((t=>le(t,(e=>{var t;return Array.isArray(e)&&e.length>0?null===(t=e[e.length-1])||void 0===t?void 0:t.trim().toUpperCase():"string"===typeof e?e.trim().toUpperCase():null})(e[t]))));if(["permanentAddress","contactNo","ppNo","ppDestinate","bwnIcNo"].forEach((t=>{const a=e[t];if(Array.isArray(a)){const e=a.join(", ").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" ");le(t,e||"")}else if("string"===typeof a){const e=a.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" ");le(t,e||"")}else le(t,a||"")})),Array.isArray(e.familyDetails)&&e.familyDetails.length>0){const t=(e=>{try{let t=e;"object"===typeof t&&(t=JSON.stringify(Array.isArray(t)?t:[t]));let a=t.trim();a.startsWith('"')&&a.endsWith('"')&&(a=a.slice(1,-1)),a=a.replace(/^"+|"+$/g,""),/"\s*:/.test(a)||(a=a.replace(/([a-zA-Z0-9_]+)(:)/g,'"$1"$2'),a=a.replace(/"(?!\\)/g,'\\"'),a=a.replace(/\\/g,""));const r=e=>e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "),n=JSON.parse(a);return Array.isArray(n)?n.map((e=>"string"===typeof e?r(e):"object"===typeof e?Object.fromEntries(Object.entries(e).map((e=>{let[t,a]=e;return[t,"string"===typeof a?r(a):a]}))):e)):["string"===typeof n?r(n):Object.fromEntries(Object.entries(n).map((e=>{let[t,a]=e;return[t,"string"===typeof a?r(a):a]})))]}catch(t){return console.error("Error cleaning and parsing familyDetails:",t),[]}})(e.familyDetails[0]);Z(t||[])}else Z([]);le("profilePhoto",(null===e||void 0===e||null===(t=e.profilePhoto)||void 0===t?void 0:t.toString())||""),le("inducBriefUp",(null===e||void 0===e||null===(a=e.inducBriefUp)||void 0===a?void 0:a.toString())||""),V((t=>({profilePhoto:e.profilePhoto||"",inducBriefUp:e.inducBriefUp||""}))),e.inducBriefUp&&null!==e.inducBriefUp?z((t=>(0,g.A)((0,g.A)({},t),{},{inducBriefUp:ve(e.inducBriefUp)||""}))):z((e=>(0,g.A)((0,g.A)({},e),{},{inducBriefUp:""})));(async e=>{try{if(e||J(v),e){var t;const a=await(0,f.I)({path:e});J(null===(t=a.url)||void 0===t?void 0:t.toString())}}catch(a){console.log("Error fetching file from storage:",a)}})(null===e||void 0===e?void 0:e.profilePhoto);["bwnUpload","applicationUpload","cvCertifyUpload","loiUpload","myIcUpload","paafCvevUpload","ppUpload","supportDocUpload","qcCertifyUpload"].forEach((t=>{const a=e[t];if(!a)return le(t,[]),H((e=>(0,g.A)((0,g.A)({},e),{},{[t]:[]}))),void z((e=>(0,g.A)((0,g.A)({},e),{},{[t]:""})));let r;try{r=JSON.parse(a)}catch(i){try{const e=a.replace(/^"+|"+$/g,"");r=JSON.parse(e)}catch(l){return le(t,[]),H((e=>(0,g.A)((0,g.A)({},e),{},{[t]:[]}))),void z((e=>(0,g.A)((0,g.A)({},e),{},{[t]:""})))}}Array.isArray(r)||(r=[r]);const n=r.flatMap(((e,t)=>{if("string"===typeof e)try{const t=JSON.parse(e);return Array.isArray(t)?t:[t]}catch(a){try{const t=e.replace(/^"+|"+$/g,""),a=JSON.parse(t);return Array.isArray(a)?a:[a]}catch(r){return[]}}else if("object"===typeof e&&null!==e)return[e];return[]})).filter((e=>{var a;return!(null!==(a=te[t])&&void 0!==a&&a.includes(ve(e.upload)))})),s=n.map((e=>ve(e.upload)));le(t,n),H((e=>(0,g.A)((0,g.A)({},e),{},{[t]:n}))),z((e=>(0,g.A)((0,g.A)({},e),{},{[t]:s})))}))},newFormData:D,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:P,setFilteredEmployees:O})})]}),(0,i.jsxs)("form",{onSubmit:ie((async e=>{const t=e=>e?new Date(e).toLocaleDateString("en-CA"):null,r=t(e.bwnIcExpiry),n=t(e.ppIssued),s=t(e.ppExpiry),i=e.contractType,m=e.empType,u=(e,t)=>{const a=[...e||[],t];if(-1!==a.findIndex((e=>null!==e))){const e=[];let t=null;return a.forEach((a=>{null!==a&&a!==t?(e.push(null===a?"N/A":a),t=a):null===a&&e.push("N/A")})),e}return[]},h=(new Date).toISOString().split("T")[0],x=localStorage.getItem("userID");try{const t=c.find((t=>t.empID===e.empID)),f=p.find((t=>t.empID===e.empID)),v=u(null===t||void 0===t?void 0:t.contractType,i),y=u(null===t||void 0===t?void 0:t.empType,m),N=u(null===f||void 0===f?void 0:f.bwnIcExpiry,r),b=u(null===f||void 0===f?void 0:f.ppExpiry,s),D=u(null===f||void 0===f?void 0:f.ppIssued,n),j=t.updatedBy?JSON.parse(t.updatedBy):[],A=[...j,{userID:x,date:h}].map((e=>({userID:e.userID,date:e.date}))),w=f.updatedBy?JSON.parse(f.updatedBy):[],S=[...w,{userID:x,date:h}].map((e=>({userID:e.userID,date:e.date})));if(t){const a=(0,g.A)((0,g.A)({},e),{},{PITableID:t.id,empID:e.empID.trim(),profilePhoto:Y.profilePhoto,contractType:v,empType:y,familyDetails:JSON.stringify(e.familyDetails),email:e.email.trim().toLowerCase(),officialEmail:e.officialEmail.trim().toLowerCase(),updatedBy:JSON.stringify(A)});await o({collectValue:a})}else{const t=(0,g.A)((0,g.A)({},e),{},{empID:e.empID.trim(),profilePhoto:Y.profilePhoto,contractType:v,empType:y,familyDetails:JSON.stringify(e.familyDetails),email:e.email.trim().toLowerCase(),officialEmail:e.officialEmail.trim().toLowerCase(),createdBy:JSON.stringify([{userID:x,date:h}])});await a({empValue:t})}if(f){const t=(0,g.A)((0,g.A)({},e),{},{IDTable:f.id,empID:e.empID.trim(),inducBriefUp:Y.inducBriefUp,bwnUpload:JSON.stringify(q.bwnUpload),bwnIcExpiry:N,ppIssued:D,ppExpiry:b,applicationUpload:JSON.stringify(q.applicationUpload),cvCertifyUpload:JSON.stringify(q.cvCertifyUpload),loiUpload:JSON.stringify(q.loiUpload),myIcUpload:JSON.stringify(q.myIcUpload),paafCvevUpload:JSON.stringify(q.paafCvevUpload),ppUpload:JSON.stringify(q.ppUpload),supportDocUpload:JSON.stringify(q.supportDocUpload),qcCertifyUpload:JSON.stringify(q.qcCertifyUpload),updatedBy:JSON.stringify(S)});await d({collectValue:t})}else{const t=(0,g.A)((0,g.A)({},e),{},{empID:e.empID.trim(),inducBriefUp:Y.inducBriefUp,bwnUpload:JSON.stringify(q.bwnUpload),bwnIcExpiry:N,ppIssued:D,ppExpiry:b,applicationUpload:JSON.stringify(q.applicationUpload),cvCertifyUpload:JSON.stringify(q.cvCertifyUpload),loiUpload:JSON.stringify(q.loiUpload),myIcUpload:JSON.stringify(q.myIcUpload),paafCvevUpload:JSON.stringify(q.paafCvevUpload),ppUpload:JSON.stringify(q.ppUpload),supportDocUpload:JSON.stringify(q.supportDocUpload),qcCertifyUpload:JSON.stringify(q.qcCertifyUpload),createdBy:JSON.stringify([{userID:x,date:h}])});await l({empValue:t})}ee("Employee Personal Info saved successfully"),M(!0)}catch(f){console.error("Error processing form submission:",f)}})),className:" flex flex-col justify-center",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center py-7 mt-2",children:[(0,i.jsxs)("div",{className:"py-2 center flex-col max-w-[160px]",children:[(0,i.jsx)("input",{type:"file",id:"fileInput",name:"profilePhoto",accept:".jpg,.jpeg,.png",onChange:e=>{me(e,"profilePhoto")},className:"hidden"}),(0,i.jsxs)("div",{className:"h-[120px] max-w-[120px] relative rounded-md bg-lite_skyBlue",children:[(0,i.jsx)("img",{src:G instanceof File?URL.createObjectURL(G):"string"===typeof G&&G?G:pe||v,id:"previewImg",alt:"profile",className:"object-cover w-full h-full",onError:e=>e.target.src=v}),(G||pe)&&(0,i.jsx)("div",{className:"absolute top-24 -right-3  bg-lite_grey p-[2px] rounded-full cursor-pointer",onClick:()=>document.getElementById("fileInput").click(),children:(0,i.jsx)(j.iog,{className:"w-6 h-6 p-1"})})]}),!G&&!pe&&(0,i.jsx)("div",{className:"mt-1 rounded-lg text-center",children:(0,i.jsx)("button",{type:"button",className:"text_size_6",onClick:()=>document.getElementById("fileInput").click(),children:"Choose Image"})}),!G&&!pe&&ce.profilePhoto&&(0,i.jsx)("p",{className:"text-[red] text-[13px] text-center",children:null===ce||void 0===ce||null===(e=ce.profilePhoto)||void 0===e?void 0:e.message})]}),(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:se,name:"empID",type:"text",value:oe("empID")||"",placeholder:"Enter Employee ID",errors:ce,trackEmpID:re})})]}),(0,i.jsx)(cn,{register:se,errors:ce,setValue:le,watch:oe,control:de}),(0,i.jsx)(pn,{register:se,errors:ce}),(0,i.jsx)(mn,{register:se,errors:ce,handleRaceChange:e=>{T(e.target.value)},handleRelegianChange:e=>{R(e.target.value)},selectedRace:k,selectedReligion:C,watch:oe,dropDownVal:m}),(0,i.jsx)(un,{register:se,errors:ce,dropDownVal:m}),(0,i.jsx)(hn,{register:se,errors:ce,handleNationalityChange:e=>{S(e.target.value)},selectedNationality:w,selectedCountry:E,handleCountryChange:e=>{I(e.target.value)},watch:oe,dropDownVal:m}),(0,i.jsx)(xn,{register:se,errors:ce}),(0,i.jsx)(gn,{register:se,errors:ce}),(0,i.jsx)(fn,{register:se,errors:ce,dropDownVal:m}),(0,i.jsx)(vn,{register:se,errors:ce}),(0,i.jsx)(yn,{register:se,errors:ce,control:de,watch:oe,setValue:le,value:$}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 form-group mt-2",children:[(0,i.jsx)(Nn,{register:se,errors:ce}),(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Upload Induction Form",register:se,fileKey:"inducBriefUp",handleFileUpload:me,uploadedFileNames:W,deletedStringUpload:async(e,t)=>{try{const a=oe("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,0,z,V,B);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));b("".concat(t)),ue()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},isUploadingString:U,error:null===ce||void 0===ce?void 0:ce.inducBriefUp,formattedPermissions:t,requiredPermissions:["Employee Info"],access:"Employee",check:U.inducBriefUp})}),(0,i.jsx)(jn,{register:se,errors:ce})]}),(0,i.jsx)("div",{className:"grid grid-cols-4 gap-5 form-group mt-5",children:At.map(((e,a)=>(0,i.jsx)(tt.xI,{name:e.title,control:de,render:a=>{var r,n;let{field:{onChange:s,value:l}}=a;return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("h2",{className:"text_size_5",children:["Upload ",e.label]}),(0,i.jsxs)("label",{onClick:()=>{F[e.title]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",{type:"file",className:"hidden",accept:".pdf,image/jpeg,image/png",onChange:t=>he(t,e.title),disabled:F[e.title]}),(0,i.jsxs)("span",{className:"ml-2 text-grey w-full font-normal flex justify-between items-center gap-10",children:[e.label,e.icon]})]}),(0,i.jsx)("p",{className:"text-xs mt-1 text-grey px-1",children:null!==W&&void 0!==W&&W[e.title]?Array.isArray(W[e.title])?W[e.title].slice().reverse().map(((a,r)=>{var n,s;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[a,(null===t||void 0===t||null===(n=t.deleteAccess)||void 0===n||null===(s=n.Employee)||void 0===s?void 0:s.includes("Employee Info"))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>xe(e.title,a),children:(0,i.jsx)(_t.uDv,{})})]},r)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[W[e.title],(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>xe(e.title,W[e.title]),children:(0,i.jsx)(_t.uDv,{})})]}):(0,i.jsx)("span",{})}),(null===ce||void 0===ce||null===(r=ce[e.title])||void 0===r||null===(n=r[0])||void 0===n?void 0:n.message)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:ce[e.title][0].message})]})}},a)))}),(0,i.jsx)("div",{className:"flex justify-center items-center mt-7 ",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),_&&(0,i.jsx)(Pe,{text:X,notification:_,path:"/employeeInfo"})]}),h&&(0,i.jsx)(Wt,{handleDeleteMsg:ue,title1:N})]})},wn=()=>{const e=(0,Ee.D)();return{SubmitWIData:(0,n.useCallback)((async t=>{let{workInfoValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,department:n,otherDepartment:s,position:i,otherPosition:l,jobCat:o,otherJobCat:d,doj:c,jobDesc:p,skillPool:m,relationship:u,hr:h,manager:x,supervisor:g,upgradePosition:f,upgradeDate:v,contractPeriod:y,contractStart:N,contractEnd:b,workStatus:D,probationStart:j,probationEnd:A,workHrs:w,workWeek:S,workMonth:E,salaryType:I,probDuration:k,sapNo:T,createdBy:C}=a,R=e=>e?new Date(e).toLocaleDateString("en-CA"):[],P=R(b),O=R(N),_=(M=c)?new Date(M).toLocaleDateString("en-CA"):null;var M;const F=[P,O,R(A),R(j),R(v),i,l,n,s,o,d,u,h,p,x,k,g,I,f,w,D,S,E,y].map((e=>null==e||Array.isArray(e)&&0===e.length?[]:Array.isArray(e)?[...new Set(e)]:[e])),[L,U,B,q,H,W,z,Y,V,G,J,K,Q,$,Z,X,ee,te,ae,re,ne,se,ie,le]=F,oe={empID:r,department:Y,otherDepartment:V,position:W,otherPosition:z,jobCat:G,otherJobCat:J,doj:_,jobDesc:$,skillPool:m,relationship:K,upgradePosition:ae,upgradeDate:H,contractStart:U,contractPeriod:le,contractEnd:L,hr:Q,manager:Z,supervisor:ee,workStatus:ne,probationStart:q,probationEnd:B,probDuration:X,workHrs:re,workWeek:se,workMonth:ie,salaryType:te,sapNo:T,createdBy:C};try{const t=await Promise.all([e.graphql({query:ke.Gk,variables:{input:oe}})]);console.log("res",t)}catch(de){console.log(de)}}),[])}},Sn=()=>{var e,t,a,r;const{dropDownVal:i}=(0,n.useContext)(s.Y),l=null===(e=i[0])||void 0===e?void 0:e.resignNotifConfDD.map((e=>({value:e,label:e}))),o=null===(t=i[0])||void 0===t?void 0:t.resignNotifProbDD.map((e=>({value:e,label:e}))),d=null===(a=i[0])||void 0===a?void 0:a.termiNotifConfDD.map((e=>({value:e,label:e})));return{positions:["Accountant","Accounts Assistant","Accounts Coordinator","Admin Clerk","Advance Scaffolder","Advance Scaffolder Leadman","Apprentice Blaster Painter","Apprentice Marker Fitter Level 1A (Structural & Basic Piping)","Assistant Construction Supervisor","Assistant Field Engineer","Assistant Material Controller","Assistant Quality Control Inspector","Blaster/Painter","Blasting/Painting & Insulation Coordinator","Blasting/Painting PTW Supervisor","Blasting/Painting Supervisor","Calibration & Certification Coordinator","Camp Inspector cum Driver","Clerk","Coating Field Support","Construction Engineer","Construction Site Supervisor","Contract Engineer","Contract Manager","Cost Engineer","Costing Engineer","Deputy Facility Manager","Deputy HR Manager","Deputy Logistic Coordinator","Deputy Project Manager","Director's Personal Asst","Document & Data Controller","Document Controller","Document Controller cum Training/Medical Support","Document Controller/Timekeeper","Driver","Driver/Operator","E&I Manager","Electrician","Equipment & Maintenance Coordinator","Executive Director","Field Engineer","Field Engineer - Rotating","Finance & Procurement Manager","Finance/Project Controls Coordinator","Fitter Mechanic","Fitter Mechanic Grade A","Flange Management Engineer","Flange Management Inspector","Foreman","Forklift cum Overhead Crane Operator","Forklift Operator","General Manager","Helper","HP Jetter/Senior Mechanical Technician","HR Assistant","HR Assistant Coordinator","HR Coordinator","Human Resource Manager","HR/LBD Coordinator","HSE & Welfare Advisor","HSE Advisor","HSSE Advisor/Auditor","HSSE Coordinator","HSSE Manager","HSSE Officer","HSSE Offshore Officer","HSSE Training Coordinator","Industrial Cleaner","Industrial Cleaner Lead","Industrial Cleaner Supervisor","Insulation Fabricator","Insulation Field Support","Insulation Inspector","Insulation Supervisor","Insulation Supervisor/Permit Holder","Insulation Worksite Supervisor","Insulator","Insulator cum Fabricator","Inventory Maintenance Supervisor","IT Assistant Engineer","Junior Coordinator","Junior Electrician","Junior Engineer","Junior Field Engineer","Junior Material Coordinator","Junior Mechancial Technician","Junior Mechanical Technician","Junior Planner","Junior QC Inspector","Junior Scheduler","LBD & Welfare Manager","Leadman","Load Out Leadman","Loadout/Backload Supervisor","Logistics Coordinator","Logistics Scheduler","Logistics Scheduler & Timekeeper","Machinist","Machinist Grade A","Maintenance Coordinator","Managing Director","Marker Fitter","Marker Fitter Grade A","Marker Fitter Grade B","Marker Fitter Multiskill","Material Coordinator","Mechanic","Mechanical Construction Coordinator","Mechanical Construction Supervisor","Mechanical cum Hotwork Supervisor","Mechanical Engineer","Mechanical Execution Lead","Mechanical Field Engineer","Mechanical Insulation Supervisor","Mechanical Leadman","Mechanical Supervisor","Mechanical Supervisor/ PIC","Mechanical Supervisor/Permit Holder","Mechanical Technician","Mechanical Technician cum Rigger","Mechanical/Hotwork Supervisor","Office Assistant/Driver","Offshore Fabrication Workshop / Deck Supervisor","Offshore Mechanical Store Supervisor","Offshore Operations Manager","Offshore PWHT Technician","OMEC Contract Manager","Painter","Pass Coordinator cum Document Controller","Permit Coordinator","Personnel Officer","Pipe Welder - 6GR Trainee","Pipe Welder (6G)","Piping Supervisor","Planner","Planning Engineer","Procurement Coordinator","Project Coordinator","Project Engineer","PTW Supervisor","Public Relation Officer","Purchaser cum Expeditor","Purchasing Clerk","Purchasing Coordinator","PWHT Technician cum Electrician","QA/QC Coordinator","QA/QC Engineer","QA/QC Inspector","QA/QC Manager/QMR","Quantity Surveyor","Rigger","Rigger Multiskill","Rotating Equipment Engineer","Rotating Equipment Technician","Rotating Supervisor","Rotating Technician","Rotating Technician cum Mechanical Technician","Scaffold Coordinator","Scaffolder","Scaffolding Field Support","Scaffolding Inspector","Scaffolding Inspector cum Supervisor","Scaffolding Superintendent","Scaffolding Supervisor","Scaffolding Supervisor & Permit Holder","Scaffolding Supervisor/Inspector","Secretary","Secretary Cum Admin","Senior Document Controller","Senior Inspector","Senior Mechanical Supervisor","Senior Mechanical Technician","Senior Mechanical Technician cum HP/UHP Lead Operator","Senior Mechanical Technician/Banksman","Senior Planning Engineer","Senior Rotating Technician","Senior Scheduler","Senior Supervisor","Store Assistant","Store Coordinator","Storekeeper","Supervisor","Technical Assistant/Driver","Technical Clerk","Technical Field Support","Technical Field Support cum Fire Watcher","Timekeeper/Clerk","Tools & Equipment Coordinator","Trainee Technician","Training Coordinator","Turnaround Coordinator","UHP/HP Pump Operator/Hydro Jetter cum Mechanical Technician","Unit Shutdown Coordinator","Valve Technician","Welder","Welder Grade A","Welder Grade A1","Welder Grade B","Welder Grade C","Welder Multiskill","Welding Inspector","Welfare Officer cum CVEV Officer","Workpack Preparer","Worksite Supervisor","Other"],workFields:[{label:"Date of Join",name:"doj",type:"date"},{label:"Job Description",name:"jobDesc",type:"text"},{label:"Skill Pool",name:"skillPool",type:"select",options:["","Corporate","Management","Supervisory","Administration & Accounts","Skilled","Unskilled"]},{label:"HR ID",name:"hr",value:"Hr-notification@adininworks.com",type:"text",readOnly:!0},{label:"Manager ID",name:"manager",type:"text"},{label:"Supervisor ID",name:"supervisor",type:"text"}],terminationFields:[{label:"Date of Resignation",name:"resignDate",type:"date"},{label:"Date of Termination",name:"termiDate",type:"date"},{label:"Resignation Notice During Probation",name:"resignNotProb",type:"select",options:o},{label:"Termination Notice During Probation",name:"termiNotProb",type:"select",options:null===(r=i[0])||void 0===r?void 0:r.termiNotifProbDD.map((e=>({value:e,label:e})))},{label:"Resignation Notice After Confirmation",name:"resignNotConf",type:"select",options:l},{label:"Termination Notice After Confirmation",name:"termiNotConf",type:"select",options:d},{label:"Reason of Resignation",name:"reasonResign",type:"text"},{label:"Reason of Termination",name:"reasonTerminate",type:"text"}],leaveBasic:[{label:"Date of Leave Passage Entitlement After Contract",name:"dateLeavePass",type:"date"},{label:"Duration Period of Leave Passage Entitlement",name:"durLeavePass",type:"text"},{label:"Destination of Leave Passage Entitlement",name:"destinateLeavePass",type:"text"}],leaveFieldsAnother:[{label:"Annual Leave Entitlement",name:"annualLeave",type:"text"},{label:"Effective Date",name:"annualLeaveDate",type:"date"},{label:"Sick Leave Entitlement",name:"sickLeave",type:"text"},{label:"Effective Date",name:"sickLeaveDate",type:"date"},{label:"Maternity Leave Entitlement",name:"materLeave",type:"text"},{label:"Paternity Leave Entitlement",name:"paterLeave",type:"text"},{label:"Marriage Leave Entitlement",name:"mrageLeave",type:"text"},{label:"Hospitalisation Leave Entitlement",name:"hospLeave",type:"text"},{label:"Previous Annual Leave Balance",name:"pervAnnualLeaveBal",type:"text"}],serviceRecords:[{label:"Position Revision",name:"positionRev",type:"text"},{label:"Effective Date",name:"positionRevDate",type:"date"},{label:"Upload File",name:"uploadPR",type:"file"},{label:"Salary Package Revision",name:"revSalary",type:"text"},{label:"Effective Date",name:"revSalaryDate",type:"date"},{label:"Upload File",name:"uploadSP",type:"file"},{label:"Leave Passage Revision",name:"revLeavePass",type:"text"},{label:"Effective Date",name:"revLeaveDate",type:"date"},{label:"Upload File",name:"uploadLP",type:"file"},{label:"Annual Leave Revison",name:"revAnnualLeave",type:"text"},{label:"Effective date",name:"revALD",type:"date"},{label:"Upload File",name:"uploadAL",type:"file"},{label:"Change of Department",name:"depEmp",type:"text"},{label:"Effective Date",name:"depEmpDate",type:"date"},{label:"Upload File",name:"uploadDep",type:"file"}],hiringJob:[{label:"Job Title",name:"jobTitle",type:"text"},{label:"Experience",name:"experience",type:"text"},{label:"Location",name:"location",type:"text"},{label:"Quantity",name:"quantity",type:"number"},{label:"Start Date",name:"startDate",type:"date"},{label:"Expiry Date",name:"expiryDate",type:"date"}]}},En=()=>{const e=(0,Ee.D)();return{WIUpdateData:(0,n.useCallback)((async t=>{let{workInfoUpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r=e=>e&&new Date(e).toLocaleDateString("en-CA"),n=(e,t)=>{var a,r;const n=null===t||void 0===t||""===(null===(a=t.trim)||void 0===a?void 0:a.call(t))?"N/A":null===(r=t.trim)||void 0===r?void 0:r.call(t);let s=Array.isArray(e)?e:e?[e]:[];if(s=s.filter((e=>{var t;return null!==e&&void 0!==e&&""!==(null===(t=e.trim)||void 0===t?void 0:t.call(e))})),0===s.length)return"N/A"===n?[]:n?[n]:[];return s[s.length-1].toLowerCase()===n.toLowerCase()?s:[...s,n]},s=(e,t)=>{const a=null===t||void 0===t||""===(null===t||void 0===t?void 0:t.trim())?"":null===t||void 0===t?void 0:t.trim();if(!e||0===(null===e||void 0===e?void 0:e.length))return a?[a]:[];const r=e[e.length-1];return(null===r||void 0===r?void 0:r.toLowerCase())===(null===a||void 0===a?void 0:a.toLowerCase())?e:[...e,a]},{empID:i,workInfoDataRecord:l,department:o,otherDepartment:d,position:c,otherPosition:p,jobCat:m,otherJobCat:u,doj:h,jobDesc:x,skillPool:g,relationship:f,hr:v,manager:y,supervisor:N,upgradePosition:b,upgradeDate:D,contractPeriod:j,contractStart:A,contractEnd:w,workStatus:S,probationStart:E,probationEnd:I,probDuration:k,workHrs:T,workWeek:C,workMonth:R,salaryType:P,sapNo:O,updatedBy:_}=a,M=r(w),F=r(A),L=(U=h)?new Date(U).toLocaleDateString("en-CA"):null;var U;const B=r(I),q=r(E),H=r(D);if(l){const t=s(l.contractEnd,M);console.log(t);const a=s(l.contractStart,F),r=s(l.probationEnd,B),h=s(l.probationStart,q),D=s(l.upgradeDate,H),A=n(l.position,c),w=n(l.otherPosition,p),E=n(l.department,o),I=n(l.otherDepartment,d),U=n(l.jobCat,m),z=n(l.otherJobCat,u),Y=n(l.jobDesc,x),V=n(l.salaryType,P),G=n(l.manager,y),J=n(l.hr,v),K=n(l.supervisor,N),Q=n(l.workHrs,T),$=n(l.workMonth,R),Z=n(l.workWeek,C),X=n(l.workStatus,S),ee=n(l.relationship,f),te=n(l.upgradePosition,b),ae=n(l.contractPeriod,j),re=n(l.probDuration,k),ne={id:l.id,empID:i,department:E,updatedBy:_,otherDepartment:I,position:A,otherPosition:w,jobCat:U,otherJobCat:z,doj:L,jobDesc:Y,skillPool:g,relationship:ee,upgradePosition:te,upgradeDate:D,contractStart:a,contractPeriod:ae,contractEnd:t,hr:J,manager:G,supervisor:K,workStatus:X,probationStart:h,probationEnd:r,probDuration:re,workHrs:Q,workWeek:Z,workMonth:$,salaryType:V,sapNo:O};try{const t=await e.graphql({query:ke.Ho,variables:{input:ne}});console.log(t)}catch(W){console.log(W)}}}),[])}},In=e=>{var t;let{register:a,errors:r,watch:n,dropDownVal:s,setValue:l,control:o}=e;const d=null===(t=s[0])||void 0===t?void 0:t.relationshipDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})));return(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-5 form-group mt-5",children:[(0,i.jsx)(mt,{label:"Employee Status",register:a,name:"relationship",type:"select",options:d,errors:r}),(0,i.jsx)(mt,{label:"Upgrade Position",register:a,name:"upgradePosition",type:"text",errors:r}),(0,i.jsx)(mt,{label:"Position Upgrade Effective Date",register:a,name:"upgradeDate",type:"date",errors:r}),(0,i.jsx)(mt,{label:"Contract Period Status",register:a,name:"contractPeriod",type:"text",errors:r}),(0,i.jsx)(mt,{label:"Contract Start Date",register:a,name:"contractStart",type:"date",errors:r}),(0,i.jsx)(mt,{label:"Contract End Date",register:a,name:"contractEnd",type:"date",errors:r}),(0,i.jsx)(mt,{label:"Probation Duration",register:a,name:"probDuration",type:"text",errors:r}),(0,i.jsx)(mt,{label:"Probationary Start Date",register:a,name:"probationStart",type:"date",errors:r}),(0,i.jsx)(mt,{label:"Probationary End Date",register:a,name:"probationEnd",type:"date",errors:r})]})},kn=e=>{var t;let{register:a,errors:r,dropDownVal:n,watch:s,setValue:l,control:o}=e;const d=null===(t=n[0])||void 0===t?void 0:t.workStatusDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})));return(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-5 form-group mt-5",children:[(0,i.jsx)(mt,{label:"Normal Working Hours Per Day",register:a,type:"text",name:"workHrs",errors:r}),(0,i.jsx)(mt,{label:"Normal Working Day Per Week",register:a,type:"text",name:"workWeek",errors:r}),(0,i.jsx)(mt,{label:"Normal Working Day Per Month",register:a,type:"text",name:"workMonth",errors:r}),(0,i.jsx)(mt,{label:"Employment Work Status",register:a,type:"select",options:d,name:"workStatus",errors:r}),(0,i.jsx)(mt,{label:"Type of Salary Pay",register:a,type:"select",options:bt,name:"salaryType",errors:r})]})},Tn=e=>{var t,a,r;let{register:n,errors:s,watch:l,onChange:o,selection:d,dropDownVal:c}=e;const p=null===(t=c[0])||void 0===t?void 0:t.departmentDD.map((e=>({value:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),m=null===(a=c[0])||void 0===a?void 0:a.positionDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),u=null===(r=c[0])||void 0===r?void 0:r.jobCatDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),h=l("department"),x=l("otherDepartment"),g=l("position"),f=l("otherPosition"),v=l("jobCat"),y=l("otherJobCat");return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 form-group mt-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:"Department",register:n,name:"department",type:"select",options:p,errors:s,onChange:o})}),(0,i.jsx)("div",{children:("OTHER"===d.department||x&&"OTHER"===h)&&(0,i.jsx)(mt,{label:"Other Department",register:n,name:"otherDepartment",type:"text",errors:s})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 form-group mt-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:"Position",register:n,name:"position",type:"select",options:m,errors:s,onChange:o})}),(0,i.jsx)("div",{children:("OTHER"===d.position||f&&"OTHER"===g)&&(0,i.jsx)(mt,{label:"Other Position",register:n,name:"otherPosition",type:"text",errors:s})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 form-group mt-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:"Job Category",register:n,name:"jobCat",type:"select",options:u,errors:s,onChange:o})}),(0,i.jsx)("div",{children:("OTHER"===d.jobCat||y&&"OTHER"===v)&&(0,i.jsx)(mt,{label:"Other Job",register:n,name:"otherJobCat",type:"text",errors:s})})]})]})},Cn=()=>{const{formattedPermissions:e}=qt(),{WIUpdateData:t}=En(),{WIUpdateSRData:a}=(()=>{const e=(0,Ee.D)();return{WIUpdateSRData:(0,n.useCallback)((async t=>{let{SRUpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r=e=>e&&new Date(e).toLocaleDateString("en-CA"),n=(e,t)=>{var a,r;const n=null===t||void 0===t||""===(null===(a=t.trim)||void 0===a?void 0:a.call(t))?"N/A":null===(r=t.trim)||void 0===r?void 0:r.call(t);let s=Array.isArray(e)?e:e?[e]:[];return s=s.filter((e=>{var t;return null!==e&&void 0!==e&&""!==(null===(t=e.trim)||void 0===t?void 0:t.call(e))})),0===s.length?"N/A"===n?[]:n?[n]:[]:s[s.length-1].toLowerCase()===n.toLowerCase()?s:[...s,n]},s=(e,t)=>{const a=null===t||void 0===t||""===(null===t||void 0===t?void 0:t.trim())?"":null===t||void 0===t?void 0:t.trim();if(!e||0===(null===e||void 0===e?void 0:e.length))return a?[a]:[];const r=e[e.length-1];return(null===r||void 0===r?void 0:r.toLowerCase())===(null===a||void 0===a?void 0:a.toLowerCase())?e:[...e,a]},{empID:i,SRDataRecord:l,depEmpDate:o,depEmp:d,positionRev:c,positionRevDate:p,revSalary:m,revSalaryDate:u,revLeavePass:h,revLeaveDate:x,revAnnualLeave:g,revALD:f,remarkWI:v,uploadPR:y,uploadSP:N,uploadLP:b,uploadAL:D,uploadDep:j,updatedBy:A}=a,w=r(o),S=r(p),E=r(u),I=r(x),k=r(f);if(l){const t=s(l.depEmpDate,w),a=n(l.depEmp,d),r=s(l.positionRevDate,S),o=n(l.positionRev,c),p=n(l.revSalary,m),u=s(l.revSalaryDate,E),x=s(l.revLeaveDate,I),f=n(l.revLeavePass,h),C=n(l.revAnnualLeave,g),R=s(l.revALD,k),P={id:l.id,empID:i,positionRev:o,positionRevDate:r,revSalary:p,revSalaryDate:u,revLeavePass:f,revLeaveDate:x,revAnnualLeave:C,revALD:R,depEmp:a,depEmpDate:t,remarkWI:v,uploadPR:y,uploadSP:N,uploadLP:b,uploadAL:D,uploadDep:j,updatedBy:A};try{await e.graphql({query:ke.WV,variables:{input:P}})}catch(T){console.log(T)}}}),[])}})(),{WIUpdateLeaveData:l}=(()=>{const e=(0,Ee.D)(),t=(0,n.useCallback)((async t=>{let{LeaveUpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r=e=>e&&new Date(e).toLocaleDateString("en-CA"),n=(e,t)=>{var a,r;const n=null===t||void 0===t||""===(null===(a=t.trim)||void 0===a?void 0:a.call(t))?"N/A":null===(r=t.trim)||void 0===r?void 0:r.call(t);let s=Array.isArray(e)?e:e?[e]:[];return s=s.filter((e=>{var t;return null!==e&&void 0!==e&&""!==(null===(t=e.trim)||void 0===t?void 0:t.call(e))})),0===s.length?"N/A"===n?[]:n?[n]:[]:s[s.length-1].toLowerCase()===n.toLowerCase()?s:[...s,n]},s=(e,t)=>{const a=null===t||void 0===t||""===(null===t||void 0===t?void 0:t.trim())?"":null===t||void 0===t?void 0:t.trim();if(!e||0===(null===e||void 0===e?void 0:e.length))return a?[a]:[];const r=e[e.length-1];return(null===r||void 0===r?void 0:r.toLowerCase())===(null===a||void 0===a?void 0:a.toLowerCase())?e:[...e,a]},{empID:i,leaveDetailsDataRecord:l,annualLeave:o,annualLeaveDate:d,destinateLeavePass:c,durLeavePass:p,dateLeavePass:m,leavePass:u,materLeave:h,mrageLeave:x,paterLeave:g,sickLeave:f,sickLeaveDate:v,hospLeave:y,pervAnnualLeaveBal:N,updatedBy:b}=a,D=r(d),j=r(m);if(l){const t=n(l.leavePass,u),a=s(l.dateLeavePass,j),r=n(l.destinateLeavePass,c),d=n(l.durLeavePass,p),m=n(l.annualLeave,o),w=s(l.annualLeaveDate,D),S={id:l.id,empID:i,leavePass:t,dateLeavePass:a,destinateLeavePass:r,durLeavePass:d,annualLeave:m,annualLeaveDate:w,sickLeave:f,sickLeaveDate:v,materLeave:h,paterLeave:g,mrageLeave:x,pervAnnualLeaveBal:N,hospLeave:y,updatedBy:b};try{const t=await e.graphql({query:ke.Jo,variables:{input:S}});console.log(t)}catch(A){console.log(A)}}}),[]);return{WIUpdateLeaveData:t}})(),{WIUpdateTerminateData:o}=(()=>{const e=(0,Ee.D)();return{WIUpdateTerminateData:(0,n.useCallback)((async t=>{let{TerminateUpValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,terminateDataRecord:n,resignDate:s,resignNotProb:i,otherResignNotProb:l,resignNotConf:o,otherResignNotConf:d,reasonResign:c,reasonTerminate:p,termiDate:m,termiNotProb:u,otherTermiNotProb:h,termiNotConf:x,otherTermiNotConf:g,WIContract:f,WIProbation:v,WIResignation:y,WITermination:N,WILeaveEntitle:b,updatedBy:D}=a;if(n){const t={id:n.id,empID:r,resignDate:s,termiDate:m,resignNotProb:i,otherResignNotProb:l,termiNotProb:u,otherTermiNotProb:h,resignNotConf:o,otherResignNotConf:d,termiNotConf:x,otherTermiNotConf:g,reasonResign:c,reasonTerminate:p,WIContract:f,WIProbation:v,WIResignation:y,WITermination:N,WILeaveEntitle:b,updatedBy:D};try{const a=await e.graphql({query:ke.mp,variables:{input:t}});console.log(a)}catch(j){console.log(j)}}}),[])}})(),{SubmitWIData:d}=wn(),{SRDataValue:c}=(()=>{const e=(0,Ee.D)();return{SRDataValue:(0,n.useCallback)((async t=>{let{SRValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,depEmpDate:n,depEmp:s,positionRev:i,positionRevDate:l,revSalary:o,revSalaryDate:d,revLeavePass:c,revLeaveDate:p,revAnnualLeave:m,revALD:u,remarkWI:h,uploadPR:x,uploadSP:g,uploadLP:f,uploadAL:v,uploadDep:y,createdBy:N}=a;console.log(a);const b=e=>e?new Date(e).toLocaleDateString("en-CA"):[],D=[b(n),s,b(l),i,b(d),o,b(p),c,b(u),m].map((e=>null==e||Array.isArray(e)&&0===e.length?[]:Array.isArray(e)?[...new Set(e)]:[e])),[j,A,w,S,E,I,k,T,C,R]=D,P={empID:r,depEmpDate:j,depEmp:A,positionRev:S,positionRevDate:w,revSalary:I,revSalaryDate:E,revLeavePass:T,revLeaveDate:k,revAnnualLeave:R,revALD:C,remarkWI:h,uploadPR:JSON.stringify(x),uploadSP:JSON.stringify(g),uploadLP:JSON.stringify(f),uploadAL:JSON.stringify(v),uploadDep:JSON.stringify(y),createdBy:N};console.log(P);try{await e.graphql({query:ke.dC,variables:{input:P}})}catch(O){console.log(O)}}),[])}})(),{LeaveDataValue:p}=(()=>{const e=(0,Ee.D)(),t=(0,n.useCallback)((async t=>{let{LeaveValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,leavePass:n,dateLeavePass:s,hospLeave:i,destinateLeavePass:l,durLeavePass:o,annualLeave:d,annualLeaveDate:c,sickLeave:p,sickLeaveDate:m,materLeave:u,paterLeave:h,mrageLeave:x,pervAnnualLeaveBal:g,remainAnnualLeave:f,createdBy:v}=a,y=e=>e?new Date(e).toLocaleDateString("en-CA"):[],N=[d,y(c),l,o,y(s),n].map((e=>null==e||Array.isArray(e)&&0===e.length?[]:Array.isArray(e)?[...new Set(e)]:[e])),[b,D,j,A,w,S]=N,E={empID:r,annualLeave:b,annualLeaveDate:D,destinateLeavePass:j,durLeavePass:A,dateLeavePass:w,leavePass:S,materLeave:u,mrageLeave:x,paterLeave:h,pervAnnualLeaveBal:g,sickLeave:p,sickLeaveDate:m,hospLeave:i,remainAnnualLeave:f,createdBy:v};try{await Promise.all([e.graphql({query:ke._H,variables:{input:E}})])}catch(I){console.log(I)}}),[]);return{LeaveDataValue:t}})(),{TerminateDataValue:m}=(()=>{const e=(0,Ee.D)();return{TerminateDataValue:(0,n.useCallback)((async t=>{let{TerminateValue:a}=t;if(!a)throw new Error("Missing required parameters");const{empID:r,resignDate:n,termiDate:s,resignNotProb:i,otherResignNotProb:l,termiNotProb:o,otherTermiNotProb:d,resignNotConf:c,otherResignNotConf:p,termiNotConf:m,otherTermiNotConf:u,reasonResign:h,reasonTerminate:x,WIContract:g,WIProbation:f,WIResignation:v,WITermination:y,WILeaveEntitle:N,createdBy:b}=a,D={empID:r,resignDate:n,resignNotProb:i,otherResignNotProb:l,resignNotConf:c,otherResignNotConf:p,reasonResign:h,reasonTerminate:x,termiDate:s,termiNotProb:o,otherTermiNotProb:d,termiNotConf:m,otherTermiNotConf:u,WIContract:JSON.stringify(g),WIProbation:JSON.stringify(f),WIResignation:JSON.stringify(v),WITermination:JSON.stringify(y),WILeaveEntitle:JSON.stringify(N),createdBy:b};try{await Promise.all([e.graphql({query:ke.T1,variables:{input:D}})])}catch(j){console.log(j)}}),[])}})();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{empPIData:u,terminateData:h,workInfoData:x,leaveDetailsData:f,SRData:v,dropDownVal:y}=(0,n.useContext)(s.Y),{register:N,handleSubmit:b,control:D,setValue:A,getValues:w,watch:S,trigger:E,formState:{errors:I}}=(0,tt.mN)({defaultValues:{uploadAL:[],uploadPR:[],uploadSP:[],uploadLP:[],uploadDep:[]},resolver:(0,at.t)(Yr)}),[k,T]=(0,n.useState)(!1),[C,R]=(0,n.useState)(""),[P,O]=(0,n.useState)(!1),[_,M]=(0,n.useState)([]),[F,L]=(0,n.useState)([]),[U,B]=(0,n.useState)(""),[q,H]=(0,n.useState)([]),W=S("empID"),[z,Y]=(0,n.useState)(!1),V=localStorage.getItem("userID"),[G,J]=(0,n.useState)(!1),{terminationFields:K,leaveFieldsAnother:Q,workFields:$,leaveBasic:Z,serviceRecords:X}=Sn(),[ee,te]=(0,n.useState)(""),[ae,re]=(0,n.useState)({department:"",position:"",jobCat:"",otherDeparment:""}),ne=S(K.map((e=>e.name)));(0,n.useEffect)((()=>{u.map((e=>{W===e.empID&&te(e.name)}))}),[u]);const[se,ie]=(0,n.useState)({uploadPR:!1,uploadSP:!1,uploadLP:!1,uploadAL:!1,uploadDep:!1,WIProbation:!1,WIResignation:!1,WITermination:!1,WILeaveEntitle:!1,WIContract:!1}),[le,oe]=(0,n.useState)({uploadPR:null,uploadSP:null,uploadLP:null,uploadAL:null,uploadDep:null,WIProbation:null,WIResignation:null,WITermination:null,WILeaveEntitle:null,WIContract:null}),[de,ce]=(0,n.useState)({uploadPR:[],uploadSP:[],uploadLP:[],uploadAL:[],uploadDep:[],WIProbation:[],WIResignation:[],WITermination:[],WILeaveEntitle:[],WIContract:[]});(0,n.useEffect)((()=>{(async()=>{try{const e=u.map((e=>{const t=x?x.find((t=>t.empID===e.empID)):{},a=h?h.find((t=>t.empID===e.empID)):{},r=f?f.find((t=>t.empID===e.empID)):{},n=v?v.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),t),a),r),n)})).filter(Boolean);M(e),L(e)}catch(e){console.log(e)}})()}),[u,h,x,f,v]);const pe=async(e,t)=>{const a=S("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=S(t)||[];if(null!==n&&void 0!==n&&n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{A(t,[...n,r]);try{((e,t)=>{ie((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dn(r,t,ce,a),oe((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},me=()=>{T(!k)},ue=async(e,t)=>{try{const a=S("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,oe,ce,ie);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));R("".concat(t)),me(),R("".concat(t)),me()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},he=e=>e.split("/").pop(),xe=["Work Info"];return(0,i.jsxs)("section",{className:"bg-[#F5F6F1CC] mx-auto p-10",onClick:()=>{H([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/employee",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Work Info"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(ea,{searchResult:e=>{e&&Y(!0);["empID"].forEach((t=>{const a=e[t];A(t,"string"===typeof a?a:"")}));["doj","hospLeave","skillPool","resignDate","termiDate","resignNotProb","otherResignNotProb","termiNotProb","otherTermiNotProb","resignNotConf","otherResignNotConf","termiNotConf","otherTermiNotConf","reasonResign","reasonTerminate","materLeave","paterLeave","sickLeave","sickLeaveDate","mrageLeave","compasLeave","remarkWI","sapNo","pervAnnualLeaveBal","remainingAnualLeave","remainingCompasLeave","remainingHosLeave","remainingMateLeave","remainingMrageLeave","remainingPaternityLeave","remainingSickLeave"].forEach((t=>{let a=void 0!==e[t]&&null!==e[t]?e[t].toString().trim().toUpperCase():"";A(t,a)}));["dateLeavePass","depEmp","positionRev","revSalary","revLeavePass","revAnnualLeave","durLeavePass","destinateLeavePass","annualLeave","leavePass","salaryType","manager","supervisor","workStatus","workHrs","workWeek","workMonth","upgradePosition","contractPeriod","probDuration","department","otherDepartment","position","otherPosition","jobCat","otherJobCat","jobDesc","relationship","upgradeDate","revALD","contractStart","contractEnd","probationStart","probationEnd","revLeaveDate","revSalaryDate","depEmpDate","annualLeaveDate","positionRevDate"].forEach((t=>{const a=e[t];A(t,(e=>{var t;return Array.isArray(e)&&e.length>0?null===(t=e[e.length-1])||void 0===t?void 0:t.trim().toUpperCase():"string"===typeof e?e.trim().toUpperCase():null})(a))})),A("hr","Hr-notification@adininworks.com");["WIProbation","WIResignation","WITermination","WILeaveEntitle","WIContract","uploadPR","uploadSP","uploadLP","uploadAL","uploadDep"].forEach((t=>{if(e[t])try{const a=e[t][0],r=(a.startsWith('"')&&a.endsWith('"')?a.slice(1,-1):a).replace(/\\"/g,'"'),n=JSON.parse(r);if(!Array.isArray(n))throw new Error("Parsed result is not an array for ".concat(t));const s=n.map((e=>"string"===typeof e?JSON.parse(e):e));A(t,s),ce((e=>(0,g.A)((0,g.A)({},e),{},{[t]:s}))),oe((e=>(0,g.A)((0,g.A)({},e),{},{[t]:s.map((e=>he(e.upload)))})))}catch(a){console.error("Failed to parse ".concat(t,":"),a)}}))},newFormData:F,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:q,setFilteredEmployees:H})})]}),(0,i.jsxs)("form",{onSubmit:b((async e=>{try{const r=(null===u||void 0===u?void 0:u.find((t=>t.empID===e.empID)))||null,n=(null===h||void 0===h?void 0:h.find((t=>t.empID===e.empID)))||null,s=(null===x||void 0===x?void 0:x.find((t=>t.empID===e.empID)))||null,i=(null===f||void 0===f?void 0:f.find((t=>t.empID===e.empID)))||null,y=(null===v||void 0===v?void 0:v.find((t=>t.empID===e.empID)))||null,N=(new Date).toISOString().split("T")[0];if(y){const t=y.updatedBy?JSON.parse(y.updatedBy):[],r=JSON.stringify([...t,{userID:V,date:N}]),n=(0,g.A)((0,g.A)({},e),{},{SRDataRecord:y,uploadPR:JSON.stringify(de.uploadPR),uploadSP:JSON.stringify(de.uploadSP),uploadLP:JSON.stringify(de.uploadLP),uploadAL:JSON.stringify(de.uploadAL),uploadDep:JSON.stringify(de.uploadDep),updatedBy:r});await a({SRUpValue:n})}else{const t=JSON.stringify([{userID:V,date:N}]),a=(0,g.A)((0,g.A)({},e),{},{empID:e.empID,uploadPR:JSON.stringify(de.uploadPR),uploadSP:JSON.stringify(de.uploadSP),uploadLP:JSON.stringify(de.uploadLP),uploadAL:JSON.stringify(de.uploadAL),uploadDep:JSON.stringify(de.uploadDep),createdBy:t});await c({SRValue:a})}if(i){const t=i.updatedBy?JSON.parse(i.updatedBy):[],a=JSON.stringify([...t,{userID:V,date:N}]),r=(0,g.A)((0,g.A)({},e),{},{leaveDetailsDataRecord:i,updatedBy:a});await l({LeaveUpValue:r})}else{const t=JSON.stringify([{userID:V,date:N}]),a=(0,g.A)((0,g.A)({},e),{},{remainAnnualLeave:"0",empID:e.empID,createdBy:t});await p({LeaveValue:a})}if(s){const a=s.updatedBy?JSON.parse(s.updatedBy):[],n=JSON.stringify([...a,{userID:V,date:N}]),i=(0,g.A)((0,g.A)({},e),{},{sapNo:null===r||void 0===r?void 0:r.sapNo,workInfoDataRecord:s,updatedBy:n});await t({workInfoUpValue:i})}else{const t=JSON.stringify([{userID:V,date:N}]),a=(0,g.A)((0,g.A)({},e),{},{sapNo:null===r||void 0===r?void 0:r.sapNo,createdBy:t});await d({workInfoValue:a})}if(n){const t=n.updatedBy?JSON.parse(n.updatedBy):[],a=JSON.stringify([...t,{userID:V,date:N}]),r=(0,g.A)((0,g.A)({},e),{},{terminateDataRecord:n,WIContract:JSON.stringify(de.WIContract),WIProbation:JSON.stringify(de.WIProbation),WIResignation:JSON.stringify(de.WIResignation),WITermination:JSON.stringify(de.WITermination),WILeaveEntitle:JSON.stringify(de.WILeaveEntitle),updatedBy:a});await o({TerminateUpValue:r})}else{const t=JSON.stringify([{userID:V,date:N}]),a=(0,g.A)((0,g.A)({},e),{},{empID:e.empID,WIContract:JSON.stringify(de.WIContract),WIProbation:JSON.stringify(de.WIProbation),WIResignation:JSON.stringify(de.WIResignation),WITermination:JSON.stringify(de.WITermination),WILeaveEntitle:JSON.stringify(de.WILeaveEntitle),createdBy:t});await m({TerminateValue:a})}B("Employee Work Info Stored successfully"),O(!0)}catch(r){console.log("Error during submission:",r)}})),className:" mt-20 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center mt-5",children:(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:"Employee ID",type:"text",name:"empID",placeholder:"Enter Employee ID",errors:I,register:N,trackEmpID:z})})}),(0,i.jsx)(Tn,{register:N,errors:I,watch:S,onChange:e=>{const{name:t,value:a}=e.target;re((e=>(0,g.A)((0,g.A)({},e),{},{[t]:a})))},selection:ae,getValues:w,setValue:A,dropDownVal:y}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-5 form-group mt-5",children:$.map(((e,t)=>{var a;return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:e.label}),"select"===e.type?(0,i.jsx)("select",(0,g.A)((0,g.A)({},N(e.name)),{},{className:"input-field select-custom",defaultValue:e.value||"",watch:S(e.name),readOnly:e.readOnly||!1,children:(e.options||[]).map(((e,t)=>(0,i.jsx)("option",{value:"Select"===e.trim()?"":e.trim().toUpperCase(),children:e.trim().toUpperCase()},t)))})):(0,i.jsx)("input",(0,g.A)((0,g.A)({type:e.type},N(e.name)),{},{className:"input-field",defaultValue:e.value||"",readOnly:e.readOnly||!1})),I[e.name]&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:null===(a=I[e.name])||void 0===a?void 0:a.message})]},t)}))}),(0,i.jsx)(In,{register:N,errors:I,watch:S,dropDownVal:y}),(0,i.jsx)(kn,{register:N,errors:I,watch:S,dropDownVal:y}),(0,i.jsx)("hr",{className:"text-lite_grey mb-5"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("p",{className:"text_size_3 form-group text-medium_grey my-5",children:"Employee Leave Info"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 form-group mt-5",children:[(0,i.jsx)(mt,{label:"Leave Passage Entitlement for Non-Local",register:N,name:"leavePass",type:"select",options:St,errors:I}),Z.map(((e,t)=>(0,i.jsx)(mt,{label:e.label,register:N,name:e.name,type:e.type,errors:I},t)))]}),(0,i.jsx)("div",{className:"grid grid-cols-4 gap-5 form-group mt-5",children:Q.map(((e,t)=>{var a;return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:e.label}),"select"===e.type?(0,i.jsx)("select",(0,g.A)((0,g.A)({},N(e.name)),{},{className:"input-field select-custom",children:(e.options||[]).map(((e,t)=>{const a=e.trim().toLowerCase().replace(/^\w/,(e=>e.toUpperCase()));return(0,i.jsx)("option",{value:"Select"===e.trim()?"":e.trim(),children:a.toUpperCase()},t)}))})):(0,i.jsx)("input",(0,g.A)((0,g.A)({type:e.type},N(e.name)),{},{defaultValue:e.value||"",className:"input-field"})),I[e.name]&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:null===(a=I[e.name])||void 0===a?void 0:a.message})]},t)}))})]}),(0,i.jsx)("hr",{className:"text-lite_grey mb-5"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("p",{className:"text_size_3 form-group text-medium_grey my-5",children:"Employee Exit Info"}),(0,i.jsx)("div",{className:"grid grid-cols-2 form-group gap-5",children:K.map(((e,t)=>{var a,r,n;const s="OTHER"===ne[t];return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"block text_size_5",children:e.label}),"select"===e.type?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("select",(0,g.A)((0,g.A)({},N(null===e||void 0===e?void 0:e.name)),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:"",children:"Select"}),null===e||void 0===e||null===(a=e.options)||void 0===a?void 0:a.map(((e,t)=>{var a,r;const n="object"===typeof e?null===(a=e.value)||void 0===a?void 0:a.trim():String(e).trim(),s="object"===typeof e?null===(r=e.label)||void 0===r?void 0:r.trim():String(e).trim();return(0,i.jsx)("option",{value:"Select"===n?"":String(n).toUpperCase(),children:s.toUpperCase()},t)}))]})),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",placeholder:"Please specify"},N("other".concat(e.name.charAt(0).toUpperCase()+e.name.slice(1)),{required:"This field is required when 'Other' is selected"})),{},{className:"input-field"})),(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:null===(r=I["other".concat(e.name.charAt(0).toUpperCase()+e.name.slice(1))])||void 0===r?void 0:r.message})]})]}):(0,i.jsx)("input",(0,g.A)((0,g.A)({type:e.type},N(e.name)),{},{className:"input-field"})),(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:null===(n=I[e.name])||void 0===n?void 0:n.message})]},t)}))})]}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-5 form-group mt-5",children:It.map(((t,a)=>(0,i.jsx)(tt.xI,{name:t.title,control:D,render:a=>{let{field:{onChange:r,value:n}}=a;return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsxs)("h2",{className:"text_size_5",children:["Upload ",t.label]}),(0,i.jsxs)("label",{onClick:()=>{se[t.title]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",{type:"file",className:"hidden",accept:".pdf,image/jpeg,image/png",onChange:e=>pe(e,t.title),disabled:se[t.title]}),(0,i.jsxs)("span",{className:"ml-2 text-grey w-full font-normal flex justify-between items-center gap-10",children:[t.label,t.icon]})]}),(0,i.jsx)("p",{className:"text-xs mt-1 text-grey px-1",children:null!==le&&void 0!==le&&le[t.title]?Array.isArray(le[t.title])?le[t.title].slice().reverse().map(((a,r)=>{var n,s;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[a,(null===e||void 0===e||null===(n=e.deleteAccess)||void 0===n||null===(s=n.Employee)||void 0===s?void 0:s.includes("Work Info"))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>ue(t.title,a),children:(0,i.jsx)(_t.uDv,{})})]},r)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[le[t.title],(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>ue(t.title,le[t.title]),children:(0,i.jsx)(_t.uDv,{})})]}):(0,i.jsx)("span",{})}),I[t.title]&&(0,i.jsx)("p",{className:"text-red text-xs mt-1",children:I[t.title].message})]})}},a)))}),(0,i.jsx)("hr",{className:"text-lite_grey mb-5"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("p",{className:"text_size_5 form-group text-medium_grey my-5",children:"Employee Service Record"}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-5 ",children:X.map(((t,a)=>"file"===t.type?(0,i.jsx)(Lt,{field:t,register:N,handleFileChange:pe,uploadedFileNames:le,watchedEmpID:W,deleteFile:ue,isUploading:se,errors:I,formattedPermissions:e,requiredPermissions:xe,access:"Employee",check:se},a):(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:t.label,name:t.name,type:t.type,register:N,errors:I})},a)))}),(0,i.jsxs)("div",{className:"md:col-span-2 form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:"Remarks for Work Info"}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},N("remarkWI")),{},{className:"resize-none w-full p-2 mt-1 border bg-lite_skyBlue border-lite_grey rounded-md outline-none",rows:"4"})),I.remarkWI&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:I.remarkWI.message})]})]}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),P&&(0,i.jsx)(Pe,{text:U,notification:P,path:"/workInfo"}),k&&(0,i.jsx)(Wt,{handleDeleteMsg:me,title1:C})]})},Rn={medicalFields:[{label:"Overseas Medical Fitness issued date",name:"overMD",type:"date"},{label:"Overseas Medical Fitness Expiry",name:"overME",type:"date"},{label:"Upload File",name:"uploadFitness",type:"file"},{label:"Date submitted of BruHims Registration",name:"bruhimsRD",type:"date"},{label:"BruHims Registration Number",name:"bruhimsRNo",type:"text"},{label:"Upload File",name:"uploadRegis",type:"file"},{label:"Brunei Medical Appointment Date",name:"bruneiMAD",type:"date"},{label:"Brunei Medical Fitness Expiry",name:"bruneiME",type:"date"},{label:"Upload File",name:"uploadBwn",type:"file"}]},Pn=e=>{let{errors:t,register:a,setValue:r,setArrayUploadDocs:s,control:l,value:o,getValues:d,watch:c,UploadingFiles:p,formattedPermissions:m,requiredPermissions:u,access:h}=e;const x=(0,n.useRef)(!0),[f,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)(""),[b,D]=(0,n.useState)({}),[j,A]=(0,n.useState)({}),[w,S]=(0,n.useState)({}),[E,I]=(0,n.useState)({}),{fields:k,append:T,remove:C,replace:R}=(0,tt.jz)({control:l,name:"dependPass"});(0,n.useEffect)((()=>{if(x.current){if(o&&o.length>0){const e=("string"===typeof o?JSON.parse(o):o).map((e=>(0,g.A)((0,g.A)({},e),{},{uploadDp:Array.isArray(e.uploadDp)?e.uploadDp:["string"===typeof e.uploadDp?JSON.parse(e.uploadDp):e.uploadDp],uploadDr:Array.isArray(e.uploadDr)?e.uploadDr:["string"===typeof e.uploadDr?JSON.parse(e.uploadDr):e.uploadDr]})));R(e),r("dependPass",e)}else T({dependName:"",dependPpNo:"",dependPpE:"",relation:"",labourDPBy:"",labourDRNo:"",labourDAmount:"",uploadDp:[],uploadDr:[],isNew:!1});x.current=!1}else if(o&&o.length>0){const e=("string"===typeof o?JSON.parse(o):o).map((e=>(0,g.A)((0,g.A)({},e),{},{uploadDp:Array.isArray(e.uploadDp)?e.uploadDp:["string"===typeof e.uploadDp?JSON.parse(e.uploadDp):e.uploadDp],uploadDr:Array.isArray(e.uploadDr)?e.uploadDr:["string"===typeof e.uploadDr?JSON.parse(e.uploadDr):e.uploadDr]})));R(e),r("dependPass",e);["uploadDp","uploadDr"].forEach((t=>{e&&Array.isArray(e)&&e.forEach(((e,a)=>{const r=null===e||void 0===e?void 0:e[t],n=Array.isArray(r)?r.map((e=>e&&"object"===typeof e&&e.upload?"string"===typeof e?JSON.parse(e):e:null)).filter(Boolean):[];D((e=>{const r=Array.isArray(e[t])?[...e[t]]:[];return r[a]=n,(0,g.A)((0,g.A)({},e),{},{[t]:r})}));const s=n.map((e=>e&&e.upload?P(e.upload):""));I((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(a,"_").concat(t)]:s})))}))}))}}),[o,T,R,r]),console.log(E);const P=e=>{if(!e)return"";return e.split("/").pop()},O=(c("empID"),async(e,t,a)=>{var n;const s=c("empID");if(!s)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/labourImmigration");const i=null===(n=e.target.files)||void 0===n?void 0:n[0];if(!i)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(i.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const l=d("dependPass[".concat(a,"].").concat(t))||[];if(l.some((e=>e.name===i.name)))return void alert("This file has already been uploaded.");if(l.some((e=>e.name===i.name)))return void alert("This file has already been uploaded.");const o=[...l,i];r("dependPass[".concat(a,"].").concat(t),o);try{((e,t,a)=>{A((r=>(0,g.A)((0,g.A)({},r),{},{["".concat(a,"_").concat(e)]:t})))})(t,!0,a),await dt(i,t,D,s,a),S((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(a,"_").concat(t)]:[i.name]})))}catch(p){console.error("File upload error:",p)}}),_=()=>{v(!f)},M=async(e,t,a,n)=>{try{const n=c("empID");if(!n)return void alert("Please provide the Employee ID before deleting files.");const s=await(0,_a.k)(e,t,n),i=await((e,t,a,r,n,s,i,l,o)=>{try{r((a=>{const r=(0,g.A)({},a);return console.log("updatedFiles : ",r),Object.keys(r).forEach((a=>{a==="".concat(o,"_").concat(e)&&(r[a]=r[a].filter((e=>e!==t)))})),r}));const l="".concat(o,"_").concat(e);n((e=>{const a=(0,g.A)({},e);return Array.isArray(a[l])&&(a[l]=[...a[l]].filter((e=>e!==t)),0===a[l].length&&delete a[l]),a})),s((r=>{const n=(0,g.A)({},r);return console.log("updatedFiles : ",n),Array.isArray(n[e])&&n[e][o]&&(n[e][o]=n[e][o].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t)))),n})),i((t=>(0,g.A)((0,g.A)({},t),{},{["".concat(o,"_").concat(e)]:!1}))),console.log("File deletion successful")}catch(d){console.log("Caught error:",d)}})(e,t,n,S,I,D,A,0,a);if(s||i){const n=(d("dependPass[".concat(a,"].").concat(e))||[]).filter((e=>{const a=(null===e||void 0===e?void 0:e.upload)||(null===e||void 0===e?void 0:e.name);return P(a)!==t}));r("dependPass[".concat(a,"].").concat(e),n),N("".concat(t)),_()}}catch(s){console.error("Error deleting file:",s),alert("Error processing the file deletion.")}};(0,n.useEffect)((()=>{s(b)}),[b,s]);return(0,i.jsxs)("div",{className:"form-group mt-5",children:[(0,i.jsxs)("div",{className:"flex justify-between mb-5 text-dark_grey",children:[(0,i.jsx)("label",{className:"text_size_3",children:"Dependent Pass Info"}),(0,i.jsx)("button",{type:"button",className:"px-3 py-1 rounded",onClick:()=>{T({dependName:"",dependPpNo:"",dependPpE:"",relation:"",labourDPBy:"",labourDRNo:"",labourDAmount:"",uploadDp:[],uploadDr:[]})},children:(0,i.jsx)(Ct.Oh0,{className:"text-xl"})})]}),k.map(((e,n)=>{var s,l,o,p;return(0,i.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-2 relative",children:[(0,i.jsx)(mt,{label:"Dependent Name",type:"text",name:"dependPass[".concat(n,"].dependName"),placeholder:"Enter Name",errors:t,register:a}),(0,i.jsx)(mt,{label:"Passport Number",type:"text",name:"dependPass[".concat(n,"].dependPpNo"),placeholder:"Enter Passport Number",errors:t,register:a}),(0,i.jsx)(mt,{label:"Date of Birth",type:"date",name:"dependPass[".concat(n,"].dependPpE"),placeholder:"Enter Date of Birth",errors:t,register:a}),(0,i.jsx)(mt,{label:"Relation",type:"text",name:"dependPass[".concat(n,"].relation"),placeholder:"Enter Relation",errors:t,register:a}),(0,i.jsx)(mt,{label:"Labour Deposit By",type:"select",name:"dependPass[".concat(n,"].labourDPBy"),options:wt,errors:t,register:a}),(0,i.jsx)(mt,{label:"Labour Deposit Received Number",type:"text",name:"dependPass[".concat(n,"].labourDRNo"),placeholder:"Enter Deposit Number",errors:t,register:a}),(0,i.jsx)(mt,{label:"Labour Deposit Amount",type:"number",inputmode:"numeric",name:"dependPass[".concat(n,"].labourDAmount"),placeholder:"Enter Deposit Amount",errors:t,register:a}),(0,i.jsx)(Ut,{label:"Upload Dependent Pass",onChangeFunc:e=>O(e,"uploadDp",n),register:a("dependPass[".concat(n,"].uploadDp")),error:null===t||void 0===t||null===(s=t.dependPass)||void 0===s||null===(l=s[n])||void 0===l?void 0:l.uploadDp,deleteFile:e=>M("uploadDp",e,n),docsUploaded:b,uploadedFileNames:w,fileName:w["".concat(n,"_uploadDp")]||"",filePath:E["".concat(n,"_uploadDp")]||"",fileType:"uploadDp",isUploading:null===j||void 0===j?void 0:j["".concat(n,"_uploadDp")],index:n,formattedPermissions:m,requiredPermissions:u,access:h}),(0,i.jsx)(Ut,{label:"Upload Dependent Passport",onChangeFunc:e=>O(e,"uploadDr",n),register:a("dependPass[".concat(n,"].uploadDr")),error:null===t||void 0===t||null===(o=t.dependPass)||void 0===o||null===(p=o[n])||void 0===p?void 0:p.uploadDr,deleteFile:e=>M("uploadDr",e,n),fileName:w["".concat(n,"_uploadDr")]||"",filePath:E["".concat(n,"_uploadDr")]||"",docsUploaded:b,fileType:"uploadDr",isUploading:null===j||void 0===j?void 0:j["".concat(n,"_uploadDr")],index:n,formattedPermissions:m,requiredPermissions:u,access:h}),0!==n&&(0,i.jsx)("button",{type:"button",onClick:()=>(async e=>{var t,a;const n=d("dependPass"),s=n[e],i=c("empID");if(!i)return void alert("Please provide the Employee ID before deleting files.");if((null===s||void 0===s||null===(t=s.uploadDp)||void 0===t?void 0:t.length)>0)for(let r=0;r<s.uploadDp.length;r++){const t=s.uploadDp[r],a=P(t.upload||t.name);console.log("Deleting uploadDp file: ".concat(a," at index ").concat(e)),await(0,_a.k)("uploadDp",a,i)}if((null===s||void 0===s||null===(a=s.uploadDr)||void 0===a?void 0:a.length)>0)for(let r=0;r<s.uploadDr.length;r++){const t=s.uploadDr[r],a=P(t.upload||t.name);console.log("Deleting uploadDr file: ".concat(a," at index ").concat(e)),await(0,_a.k)("uploadDr",a,i)}const l=n.filter(((t,a)=>a!==e));r("dependPass",[...l]),S((t=>{const a=(0,g.A)({},t);Object.keys(a).forEach((t=>{t.startsWith("".concat(e,"_"))&&delete a[t]}));const r={};return Object.keys(a).forEach((t=>{const[n,s]=t.split("_"),i=parseInt(n)>e?parseInt(n)-1:parseInt(n);r["".concat(i,"_").concat(s)]=a[t]})),console.log("Updated uploadedFileNames:",r),r})),I((t=>{const a=(0,g.A)({},t);Object.keys(a).forEach((t=>{t.startsWith("".concat(e,"_"))&&delete a[t]}));const r={};return Object.keys(a).forEach((t=>{const[n,s]=t.split("_"),i=parseInt(n)>e?parseInt(n)-1:parseInt(n);r["".concat(i,"_").concat(s)]=a[t]})),console.log("Updated fileNames:",r),r})),D((t=>{const a=(0,g.A)({},t);return["uploadDp","uploadDr"].forEach((t=>{Array.isArray(a[t])&&(a[t]=a[t].map(((t,a)=>a===e?[]:t)))})),console.log("Updated state:",a),a})),console.log("Updated dependPass:",l)})(n),className:"absolute top-0 right-0 text-medium_grey text-[18px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id)})),f&&(0,i.jsx)(Wt,{handleDeleteMsg:_,title1:y})]})},On=()=>{const e=(0,Ee.D)();return{SubmitMPData:(0,n.useCallback)((async t=>{let{labValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,overMD:a.overMD,overME:a.overME,bruhimsRD:a.bruhimsRD,bruhimsRNo:a.bruhimsRNo,bruneiMAD:a.bruneiMAD,bruneiME:a.bruneiME,dependPass:JSON.stringify(a.dependPass),uploadFitness:a.uploadFitness,uploadRegis:a.uploadRegis,uploadBwn:a.uploadBwn,createdBy:a.createdBy};try{await Promise.all([e.graphql({query:ke.tS,variables:{input:r}})])}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}},_n=()=>{const e=(0,Ee.D)();return{updateMedicalSubmit:(0,n.useCallback)((async t=>{let{LabUpValue:a}=t;if(!a||!a.LabTable)throw new Error("Missing required parameters or LabTable ID");const r={id:a.LabTable,empID:a.empID,overMD:a.overMD,overME:a.overME,bruhimsRD:a.bruhimsRD,bruhimsRNo:a.bruhimsRNo,bruneiMAD:a.bruneiMAD,bruneiME:a.bruneiME,uploadBwn:a.uploadBwn,dependPass:JSON.stringify(a.dependPass),uploadFitness:a.uploadFitness,uploadRegis:a.uploadRegis,updatedBy:a.updatedBy};try{return await e.graphql({query:ke.AA,variables:{input:r}})}catch(n){throw console.error("Error updating LabourMedicalInfo:",n.message),n}}),[])}},Mn=()=>{const{formattedPermissions:e}=qt();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{SubmitMPData:t}=On(),{updateMedicalSubmit:a}=_n(),{empPIData:l,LMIData:o}=(0,n.useContext)(s.Y),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)({}),[x,f]=(0,n.useState)([]),[v,y]=(0,n.useState)({uploadFitness:!1,uploadRegis:!1,uploadBwn:!1}),[N,b]=(0,n.useState)({uploadFitness:[],uploadRegis:[],uploadBwn:[]}),[D,A]=(0,n.useState)(!1),[w,S]=(0,n.useState)(""),[E,I]=(0,n.useState)(!1),[k,T]=(0,n.useState)(null),[C,R]=(0,n.useState)(""),[P,O]=(0,n.useState)(!1),{register:_,handleSubmit:M,setValue:F,watch:L,control:U,trigger:B,getValues:q,formState:{errors:H}}=(0,tt.mN)({defaultValues:{uploadFitness:[],uploadRegis:[],uploadBwn:[],dependPass:[]},resolver:(0,at.t)(zr)});(0,n.useEffect)((()=>{(async()=>{try{const e=l.map((e=>{const t=o?o.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)({},e),t)})).filter(Boolean);c(e)}catch(e){console.error("Error fetching data:",e)}})()}),[l,o]);const W=L("empID"),z=async(e,t)=>{const a=L("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=L(t)||[];if(null!==n&&void 0!==n&&n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{F(t,[...n,r]);try{((e,t)=>{y((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dt(r,t,b,a),h((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},Y=()=>{A(!D)},V=async(e,t)=>{try{const a=L("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"LabourImmiUpload in employe info")}})(e,t,a,h,b,y);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));S("".concat(t)),Y()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},G=e=>e.split("/").pop(),J=["Medical & Dependent Info"],K="Employee";return console.log("Up",v),(0,i.jsxs)("form",{onSubmit:M((async e=>{try{const r=l.find((t=>t.empID===e.empID)),n=o.find((t=>t.empID===e.empID)),s=(new Date).toISOString().split("T")[0],i=localStorage.getItem("userID"),d=n.updatedBy?JSON.parse(n.updatedBy):[],c=[...d,{userID:i,date:s}].map((e=>({userID:e.userID,date:e.date}))),m=e=>{if(!e||isNaN(new Date(e).getTime()))return;const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},u=m(e.overMD),h=m(e.overME),x=m(e.bruhimsRD),f=m(e.bruneiMAD),v=m(e.bruneiME);if(n&&r){const t=(e,t)=>{if(""===t)return e;const a=[...new Set([...e||[],t])];return a.length>0?a:null},r=t(null===n||void 0===n?void 0:n.bruneiMAD,f),s=t(null===n||void 0===n?void 0:n.bruneiME,v),i=(0,g.A)((0,g.A)({},e),{},{overMD:u,overME:h,bruhimsRD:x,bruneiMAD:r,bruneiME:s,uploadFitness:JSON.stringify(N.uploadFitness),uploadRegis:JSON.stringify(N.uploadRegis),uploadBwn:JSON.stringify(N.uploadBwn),dependPass:JSON.stringify(e.dependPass.map(((e,t)=>{const a=Array.isArray(p.uploadDp)?p.uploadDp:Object.values(p.uploadDp||{}),r=Array.isArray(p.uploadDr)?p.uploadDr:Object.values(p.uploadDr||{}),n=a[t]&&a[t].length>0?a[t]:e.uploadDp||[],s=r[t]&&r[t].length>0?r[t]:e.uploadDr||[];return(0,g.A)((0,g.A)({},e),{},{uploadDp:n,uploadDr:s})}))),LabTable:n.id,updatedBy:JSON.stringify(c)});await a({LabUpValue:i}),R("Medical and Dependent Info details updated successfully"),I(!0)}else{const[a,r]=[[f],[v]].map((e=>[...new Set(e)])),n=(0,g.A)((0,g.A)({},e),{},{overMD:u,overME:h,bruhimsRD:x,bruneiMAD:a,bruneiME:r,uploadFitness:JSON.stringify(N.uploadFitness),uploadRegis:JSON.stringify(N.uploadRegis),uploadBwn:JSON.stringify(N.uploadBwn),dependPass:JSON.stringify(e.dependPass.map(((e,t)=>{var a,r;const n=(null===p||void 0===p||null===(a=p.uploadDp)||void 0===a?void 0:a[t])||e.uploadDp,s=(null===p||void 0===p||null===(r=p.uploadDr)||void 0===r?void 0:r[t])||e.uploadDr;return(0,g.A)((0,g.A)({},e),{},{uploadDp:n,uploadDr:s})}))),createdBy:JSON.stringify([{userID:i,date:s}])});await t({labValue:n}),R("Medical and Dependent Info details saved successfully"),I(!0)}}catch(r){console.log(r),console.error("Error submitting data to AWS:",JSON.stringify(r,null,2))}})),onClick:()=>{f([])},className:"container mx-auto p-10 bg-[#F5F6F1CC]",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,i.jsx)(r.N_,{to:"/employee",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Medical & Dependent Info"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(ea,{searchIcon2:(0,i.jsx)(j.zfp,{}),searchResult:e=>{["empID","bruhimsRNo","overMD","overME","bruhimsRD"].forEach((t=>{if(e[t]){let a=e[t];"overMD"!==t&&"overME"!==t&&"bruhimsRD"!==t||(a=(e=>{const t=e.split("/");if(3!==t.length)throw new Error("Invalid date format: ".concat(e));let a,r,n;if(t[0]>12?[a,r,n]=t:[r,a,n]=t,!(e=>{const[t,a,r]=e;return!isNaN(t)&&!isNaN(a)&&!isNaN(r)&&t>0&&a>0&&r>0})([a,r,n]))throw new Error("Invalid date values: ".concat(e));return"".concat(n,"-").concat(r.padStart(2,"0"),"-").concat(a.padStart(2,"0"))})(a)),F(t,a)}})),e.empID&&O(!0);if(["bruneiMAD","bruneiME"].forEach((t=>{const a=(e=>{if(/^\d{2}\/\d{2}\/\d{4}$/.test(e)){const[t,a,r]=e.split("/");return"".concat(r,"-").concat(a,"-").concat(t)}return e})((e=>{if(Array.isArray(e)){const t=e[e.length-1];return"string"===typeof t&&t.startsWith("[")&&t.endsWith("]")?t.slice(1,-1):t}return e})(e[t]));F(t,a)})),null!==e&&void 0!==e&&e.dependPass)try{const t=JSON.parse(e.dependPass);T(t)}catch(t){console.error("Failed to parse dependPass:",t)}["uploadFitness","uploadRegis","uploadBwn"].forEach((a=>{if(e&&e[a])try{const t=JSON.parse(e[a]).map((e=>"string"===typeof e?JSON.parse(e):e));F(a,t),b((e=>(0,g.A)((0,g.A)({},e),{},{[a]:t}))),h((e=>(0,g.A)((0,g.A)({},e),{},{[a]:t.map((e=>G(e.upload)))})))}catch(t){console.error("Failed to parse ".concat(a,":"),t)}}))},placeholder:"Employee ID",rounded:"rounded-lg",newFormData:d,filteredEmployees:x,setFilteredEmployees:f})})]}),(0,i.jsx)("div",{className:"flex justify-end items-center pt-10 pb-2",children:(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:"Employee ID",type:"text",name:"empID",placeholder:"Enter Employee ID",errors:H,register:_})})}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("p",{className:"text_size_3 form-group text-medium_grey mb-5",children:"Employee Medical Info"}),(0,i.jsx)("div",{className:" grid grid-cols-3 gap-x-5 gap-y-5 mt-5 mb-5 ",children:Rn.medicalFields.map(((t,a)=>(0,i.jsx)(Lt,{field:t,register:_,handleFileChange:z,uploadedFileNames:u,watchedEmpID:W,deleteFile:V,isUploading:v,errors:H,formattedPermissions:e,requiredPermissions:J,access:K},a)))})]}),(0,i.jsx)("hr",{}),(0,i.jsx)(Pn,{register:_,uploadedFileNames:u,setUploadedFileNames:h,control:U,setValue:F,setArrayUploadDocs:m,arrayUploadDocs:p,errors:H,watch:L,trigger:B,isUploading:v,value:k,watchedEmpID:W,deleteFile:V,getValues:q,formattedPermissions:e,requiredPermissions:J,access:K}),(0,i.jsx)("div",{className:"center",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Submit"})}),E&&(0,i.jsx)(Pe,{text:C,notification:E,path:"/labourImmigration"}),D&&(0,i.jsx)(Wt,{handleDeleteMsg:Y,title1:w})]})},Fn=((0,Ee.D)(),e=>{let{isVisible:t,onClose:a,userID:r}=e;const{SubmitReqData:s}=(()=>{const e=(0,Ee.D)();return{SubmitReqData:(0,n.useCallback)((async t=>{let{EmpReqValue:a}=t;if(!a)throw new Error("Missing required parameters");const r=localStorage.getItem("userID");if(!r)throw new Error("User ID is not available in localStorage");const n=a.requestorID||r;if(!n)throw new Error("Requestor ID is missing");const s={requestorID:n,approverID:a.approverID||"",reqName:a.reqName,department:a.department,project:a.project,position:a.position,quantity:a.quantity,reasonForReq:a.reasonForReq,justification:a.justification,replacementFor:a.replacementFor||null,qualification:a.qualification,status:a.status,remarkReq:a.remarkReq,tentativeDate:a.tentativeDate?new Date(a.tentativeDate).toISOString():null};console.log("Submitting data:",s);try{const t=await e.graphql({query:ke.Oh,variables:{input:s}});console.log("Successfully stored data:",t)}catch(i){throw console.error("Error executing GraphQL request:",i),i}}),[])}})(),[l,o]=(0,n.useState)(""),{gmMail:d,hrManagerMail:c}=(0,Fe.b)(),[p,m]=(0,n.useState)(!1),{register:u,handleSubmit:h,formState:{errors:x}}=(0,tt.mN)({resolver:(0,at.t)(rt.M3)}),[f,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");o(e)}),[]);const{personalInfo:b}=Be(r),D="hr-recruitment@adininworks.com";return(0,i.jsxs)("div",{className:"bg-white w-full max-w-[900px] rounded-lg relative",children:[(0,i.jsxs)("div",{className:"text-center p-2",children:[(0,i.jsx)("img",{src:Se.A,alt:"Logo",className:"max-w-[250px] w-full mx-28 mb-3"}),(0,i.jsx)("h2",{className:"text-lg font-semibold underline my-6",children:"Apply for Employee Requisition"}),(0,i.jsx)("button",{onClick:a,className:"absolute -top-4 -right-4 border rounded-full p-1",children:(0,i.jsx)(A.RQJ,{size:20})})]}),(0,i.jsx)("div",{className:"max-h-[450px] overflow-y-auto px-4",children:(0,i.jsxs)("form",{onSubmit:h((async e=>{try{const t=b.empID;if(!t)throw new Error("Requestor ID is missing.");m(!0);const a=(0,g.A)((0,g.A)({},e),{},{reqName:b.name,requestorID:t,department:e.department,project:e.project,position:e.position,quantity:parseInt(e.quantity,10),reasonForReq:e.reasonForReq,justification:e.justification,replacementFor:e.replacementFor||null,qualification:e.qualification,tentativeDate:e.tentativeDate,status:e.status,approverID:b.officialEmail,remarkReq:e.remarkReq});if(await s({EmpReqValue:a}),"Manager"===l){if(d&&Array.isArray(d))for(const e of d)await Me("Employee Requisition Request","<html>\n                <body>\n                  <p>\n                    Dear GM,<br><br>\n                    Your Manager ".concat(b.name||"N/A",' has submitted the Employee Requisition Form.<br/><br/>\n                    Click here <a href="https://hr.adininworks.co">hr.adininworks.co</a> to view the request.\n                  </p>\n                </body>\n              </html>'),"hr_no-reply@adininworks.com",e);else console.error("General Manager email not found.");if(c&&Array.isArray(c))for(const e of c)await Me("Employee Requisition Request","<html>\n                <body>\n                  <p>\n                    Dear HR,<br><br>\n                    Your Manager ".concat(b.name||"N/A",' has submitted the Employee Requisition Form.<br/><br/>\n                    View the details at: <a href="https://hr.adininworks.co">hr.adininworks.co</a>\n                  </p>\n                </body>\n              </html>'),"hr_no-reply@adininworks.com",e);D&&await Me("Employee Requisition Request","<html>\n              <body>\n                <p>\n                  Dear HR,<br><br>\n                  Your Manager ".concat(b.name||"N/A",' has submitted the Employee Requisition Form.<br/><br/>\n                  View the details at: <a href="https://hr.adininworks.co">hr.adininworks.co</a>\n                </p>\n              </body>\n            </html>'),"hr_no-reply@adininworks.com",D)}m(!1),setTimeout((()=>{v(!0),N("Your Requisition Submitted Successfully")}),300)}catch(t){console.error("Error submitting data:",t)}})),className:"pb-5",children:[(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{label:"Department",name:"department",type:"text"},{label:"Position",name:"position",type:"text"},{label:"Project",name:"project",type:"text"},{label:"Quantity",name:"quantity",type:"text"},{label:"Reason for Request",name:"reasonForReq",type:"select",options:[{value:"Additional",label:"Additional"},{value:"Replacement",label:"Replacement"}]},{label:"Justification of Request",name:"justification",type:"text"},{label:"If Replacement, for whom",name:"replacementFor",type:"text"},{label:"State Qualification Desired",name:"qualification",type:"text"},{label:"Tentative Date to Mobilize",name:"tentativeDate",type:"date"}].map((e=>(0,i.jsx)(mt,(0,g.A)({label:e.label,name:e.name,type:e.type,register:u,errors:x},"select"===e.type&&{options:e.options}),e.name)))}),(0,i.jsx)("div",{className:"flex justify-center items-center gap-4 pt-4",children:(0,i.jsx)("button",{type:"submit",disabled:p,className:"primary_btn",children:p?"Loading...":"Submit"})}),f&&(0,i.jsx)(Pe,{text:y,notification:f,path:"/recrutiles/applyemployreq"})]})})]})}),Ln=()=>{const{empPIData:e,EmpInsuranceData:t,workInfoData:a,IDData:l,depInsuranceData:o}=(0,n.useContext)(s.Y),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)("employeeInsurances"),[u,h]=(0,n.useState)([]),[x,f]=(0,n.useState)([]),[v,y]=(0,n.useState)([]),N=(0,r.Zp)(),b=(0,r.zy)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,n.useEffect)((()=>{(async()=>{try{const r=e.map((e=>{const r=t?t.find((t=>t.empID===e.empID)):{},n=a?a.find((t=>t.empID===e.empID)):{},s=l?l.find((t=>t.empID===e.empID)):{},i=o?o.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),n),s),i)}));c(r)}catch(r){console.log(r)}})()}),[e,t,a,l]);const D=(e,t)=>{m(e),N(t)};(0,n.useEffect)((()=>{const e=b.pathname;m("/insuranceAdd"===e?"employeeInsurances":"/insuranceAdd/dependentInsurance"===e?"dependentInsurance":"employeeInsurances")}),[b]);return(0,i.jsx)("section",{className:"w-full bg-[#F5F6F1]",onClick:()=>{y([])},children:(0,i.jsxs)("div",{className:"relative mx-auto p-10 h-full",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/employee",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Insurance Form"}),(0,i.jsx)("div",{className:"flex-1",children:"/insuranceAdd"===b.pathname?(0,i.jsx)(ea,{searchResult:e=>{h(e)},newFormData:d,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:v,setFilteredEmployees:y}):(0,i.jsx)(ea,{searchResult:e=>{f(e)},newFormData:d,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:v,setFilteredEmployees:y})})]}),(0,i.jsxs)("div",{className:"flex border-b m-4 text-[16px] font-semibold",children:[(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("employeeInsurances"===p?"border-b-8 border-yellow":""),onClick:()=>D("employeeInsurances","/insuranceAdd"),children:"Employee Insurance"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("dependentInsurance"===p?"border-b-8 border-yellow":""),onClick:()=>D("dependentInsurance","/insuranceAdd/dependentInsurance"),children:"Dependent Insurance"})]}),(0,i.jsx)("div",{children:(0,i.jsx)(r.sv,{context:{activeNavTab:p,handleNext:()=>{switch(p){case"employeeInsurances":N("/insuranceAdd"),m("employeeInsurances");break;case"dependentInsurance":N("/insuranceAdd/dependentInsurance"),m("dependentInsurance")}},searchResultData:u,depInsuData:x}})})]})})},Un=()=>{const e=(0,Ee.D)();return{SubmitMPData:(0,n.useCallback)((async t=>{let{empInsValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,groupIns:[a.groupIns],groupInsEffectDate:[a.groupInsEffectDate],groupInsEndDate:[a.groupInsEndDate],empStatusType:a.empStatusType,workmenCompNo:a.workmenCompNo,travelIns:[a.travelIns],accidentIns:[a.accidentIns],empInsUpload:[a.empInsUpload],createdBy:a.createdBy};try{const t=await Promise.all([e.graphql({query:ke.hr,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}},Bn=()=>{const e=(0,Ee.D)();return{UpdateEIDataSubmit:(0,n.useCallback)((async t=>{let{empInsValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,groupIns:[a.groupIns],groupInsEffectDate:[a.groupInsEffectDate],groupInsEndDate:[a.groupInsEndDate],empStatusType:a.empStatusType,workmenCompNo:a.workmenCompNo,travelIns:[a.travelIns],accidentIns:[a.accidentIns],empInsUpload:[a.empInsUpload],updatedBy:a.updatedBy};try{await Promise.all([e.graphql({query:ke.WT,variables:{input:r}})])}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}},qn=()=>{var e;const{formattedPermissions:t}=qt(),{searchResultData:a}=(0,r.KC)(),{EmpInsuranceData:l,workMenDetails:o,dropDownVal:d}=(0,n.useContext)(s.Y),{SubmitMPData:c}=Un(),{UpdateEIDataSubmit:p}=Bn(),[m,u]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""),[f,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)({empInsUpload:[]}),[b,D]=(0,n.useState)([]),[j,A]=(0,n.useState)([]),[w,S]=(0,n.useState)([{}]),[E,I]=(0,n.useState)([]),[k,T]=(0,n.useState)(""),[C,R]=(0,n.useState)([]),P=localStorage.getItem("userID"),{register:O,handleSubmit:_,setValue:M,watch:F,control:L,formState:{errors:U}}=(0,tt.mN)({defaultValues:{empStatusType:"",workmenCompNo:"",empInsUpload:[]},resolver:(0,at.t)(Gr)}),B=null===(e=d[0])||void 0===e?void 0:e.insuHSDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}))),q=F("otherNation"),[H,W]=(0,n.useState)(""),[z,Y]=(0,n.useState)([]),V=[{label:"Employee Badge Number",key:"empBadgeNo",type:"text"},{label:"Employee Name",key:"name",type:"text"},{label:"Department",key:"department",type:"text"},{label:"Position",key:"position",type:"text"},{label:"Date of Joining",key:"doj",type:"date"},{label:"Gender",key:"gender",type:"text"},{label:"Brunei I/C Number",key:"bwnIcNo",type:"text"},{label:"Passport Number for Non-Local",key:"ppNo",type:"text"},{label:"Date of Birth",key:"dob",type:"date"},{label:"Marital Status",key:"marital",type:"text"},{label:"Nationality",key:"nationality",type:"text"},{label:"Other Nationality",key:"otherNation",type:"text"},{label:"Group H&S Insurance",key:"groupIns",type:"select",options:B},{label:"Group H&S Insurance Enrollment Effective Date",key:"groupInsEffectDate",type:"date"},{label:"Group H&S Insurance Enrollment End Date",key:"groupInsEndDate",type:"date"},{label:"Travelling Insurance",key:"travelIns",type:"select",options:["Yes","No"]}],G=e=>{const t=F("empID");S((t=>t.filter(((t,a)=>a!==e))));const a=y.empInsUpload[e];if(!a)return void console.error("File not found at index:",e);const r=a.upload.split("/").pop();N((t=>(0,g.A)((0,g.A)({},t),{},{empInsUpload:t.empInsUpload.filter(((t,a)=>a!==e))}))),R((t=>null===t||void 0===t?void 0:t.filter((t=>(null===t||void 0===t?void 0:t.ind)!==e)).map(((e,t)=>(0,g.A)((0,g.A)({},e),{},{ind:t}))))),D((t=>null===t||void 0===t?void 0:t.filter((t=>(null===t||void 0===t?void 0:t.ind)!==e)).map(((e,t)=>(0,g.A)((0,g.A)({},e),{},{ind:t}))))),(0,_a.k)("empInsUpload",r,t),x("".concat(r)),Q()},J=async(e,a,r)=>{var n,s,i;const l=F("empID");if(!l)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/insuranceAdd");const o=null===(n=e.target.files)||void 0===n?void 0:n[0];if(!o)return;if(null!==y&&void 0!==y&&null!==(s=y.empInsUpload)&&void 0!==s&&null!==(i=s[r])&&void 0!==i&&i.upload)return alert("Please click Add Upload to upload a new one."),void(e.target.value="");if(["application/pdf","image/jpeg","image/jpg","image/png"].includes(o.type))try{await(async(e,a,r)=>{D([]),R((e=>{const n=0===e.length;let s=[];n&&(s=(null===j||void 0===j?void 0:j.map((e=>{var a,r;const n=null===t||void 0===t||null===(a=t.deleteAccess)||void 0===a||null===(r=a[Z])||void 0===r?void 0:r.some((e=>$.includes(e)));return(0,g.A)((0,g.A)({},e),{},{empInsUpload:n})})))||[]);const i=[...e.filter((e=>e.ind!==r)),{ind:r,empInsUpload:a}];return n?[...s,...i]:i}))})(0,!0,r);const e=await dt(o,a,N,l);e&&(N((t=>{const a=[...t.empInsUpload];return a[r]={date:(new Date).toISOString().split("T")[0],upload:e,value:!0},(0,g.A)((0,g.A)({},t),{},{empInsUpload:a})})),M("empInsUpload[".concat(r,"]"),e))}catch(d){console.error("Error uploading file:",d),alert("An error occurred while uploading the file. Please try again.")}else alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},K=e=>Array.isArray(e)?e[e.length-1]:e,Q=()=>{u(!m)};(0,n.useEffect)((()=>{if(!a)return;M("empID",a.empID);const e=K(a.empStatusType);e&&(W(e),M("empStatusType",e));const r=K(a.workmenCompNo);r&&M("workmenCompNo",r),V.forEach((e=>{void 0!==a[e.key]&&M(e.key,K(a[e.key]))}));["accidentIns"].forEach((e=>{var t;M(e,(t=a[e],Array.isArray(t)?t[t.length-1]:t))}));const n=null===a||void 0===a?void 0:a.empInsUpload;if(n)try{const e=JSON.parse(n);N((t=>(0,g.A)((0,g.A)({},t),{},{empInsUpload:e}))),S(e.map((e=>({}))));const a=e.map(((e,a)=>{var r,n;return{ind:a,empInsUpload:null===t||void 0===t||null===(r=t.deleteAccess)||void 0===r||null===(n=r[Z])||void 0===n?void 0:n.some((e=>$.includes(e)))}}));D(a),A(a)}catch(s){console.error("Failed to parse JSON:",s)}}),[a,M]),(0,n.useEffect)((()=>{if(H){const e=new Date,t=o.filter((t=>{var a;const r=new Date(t.workmenCompExp);return(null===(a=t.empStatusType)||void 0===a?void 0:a.toUpperCase())===H&&r>e})).sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)));Y(t);!F("workmenCompNo")&&t.length>0&&M("workmenCompNo",t[0].workmenCompNo)}}),[H,M,F,o]);const $=["Insurance"],Z="Employee";return(0,i.jsxs)("section",{children:[(0,i.jsxs)("form",{onSubmit:_((async e=>{const t=(new Date).toISOString().split("T")[0],a=y.empInsUpload.filter((e=>e.upload));N((e=>(0,g.A)((0,g.A)({},e),{},{empInsUpload:a}))),S((e=>e.slice(0,a.length)));const r=l.find((t=>t.empID===e.empID)),n=(0,g.A)((0,g.A)({},e),{},{empInsUpload:JSON.stringify(a)});if(r){n.id=r.id;const e=r.updatedBy?JSON.parse(r.updatedBy):[],a=JSON.stringify([...e,{userID:P,date:t}]);n.updatedBy=a,console.log(n,"empInsValue"),await p({empInsValue:n}),T("Employee Insurance Info updated successfully")}else n.createdBy=JSON.stringify([{userID:P,date:t}]),console.log(n,"empInsValue"),await c({empInsValue:n}),T("Employee Insurance Info Saved successfully");v(!0)})),className:"mx-auto p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:O,name:"empID",type:"text",watch:F("empID")||"",placeholder:"Enter Employee ID",errors:U})})}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-5 w-full ",children:V.map((e=>{var t;let{label:a,key:r,type:n,options:s=[],className:l=""}=e;return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:a}),"select"===n?(0,i.jsxs)("select",(0,g.A)((0,g.A)({},O(r)),{},{className:"input-field select-custom ".concat(l),children:[(0,i.jsx)("option",{value:"",children:"SELECT"}),s.map((e=>"string"===typeof e?(0,i.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},e):(0,i.jsx)("option",{value:e.value.toUpperCase(),children:e.label.toUpperCase()},e.value)))]})):"otherNation"===r?(0,i.jsx)("input",(0,g.A)((0,g.A)({type:n},O(r)),{},{className:"input-field ".concat(l),value:q||"N/A"})):(0,i.jsx)("input",(0,g.A)((0,g.A)({type:n},O(r)),{},{className:"input-field ".concat(l)})),U[r]&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:null===(t=U[r])||void 0===t?void 0:t.message})]},r)}))}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 mt-5",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:"Workmen Compensation Insurance"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},O("empStatusType")),{},{className:"input-field select-custom ",onChange:e=>W(e.target.value),value:H,children:[" ",(0,i.jsx)("option",{value:"",children:"SELECT"}),["OFFSHORE","ONSHORE","GENERAL"].map((e=>(0,i.jsx)("option",{value:e,children:e},e)))]}))]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:"Workmen Compensation Policy Number"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({},O("workmenCompNo")),{},{className:"input-field select-custom ",value:F("workmenCompNo")||"",onChange:e=>M("workmenCompNo",e.target.value),children:z.map((e=>(0,i.jsx)("option",{value:e.workmenCompNo,children:e.workmenCompNo},e.id)))}))]})]}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-5 mt-5 ",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text_size_5",children:"Personal Accident Insurance"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({className:"input-field select-custom"},O("accidentIns")),{},{children:[(0,i.jsx)("option",{value:"",children:"Select"}),(0,i.jsx)("option",{value:"YES",children:"YES"}),(0,i.jsx)("option",{value:"NO",children:"NO"})]}))]})}),(0,i.jsx)("div",{children:(0,i.jsxs)("button",{type:"button",onClick:()=>{S((e=>[...e,{}])),N((e=>(0,g.A)((0,g.A)({},e),{},{empInsUpload:[...e.empInsUpload]})))},className:" flex items-center text-[#5d5d5d] text-[20px] mt-10 gap-3 bg-white  p-2 rounded-md cursor-pointer",children:[(0,i.jsx)("p",{children:"Add Upload"})," ",(0,i.jsx)(Fr.tN3,{className:"mr-1"})]})}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-10 mt-7",children:w.map(((e,a)=>{var r,n,s,l,o,d,c;return(0,i.jsxs)("div",{className:"form-group w-full relative",children:[(0,i.jsxs)("label",{className:"w-full flex items-center px-3 py-3 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] rounded-md cursor-pointer",onClick:()=>{var e,t;null!==y&&void 0!==y&&null!==(e=y.empInsUpload)&&void 0!==e&&null!==(t=e[a])&&void 0!==t&&t.upload&&alert("Please click Add Upload to upload a new one.")},children:[(0,i.jsx)(tt.xI,{name:"empInsUpload[".concat(a,"]"),control:L,render:e=>{var t,r;let{field:n}=e;return(0,i.jsx)("input",{type:"file",onChange:e=>{J(e,"empInsUpload",a)},className:"hidden",disabled:null===y||void 0===y||null===(t=y.empInsUpload)||void 0===t||null===(r=t[a])||void 0===r?void 0:r.upload})}}),(0,i.jsxs)("span",{className:"ml-2 w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),(0,i.jsx)("p",{className:"text-grey mt-1 text-xs",children:null!==(r=y.empInsUpload[a])&&void 0!==r&&r.upload?y.empInsUpload[a].upload.split("/").pop():null===(n=E[a])||void 0===n?void 0:n.name}),!0===(null===(s=b[a])||void 0===s?void 0:s.empInsUpload)&&b&&b.length>0&&null!==t&&void 0!==t&&null!==(l=t.deleteAccess)&&void 0!==l&&null!==(o=l[Z])&&void 0!==o&&o.some((e=>$.includes(e)))||!0===(null===(d=C[a])||void 0===d?void 0:d.empInsUpload)&&null!==(c=y.empInsUpload[a])&&void 0!==c&&c.upload&&C&&C.length>0?(0,i.jsx)("button",{type:"button",onClick:()=>{G(a)},className:"absolute top-1/2 -right-8 transform -translate-y-1/2 flex items-center text-medium_grey text-[20px]",children:(0,i.jsx)(_t.uDv,{className:"mr-1 text-[red]"})}):(0,i.jsx)("span",{})]},a)}))}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),f&&(0,i.jsx)(Pe,{text:k,notification:f,path:"/insuranceAdd"})]}),m&&(0,i.jsx)(Wt,{handleDeleteMsg:Q,title1:h})]})},Hn=e=>{var t;let{dropDownVal:a,register:r,errors:n,index:s,selectedNationality:l,handleNationalityChange:o,watch:d}=e;const c=d("depInsurance[".concat(s,"].depenotherNation")||0),p=d("depInsurance[".concat(s,"].depenNation")||0),m=null===(t=a[0])||void 0===t?void 0:t.nationalityDD.map((e=>({value:e,label:e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})));return(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,i.jsx)(mt,{label:"Gender",register:r,name:"depInsurance[".concat(s,"].depenGender"),type:"select",options:ht,errors:n}),(0,i.jsx)(mt,{label:"Date of Birth",register:r,name:"depInsurance[".concat(s,"].depenDob"),type:"date",errors:n}),(0,i.jsx)(mt,{label:"Nationality",register:r,name:"depInsurance[".concat(s,"].depenNation"),type:"select",options:m,errors:n,onChange:o}),("OTHER"===l||c&&"OTHER"===p)&&(0,i.jsx)(mt,{label:"Other Nationality",register:r,name:"depInsurance[".concat(s,"].depenotherNation"),type:"text",errors:n}),(0,i.jsx)(mt,{label:"Birth Certificate Number (Below Age 12)",register:r,name:"depInsurance[".concat(s,"].depenBcNo"),type:"text",errors:n}),(0,i.jsx)(mt,{label:"Brunei I/C Number",register:r,name:"depInsurance[".concat(s,"].depenIcNumber"),type:"text",errors:n}),(0,i.jsx)(mt,{label:"Passport Number for Non-Local",register:r,name:"depInsurance[".concat(s,"].depenPpNo"),type:"text",errors:n}),(0,i.jsx)(mt,{label:"Group H&S Insurance Enrollment Effective Date",register:r,name:"depInsurance[".concat(s,"].depenGroupInsEffect"),type:"date",errors:n}),(0,i.jsx)(mt,{label:"Group H&S Insurance Enrollment End Date",register:r,name:"depInsurance[".concat(s,"].depenGroupInsEnd"),type:"date",errors:n}),(0,i.jsx)(mt,{label:"Travelling Insurance Enrollment Effective Date",register:r,name:"depInsurance[".concat(s,"].depenTravelInsEffect"),type:"date",errors:n}),(0,i.jsx)(mt,{label:"Travelling Insurance Enrollment End Date",register:r,name:"depInsurance[".concat(s,"].depenTravelInsEnd"),type:"date",errors:n}),(0,i.jsx)(mt,{label:"Personal Accident Insurance Enrollment Effective Date",register:r,name:"depInsurance[".concat(s,"].depenPersonInsEffect"),type:"date",errors:n}),(0,i.jsx)(mt,{label:"Personal Accident Insurance Enrollment End Date",register:r,name:"depInsurance[".concat(s,"].depenPersonInsEnd"),type:"date",errors:n})]})})},Wn=e=>{var t,a;let{register:r,errors:n,index:s}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 flex-wrap",children:[(0,i.jsx)(mt,{label:"Dependent Name",register:r,name:"depInsurance[".concat(s,"].depenName"),type:"text",errors:n}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:"Relationship"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},r("depInsurance[".concat(s,"].depenRelation"))),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"Spouse",children:"Spouse"}),(0,i.jsx)("option",{value:"Child",children:"Child"})]})),(null===(t=n.depInsurance)||void 0===t||null===(a=t[s])||void 0===a?void 0:a.depenRelation)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:n.depInsurance[s].depenRelation.message})]})]})},zn=()=>{var e;const{formattedPermissions:t}=qt();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{depInsuranceData:a,dropDownVal:l}=(0,n.useContext)(s.Y),{SubmitMPData:o}=(()=>{const e=(0,Ee.D)();return{SubmitMPData:(0,n.useCallback)((async t=>{let{depValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,depInsurance:JSON.stringify(a.depInsurance),createdBy:a.createdBy};console.log(r);try{const t=await Promise.all([e.graphql({query:ke.A2,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{UpdateDIData:d}=(()=>{const e=(0,Ee.D)();return{UpdateDIData:(0,n.useCallback)((async t=>{let{depValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,depInsurance:JSON.stringify(a.depInsurance),id:a.id,updatedBy:a.updatedBy};try{await Promise.all([e.graphql({query:ke.Zk,variables:{input:r}})])}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),[c,p]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(!1),{depInsuData:f}=(0,r.KC)(),v=localStorage.getItem("userID"),[y,N]=(0,n.useState)(""),{register:b,handleSubmit:D,formState:{errors:j},setValue:A,watch:w,trigger:S}=(0,tt.mN)({resolver:(0,at.t)(Jr),defaultValues:{depInsurance:[{}]}}),[E,I]=(0,n.useState)([{id:Date.now()}]),[k,T]=(0,n.useState)({depInsurance:[]}),[C,R]=(0,n.useState)({depInsurance:[]}),[P,O]=(0,n.useState)({depInsurance:[]}),[_,M]=(0,n.useState)({depInsurance:[]}),[F,L]=(0,n.useState)(E),[U,B]=(0,n.useState)(""),q=((0,n.useRef)(!0),["Insurance"]),H="Employee",W=(w("empID"),w("depInsurance")),z=null===(e=l[0])||void 0===e?void 0:e.insuClaimDD.map((e=>({value:e,label:e}))),Y=e=>{N(e.target.value)},V=async(e,t,a)=>{var r;const n=w("empID");if(!n)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const s=null===(r=e.target.files)||void 0===r?void 0:r[0];if(!s)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(s.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");if((w(t)||[]).some((e=>e.name===s.name)))alert("This file has already been uploaded.");else{A("depInsurance[".concat(a,"].depenInfUpload"),s);try{i=t,l=!0,o=a,T((e=>(0,g.A)((0,g.A)({},e),{},{[i]:(0,g.A)((0,g.A)({},e[i]),{},{[o]:l})})));await(async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result,i=s.path,l=(new Date).toISOString().split("T")[0];console.log(s),a((e=>{e||(e={});const a=(0,g.A)({},e);return a[t]&&"object"===typeof a[t]||(a[t]={}),"undefined"===typeof n||null===n?(console.error("Invalid index:",n),e):(Array.isArray(a[t][n])||(a[t][n]=[]),a[t][n].find((e=>e.upload===i))||(a[t][n]=[...a[t][n],{upload:i,date:l}]),console.log("Updated Uploads:",a),a)}))}}catch(s){console.log("Error uploading ".concat(t,":, error"))}})(s,t,O,n,a);R((e=>{var t;return(0,g.A)((0,g.A)({},e),{},{depInsurance:(0,g.A)((0,g.A)({},e.depInsurance),{},{[a]:[...(null===(t=e.depInsurance)||void 0===t?void 0:t[a])||[],{name:s.name}]})})}))}catch(d){console.error(d)}var i,l,o}};(0,n.useEffect)((()=>{A("empID",null===f||void 0===f?void 0:f.empID);const e=null===f||void 0===f?void 0:f.depInsurance;if(e)try{const a=JSON.parse(e);if(!Array.isArray(a))return void console.error("Invalid depInsurance data format:",e);A("depInsurance",[]),a&&a.length>0&&(L(a),A("depInsurance",a),a.forEach(((e,r)=>{if(null!==e&&void 0!==e&&e.depenInfUpload)try{const n=e.depenInfUpload;if(Array.isArray(n)&&0===n.length)return;const s="string"===typeof n?JSON.parse(n):n;if(!Array.isArray(s))return void console.error("Invalid depenInfUpload format:",n);const i=s.map((e=>{try{return"string"===typeof e?JSON.parse(e):e}catch(t){return console.error("Error parsing nested depenInfUpload item:",e),null}})).filter(Boolean);O((e=>(0,g.A)((0,g.A)({},e),{},{depInsurance:(0,g.A)((0,g.A)({},e.depInsurance),{},{[r]:i})}))),M((e=>(0,g.A)((0,g.A)({},e),{},{depInsurance:(0,g.A)((0,g.A)({},e.depInsurance),{},{[r]:i})})));const l=a.map(((e,a)=>{var r,n;return{ind:a,empInsUpload:null===t||void 0===t||null===(r=t.deleteAccess)||void 0===r||null===(n=r[H])||void 0===n?void 0:n.some((e=>q.includes(e)))}}));R([...l])}catch(n){console.error("Error parsing depenInfUpload JSON:",e.depenInfUpload)}})))}catch(a){console.error("Error parsing depInsurance data:",a)}}),[f]);const G=()=>{p(!c)},J=async(e,t,a)=>{try{const r=w("empID");if(!r)return void alert("Please provide the Employee ID before deleting files.");const n=await(0,_a.k)(e,t,r),s=await((e,t,a,r,n)=>{try{a((t=>{const a=(0,g.A)({},t);return Object.keys(a).forEach((t=>{a[t]===e&&delete a[t]})),a})),r((t=>{const a=(0,g.A)({},t);a.depInsurance&&"object"===typeof a.depInsurance||(a.depInsurance={}),Array.isArray(a.depInsurance[n])||(a.depInsurance[n]=[]);const r=a.depInsurance[n].findIndex((t=>t.upload.includes("/".concat(e))));return-1!==r&&a.depInsurance[n].splice(r,1),0===a.depInsurance[n].length&&delete a.depInsurance[n],a}))}catch(s){console.log("Caught error:",s)}})(t,0,R,M,a),i=(e,t)=>Array.isArray(e)?e.map((e=>(null===e||void 0===e?void 0:e.ind)===t?(0,g.A)((0,g.A)({},e),{},{empInsUpload:!1}):e)).map(((e,t)=>(0,g.A)((0,g.A)({},e),{},{ind:t}))):[];if(T((e=>i(e,a))),R((e=>i(e,a))),!n||s)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));u("".concat(t)),G()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}};return(0,i.jsxs)("div",{className:"bg-[#F5F6F1CC] mx-auto p-2 py-10",children:[(0,i.jsxs)("form",{className:"flex flex-col gap-5",onSubmit:D((async e=>{try{const s=a.find((t=>t.empID===e.empID)),i=(new Date).toISOString().split("T")[0];if(s){var t,r;const a=s.updatedBy?JSON.parse(s.updatedBy):[],n=JSON.stringify([...a,{userID:v,date:i}]),l=(0,g.A)((0,g.A)({},e),{},{depInsurance:null===e||void 0===e||null===(t=e.depInsurance)||void 0===t||null===(r=t.filter(((e,t)=>Object.values(e).some((e=>"string"===typeof e?""!==e.trim():Array.isArray(e)?e.length>0:null!==e&&void 0!==e)))))||void 0===r?void 0:r.map(((e,t)=>{var a,r,n;return(0,g.A)((0,g.A)({},e),{},{depenInfUpload:(null===P||void 0===P||null===(a=P.depInsurance)||void 0===a||null===(r=a[t])||void 0===r?void 0:r.length)>0?JSON.stringify(null===P||void 0===P||null===(n=P.depInsurance)||void 0===n?void 0:n[t]):[]})})),id:s.id,updatedBy:n});await d({depValue:l}),B("Dependent Insurance Info Updated successfully"),x(!0)}else{var n;const t=(0,g.A)((0,g.A)({},e),{},{depInsurance:null===e||void 0===e||null===(n=e.depInsurance)||void 0===n?void 0:n.map(((e,t)=>{var a;return(0,g.A)((0,g.A)({},e),{},{depenInfUpload:JSON.stringify(null===P||void 0===P||null===(a=P.depInsurance)||void 0===a?void 0:a[t])||[]})})),createdBy:JSON.stringify([{userID:v,date:i}])});await o({depValue:t}),B("Dependent Insurance Info saved successfully"),x(!0)}}catch(s){console.error("Error in submitting data:",s)}})),children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsxs)("div",{className:"max-w-sm",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee ID"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",placeholder:"Enter Employee ID"},b("empID"))),j.empID&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:j.empID.message})]})}),(0,i.jsx)("button",{type:"button",onClick:()=>{const e={id:Date.now()};L((t=>[...t,e]))},className:"absolute right-3 mt-10 text-medium_grey text-[25px]",children:(0,i.jsx)(Fr.tN3,{className:"mr-1"})}),F&&F.length>0&&F.filter((e=>Object.values(e).some((e=>""!==e&&null!==e&&void 0!==e&&!(Array.isArray(e)&&0===e.length))))).map(((e,a)=>{var r,n,s,o,d,c,p,m,u,h,x,f;return(0,i.jsxs)("div",{className:"flex flex-col gap-5 border-b pb-10",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,i.jsx)(mt,{label:"Type of Insurance Claim",register:b,name:"depInsurance[".concat(a,"].depenInsType"),type:"select",options:z,errors:null===(r=j.insuranceClaims)||void 0===r?void 0:r[a]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:"Dependent Information"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},b("depInsurance[".concat(a,"].depenInfo"))),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"Spouse",children:"Spouse"}),(0,i.jsx)("option",{value:"Child",children:"Child"}),(0,i.jsx)("option",{value:"Spouse&Child",children:"Spouse & Child"})]})),(null===(n=j.depInsurance)||void 0===n||null===(s=n[a])||void 0===s?void 0:s.depenInfo)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:j.depInsurance[a].depenInfo.message})]})]}),(0,i.jsx)(Wn,{register:b,errors:j,index:a}),(0,i.jsx)(Hn,{register:b,errors:j,index:a,watch:w,selectedNationality:y,handleNationalityChange:Y,dropDownVal:l}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-10",children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{onClick:()=>{var e,t;(null===C||void 0===C||null===(e=C.depInsurance)||void 0===e||null===(t=e[a])||void 0===t?void 0:t.length)>0&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"flex items-center px-3 py-3 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] rounded-md cursor-pointer",children:["Upload",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file"},b("depInsurance[".concat(a,"].depenInfUpload"))),{},{onChange:e=>V(e,"depInsurance",a),accept:"application/pdf",className:"hidden",disabled:null===k||void 0===k||null===(o=k.depInsurance)||void 0===o?void 0:o[a]})),(0,i.jsx)(ut.gwN,{className:"ml-1"})]}),(0,i.jsx)("div",{className:"flex flex-col",children:null!==C&&void 0!==C&&null!==(d=C.depInsurance)&&void 0!==d&&d[a]&&Array.isArray(null===C||void 0===C||null===(c=C.depInsurance)||void 0===c?void 0:c[a])&&(null===C||void 0===C||null===(p=C.depInsurance)||void 0===p?void 0:p[a].length)>0?(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-secondary text-xs pt-1",children:null===C||void 0===C||null===(m=C.depInsurance)||void 0===m||null===(u=m[a])||void 0===u?void 0:u.map((e=>e.name)).join(", ")}),(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{var e,t,r;return J("depInsurance",null===C||void 0===C||null===(e=C.depInsurance)||void 0===e||null===(t=e[a])||void 0===t||null===(r=t[0])||void 0===r?void 0:r.name,a)},children:(0,i.jsx)(_t.uDv,{})})]}):Array.isArray(null===_||void 0===_||null===(h=_.depInsurance)||void 0===h?void 0:h[a])?null===_||void 0===_||null===(x=_.depInsurance)||void 0===x||null===(f=x[a])||void 0===f?void 0:f.slice().sort(((e,t)=>new Date(t.date)-new Date(e.date))).map(((e,r)=>{var n,s,l;return(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-secondary text-xs pt-1",children:null===(n=e.upload)||void 0===n?void 0:n.split("/").pop()}),(null===t||void 0===t||null===(s=t.deleteAccess)||void 0===s||null===(l=s[H])||void 0===l?void 0:l.some((e=>q.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{var t;return J("depInsurance",null===(t=e.upload)||void 0===t?void 0:t.split("/").pop(),a)},children:(0,i.jsx)(_t.uDv,{})})]},r)})):""}),(null===j||void 0===j?void 0:j.depenInfUpload)&&(0,i.jsx)("p",{className:"text-red text-sm",children:j.depenInfUpload.message})]})}),a>0&&(0,i.jsx)("button",{type:"button",onClick:()=>(async e=>{const t=W.filter(((t,a)=>a!==e)).map((e=>(0,g.A)({},e)));L(t),A("depInsurance",t),O((t=>{if(!t.depInsurance)return t;const a=Object.entries(t.depInsurance).filter((t=>{let[a]=t;return Number(a)!==e})).map((e=>{let[,t]=e;return t})),r=Object.fromEntries(a.map(((e,t)=>[t,e])));return(0,g.A)((0,g.A)({},t),{},{depInsurance:r})})),R((t=>{if(!t.depInsurance)return t;const a=(0,g.A)({},t.depInsurance);delete a[e];const r=Object.values(a).reduce(((e,t,a)=>(e[a]=t,e)),{});return(0,g.A)((0,g.A)({},t),{},{depInsurance:r})})),M((t=>{if(!t.depInsurance)return t;const a=Object.entries(t.depInsurance).filter((t=>{let[a]=t;return Number(a)!==e})).map((e=>{let[,t]=e;return t})),r=Object.fromEntries(a.map(((e,t)=>[t,e])));return(0,g.A)((0,g.A)({},t),{},{depInsurance:r})}))})(a),className:"text-red-500 mt-2 text-medium_grey text-[25px]",children:(0,i.jsx)(Fr.prK,{})})]},a)})),(0,i.jsx)("div",{className:"md:col-span-2 flex justify-center mt-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),h&&(0,i.jsx)(Pe,{text:U,notification:h,path:"/insuranceAdd/dependentInsurance"})]}),c&&(0,i.jsx)(Wt,{handleDeleteMsg:G,title1:m})]})},Yn=()=>{const{empPIData:e,SawpDetails:t,DNData:a,BJLData:l,PPValidsData:o}=(0,n.useContext)(s.Y),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)("sawp"),[u,h]=(0,n.useState)([]),[x,f]=(0,n.useState)(""),[v,y]=(0,n.useState)([]),N=(0,r.Zp)(),b=(0,r.zy)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");f(e)}),[]),(0,n.useEffect)((()=>{(async()=>{try{const r=e.map((e=>{const r=t?t.find((t=>t.empID===e.empID)):{},n=l?l.find((t=>t.empID===e.empID)):{},s=o?o.find((t=>t.empID===e.empID)):{},i=a?a.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),i),s),n)})).filter(Boolean);c(r)}catch(r){console.log(r)}})()}),[e,t,a,l,o]);const D=(e,t)=>{m(e),N(t)};(0,n.useEffect)((()=>{const e=b.pathname;e.includes("/doe")?m("doe"):e.includes("/nlms")?m("nlms"):e.includes("/bankGuarantee")?m("bankGuarantee"):e.includes("/jitpa")?m("jitpa"):e.includes("/labourDeposit")?m("labourDeposit"):e.includes("/immigration")?m("immigration"):m("sawp")}),[b]);const A=e=>{h(e)};return(0,i.jsx)("section",{className:"w-full min-h-screen bg-[#F5F6F1]",onClick:()=>{y([])},children:(0,i.jsxs)("div",{className:"relative mx-auto p-10 h-full",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/employee",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Employee Work Pass"}),(0,i.jsx)("div",{className:"flex-1",children:"/sawp"===b.pathname||"/sawp/doe"===b.pathname||"/sawp/nlms"===b.pathname||"/sawp/bankGuarantee"===b.pathname||"/sawp/jitpa"===b.pathname||"/sawp/labourDeposit"===b.pathname||"/sawp/immigration"===b.pathname?(0,i.jsx)(ea,{searchResult:A,newFormData:d,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",empID:x,filteredEmployees:v,setFilteredEmployees:y}):null})]}),(0,i.jsxs)("div",{className:"flex justify-between border-b m-4 text-[16px] font-semibold",children:[(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("sawp"===p?"border-b-8 border-yellow":""),onClick:()=>D("sawp","/sawp"),children:"SAWP"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("doe"===p?"border-b-8 border-yellow":""),onClick:()=>D("doe","/sawp/doe"),children:"DOE"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("nlms"===p?"border-b-8 border-yellow":""),onClick:()=>D("nlms","/sawp/nlms"),children:"NLMS"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("bankGuarantee"===p?"border-b-8 border-yellow":""),onClick:()=>D("bankGuarantee","/sawp/bankGuarantee"),children:"BANK GUARANTEE"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("jitpa"===p?"border-b-8 border-yellow":""),onClick:()=>D("jitpa","/sawp/jitpa"),children:"JITPA"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("labourDeposit"===p?"border-b-8 border-yellow":""),onClick:()=>D("labourDeposit","/sawp/labourDeposit"),children:"LABOUR DEPOSIT"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("immigration"===p?"border-b-8 border-yellow":""),onClick:()=>D("immigration","/sawp/immigration"),children:"IMMIGRATION"})]}),(0,i.jsx)("div",{children:(0,i.jsx)(r.sv,{context:{activeNavTab:p,handleNext:()=>{switch(p){case"sawp":N("/sawp"),m("doe");break;case"doe":N("/sawp/doe"),m("nlms");break;case"nlms":N("/sawp/nlms"),m("bankGuarantee");break;case"bankGuarantee":N("/sawp/bankGuarantee"),m("jitpa");break;case"jitpa":N("/sawp/jitpa"),m("labourDeposit");break;case"labourDeposit":N("/sawp/labourDeposit"),m("immigration");break;case"immigration":N("/sawp/immigration"),m("immigration")}},searchResultData:u}})})]})})},Vn=()=>{const e=(0,Ee.D)();return{NLADatas:(0,n.useCallback)((async t=>{let{NLACreValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,accommodation:[a.accommodation],accommodationAddress:[a.accommodationAddress],createdBy:a.createdBy};console.log(r);try{const t=await Promise.all([e.graphql({query:ke.LX,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}},Gn=()=>{const e=(0,Ee.D)(),[t,a]=(0,n.useState)("");return{NLAUpdateFun:(0,n.useCallback)((async t=>{let{NLAValue:r}=t;if(!r)throw a("All fields (empID, accommodation, accommodationAddress, IDTable, updatedBy) are required."),new Error("Missing required parameters");try{const{empID:t,accommodation:n,accommodationAddress:s,updatedBy:i,IDTable:l}=r,o={id:l,empID:t,accommodation:n,accommodationAddress:s,updatedBy:i};await e.graphql({query:ke.cV,variables:{input:o}});a("")}catch(n){throw console.error("Error updating data:",n),a("Error updating employee data. Please try again."),n}}),[]),errorEmpID:t}},Jn=()=>{const{NLADatas:e,errorEmpID:t}=Vn(),{NLAUpdateFun:a}=Gn(),{empPIData:l,IDData:o,NLAData:d}=(0,n.useContext)(s.Y),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)(!1),[f,v]=(0,n.useState)([]),[y,N]=(0,n.useState)(""),[b,D]=(0,n.useState)(!1),A=localStorage.getItem("userID");(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,n.useEffect)((()=>{(async()=>{try{const e=l.map((e=>{const t=d?d.find((t=>t.empID===e.empID)):{},a=o?o.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)({},e),t),a)})).filter(Boolean);p(e),u(e)}catch(e){console.error("Error fetching data:",e)}})()}),[l,d]);const{register:w,handleSubmit:S,setValue:E,watch:I,formState:{errors:k}}=(0,tt.mN)({resolver:(0,at.t)(Wr)});return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center  p-10 bg-[#F5F6F1]",onClick:()=>{v([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/employee",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Non-Local Accommodation in Brunei"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(ea,{searchResult:e=>{e&&D(!0);["empID","empBadgeNo"].forEach((t=>{const a=e[t];E(t,"string"===typeof a?a:"")}));["name","accommodation","accommodationAddress"].forEach((t=>{const a=void 0!==e[t]&&null!==e[t]?e[t].toString().trim().toUpperCase():"";E(t,a)}));["accommodation","accommodationAddress"].forEach((t=>{void 0!==e[t]&&E(t,(e=>{var t;return Array.isArray(e)&&e.length>0?null===(t=e[e.length-1])||void 0===t?void 0:t.toString().trim().toUpperCase():"string"===typeof e?e.trim().toUpperCase():null})(e[t]))}))},newFormData:m,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:f,setFilteredEmployees:v})})]}),(0,i.jsxs)("form",{className:"h-screen   w-full",onSubmit:S((async t=>{if(t.empID)try{const r=l.find((e=>e.empID===t.empID)),n=d.find((e=>e.empID===t.empID)),s=(new Date).toISOString().split("T")[0];if(n&&r){const e=n.updatedBy?JSON.parse(n.updatedBy):[],i=JSON.stringify([...e,{userID:A,date:s}]),l=(0,g.A)((0,g.A)({},t),{},{PITableID:r.id,IDTable:n.id,updatedBy:i});console.log("update",l),await a({NLAValue:l}),N("Details updated successfully"),x(!0)}else{const a=(0,g.A)((0,g.A)({},t),{},{createdBy:JSON.stringify([{userID:A,date:s}])});console.log("NLACreValue",a),await e({NLACreValue:a}),N("Details saved successfully"),x(!0)}}catch(r){console.log(r),console.error("Error submitting data to AWS:",JSON.stringify(r,null,2))}else console.error("empID is missing")})),children:[(0,i.jsx)("div",{className:"flex justify-end items-center mt-14",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:w,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:k,trackEmpID:b})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-6 mt-10",children:[(0,i.jsx)(mt,{label:"Badge Number",register:w,name:"empBadgeNo",type:"text",value:I("empBadgeNo")||"",errors:k}),(0,i.jsx)(mt,{label:"Name",register:w,name:"name",type:"text",errors:k}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text_size_5",children:"Accommodation"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({className:"input-field select-custom"},w("accommodation")),{},{children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"COMPANY PREMISES",children:"COMPANY PREMISES"}),(0,i.jsx)("option",{value:"OWN PREMISES",children:"OWN PREMISES"})]})),k.accommodation&&(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:k.accommodation.message})]}),(0,i.jsxs)("div",{className:"col-span-1",children:[(0,i.jsx)("label",{className:"block text_size_5",children:"Accommodation Address"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field"},w("accommodationAddress"))),k.accommodationAddress&&(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:k.accommodationAddress.message})]})]}),(0,i.jsx)("div",{className:"flex justify-center items-center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),h&&(0,i.jsx)(Pe,{text:y,notification:h,path:"/employee"})]})]})};const Kn=a.p+"static/media/lock.8b3c70d53923d4f1b00fadb4331d1371.svg";var Qn=a(1957),$n=a(432);const Zn=(0,Ee.D)(),Xn=()=>{var e,t,a,s;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),{register:u,formState:{errors:h},handleSubmit:x}=(0,tt.mN)({resolver:(0,at.t)(rt.$A)}),[f,v]=(0,n.useState)(""),y=x((async e=>{const{password:t,currentPassword:a}=e;try{var r;const e=await(0,nt.H)(),o=null===(r=localStorage.getItem("userID"))||void 0===r?void 0:r.toUpperCase();if(e){await(0,Qn.f)({oldPassword:a,newPassword:t});let e=[],r=null;do{var n,s,i,l;const t=await Zn.graphql({query:Ie.ZZ,variables:{filter:{empID:{eq:o}},nextToken:r}});e=[...e,...(null===t||void 0===t||null===(n=t.data)||void 0===n||null===(s=n.listUsers)||void 0===s?void 0:s.items)||[]],r=null===t||void 0===t||null===(i=t.data)||void 0===i||null===(l=i.listUsers)||void 0===l?void 0:l.nextToken}while(r);if(e.length>0){const a=e[0].id;await Zn.graphql({query:ke.TK,variables:{input:{id:a,password:t}}}).then((async e=>{console.log(e),localStorage.removeItem("userID"),localStorage.removeItem("userType"),await(0,$n.C)(),window.location.href="/login"})),console.log("Password reset successfully")}else console.log("User not found")}}catch(f){console.log(f),v(f.message)}}));return(0,i.jsxs)("section",{className:"screen-size mx-auto flex absolute top-0 left-0 min-h-screen ",children:[(0,i.jsx)("div",{className:"flex-1 border-r-2 border-[#E9E9E9] center",children:(0,i.jsx)("img",{className:"w-full max-w-[450px]",src:Kn,alt:" Rightside Image not found"})}),(0,i.jsxs)("div",{className:"flex-1 flex items-center gap-8 py-20 flex-col w-full",children:[(0,i.jsxs)("div",{children:[" ",(0,i.jsx)("img",{className:"w-full max-w-[450px]",src:Se.A,alt:" Logo not found"})]}),f&&(0,i.jsx)("p",{className:"text-red",children:f}),(0,i.jsxs)("section",{className:" space-y-5",children:[(0,i.jsx)("h4",{className:"title text-center",children:"Change Password"}),(0,i.jsxs)("div",{className:"w-[400px] space-y-1",children:[(0,i.jsx)("label",{htmlFor:"userID",className:"text-dark_grey text_size_8",children:"Login ID"}),(0,i.jsx)("div",{className:"shadow-md shadow-[#00000040] border border-[#D3D3D3] overflow-hidden rounded-lg py-1 px-3 w-full",children:(0,i.jsx)("input",(0,g.A)({className:"outline-none py-2 w-full",type:"text",id:"userID",name:"userID"},u("userID")))}),(0,i.jsx)("p",{className:"text-[red] text-sm my-2 ml-5",children:null===(e=h.userID)||void 0===e?void 0:e.message})]}),(0,i.jsxs)("div",{className:"w-[400px] space-y-1",children:[(0,i.jsx)("label",{htmlFor:"currentPassword",className:"text-dark_grey text_size_8",children:"Current Password"}),(0,i.jsxs)("div",{className:"shadow-md shadow-[#00000040] border border-[#D3D3D3] overflow-hidden rounded-lg py-1 pl-3 pr-4 w-full center",children:[(0,i.jsx)("input",(0,g.A)({className:"outline-none py-2 w-full",type:l?"text":"password",id:"currentPassword",name:"currentPassword"},u("currentPassword"))),l?(0,i.jsx)(j.whC,{className:"text-2xl text-[#837E7E]",onClick:()=>o(!l)}):(0,i.jsx)(j.Rds,{className:"text-2xl text-[#837E7E]",onClick:()=>o(!l)})]}),(0,i.jsx)("p",{className:"text-[red] text-sm my-2 ml-5",children:null===(t=h.password)||void 0===t?void 0:t.message})]}),(0,i.jsxs)("div",{className:"w-[400px] space-y-1",children:[(0,i.jsx)("label",{htmlFor:"password",className:"text-dark_grey text_size_8",children:"New Password"}),(0,i.jsxs)("div",{className:"shadow-md shadow-[#00000040] border border-[#D3D3D3] overflow-hidden rounded-lg py-1 pl-3 pr-4 w-full center",children:[(0,i.jsx)("input",(0,g.A)({className:"outline-none py-2 w-full",type:d?"text":"password",id:"password",name:"password"},u("password"))),d?(0,i.jsx)(j.whC,{className:"text-2xl text-[#837E7E]",onClick:()=>c(!d)}):(0,i.jsx)(j.Rds,{className:"text-2xl text-[#837E7E]",onClick:()=>c(!d)})]}),(0,i.jsx)("p",{className:"text-[red] text-sm my-2 ml-5",children:null===(a=h.password)||void 0===a?void 0:a.message})]}),(0,i.jsxs)("div",{className:"w-[400px] space-y-1",children:[(0,i.jsx)("label",{htmlFor:"confirmPassword",className:"text-dark_grey text_size_8",children:"Confirm Password"}),(0,i.jsxs)("div",{className:"shadow-md shadow-[#00000040] border border-[#D3D3D3] overflow-hidden rounded-lg py-1 pl-3 pr-4 w-full center",children:[(0,i.jsx)("input",(0,g.A)({className:"outline-none py-2 w-full",type:p?"text":"password",id:"confirmPassword",name:"confirmPassword"},u("confirmPassword"))),p?(0,i.jsx)(j.whC,{className:"text-2xl text-[#837E7E]",onClick:()=>m(!p)}):(0,i.jsx)(j.Rds,{className:"text-2xl text-[#837E7E]",onClick:()=>m(!p)})]}),(0,i.jsx)("p",{className:"text-[red] text-sm my-2 ml-5",children:null===(s=h.password)||void 0===s?void 0:s.message})]}),(0,i.jsx)("div",{className:"center pb-5",children:(0,i.jsx)(r.N_,{to:"/dashboard",className:"primary_btn text_size_4 my-5",onClick:y,children:"Update"})}),(0,i.jsx)("hr",{className:"border-[1.5px] text-[#B3B3B3]"})]})]})]})};var es=a(423);const ts=(0,Ee.D)(),as=e=>{const[t,a]=(0,n.useState)({id:"",name:"",email:"",contactNo:"",dob:""}),[r,s]=(0,n.useState)(!1),[i,l]=(0,n.useState)(!0),[o,d]=(0,n.useState)(null);return(0,n.useEffect)((()=>{e&&(async()=>{l(!0),d(null);let t=[],r=null;try{do{const e=await ts.graphql({query:Ie.it,variables:{nextToken:r}});t=[...t,...e.data.listEmpPersonalInfos.items],r=e.data.listEmpPersonalInfos.nextToken}while(r);const n=t.find((t=>t.empID.toLowerCase()===e.toLowerCase()));n?a({id:n.id,name:n.name,email:n.email,contactNo:n.contactNo||"",dob:n.dob||""}):d("No employee found with ID: ".concat(e))}catch(n){d("Error fetching employee personal information."),console.error("Error fetching employee personal info:",n)}finally{l(!1)}})()}),[e]),{personalInfo:t,isEditing:r,setIsEditing:s,handleSave:async()=>{const r={id:t.id,empID:e.toUpperCase(),name:t.name,email:t.email,contactNo:t.contactNo,dob:t.dob};try{const e=await ts.graphql({query:ke.CD,variables:{input:r}});if(e.data.updateEmpPersonalInfo){const t=e.data.updateEmpPersonalInfo;a({id:t.id,name:t.name,email:t.email,contactNo:t.contactNo,dob:t.dob}),s(!1)}}catch(n){console.error("Error saving data:",n)}},setPersonalInfo:a,loading:i,error:o}},rs=()=>{const[e,t]=(0,n.useState)(""),{personalInfo:a,isEditing:s,setIsEditing:l,handleSave:o,setPersonalInfo:d}=as(e),c=e=>{const{name:t,value:r}=e.target;d((0,g.A)((0,g.A)({},a),{},{[t]:r}))};return(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");t(e),console.log("UserID from localStorage:",e)}),[]),(0,i.jsx)("section",{className:"screen-size center py-20",children:(0,i.jsxs)("div",{className:"rounded-lg shadow-lg p-5 px-10 space-y-4 max-w-xl w-full text_size_8 text-dark_grey",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h3",{className:"text_size_2",children:"Personal Information"}),(0,i.jsx)(r.N_,{to:"/dashboard",children:(0,i.jsx)(es.WQq,{className:"text-2xl font-semibold"})})]}),(0,i.jsx)("hr",{className:"border border-[#d4cfcf]"}),(0,i.jsxs)("section",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"flex justify-between gap-10",children:(0,i.jsxs)("div",{className:"w-full space-y-2 ",children:[(0,i.jsx)("label",{htmlFor:"name",children:"Name"}),(0,i.jsx)("div",{className:"border rounded-sm flex-1 border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-3 ",children:(0,i.jsx)("input",{id:"name",className:"outline-none w-full",type:"text",name:"name",readOnly:!s,value:a.name,onChange:c})})]})}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,i.jsx)("div",{className:"border rounded-sm border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-3 ",children:(0,i.jsx)("input",{id:"email",className:"outline-none w-full",type:"email",name:"email",readOnly:!s,value:a.email,onChange:c})})]}),(0,i.jsxs)("div",{className:"flex justify-between gap-10",children:[(0,i.jsxs)("div",{className:"w-full space-y-2",children:[(0,i.jsx)("label",{htmlFor:"contactNo",children:"Mobile Number"}),(0,i.jsx)("div",{className:"border rounded-sm flex-1 border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-3.5 ",children:(0,i.jsx)("input",{id:"contactNo",className:"outline-none w-full",type:"text",name:"contactNo",readOnly:!s,value:a.contactNo,onChange:c})})]}),(0,i.jsxs)("div",{className:"w-full space-y-2",children:[(0,i.jsx)("label",{htmlFor:"dob",children:"Date of Birth"}),(0,i.jsxs)("div",{className:"border flex rounded-sm flex-1 border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-3 ",children:[(0,i.jsx)("input",{id:"dob",className:"outline-none w-full",type:"text",name:"dob",readOnly:!s,value:a.dob,onChange:c}),(0,i.jsx)("span",{children:(0,i.jsx)(j.qsp,{className:"text-xl"})})]})]})]}),(0,i.jsx)("div",{className:"center flex justify-between py-3",children:s?(0,i.jsx)("button",{onClick:o,className:"primary_btn",children:"Save"}):(0,i.jsx)("button",{onClick:()=>l(!0),className:"primary_btn",children:"Edit"})})]})]})})},ns=e=>{let{fileName:t,ensureExcelFile:a,UploadFile:r,setEnsureExcelFile:s,setFileName:l,clearUseRefObject:o}=e;const[d,c]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{t&&t&&c(!0)}),[t]),(0,i.jsx)("div",{children:d&&(0,i.jsx)("section",{className:" inset-0 flex items-center justify-center z-50 ",children:!1===a&&(0,i.jsxs)("div",{className:" flex flex-col relative items-center justify-center space-y-2 text-dark_grey text_size_5 max-w-sm  w-full bg-white shadow-md p-10 border border-lite_grey",children:[(0,i.jsx)("p",{className:"absolute right-2 top-2",onClick:()=>{o(),s(!0),l(null)},children:(0,i.jsx)(_t.uDv,{className:"text-3xl text-grey cursor-pointer"})}),(0,i.jsx)("p",{children:"Filename"}),(0,i.jsx)("p",{className:"text-center",children:t}),(0,i.jsxs)("p",{className:"text-[red] text-center",children:[" ","Error: Please upload CSV or XLS file type only"," "]})]})})})},ss=e=>{let{fileNameForSuccessful:t,setCloseSavedModel:a,backToHome:r}=e;const[s,l]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{t&&t&&l(!0)}),[t]),(0,i.jsx)("div",{children:s&&(0,i.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 ",children:(0,i.jsxs)("div",{className:"relative ",children:[(0,i.jsx)(j.enS,{className:"absolute  left-60 -top-5 text-5xl text-[#2BEE48] z-50"}),(0,i.jsx)("div",{className:"border w-[509px] h-[218px]  border-lite_grey rounded shadow-md  bg-white pt-8",children:(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:" flex flex-col items-center gap-5",children:[(0,i.jsx)("p",{className:"text-dark_grey text_size_5",children:"Saved Successfully"}),(0,i.jsx)("p",{className:" text-dark_grey text-[16px] ",children:t}),(0,i.jsx)("button",{className:" p-2 rounded border-[#FEF116] bg-[#FEF116] text-dark_grey text_size_5 w-52",onClick:()=>{l(!s),a(!1),r(0)},children:"Close"})]})})})]})})})};var is=a(3986);const ls=e=>{let{allEmpDetails:t,secondaryData:a,searchResult:s,placeholder:l,Position:o,searchIcon1:d,searchIcon2:c,border:p}=e;const[m,u]=(0,n.useState)(""),h=(0,r.zy)();(0,n.useEffect)((()=>{u("")}),[a,h]);const x=(0,n.useCallback)((()=>{if(a&&a.length>0){const e=m.toString().toUpperCase(),t=a.filter((t=>[t.no,t.NO,t.fidNo,t.FID,t.empBadgeNo,t.BADGE,t.sapNo,t.empID,t.EMPLOYEEID,t.NAME,t.empName,t.name].some((t=>(null===t||void 0===t?void 0:t.toString().toUpperCase())===e))));t&&t.length>0?s(t):(alert("Employee not found."),s([]))}}),[a,m,s]);return(0,i.jsxs)("div",{className:"flex items-center border border-[#D9D9D9] bg-white rounded p-2 text-[#000000] text-sm w-fit md:max-w-md",children:[(0,i.jsx)("input",{value:m,type:"text",placeholder:l,className:"outline-none flex-grow text-sm text_size_7 text-dark_grey w-full ",onChange:e=>{const t=e.target.value.toString().toUpperCase();if(u(t),t){const e=a.filter((e=>[null===e||void 0===e?void 0:e.no,null===e||void 0===e?void 0:e.NO,null===e||void 0===e?void 0:e.fidNo,null===e||void 0===e?void 0:e.FID,null===e||void 0===e?void 0:e.empBadgeNo,null===e||void 0===e?void 0:e.EMPLOYEEID,null===e||void 0===e?void 0:e.BADGE,null===e||void 0===e?void 0:e.sapNo,null===e||void 0===e?void 0:e.empID,null===e||void 0===e?void 0:e.NAME,null===e||void 0===e?void 0:e.empName,null===e||void 0===e?void 0:e.name].some((e=>null===e||void 0===e?void 0:e.toString().toUpperCase().includes(t))))).sort(((e,a)=>{const r=["no","NO","fidNo","FID","empBadgeNo","EMPLOYEEID","BADGE","sapNo","empID","NAME","empName","name"],n=e=>r.some((a=>{var r;return(null===(r=e[a])||void 0===r?void 0:r.toString().toUpperCase())===t})),s=e=>r.some((a=>{var r;return null===(r=e[a])||void 0===r?void 0:r.toString().toUpperCase().startsWith(t)}));return n(e)&&!n(a)?-1:!n(e)&&n(a)?1:s(e)&&!s(a)?-1:!s(e)&&s(a)?1:0}));s(e)}else s(a)}}),(0,i.jsx)("span",{className:"ml-2",children:(0,i.jsx)(Fr.CKj,{className:"text-xl text-dark_grey cursor-pointer",onClick:()=>{x()}})})]})},os=e=>{let{setClosePopup:t}=e;return(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsxs)("div",{className:"relative flex flex-col items-center gap-5 p-5 px-16 rounded shadow-lg border border-lite_grey bg-white",children:[(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"absolute top-2 right-2 text-dark_grey ",onClick:()=>{t(!1)},children:(0,i.jsx)(_t.uDv,{className:" text-[25px]  text-dark_grey"})})}),(0,i.jsxs)("div",{className:"flex flex-col items-center  gap-2",children:[(0,i.jsx)("p",{className:"text-dark_grey text_size_3 font-semibold",children:"Alert!"}),(0,i.jsx)("p",{className:"text-dark_grey text-center text_size_6",children:"The uploaded Excel sheet does not match the expected format."}),(0,i.jsx)("p",{children:"Please verify the structure and try uploading again."}),(0,i.jsx)("p",{className:"text-[#FF0000] text_size_5 font-bold",children:"ERROR"})]})]})})},ds=e=>{var t;return"HO"===(t=e)?{fieldObj:{REC:null,CTR:null,DEPT:null,EMPLOYEEID:null,BADGE:null,NAME:null,DATE:null,ONAM:null,OFFAM:null,ONPM:null,OFFPM:null,IN:null,OUT:null,TOTALINOUT:null,ALLDAYMINUTES:null,NETMINUTES:null,TOTALHOURS:null,NORMALWORKINGHRSPERDAY:null,TOTALACTUALHOURS:null,OT:null,REMARKS:null},fields:["REC","CTR","DEPT","EMPLOYEEID","BADGE","NAME","DATE","ONAM","OFFAM","ONPM","OFFPM","IN","OUT","TOTALINOUT","ALLDAYMINUTES","NETMINUTES","TOTALHOURS","NORMALWORKINGHRSPERDAY","TOTALACTUALHOURS","OT","REMARKS"],tableHeader:["REC#","CTR","DEPT","EMPLOYEE ID","BADGE#","NAME","DATE","ON AM","OFF AM","ON PM","OFF PM","IN","OUT","TOTAL IN/OUT","ALL DAY MINUTES","NET MINUTES","TOTAL HOURS","NORMAL WORKING HRS PER DAY","TOTAL ACTUAL HOURS","OT","REMARKS"]}:"BLNG"===t?{fieldObj:{FID:null,NAMEFLAST:null,ENTRANCEDATEUSED:null,ENTRANCEDATETIME:null,EXITDATETIME:null,AVGDAILYTOTALBYDAY:null,AHIGHLIGHTDAILYTOTALBYGROUP:null,ADININWORKSENGINEERINGSDNBHD:null,NORMALWORKINGHRSPERDAY:null,WORKINGHOURS:null,OT:null,REMARKS:null},fields:["FID","NAMEFLAST","ENTRANCEDATEUSED","ENTRANCEDATETIME","EXITDATETIME","AVGDAILYTOTALBYDAY","AHIGHLIGHTDAILYTOTALBYGROUP","ADININWORKSENGINEERINGSDNBHD","NORMALWORKINGHRSPERDAY","WORKINGHOURS","OT","REMARKS"],tableHeader:["FID","NAME (FLAST)","ENTRANCE DATE USED","ENTRANCE DATETIME","EXIT DATETIME","AVG. DAILY TOTAL BY DAY","A HIGHLIGHT DAILY TOTAL BY GROUP","ADININ WORK & ENGINEERING SDN BHD","NORMAL WORKING HRS PER DAY","ACTUAL WORKING HOURS","OT","REMARKS"]}:"SBW"===t?{fieldObj:{NAME:null,DEPTDIV:null,BADGE:null,DATE:null,IN:null,OUT:null,TOTALINOUT:null,ALLDAYMINHRS:null,NETMINUTES:null,TOTALHOURS:null,NORMALWORKINGHRSPERDAY:null,WORKINGHOURS:null,OT:null,REMARKS:null},fields:["NAME","DEPTDIV","BADGE","DATE","IN","OUT","TOTALINOUT","ALLDAYMINHRS","NETMINUTES","TOTALHOURS","NORMALWORKINGHRSPERDAY","WORKINGHOURS","OT","REMARKS"],tableHeader:["NAME","DEPT/DIV","BADGE#","DATE","IN","OUT","TOTAL IN/OUT","ALL DAY MIN (HRS)","NET MINUTES","TOTAL HOURS","NORMAL WORKING HRS PER DAY","ACTUAL WORKING HOURS","OT","REMARKS"]}:"ORMC"===t?{fieldObj:{NAME:null,DEPTDIV:null,BADGE:null,DATE:null,IN:null,OUT:null,TOTALINOUT:null,ALLDAYMINHRS:null,NETMINUTES:null,TOTALHOURS:null,NORMALWORKINGHRSPERDAY:null,WORKINGHOURS:null,OT:null,REMARKS:null},fields:["NAME","DEPTDIV","BADGE","DATE","IN","OUT","TOTALINOUT","ALLDAYMINHRS","NETMINUTES","TOTALHOURS","NORMALWORKINGHRSPERDAY","WORKINGHOURS","OT","REMARKS"],tableHeader:["Name","DEPT/DIV","BADGE#","DATE","IN","OUT","TOTAL IN/OUT","ALL DAY MIN (HRS)","NET MINUTES","TOTAL HOURS","NORMAL WORKING HRS PER DAY","ACTUAL WORKING HOURS","OT","REMARKS"]}:"Offshore"===t||"Offshore's ORMC"===t?{fieldObj:{NAME:null,TRADE:null,NO:null,LOCATION:null,DATE:null,TOTALHOURS:null,TOTALHOURS2:null,TOTALHOURS3:null,NORMALWORKINGHRSPERDAY:null,WORKINGHOURS:null,OT:null,REMARKS:null},fields:["NAME","TRADE","NO","LOCATION","DATE","TOTALHOURS","TOTALHOURS2","TOTALHOURS3","NORMALWORKINGHRSPERDAY","WORKINGHOURS","OT","REMARKS"],tableHeader:["EMPLOYEE NAME","TRADE","SAP ID","LOCATION","DATE","TOTAL NT","TOTAL OT","TOTAL IN/OUT","NORMAL WORKING HRS PER DAY","ACTUAL WORKING HOURS","OT","REMARKS"]}:void 0};a(9555);const cs=e=>{let{searchResult:t,newFormData:a,searchIcon1:r,searchIcon2:s,placeholder:l,rounded:o,setDrpValue:d,searchedValue:c,id:p,identify:m,setSelectedLocation:u}=e;const[h,x]=(0,n.useState)(""),[g,f]=(0,n.useState)([]),[v,y]=(0,n.useState)(!1);(0,n.useEffect)((()=>{d&&x(d)}),[d]),(0,n.useEffect)((()=>{const e=e=>{e.target.closest(".dropdown-container")||y(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const N=(0,n.useCallback)((()=>{y((e=>!e))}),[]);(0,n.useEffect)((()=>{f(a)}),[v]);return(0,i.jsxs)("div",{className:"relative dropdown-container",children:[(0,i.jsxs)("div",{className:"py-2 w-full text_size_5 border text-dark_grey bg-white border-lite_grey ".concat(o," flex items-center px-2 gap-2"),children:[(0,i.jsx)("div",{className:"text-dark_grey text-2xl",children:r}),(0,i.jsx)("input",{type:"text",placeholder:l,className:"outline-none w-full cursor-pointer",value:h,onChange:e=>{const t=e.target.value.toUpperCase();if(x(t),null===c||void 0===c||c(p,t),t){const e=null===a||void 0===a?void 0:a.filter((e=>{var a,r,n,s,i;return(null===(a=e.name)||void 0===a?void 0:a.toUpperCase().includes(t))||(null===(r=e.empID)||void 0===r?void 0:r.toUpperCase().includes(t))||(null===(n=e.JOBCODE)||void 0===n?void 0:n.toUpperCase().includes(t))||(null===(s=e.location)||void 0===s?void 0:s.toUpperCase().includes(t))||(null===(i=e.empBadgeNo)||void 0===i?void 0:i.toUpperCase().includes(t))})),r=null===e||void 0===e?void 0:e.sort(((e,a)=>{var r,n,s,i,l,o,d,c,p,m;const u=null===(r=e.empID)||void 0===r?void 0:r.toString().toUpperCase(),h=null===(n=a.empID)||void 0===n?void 0:n.toString().toUpperCase(),x=null===(s=e.name)||void 0===s?void 0:s.toUpperCase(),g=null===(i=a.name)||void 0===i?void 0:i.toUpperCase(),f=null===(l=e.JOBCODE)||void 0===l?void 0:l.toString().toUpperCase(),v=null===(o=a.JOBCODE)||void 0===o?void 0:o.toString().toUpperCase(),y=null===(d=e.location)||void 0===d?void 0:d.toString().toUpperCase(),N=null===(c=a.location)||void 0===c?void 0:c.toString().toUpperCase(),b=null===(p=e.empBadgeNo)||void 0===p?void 0:p.toString().toUpperCase(),D=null===(m=a.empBadgeNo)||void 0===m?void 0:m.toString().toUpperCase(),j=u===t||x===t||f===t||y===t||b===t,A=h===t||g===t||v===t||N===t||D===t,w=(null===u||void 0===u?void 0:u.startsWith(t))||(null===x||void 0===x?void 0:x.startsWith(t))||(null===f||void 0===f?void 0:f.startsWith(t))||(null===y||void 0===y?void 0:y.startsWith(t))||(null===b||void 0===b?void 0:b.startsWith(t)),S=(null===h||void 0===h?void 0:h.startsWith(t))||(null===g||void 0===g?void 0:g.startsWith(t))||(null===v||void 0===v?void 0:v.startsWith(t))||(null===N||void 0===N?void 0:N.startsWith(t))||(null===D||void 0===D?void 0:D.startsWith(t));return j&&!A?-1:!j&&A?1:w&&!S?-1:!w&&S?1:0}));f(r)}else f(a)},onClick:N}),(0,i.jsx)("div",{className:"text-dark_grey cursor-pointer mb-1".concat("viewSummary"===m?"text-[20px]":"text-1xl"),onClick:()=>{"viewSummary"===m&&(null===u||void 0===u||u(h),y(!1))},children:(0,i.jsx)("span",{className:"".concat("viewSummary"===m?"border rounded-full px-2 py-1  text-[13px] text-[#555252] ":"hidden"),children:"Search"})})]}),v&&(null===g||void 0===g?void 0:g.length)>0&&(0,i.jsx)("ul",{className:"absolute right-0 overflow-x-hidden mt-2 w-full max-h-36 overflow-y-auto rounded-lg shadow-lg bg-white z-10",children:g.map(((e,a)=>(0,i.jsx)("li",{className:"m-2 p-1 hover:bg-grey hover:text-white text_size_6 cursor-pointer flex justify-between items-center transition-all duration-200",onClick:()=>(e=>{e.empID||e.name?(x("".concat(e.empID," - ").concat(e.name||"")),t(e)):e.JOBCODE?(x(e.JOBCODE),t(e,p)):e.location&&(x(e.location),t(e,p)),y(!1),f([])})(e),children:(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-sm",children:e.empID}),(0,i.jsxs)("span",{className:"text-sm",children:[" ",e.name]}),(0,i.jsx)("span",{className:"text-sm",children:e.JOBCODE}),(0,i.jsx)("span",{className:"text-sm",children:e.location})]})},a)))})]})},ps=[{id:1,JOBCODE:"J9001"},{id:2,JOBCODE:"J9002"},{id:3,JOBCODE:"J9009M433"},{id:4,JOBCODE:"J9010M432"},{id:5,JOBCODE:"J9013M432"},{id:6,JOBCODE:"J9014"},{id:7,JOBCODE:"J9026M433"},{id:8,JOBCODE:"J9027M433"},{id:9,JOBCODE:"J9028M432"},{id:10,JOBCODE:"J9032M431"},{id:11,JOBCODE:"J9036M433"},{id:12,JOBCODE:"J9037M433"},{id:13,JOBCODE:"J9038M433"},{id:14,JOBCODE:"J9040M433"},{id:15,JOBCODE:"J9041M433"},{id:16,JOBCODE:"J9043M432"},{id:17,JOBCODE:"J9057M431"},{id:18,JOBCODE:"J9063M431"},{id:19,JOBCODE:"J9064M431"},{id:20,JOBCODE:"J9068M431"},{id:21,JOBCODE:"J9069M433"},{id:22,JOBCODE:"J9070M431"},{id:23,JOBCODE:"J9071M433"},{id:24,JOBCODE:"J9072M431"},{id:25,JOBCODE:"J9073M431"},{id:26,JOBCODE:"J9074M433"},{id:27,JOBCODE:"J9075M433"},{id:28,JOBCODE:"M43-J9010M43"},{id:29,JOBCODE:"M43-J9092M43"},{id:30,JOBCODE:"M43-J9094M433"},{id:31,JOBCODE:"M43-J9095M431"},{id:32,JOBCODE:"M43-J9093M433"},{id:33,JOBCODE:"M43-J9096M433"},{id:34,JOBCODE:"M43-J9097M433"},{id:35,JOBCODE:"M43-J9098M433"},{id:36,JOBCODE:"M43-J9099M433"},{id:37,JOBCODE:"M43-J9100M433"},{id:38,JOBCODE:"M43-NA"},{id:39,JOBCODE:"M43-J9991"},{id:40,JOBCODE:"M47-J9001"},{id:41,JOBCODE:"M42-J9002"}],ms=[{id:1,location:"OFFSHORE"},{id:2,location:"HEAD OFFICE"},{id:3,location:"ORMC"},{id:4,location:"SBW"},{id:5,location:"BLNG"},{id:6,location:"CREST CENTURION 2"},{id:7,location:"DAY TRIPPING"},{id:8,location:"ICON ALIZA"},{id:9,location:"ICON VALIANT"},{id:10,location:"KHALIFA"},{id:11,location:"MASSHOR PRINCESS"},{id:12,location:"MV FALGOUT"},{id:13,location:"ACCOUNTS"},{id:14,location:"HR"},{id:15,location:"PURCHASING"},{id:16,location:"CORPORATE"},{id:17,location:"CPD"},{id:18,location:"BLNG-MGT"},{id:19,location:"BLNG-BT"},{id:20,location:"BLNG-PROJ"},{id:21,location:"THIRD PARTY SERVICES"},{id:22,location:"CERMAT"}],us=[{id:"712a1c4b-88a8-49f3-aa13-880879a7b168",empID:"3028",leaveType:"Annual Leave",fromDate:"2025-03-10",toDate:"2025-03-20",days:3,applyTo:["Manager","Supervisor"],reason:"for vacation",medicalCertificate:null,supervisorName:"Rose",supervisorEmpID:"AWE026",supervisorStatus:"Approved",supervisorDate:"2024-12-04T16:28:26.887Z",supervisorRemarks:"",managerName:"Arjun",managerEmpID:"AWE765",managerStatus:"Approved",managerDate:"2024-12-04T16:31:02.182Z",managerRemarks:"",empStatus:"Pending",empDate:null,empRemarks:null,createdAt:"2024-12-04T16:27:44.356Z",updatedAt:"2024-12-04T16:31:02.038Z",__typename:"LeaveStatus"},{id:"39c6cb04-30df-4f67-81ef-dfdca46bc6ee",empID:"3028",leaveType:"Annual Leave",fromDate:"2025-03-21",toDate:"2025-03-22",days:1,applyTo:["Manager","Supervisor"],reason:"dfhadfh",medicalCertificate:"public/medicalCertificates/AWE028/passport -1.jpg",supervisorName:"Rose",supervisorEmpID:"AWE026",supervisorStatus:"Approved",supervisorDate:"2024-12-05T07:44:54.685Z",supervisorRemarks:"",managerName:"Arjun",managerEmpID:"AWE765",managerStatus:"Approved",managerDate:"2024-12-05T07:45:27.439Z",managerRemarks:"",empStatus:"Pending",empDate:null,empRemarks:null,createdAt:"2024-12-05T07:44:16.713Z",updatedAt:"2024-12-05T07:45:27.457Z",__typename:"LeaveStatus"},{id:"39c6cb04-30df-4f67-81ef-dfdca46bc6ee",empID:"3028",leaveType:"Sick Leave",fromDate:"2025-03-24",toDate:"2025-03-24",days:.5,applyTo:["Manager","Supervisor"],reason:"dfhadfh",medicalCertificate:"public/medicalCertificates/AWE028/passport -1.jpg",supervisorName:"Rose",supervisorEmpID:"AWE026",supervisorStatus:"Approved",supervisorDate:"2024-12-05T07:44:54.685Z",supervisorRemarks:"",managerName:"Arjun",managerEmpID:"AWE765",managerStatus:"Approved",managerDate:"2024-12-05T07:45:27.439Z",managerRemarks:"",empStatus:"Pending",empDate:null,empRemarks:null,createdAt:"2024-12-05T07:44:16.713Z",updatedAt:"2024-12-05T07:45:27.457Z",__typename:"LeaveStatus"},{id:"39c6cb04-30df-4f67-81ef-dfdca46bc6ee",empID:"1937",leaveType:"Sick Leave",fromDate:"2025-04-11",toDate:"2025-04-12",days:2,applyTo:["Manager","Supervisor"],reason:"dfhadfh",medicalCertificate:"public/medicalCertificates/AWE028/passport -1.jpg",supervisorName:"Rose",supervisorEmpID:"AWE026",supervisorStatus:"Approved",supervisorDate:"2024-12-05T07:44:54.685Z",supervisorRemarks:"",managerName:"Arjun",managerEmpID:"AWE765",managerStatus:"Approved",managerDate:"2024-12-05T07:45:27.439Z",managerRemarks:"",empStatus:"Pending",empDate:null,empRemarks:null,createdAt:"2024-12-05T07:44:16.713Z",updatedAt:"2024-12-05T07:45:27.457Z",__typename:"LeaveStatus"},{id:"39c6cb04-30df-4f67-81ef-dfdca46bc6ee",empID:"1937",leaveType:"Compensate Leave",fromDate:"2025-04-18",toDate:"2025-04-19",days:2,applyTo:["Manager","Supervisor"],reason:"dfhadfh",medicalCertificate:"public/medicalCertificates/AWE028/passport -1.jpg",supervisorName:"Rose",supervisorEmpID:"AWE026",supervisorStatus:"Approved",supervisorDate:"2024-12-05T07:44:54.685Z",supervisorRemarks:"",managerName:"Arjun",managerEmpID:"AWE765",managerStatus:"Approved",managerDate:"2024-12-05T07:45:27.439Z",managerRemarks:"",empStatus:"Pending",empDate:null,empRemarks:null,createdAt:"2024-12-05T07:44:16.713Z",updatedAt:"2024-12-05T07:45:27.457Z",__typename:"LeaveStatus"},{id:"39c6cb04-30df-4f67-81ef-dfdca46bc6ee",empID:"1937",leaveType:"Sick Leave",fromDate:"2025-03-26",toDate:"2025-03-26",days:.5,applyTo:["Manager","Supervisor"],reason:"dfhadfh",medicalCertificate:"public/medicalCertificates/AWE028/passport -1.jpg",supervisorName:"Rose",supervisorEmpID:"AWE026",supervisorStatus:"Approved",supervisorDate:"2024-12-05T07:44:54.685Z",supervisorRemarks:"",managerName:"Arjun",managerEmpID:"AWE765",managerStatus:"Approved",managerDate:"2024-12-05T07:45:27.439Z",managerRemarks:"",empStatus:"Pending",empDate:null,empRemarks:null,createdAt:"2024-12-05T07:44:16.713Z",updatedAt:"2024-12-05T07:45:27.457Z",__typename:"LeaveStatus"}],hs=e=>{let{editObject:t,toggleFunction:a,tableHeader:r,editFunction:s,fields:l,fieldObj:o,titleName:d,Position:c,handleSubmit:p,editFormTitle:m,empAndWorkInfo:u}=e;const[h,x]=(0,n.useState)(null),[f,v]=(0,n.useState)(null),[y,N]=(0,n.useState)(null),[b,D]=(0,n.useState)(!1),[A,w]=(0,n.useState)(null),[S,E]=(0,n.useState)([]),[I,k]=(0,n.useState)({}),[T,C]=(0,n.useState)({fieldObj:o});(0,n.useEffect)((()=>{if(t){var e;const a=e=>{try{const t=String(e),a=new Date(t),r=a.getDate(),n=a.getMonth()+1,s=a.getFullYear(),i=(null===t||void 0===t?void 0:t.split(" ")[1])+" "+(null===t||void 0===t?void 0:t.split(" ")[2]);return"".concat(r,"/").concat(n,"/").concat(s," ").concat(i)}catch(t){console.log("Error :",t)}},r=a(null===t||void 0===t?void 0:t.ENTRANCEDATETIME),n=a(null===t||void 0===t?void 0:t.EXITDATETIME),s=void 0!==t.DATE?"DATE":"ENTRANCEDATEUSED",i=t[s],l=i?"".concat(null===i||void 0===i?void 0:i.split("/")[1],"/").concat(null===i||void 0===i?void 0:i.split("/")[0],"/").concat(null===i||void 0===i?void 0:i.split("/")[2]):null,o=(0,g.A)((0,g.A)({},t),{},{["formatted_".concat(s)]:null!==l&&void 0!==l&&l.includes("NaN")?"":l,["formatted_".concat("ENTRANCEDATETIME")]:null!==r&&void 0!==r&&r.includes("NaN")?"":r,["formatted_".concat("EXITDATETIME")]:null!==n&&void 0!==n&&n.includes("NaN")?"":n});C(o);const d=(null===t||void 0===t||null===(e=t.jobLocaWhrs)||void 0===e?void 0:e.filter((e=>null!==e&&void 0!==e)))||[];if(d.length>0){const e=d.map(((e,t)=>({id:e.id||t+1,JOBCODE:e.JOBCODE,LOCATION:e.LOCATION,WORKINGHRS:e.WORKINGHRS,OVERTIMEHRS:e.OVERTIMEHRS})));e&&F(e)}else F([{id:1}])}}),[t]);const R=(e,t)=>{""===t&&""!==t||F((a=>a.map((a=>a.id===e?(0,g.A)((0,g.A)({},a),{},{JOBCODE:t||null}):a))))},P=(e,t)=>{(""!==t||""===t)&&F((a=>a.map((a=>a.id===e?(0,g.A)((0,g.A)({},a),{},{LOCATION:t||null}):a))))},O=(e,t)=>{F((a=>a.map((a=>a.id===t?(0,g.A)((0,g.A)({},a),{},{JOBCODE:(null===e||void 0===e?void 0:e.JOBCODE)||a.JOBCODE||null}):a))))},_=(e,t)=>{v(e),F((a=>a.map((a=>a.id===t?(0,g.A)((0,g.A)({},a),{},{LOCATION:(null===e||void 0===e?void 0:e.location)||a.location||null}):a))))},[M,F]=(0,n.useState)([{id:1}]),L=(0,n.useCallback)(((e,t,a)=>{F((r=>r.map((r=>r.id===e?(0,g.A)((0,g.A)({},r),{},{WORKINGHRS:"WorkingHrs"===a?t:r.WORKINGHRS,OVERTIMEHRS:"WorkingHrs"!==a||t&&""!==t?"OvertimeHrs"===a?t:r.OVERTIMEHRS:0}):r))))}),[]);(0,n.useEffect)((()=>{try{function t(e){try{if(null!==e&&void 0!==e&&e.includes(":")){var t,a;const[r,n]=null===e||void 0===e||null===(t=e.split(":"))||void 0===t?void 0:t.map(Number);return"".concat(r,":").concat(null===n||void 0===n||null===(a=n.toString())||void 0===a?void 0:a.padStart(2,"0"))}if(null!==e&&void 0!==e&&e.includes(".")){var r,n;const[t,a]=null===e||void 0===e||null===(r=e.split("."))||void 0===r?void 0:r.map(Number);return"".concat(t,":").concat(null===a||void 0===a||null===(n=a.toString())||void 0===n?void 0:n.padStart(2,"0"))}const s=parseInt(e,10);return"".concat(s,":00")}catch(s){console.log("Error : ",s)}}const a=(e,a)=>{try{const e=(e,t)=>{let a=null===e||void 0===e?void 0:e.reduce(((e,a)=>{if(a[t]){e+=parseFloat(a[t])}return e}),0);const r=Math.floor(a),n=Math.round(100*(a-r)),s=r+Math.floor(n/100),i=n%100;return"".concat(s,":").concat(i.toString().padStart(2,"0"))};let r=e(M,"WORKINGHRS");C((e=>{var n;const[s,i]=null===r||void 0===r?void 0:r.split(":").map(Number),l=s+i/100,[o,d]=null===(n=t(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY))||void 0===n?void 0:n.split(":").map(Number),c=l>o+d/100;N(c);try{c?N(!0):(w(!1),D(!1))}catch(p){console.log(p)}return(0,g.A)((0,g.A)({},e),{},{[a]:null!==r&&void 0!==r&&r.includes("NaN")||!r?"0:00":r})}))}catch(r){console.log("Error : ",r)}};"HO"===d?a("TOTALACTUALHOURS","TOTALACTUALHOURS"):a("WORKINGHOURS","WORKINGHOURS")}catch(e){console.log("Error : ",e)}}),[M]),(0,n.useEffect)((()=>{const e=null===M||void 0===M?void 0:M.reduce(((e,t)=>{try{var a;let s=t.OVERTIMEHRS||"0:00";if(null!==(a=s)&&void 0!==a&&a.includes(":")){var r,n;const[e,t]=null===(r=s)||void 0===r||null===(n=r.split(":"))||void 0===n?void 0:n.map(Number);s=e+t/100}else s=parseFloat(s);return e+(isNaN(s)?0:s)}catch(s){return e}}),0),t=Math.floor(e),a=Math.round(100*(e-t)),r=t+Math.floor(a/100),n=a%100,s="".concat(r,":").concat(n.toString().padStart(2,"0"));C((t=>(0,g.A)((0,g.A)({},t),{},{OT:e>0?s:"0:00"})))}),[M]);const U=(0,n.useCallback)((()=>{const e=M&&M.map((e=>(0,g.A)((0,g.A)({},e),{},{JOBCODE:null===e||void 0===e?void 0:e.JOBCODE,LOCATION:null===e||void 0===e?void 0:e.LOCATION,WORKINGHRS:(null===e||void 0===e?void 0:e.WORKINGHRS)||"",OVERTIMEHRS:(null===e||void 0===e?void 0:e.OVERTIMEHRS)||""}))),t=(0,g.A)((0,g.A)({},T),{},{jobLocaWhrs:e});s(t),p(t)}),[M,T]),B=e=>{const{name:t,value:a}=e.target;C((e=>(0,g.A)((0,g.A)({},e),{},{[t]:a})))};function q(e){let t=Math.floor(e),a=Math.round(100*(e-t));return a>=100&&(t+=Math.floor(a/100),a%=100),parseFloat("".concat(t,".").concat(a.toString().padStart(2,"0")))}const H=()=>{if((()=>{const e={};return null===M||void 0===M||M.forEach(((a,r)=>{a.LOCATION||(e["LOCATION-".concat(r)]="Location is required."),a.WORKINGHRS||(e["WORKINGHRS-".concat(r)]="Working Hrs is required."),t&&"object"===typeof t&&Object.keys(t).forEach((a=>{var r;const n=null===(r=t[a])||void 0===r?void 0:r.toString().trim();switch(a){case"BADGE":n&&"N/A"!==n&&"0"!==n||(e.badgeNo="Badge Number is required.");break;case"FID":n&&"N/A"!==n&&"0"!==n||(e.fid="FID or SAP Number is required.");break;case"NO":n&&"N/A"!==n&&"0"!==n||(e.no="FID or SAP Number is required.");break;case"NORMALWORKINGHRSPERDAY":n&&"N/A"!==n&&"0"!==n||(e.NWHPD="Working hours per day is required.")}}))})),k(e),0===Object.keys(e).length})()){if(y)return void alert("Working hours cannot be greater than 'Normal Daily Hours' (".concat(null===t||void 0===t?void 0:t.NORMALWORKINGHRSPERDAY,")"));let s=!0,i=!0;try{var e,r;const a=((e,a)=>{const r=["Offshore","Offshore's ORMC"],n=["HO","SBW","ORMC"];return null===e||void 0===e?void 0:e.filter((e=>null!==t&&void 0!==t&&t.BADGE&&null!==e&&void 0!==e&&e.empBadgeNo&&(null===t||void 0===t?void 0:t.BADGE)===(null===e||void 0===e?void 0:e.empBadgeNo)&&n.includes(a)||null!==t&&void 0!==t&&t.NO&&null!==e&&void 0!==e&&e.sapNo&&(null===t||void 0===t?void 0:t.NO)===(null===e||void 0===e?void 0:e.sapNo)&&r.includes(a)||null!==t&&void 0!==t&&t.FID&&null!==e&&void 0!==e&&e.sapNo&&(null===t||void 0===t?void 0:t.FID)===(null===e||void 0===e?void 0:e.sapNo)&&"BLNG"===a?e:void 0))[0]})(u,null===t||void 0===t?void 0:t.fileType);let n=function(e){const[t,a,r]=e.split(/[-\/]/),n=t.padStart(2,"0"),s=a.padStart(2,"0");return"".concat(r,"-").concat(n,"-").concat(s)}((null===t||void 0===t||null===(e=t.DATE)||void 0===e?void 0:e.trim())||(null===t||void 0===t||null===(r=t.ENTRANCEDATEUSED)||void 0===r?void 0:r.trim()),t.fileType);const l=new Date(n),o=new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(l);let d=(null===a||void 0===a?void 0:a.workHrs[(null===a||void 0===a?void 0:a.workHrs.length)-1])||0,c=(null===a||void 0===a?void 0:a.workMonth[(null===a||void 0===a?void 0:a.workMonth.length)-1])||0,p=parseFloat(d);"8"===String(d)&&"24"===String(c)&&"Saturday"===o&&(p=parseFloat(d)/2),M.map((e=>{if(!i)return;if(!e.WORKINGHRS)return;return function(e){const[t,a]=null===e||void 0===e?void 0:e.split(":"),r=parseInt(t),n=parseInt(a);return q(parseFloat("".concat(r,".").concat(n.toString().padStart(2,"0"))))}(function(e){const t=null===e||void 0===e?void 0:e.toString();if(/^\d+$/.test(t))return"".concat(t,":00");if(/^\d+\.\d+$/.test(t)){const[e,a]=t.split("."),r=1===a.length?"".concat(a,"0"):a;return"".concat(parseInt(e),":").concat(r)}if(/^\d{1,2}:\d{1,2}$/.test(t)){const[e,a]=t.split(":"),r=1===a.length?"".concat(a,"0"):a;return"".concat(parseInt(e),":").concat(r)}return null}(e.WORKINGHRS))>q(p)&&(i=!1,"Saturday"===o&&8==d&&24==c)?(D(!0),alert("On Saturdays, working hours cannot exceed the normal daily limit (".concat(p," hours) for staff-level employees.")),void(s=!1)):void 0}))}catch(n){s=!0,console.log("ERROR : ",n)}if(!s)return;const l=void 0!==T.DATE?"DATE":"ENTRANCEDATEUSED",o="ENTRANCEDATETIME",d="EXITDATETIME",c=(0,g.A)((0,g.A)({},T),{},{[l]:t[l],[o]:t[o],[d]:t[d]});delete c["formatted_".concat(l)],delete c["formatted_".concat(o)],delete c["formatted_".concat(d)],U(c),a()}};return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 ",onClick:()=>{E([])},children:(0,i.jsxs)("section",{className:"bg-[#f9fafb] p-5 gap-2 flex flex-col item-center rounded-lg shadow-md   border-[#EBEBEB] w-[50%] h-[80%] overflow-y-auto ",children:[(0,i.jsxs)("header",{className:"flex justify-between mt-5 ",children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex justify-center flex-1",children:(0,i.jsx)("img",{className:"size-36 h-12 w-52",src:Se.A,alt:"not found"})}),(0,i.jsx)("div",{className:"flex justify-end pt-2 flex-1",children:(0,i.jsx)(j.LwM,{className:"text-[30px] cursor-pointer",onClick:a})})]}),(0,i.jsxs)("div",{className:"mx-7 mt-2 mb-14",children:[(0,i.jsx)("div",{className:"flex items-center justify-center  text-dark_grey font-bold text-[25px] mb-3",children:(0,i.jsx)("u",{children:(0,i.jsx)("p",{children:m||"Edit Form"})})}),null===l||void 0===l?void 0:l.map(((e,a)=>(0,i.jsxs)("div",{className:"grid grid-cols-2  space-y-3  ",children:[(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-dark_grey text_size_5 pt-5",children:r[a]})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{type:"text",name:"DATE"===e?"formatted_DATE":"ENTRANCEDATEUSED"===e?"formatted_ENTRANCEDATEUSED":"ENTRANCEDATETIME"===e?"formatted_ENTRANCEDATETIME":"EXITDATETIME"===e?"formatted_EXITDATETIME":e,className:"border border-slate_grey bg-[#f1f5f9] rounded text-dark_grey text-[16px] text_size_5 outline-none w-full py-[7px] px-3 cursor-auto",value:T["formatted_".concat(e)]||T[e]||"",onChange:B,readOnly:"NORMALWORKINGHRSPERDAY"===e||"BADGE"!==e&&"FID"!==e&&"NO"!==e&&("Manager"!==c&&a<6)}),"BADGE"===e&&I.badgeNo?(0,i.jsx)("span",{className:"text-red text_size_9",children:I.badgeNo}):"FID"===e&&I.fid?(0,i.jsx)("span",{className:"text-red text_size_9",children:I.fid}):"NO"===e&&I.no?(0,i.jsx)("span",{className:"text-red text_size_9",children:I.no}):"NORMALWORKINGHRSPERDAY"===e&&I.NWHPD?(0,i.jsx)("span",{className:"text-red text_size_9",children:I.NWHPD}):"",!0===b&&!1===y?("WORKINGHOURS"===e||"TOTALACTUALHOURS"===e)&&(0,i.jsx)("span",{className:"text_size_9 mt-2 text-red",children:"Staff can't exceed ".concat(parseFloat(null===t||void 0===t?void 0:t.NORMALWORKINGHRSPERDAY)/2," hrs on Saturdays.")}):null,!0===y&&!1===A&&"BLNG"===d?("WORKINGHOURS"===e||"TOTALACTUALHOURS"===e)&&(0,i.jsx)("span",{className:"text_size_9 mt-2 text-red",children:"Working hours exceed the NWHPD"}):!1===y&&!0===A&&"BLNG"===d?("WORKINGHOURS"===e||"TOTALACTUALHOURS"===e)&&(0,i.jsx)("span",{className:"text_size_9 mt-2 text-red",children:"Working hours + OT exceed the AW & ESB"}):!0===y&&!0===A&&"BLNG"===d?("WORKINGHOURS"===e||"TOTALACTUALHOURS"===e)&&(0,i.jsx)("span",{className:"text_size_9 mt-2 text-red",children:"Working hours + OT exceed the NWHPD, AW & ESB"}):y&&"BLNG"!==d?("WORKINGHOURS"===e||"TOTALACTUALHOURS"===e)&&(0,i.jsx)("span",{className:"text_size_9 mt-2 text-red",children:"Working hours exceed the NWHPD"}):""]})]},a))),"Manager"===c&&(0,i.jsxs)("div",{className:"grid grid-cols-2  space-y-3",children:[(0,i.jsx)("p",{className:"text-dark_grey text_size_5 pt-5",children:"STATUS"}),(0,i.jsx)("input",{name:"STATUS",type:"text",className:"border border-slate_grey bg-[#f1f5f9]  rounded text-dark_grey text_size_5 outline-none w-full py-2 px-3 cursor-auto ",value:T.STATUS||T.status||"",readOnly:!0})]}),(0,i.jsxs)("section",{className:"grid grid-cols-1 ",children:[(0,i.jsxs)("div",{className:"grid grid-cols-[10fr,10fr,10fr,10fr,0.6fr] gap-0 pt-5",children:[(0,i.jsx)("label",{className:"text_size_5 text-dark_grey ",children:"JOBCODE"}),(0,i.jsx)("label",{className:"text_size_5 text-dark_grey ",children:"LOCATION"}),(0,i.jsx)("label",{className:"text_size_5 text-dark_grey ",children:"WORKING HOURS"}),(0,i.jsx)("label",{className:"text_size_5 text-dark_grey ",children:"OVERTIME HOURS"})]}),M&&M.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-[5fr,5fr,5fr,5fr,0fr] gap-4 pt-1 pb-2 ",style:"Manager"===c?{pointerEvents:"none"}:void 0,children:[(0,i.jsx)("div",{className:"w-fit",children:(0,i.jsx)(cs,{newFormData:ps,placeholder:"Search Job Code",rounded:"rounded",searchResult:O,searchedValue:R,setDrpValue:(null===e||void 0===e?void 0:e.JOBCODE)||null,id:e.id})}),(0,i.jsxs)("div",{className:"w-fit",children:[(0,i.jsx)(cs,{newFormData:ms,placeholder:"Search Location",rounded:"rounded",searchResult:_,setDrpValue:e.LOCATION||null,searchedValue:P,id:e.id}),I["LOCATION-".concat(t)]&&(0,i.jsx)("span",{className:"text-red text_size_9",children:I["LOCATION-".concat(t)]})]}),(0,i.jsxs)("div",{className:"w-fit ",children:[(0,i.jsx)("input",{type:"text",id:"workingHours-".concat(t),value:e.WORKINGHRS||"",onChange:t=>{L(e.id,t.target.value,"WorkingHrs")},placeholder:"H.100 or x(H.100)H.100",className:"border border-lite_grey rounded text-dark_grey text_size_5 outline-none w-full py-2 px-3 cursor-auto bg-white",readOnly:!e.LOCATION}),I["WORKINGHRS-".concat(t)]&&(0,i.jsx)("span",{className:"text-red text_size_9",children:I["WORKINGHRS-".concat(t)]})]}),(0,i.jsx)("div",{className:"w-fit",children:(0,i.jsx)("input",{type:"text",id:"OverTimeHours-".concat(t),value:e.OVERTIMEHRS||"",onChange:t=>{L(e.id,t.target.value,"OvertimeHrs")},placeholder:"H.100",className:"border border-lite_grey rounded text-dark_grey text_size_5 outline-none w-full py-2 px-3 cursor-auto bg-white",readOnly:!e.LOCATION})}),(0,i.jsx)("div",{className:"pt-2.5",children:0===t?(0,i.jsx)(la.hkz,{className:"text-xl text-dark_ash cursor-pointer",onClick:()=>{F((e=>{let t=e.length+1;for(;e.some((e=>e.id===t));)t++;const a={id:t};return[...e,a]}))}}):(0,i.jsx)(la.noF,{className:"text-xl text-dark_ash cursor-pointer",onClick:()=>{(e=>{const t=null===M||void 0===M?void 0:M.filter((t=>{if(t.id!==e)return t}));F(t)})(e.id)}})})]},t)))]}),(0,i.jsx)("div",{className:"flex justify-center ".concat("Manager"===c?"hidden ":""),children:(0,i.jsx)("button",{className:"text-dark_grey text_size_3 rounded bg-[#FEF116] px-9 m-5 py-2 ",onClick:()=>{H()},children:"Save"})})]})]})})},xs=e=>{let{toggleSFAMessage:t,setExcelData:a,icons:r,iconColor:n,textColor:s,title:l,message:o,btnText:d,messageTwo:c}=e;return(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,i.jsxs)("div",{className:"relative ",children:[(0,i.jsx)("div",{className:"absolute  left-44 -top-5 text-5xl ".concat(n," z-50 "),children:r}),(0,i.jsx)("div",{className:"border w-[409px] h-[225px]  border-lite_grey rounded shadow-md  bg-white pt-12",children:(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:" flex flex-col items-center gap-5",children:[(0,i.jsx)("p",{className:"text_size_2 ".concat(s),children:l}),(0,i.jsx)("p",{className:" text-dark_grey  text_size_6 ",children:o}),c&&(0,i.jsx)("p",{className:" text-dark_grey  text_size_6 ",children:c}),!c&&(0,i.jsx)("button",{className:" p-2 rounded border-[#FEF116] bg-[#FEF116] text-dark_grey text_size_5 w-52",onClick:()=>{t(null),null===a||void 0===a||a(null),window.location.reload()},children:d})]})})})]})})})},gs=e=>{let{successMess:t,toggleSFAMessage:a,setExcelData:r,userIdentification:n}=e;return(0,i.jsxs)("div",{children:[!0===t&&(0,i.jsx)(xs,{toggleSFAMessage:a,setExcelData:r,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Success!",message:"Data has been successfully ".concat("Manager"===n?"Approved":"Stored"),btnText:"OK"}),!1===t&&(0,i.jsx)(xs,{toggleSFAMessage:a,icons:(0,i.jsx)(_t.uDv,{}),iconColor:"text-[#dc2626]",textColor:"text-[#dc2626]",title:"Sorry :(",message:"Something went wrong please try again!!",btnText:"TRY AGAIN"})]})},fs=(0,Ee.D)(),vs=async e=>{let t=[],a=null;do{const r=await fs.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items||[];t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t},ys=async(e,t,a)=>{try{var r;null===t||void 0===t||t(!0),null===a||void 0===a||a("Please wait a few seconds...");const n=null===(r=localStorage.getItem("userID"))||void 0===r?void 0:r.toUpperCase(),s=async()=>{const[e,t,a]=await Promise.all([vs(Ie.it),vs(Ie.bJ),vs(Ie.ZZ)]),r=e.map((e=>{const r=t.find((t=>t.empID===e.empID)),n=a.find((t=>t.empID===e.empID));return r||n?(0,g.A)((0,g.A)((0,g.A)({},e),r),n):null})).filter((e=>null!==e));return r.filter((e=>e.empID===n&&"Manager"===e.selectType))},i=await s(),l=(null===e||void 0===e?void 0:e.filter((e=>i.some((t=>e.assignTo===t.empBadgeNo))))).filter((e=>null!==e&&void 0!==e));return null===t||void 0===t||t(!1),0===l.length?null===a||void 0===a||a("No data available"):null===a||void 0===a||a(""),l}catch(n){console.error("ERROR:",n),null===t||void 0===t||t(!1),null===a||void 0===a||a("An error occurred. Please try again.")}},Ns=e=>{let{toggleFunctionForAssiMana:t,renameKeysFunctionAndSubmit:a,mergedData:r}=e;const[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)({mbadgeNo:"",mName:"",mdepartment:"",mfromDate:"",muntilDate:""}),[c,p]=(0,n.useState)({}),m=e=>{const{name:t,value:a}=e.target;d((e=>(0,g.A)((0,g.A)({},e),{},{[t]:a}))),p((e=>(0,g.A)((0,g.A)({},e),{},{[t]:""})))};return(0,i.jsx)("section",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,i.jsx)("div",{className:"bg-white w-[90%] max-w-[500px] rounded-lg shadow-lg p-7 ",onClick:()=>{l([])},children:(0,i.jsxs)("div",{className:" p-5 shadow-xl bg-[#fdfcfc]",children:[(0,i.jsxs)("div",{className:" flex items-center justify-between pb-2",children:[(0,i.jsx)("p",{className:"flex-1"}),(0,i.jsx)("img",{className:"max-w-[220px] flex-1 w-full",src:Se.A,alt:"not found"}),(0,i.jsx)("p",{className:"flex-1 flex justify-end",children:(0,i.jsx)(j.LwM,{className:"text-[30px]  text-dark_grey cursor-pointer",onClick:t})})]}),(0,i.jsx)("header",{className:"flex justify-center items-center pb-2 ",children:(0,i.jsx)("h2",{className:"text-dark_grey text-[22px] font-bold border-b-2",children:"Assign Manager"})}),(0,i.jsx)("main",{className:"mt-4",children:(0,i.jsxs)("form",{className:"grid grid-cols-1 gap-4",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(ea,{searchResult:e=>{var t,a,r,n;const s=Array.isArray(null===e||void 0===e?void 0:e.department)&&(null===e||void 0===e||null===(t=e.department)||void 0===t?void 0:t.length)>0?null===e||void 0===e?void 0:e.department[(null===e||void 0===e||null===(a=e.department)||void 0===a?void 0:a.length)-1]:"",i="OTHER"===s?Array.isArray(null===e||void 0===e?void 0:e.otherDepartment)&&(null===e||void 0===e||null===(r=e.otherDepartment)||void 0===r?void 0:r.length)>0?null===e||void 0===e?void 0:e.otherDepartment[(null===e||void 0===e||null===(n=e.otherDepartment)||void 0===n?void 0:n.length)-1]:"":s;d({mbadgeNo:(null===e||void 0===e?void 0:e.empBadgeNo)||"",mName:(null===e||void 0===e?void 0:e.name)||"",mdepartment:i})},newFormData:r,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Search Employee Id",rounded:"rounded-lg",filteredEmployees:s,setFilteredEmployees:l})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5 ",children:"Badge No."}),(0,i.jsx)("input",{type:"text",name:"mbadgeNo",value:o.mbadgeNo||"",onChange:m,className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.mbadgeNo?"bg-lite_skyBlue":"bg-white")}),c.mbadgeNo&&(0,i.jsx)("p",{className:"text-red text-xs",children:c.mbadgeNo})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Name"}),(0,i.jsx)("input",{type:"text",name:"mName",value:o.mName||"",onChange:m,className:"mt-1 block w-full border outline-none border-lite_grey text_size_7 rounded text-sm py-2 px-3 ".concat(o.mName?"bg-lite_skyBlue":"bg-white")}),c.mName&&(0,i.jsx)("p",{className:"text-red text-xs",children:c.mName})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Department"}),(0,i.jsx)("input",{type:"text",name:"mdepartment",value:o.mdepartment||"",onChange:m,className:"mt-1 block w-full border outline-none border-lite_grey text_size_7 rounded text-sm py-2 px-3 ".concat(o.mdepartment?"bg-lite_skyBlue":"bg-white")}),c.mdepartment&&(0,i.jsx)("p",{className:"text-red text-xs",children:c.mdepartment})]}),(0,i.jsx)("p",{className:"text-dark_grey text_size_2",children:"Timesheet Period:"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5 text-gray-600",children:"From"}),(0,i.jsx)("input",{type:"date",name:"mfromDate",value:o.mfromDate||"",onChange:m,className:"mt-1 block w-full border outline-none border-lite_grey  rounded text_size_6 py-1.5 px-3 "}),c.mfromDate&&(0,i.jsx)("p",{className:"text-red text-xs",children:c.mfromDate})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5 text-gray-600",children:"Until"}),(0,i.jsx)("input",{type:"date",name:"muntilDate",value:o.muntilDate||"",onChange:m,className:"mt-1 block w-full border outline-none border-lite_grey  rounded text_size_6 py-1.5 px-3"}),c.muntilDate&&(0,i.jsx)("p",{className:"text-red text-xs",children:c.muntilDate})]})]})]})}),(0,i.jsx)("footer",{className:"flex justify-center mt-6 space-x-3",children:(0,i.jsx)("button",{className:"px-5 py-2 bg-[#FEF116] text_size_5 text-dark_grey rounded",onClick:()=>{const e=(()=>{const e={},{mbadgeNo:t,mName:a,mdepartment:r,mfromDate:n,muntilDate:s}=o;return t||(e.mbadgeNo="Badge No is required."),a||(e.mName="Name is required."),r||(e.mdepartment="Department is required."),n||(e.mfromDate="From Date is required."),s?new Date(s)<new Date(n)&&(e.muntilDate="Until Date cannot be before From Date."):e.muntilDate="Until Date is required.",e})();Object.keys(e).length>0?p(e):(a(o),t())},children:"Send for Approval"})})]})})})},bs=e=>{let{toggleForRemarkFunc:t,addRemarks:a,passSelectedData:r,addEditedRemarks:s}=e;const[l,o]=(0,n.useState)("");return(0,i.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-96",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center pb-2",children:[(0,i.jsx)("p",{className:"flex-1"}),(0,i.jsx)("img",{className:"max-w-[180px] flex-1 w-full",src:Se.A,alt:"not found"}),(0,i.jsx)("button",{onClick:()=>{if(r){const e=(0,g.A)((0,g.A)({},r),{},{status:"Rejected"});a(e),null===s||void 0===s||s(e),t()}},className:"text-dark_grey flex-1 flex justify-end",children:(0,i.jsx)(j.LwM,{className:"text-[30px]  text-dark_grey cursor-pointer "})})]}),(0,i.jsx)("header",{className:"flex justify-center items-center ",children:(0,i.jsx)("h2",{className:"text-dark_grey text-[20px] font-bold ",children:"Add Remark"})}),(0,i.jsx)("div",{className:"",children:(0,i.jsx)("textarea",{value:l,onChange:e=>o(e.target.value),className:"mt-1 p-2 w-full border border-lite_grey rounded-md outline-none",rows:"4",placeholder:"Enter your remark...","data-gramm":"false"})}),(0,i.jsx)("div",{className:"flex justify-center mt-6",children:(0,i.jsx)("button",{onClick:()=>{if(r){const e=(0,g.A)((0,g.A)({},r),{},{REMARKS:l,status:"Rejected"});a(e),null===s||void 0===s||s(e)}t()},className:"px-4 py-2 text-dark_grey text_size_5 border bg-primary rounded border-primary",children:"Reject"})})]})})},Ds=(0,Ee.D)(),js=async e=>{let t=[],a=null;do{const r=await Ds.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t},As=async(e,t,a)=>{try{var r;null===t||void 0===t||t(!0),null===a||void 0===a||a("Please wait a few seconds...");const n=null===(r=localStorage.getItem("userID"))||void 0===r?void 0:r.toUpperCase(),s=async()=>{const[e,t]=await Promise.all([js(Ie.it),js(Ie.ZZ)]),a=e.map((e=>{const a=t.find((t=>t.empID===e.empID));return a?(0,g.A)((0,g.A)({},e),a):null})).filter((e=>null!==e));return a.filter((e=>e.empID===n&&"Manager"!==e.selectType))},i=await s(),l=(null===e||void 0===e?void 0:e.filter((e=>i.some((t=>e.assignBy===t.empID))))).filter((e=>null!==e&&void 0!==e));return null===t||void 0===t||t(!1),0===l.length?null===a||void 0===a||a("No data available"):null===a||void 0===a||a(""),l}catch(n){null===t||void 0===t||t(!1),null===a||void 0===a||a("An error occurred. Please try again.")}},ws=()=>{const{startDate:e,setStartDate:t,endDate:a,setEndDate:r}=(0,Fe.b)();return(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1",children:[(0,i.jsx)("label",{htmlFor:"",className:" text-dark_grey text_size_5",children:"Start Date"}),(0,i.jsx)("input",{type:"date",value:e||"",onChange:e=>t(e.target.value),className:"border border-lite_grey rounded px-2 py-1"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1",children:[(0,i.jsx)("label",{htmlFor:"",className:"px-2 text-dark_grey text_size_5",children:"End Date"}),(0,i.jsx)("input",{type:"date",value:a||"",onChange:e=>r(e.target.value),className:"ml-2 border border-lite_grey rounded px-2 py-1 "})]})]})},Ss=e=>{let{totalPages:t,currentPage:a,paginate:r}=e;const n=Math.max(1,a-Math.floor(2)),s=Math.min(t,n+4-1),l=[];for(let i=n;i<=s;i++)l.push(i);return(0,i.jsxs)("div",{className:"pagination flex justify-center space-x-5 ",children:[(0,i.jsxs)("div",{onClick:()=>r(a-1),className:" py-1.5 flex items-center justify-center space-x-2 rounded-lg border border-dark_ash bg-white cursor-pointer w-28 ".concat(1===a?" pointer-events-none":""),children:[(0,i.jsx)(la.QVr,{}),(0,i.jsx)("span",{children:"Previous"})]}),(0,i.jsx)("div",{className:"flex items-center justify-center space-x-5",children:l.map((e=>(0,i.jsx)("button",{onClick:()=>r(e),className:"rounded-full  text-lg w-7 h-7 flex items-center justify-center  ".concat(a===e?"bg-[indigo] text-white":" text-dark_grey hover:bg-[indigo] hover:text-white"),children:e},e)))}),(0,i.jsxs)("div",{onClick:()=>r(a+1),className:"px-3 py-1.5 flex items-center  space-x-2 rounded-lg border border-dark_ash bg-white cursor-pointer  ".concat(a===t?" pointer-events-none":""),children:[(0,i.jsx)("span",{children:"Next"}),(0,i.jsx)(la.Z0P,{})]})]})},Es=(0,Ee.D)(),Is=()=>{const[e,t]=(0,n.useState)(null);return(0,n.useEffect)((()=>{async function e(e){let t=[],a=null;do{const r=await Es.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}!async function(){try{const[a,r]=await Promise.all([e(Ie.it),e(Ie.bJ)]),n=r,s=a.map((e=>{const t=n.find((t=>t.empID===e.empID));return t?(0,g.A)((0,g.A)({},e),t):null})).filter((e=>null!==e));t(s)}catch(a){}}()}),[]),e},ks=(0,Ee.D)(),Ts=async e=>{try{const t=await(async e=>{let t=[],a=null;do{const r=await ks.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t})(Ie.it);if(t&&e){const a=t.find((t=>t.empBadgeNo===e.assignTo)),r=t.find((t=>t.empID===e.assignBy));return{ManagerDetails:a||null,TimeKeeperDetails:r||null,TimeSheetData:e}}}catch(t){}return null},Cs=async e=>{let{getEmail:t,Position:a,correctionMade:r,identify:n}=e,s=!1;const i=e=>{if(!e)return"Invalid date";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)};if(t&&!s)try{var l,o,d,c,p,m,u,h,x,g,f,v,y,N;const e=new Date,B=i(null===t||void 0===t||null===(l=t.TimeSheetData)||void 0===l?void 0:l.fromDate),q=i(null===t||void 0===t||null===(o=t.TimeSheetData)||void 0===o?void 0:o.untilDate),H=(i(e),null===t||void 0===t||null===(d=t.TimeSheetData)||void 0===d?void 0:d.status),W="Manager"===a?null===t||void 0===t||null===(c=t.TimeKeeperDetails)||void 0===c?void 0:c.name:null===t||void 0===t||null===(p=t.ManagerDetails)||void 0===p?void 0:p.name,z="HR"===n?'"Dear HR" <timesheet_no-reply@adininworks.com>':'"Dear '.concat(W,'" <timesheet_no-reply@adininworks.com>'),Y="Manager"===a?null===t||void 0===t||null===(m=t.TimeKeeperDetails)||void 0===m?void 0:m.officialEmail:null===t||void 0===t||null===(u=t.ManagerDetails)||void 0===u?void 0:u.officialEmail,V="https://hr.adininworks.co/login";let G="",J="";var b,D,j;if("General"===n&&r&&"Manager"!==a)G="Corrected Time Sheet Submitted for Approval",J="\n  <html>\n    <body>\n      <p>Dear ".concat(null===t||void 0===t||null===(b=t.ManagerDetails)||void 0===b?void 0:b.name,",</p>\n      <p>The corrected ").concat(null===t||void 0===t||null===(D=t.TimeSheetData)||void 0===D?void 0:D.fileType," timesheet for the period from ").concat(B," until ").concat(q," has been submitted by Timekeeper ").concat(null===t||void 0===t||null===(j=t.TimeKeeperDetails)||void 0===j?void 0:j.name,'\n      </p>\n      \n      <p>Click here <a href="').concat(V,'">').concat(V,"</a> to Review and update the Status.</p>\n      \n   \n    </body>\n  </html>\n");else if("HR"===n&&r&&"Manager"!==a){var A,w;G="Corrected Time Sheet Submitted for Approval",J="\n  <html>\n    <body>\n      <p>Dear HR,</p>\n      <p>The corrected ".concat(null===t||void 0===t||null===(A=t.TimeSheetData)||void 0===A?void 0:A.fileType," timesheet for the period from ").concat(B," until ").concat(q," has been submitted by Timekeeper ").concat(null===t||void 0===t||null===(w=t.TimeKeeperDetails)||void 0===w?void 0:w.name,'\n      </p>\n      \n      <p>Click here <a href="').concat(V,'">').concat(V,"</a> to review the status.</p>\n      \n   \n    </body>\n  </html>\n")}else if("Manager"===a&&"General"===n){var S,E,I,k;G="".concat(null===t||void 0===t||null===(S=t.TimeSheetData)||void 0===S?void 0:S.fileType," Time Sheet ").concat("Approved"===H?"Approved":"Rejected"===H?"Rejected":""),J="\n        <html>\n          <body>\n            <p>Dear ".concat(null===t||void 0===t||null===(E=t.TimeKeeperDetails)||void 0===E?void 0:E.name,",</p>\n            <p>Your submitted ").concat(null===t||void 0===t||null===(I=t.TimeSheetData)||void 0===I?void 0:I.fileType," timesheet for the period ").concat(B," to ").concat(q," has been ").concat(H," by Manager : ").concat(null===t||void 0===t||null===(k=t.ManagerDetails)||void 0===k?void 0:k.name,".</p>   \n            ").concat("Rejected"===H?'<p>Click here <a href="'.concat(V,'">').concat(V,"</a> to review and make the necessary corrections.</p>"):'<p>Click here <a href="'.concat(V,'">').concat(V,"</a> to check the status.</p>"),"       \n          </body>\n        </html>\n      ")}else if("Manager"===a&&"HR"===n){var T,C,R;G="".concat(null===t||void 0===t||null===(T=t.TimeSheetData)||void 0===T?void 0:T.fileType," Time Sheet ").concat("Approved"===H?"Approved":"Rejected"===H?"Rejected":""),J="\n        <html>\n          <body>\n            <p>Dear HR,</p>\n            <p>".concat(null===t||void 0===t||null===(C=t.TimeSheetData)||void 0===C?void 0:C.fileType," timesheet for the period ").concat(B," to ").concat(q," has been ").concat(H," by Manager : ").concat(null===t||void 0===t||null===(R=t.ManagerDetails)||void 0===R?void 0:R.name,".</p>\n           \n             \n            ").concat('<p>Click here <a href="'.concat(V,'">').concat(V,"</a> to check the status.</p>"),"       \n          </body>\n        </html>\n      ")}else if("Manager"!==a&&"General"===n){var P,O,_,M;G="".concat(null===t||void 0===t||null===(P=t.TimeSheetData)||void 0===P?void 0:P.fileType," Time Sheet Submitted for Approval"),J="\n        <html>\n          <body>\n            <p>Dear ".concat(null===t||void 0===t||null===(O=t.ManagerDetails)||void 0===O?void 0:O.name,",</p>\n            <p>The ").concat(null===t||void 0===t||null===(_=t.TimeSheetData)||void 0===_?void 0:_.fileType," timesheet for the period from ").concat(B," until ").concat(q," has been submitted by Timekeeper \n           ").concat(null===t||void 0===t||null===(M=t.TimeKeeperDetails)||void 0===M?void 0:M.name,'</p>\n                   \n            <p>Click here <a href="').concat(V,'">').concat(V,"</a> to review and update the status.</p>   \n          </body>\n        </html>\n      ")}else if("Manager"!==a&&"HR"===n){var F,L,U;G="".concat(null===t||void 0===t||null===(F=t.TimeSheetData)||void 0===F?void 0:F.fileType," Time Sheet Submitted for Approval"),J="\n        <html>\n          <body>\n            <p>Dear HR,</p>\n            <p>The ".concat(null===t||void 0===t||null===(L=t.TimeSheetData)||void 0===L?void 0:L.fileType," timesheet for the period from ").concat(B," until ").concat(q," has been submitted by Timekeeper \n           ").concat(null===t||void 0===t||null===(U=t.TimeKeeperDetails)||void 0===U?void 0:U.name,'</p>\n                   \n            <p>Click here <a href="').concat(V,'">').concat(V,"</a> to review the status.</p>   \n          </body>\n        </html>\n      ")}s=!0;const K="Manager"===a?null===t||void 0===t||null===(h=t.TimeKeeperDetails)||void 0===h?void 0:h.empID:null===t||void 0===t||null===(x=t.ManagerDetails)||void 0===x?void 0:x.empID,Q=null===t||void 0===t||null===(g=t.TimeKeeperDetails)||void 0===g?void 0:g.empID,$=null===t||void 0===t||null===(f=t.TimeKeeperDetails)||void 0===f?void 0:f.empID,Z=null===t||void 0===t||null===(v=t.ManagerDetails)||void 0===v?void 0:v.name,X=null===t||void 0===t||null===(y=t.TimeSheetData)||void 0===y?void 0:y.fileType,ee=null===t||void 0===t||null===(N=t.TimeKeeperDetails)||void 0===N?void 0:N.name;return{subject:G,message:J,fromAddress:z,toAddress:Y,empID:K,timeKeeperEmpID:Q,ManagerEmpID:$,managerName:Z,fileType:X,timeKeeperName:ee,fromDate:B,untilDate:q,senderEmail:"timesheet_no-reply@adininworks.com",sheetStatus:"Approved"===H?"Approved":"Rejected"===H?"Rejected":""}}catch(B){}},Rs=(0,Ee.D)(),Ps=async e=>{let{finalResult:t,toggleSFAMessage:a,setStoringMess:r,setData:n,Position:s,action:i,setShowTitle:l,setNotification:o,setAllApprovedData:d,setAllRejectedData:c,handleAssignManager:p,selectedRows:m,storeApproveRej:u}=e,h="hr-timesheet@adininworks.com";if("create"===i){const e=(e,t)=>{const a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a};(async t=>{let s=0,i=!1;const l=e(t,1e3);r(!0);for(const e of l)try{await Promise.all(e.map((async e=>{var l;const o=await Rs.graphql({query:ke.d$,variables:{input:e}});if(null!==o&&void 0!==o&&null!==(l=o.data)&&void 0!==l&&l.createTimeSheet){if(s++,!i){i=!0;o.data.createTimeSheet}s===t.length&&(r(!1),a(!0),n(null))}})))}catch(o){r(!1),a(!1)}})(t)}else{if("updateStoredData"===i){const e=(e,t)=>{const a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a},n=async t=>{let n=0,i=!1,d=null;null===o||void 0===o||o(!0),null===l||void 0===l||l("Data has been submitted successfully");const c=e(t,1e3);for(const e of c)try{await Promise.all(e.map((async e=>{var a;const r=await Rs.graphql({query:ke.gB,variables:{input:e}});if(null!==r&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&a.updateTimeSheet&&(n++,!i)){i=!0;const e=r.data.updateTimeSheet,a=await Ts(e);if(a){const e=await Cs({getEmail:a,Position:s,identify:"General"});if(e){d=e;const{subject:r,message:i,fromAddress:l,toAddress:c}=e;await Me(r,i,l,c);const m=await Cs({getEmail:a,Position:s,identify:"HR"});if(m){const{subject:e,message:a,fromAddress:r,toAddress:s}=m;"success"===await Me(e,a,r,h)&&n===t.length&&(await p(),null===o||void 0===o||o(!1))}}}}})))}catch(m){r(!1),a(!1)}return d};return await n(t)}if("update"===i){const e=(e,t)=>{const a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a},n=async t=>{var n,i;let p=!1,m=[];null===o||void 0===o||o(!0),null===l||void 0===l||l("Data has been submitted successfully");const x=e(t,1e3);for(const e of x)try{await Promise.all(e.map((async e=>{try{var t;const r=await Rs.graphql({query:ke.gB,variables:{input:e}});if(null!==r&&void 0!==r&&null!==(t=r.data)&&void 0!==t&&t.updateTimeSheet){0;const e=r.data.updateTimeSheet;if(m.push(e),!p){r.data.updateTimeSheet;p=!0,a(!0)}}}catch(n){r(!1),null===o||void 0===o||o(!1),a(!1)}})))}catch(f){}const g=await(async e=>e.reduce(((e,t)=>{const{status:a}=t;return e[a]||(e[a]=[]),e[a].push(t),e}),{}))(m);if((null===(n=g.Rejected)||void 0===n?void 0:n.length)>0){const e=g.Rejected[0],t=await Ts(e);if(t){const e=await Cs({getEmail:t,Position:s,identify:"General"});if(e){u.push(e);const{subject:a,message:r,fromAddress:n,toAddress:i}=e;await Me(a,r,n,i);const l=await Cs({getEmail:t,Position:s,identify:"HR"});if(l){const{subject:e,message:t,fromAddress:a,toAddress:r}=l;"success"===await Me(e,t,a,h)&&setTimeout((()=>{null===o||void 0===o||o(!1)}),1e3)}}}}if((null===(i=g.Approved)||void 0===i?void 0:i.length)>0){const e=g.Approved[0],t=await Ts(e);if(t){const e=await Cs({getEmail:t,Position:s,identify:"General"});if(e){u.push(e);const{subject:a,message:r,fromAddress:n,toAddress:i}=e;await Me(a,r,n,i);const l=await Cs({getEmail:t,Position:s,identify:"HR"});if(l){const{subject:e,message:t,fromAddress:a,toAddress:r}=l;"success"===await Me(e,t,a,h)&&setTimeout((()=>{null===o||void 0===o||o(!1)}),1e3)}}}}return null===d||void 0===d||d([]),null===c||void 0===c||c([]),u};return await n(t)}if("ResubmitRejectedItems"===i){const e=(e,t)=>{const a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a},n=async t=>{let n=0,i=null,d=!1;null===o||void 0===o||o(!0),null===l||void 0===l||l("Data has been submitted successfully");const c=e(t,1e3);for(const e of c)try{await Promise.all(e.map((async e=>{var r;const l=await Rs.graphql({query:ke.gB,variables:{input:e}});if(null!==l&&void 0!==l&&null!==(r=l.data)&&void 0!==r&&r.updateTimeSheet&&(n++,!d)){d=!0,a(!0);const e=l.data.updateTimeSheet,r=await Ts(e);if(r){let e=!0;const a=await Cs({getEmail:r,Position:s,correctionMade:e,identify:"General"});if(a){i=a;const{subject:e,message:l,fromAddress:d,toAddress:c}=a;await Me(e,l,d,c);let m=!0;const u=await Cs({getEmail:r,Position:s,correctionMade:m,identify:"HR"});if(u){const{subject:e,message:a,fromAddress:r,toAddress:s}=u;"success"===await Me(e,a,r,h)&&n===t.length&&(await p(),null===o||void 0===o||o(!1))}}}}})))}catch(m){null===o||void 0===o||o(!1),r(!1),a(!1)}return i};return await n(t)}}},Os=()=>{const[e,t]=(0,n.useState)([]);return{selectedRows:e,setSelectedRows:t,handleCheckboxChange:a=>{e.some((e=>e.id===a.id))?t(e.filter((e=>e.id!==a.id))):t([...e,a])},handleSubmit:a=>{if(a){if(e.some((e=>e.id===a.id))){const r=e.map((e=>e.id===a.id?a:e));t(r)}else t([...e,a])}}}},_s=e=>{let{text:t}=e;return(0,i.jsx)("section",{children:(0,i.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-[70]",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[(0,i.jsx)("p",{className:"text-dark_grey font-semibold",children:t}),(0,i.jsx)("img",{src:Re,alt:"Logo",className:"mt-4 cursor-pointer w-12 h-12 mx-auto animate-spin-slow"})]})})})},Ms=async e=>{let{finalResult:t,setLoadingMessForDelay:a,identifier:r,setShowDuplicateAlert:n,setCancelAction:s}=e;const i=(0,Ee.D)();let l=[],o=[],d=[],c=0,p="",m=!1;null===a||void 0===a||a(!0);try{let e=null;do{var u,h,x,g;const t=await i.graphql({query:Ie.Oy,variables:{limit:800,nextToken:e}}),a=(null===t||void 0===t||null===(u=t.data)||void 0===u||null===(h=u.listTimeSheets)||void 0===h?void 0:h.items)||[];l=[...l,...a],e=null===t||void 0===t||null===(x=t.data)||void 0===x||null===(g=x.listTimeSheets)||void 0===g?void 0:g.nextToken}while(e)}catch(y){return console.error("\u274c Error while fetching all records:",y),null===a||void 0===a||a(!1),{filteredResults:[],deleteDuplicateData:""}}const f=new Map;for(const N of l){const e="Offshore"===N.fileType||"BLNG"===N.fileType||"Offshore's ORMC"===N.fileType?N.fidNo:N.empBadgeNo;if("create"===r){const t="".concat(N.fileType,"|").concat(N.date.trim(),"|").concat(e);f.set(t,N)}else if("Verified"===N.status&&"updateStoredData"===r){const t="".concat(N.fileType,"|").concat(N.date.trim(),"|").concat(e);f.set(t,N)}}for(const N of t){const e="Offshore"===N.fileType||"BLNG"===N.fileType||"Offshore's ORMC"===N.fileType?N.fidNo:N.empBadgeNo,t="".concat(N.fileType,"|").concat(N.date.trim(),"|").concat(e);f.has(t)&&"updateStoredData"===r&&(d.push(f.get(t)),o.push(N)),f.has(t)||"updateStoredData"!==r||o.push(N),f.has(t)&&"create"===r&&!m&&(m=!0,null===n||void 0===n||n(!0),null===s||void 0===s||s(!0)),f.has(t)||"create"!==r||o.push(N)}const v=((e,t)=>{const a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a})(d,500);for(const N of v)await Promise.allSettled(N.map((async e=>{try{var t;const a=await i.graphql({query:ke.OB,variables:{input:{id:e.id}}});null!==a&&void 0!==a&&null!==(t=a.data)&&void 0!==t&&t.deleteTimeSheet&&(c++,c===d.length&&(p="DuplicateDataDeletedSuccessfully"))}catch(y){console.error("\u274c Error deleting item with ID ".concat(e.id,":"),y)}})));return null===a||void 0===a||a(!1),{filteredResults:o,deleteDuplicateData:p}},Fs=e=>{let{setCancelAction:t,onClose:a,fileNameForSuccessful:r,title:n,message:s,buttonName:l,popupIdentification:o,onClearData:d}=e;return(0,i.jsx)("div",{className:"".concat("duplicateRecords"===o&&"fixed inset-0 bg-black/50 z-50"," flex items-center justify-center"),children:(0,i.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-[90%] max-w-md shadow-lg text-dark_grey grid grid-rows-[auto_1fr_auto]",children:[(0,i.jsxs)("div",{className:"grid grid-cols-[1fr_auto] justify-items-center items-center ",children:[(0,i.jsx)("h2",{className:"text_size_2 mx-10 mb-4 text-center ",children:n}),(0,i.jsx)("i",{className:"cursor-pointer mb-auto text-dark_grey text-2xl",onClick:()=>{null===t||void 0===t||t(!0),null===a||void 0===a||a()},children:(0,i.jsx)(es.qpF,{})})]}),(0,i.jsxs)("p",{className:"mb-1.5",children:[(0,i.jsx)("span",{className:"text_size_5",children:"File Name : "}),(0,i.jsx)("span",{className:"px-3 text_size_6",children:r})]}),(0,i.jsx)("p",{className:"text_size_6 mb-2 text-justify",children:s}),(0,i.jsx)("div",{className:"flex justify-end text-dark_grey text_size_5",children:(0,i.jsx)("button",{className:"px-6 py-2 bg-primary rounded",onClick:async()=>{"OK"===l?(null===d||void 0===d||d(),null===a||void 0===a||a()):"Save"===l?(null===t||void 0===t||t(!1),null===a||void 0===a||a()):null===a||void 0===a||a()},children:l})})]})})},Ls=["sapNo"],Us=(0,Ee.D)(),Bs=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]);return(0,n.useEffect)((()=>{try{const e=async()=>{try{async function a(e){let t=[],a=null;do{const r=await Us.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}(async()=>{try{const[e,n,s]=await Promise.all([a(Ie.it),a(Ie.bJ),a(Ie._n)]),i=e,l=n.map((e=>{let{sapNo:t}=e;return(0,is.A)(e,Ls)})),o=i.map((e=>{const t=l.find((t=>String(null===t||void 0===t?void 0:t.empID).toUpperCase()===String(null===e||void 0===e?void 0:e.empID).toUpperCase()));return t?(0,g.A)((0,g.A)({},e),t):null})).filter((e=>null!==e));t(o),r(s)}catch(e){}})()}catch(e){console.log("Error : ",e)}};e()}catch(e){console.log("ERROR : ",e)}}),[]),{empAndWorkInfo:e,leaveStatuses:a}},qs=e=>{let{handleDecision:t,alertMessage:a}=e;return(0,i.jsx)("div",{className:"p-6",children:(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-200 ease-in-out",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-2xl w-96 transform opacity-100 scale-95 animate-fade-in",children:[(0,i.jsx)("h2",{className:"text_size_2  mb-4 text-center",children:"Alert!"}),(0,i.jsx)("p",{className:"text-dark_grey mb-6 text_size_7 leading-relaxed text-center",children:a}),(0,i.jsx)("div",{className:"flex justify-center items-center border-lite_grey",children:(0,i.jsx)("button",{onClick:()=>t("Denied"),className:"px-5 py-1 text_size_5 text-dark_grey border-lite_grey border bg-primary rounded",children:"OK"})})]})})})},Hs=e=>{let{handleSelectItem:t,storeLocation:a,isOpen:r,setIsOpen:s}=e;const[l,o]=(0,n.useState)(""),[d,c]=(0,n.useState)([]);(0,n.useEffect)((()=>{let e=[...new Set(a.filter(Boolean))].filter((e=>{var t,a;return null===e||void 0===e||null===(t=e.toLowerCase())||void 0===t||null===(a=t.includes)||void 0===a?void 0:a.call(t,null===l||void 0===l?void 0:l.toLowerCase())}));c(e)}),[l]);return(0,i.jsxs)("div",{className:"text-dark_grey text_size_5 bg-white relative",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"flex justify-between items-center border border-lite_grey cursor-pointer rounded",onClick:()=>{c(a),s(!r)},children:[(0,i.jsx)("input",{type:"text",className:"px-3 py-1.5 outline-none rounded",placeholder:"Search Location",value:l,onChange:e=>{o(e.target.value),s(!0)}}),(0,i.jsx)("i",{className:"pr-2",children:(0,i.jsx)(Tt.Vr3,{})})]}),r&&(0,i.jsx)("ul",{className:"absolute top-10 w-full z-10 bg-medium_white max-h-32 rounded border border-lite_grey overflow-y-auto",children:d.length>0?d.map(((e,a)=>(0,i.jsx)("li",{onClick:()=>{(e=>{o(e),s(!1)})(e),t(e),s(!1)},className:"m-1 px-4 py-1.5 hover:text-white hover:bg-grey text-dark_grey duration-200 cursor-pointer",children:e},a))):(0,i.jsx)("li",{className:"px-4 py-2",children:"No results found"})})]})},Ws=["sapNo"],zs=(0,Ee.D)(),Ys=e=>{var t,a,s;let{excelData:l,returnedTHeader:o,Position:d,titleName:c,setExcelData:p,fileName:m,showRejectedItemTable:u,submittedData:h,wholeData:x,ManagerData:f}=e;const v=(0,n.useRef)(!1),y=(0,n.useRef)(!1),N=(0,r.Zp)(),b=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toUpperCase(),[D,A]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),[E,I]=(0,n.useState)(null),[k,T]=(0,n.useState)(null),[C,R]=(0,n.useState)(),[P,O]=(0,n.useState)(!1),[_,M]=(0,n.useState)(!0),[F,L]=(0,n.useState)(""),[U,B]=(0,n.useState)(null),[q,H]=(0,n.useState)(null),[W,z]=(0,n.useState)(!1),[Y,V]=(0,n.useState)(null),[G,J]=(0,n.useState)(null),[K,Q]=(0,n.useState)({}),[$,Z]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(""),[te,ae]=(0,n.useState)(null),[re,ne]=(0,n.useState)(!1),[se,ie]=(0,n.useState)(""),[le,oe]=(0,n.useState)(!1),[de,ce]=(0,n.useState)(!1),[pe,me]=(0,n.useState)(null),[ue,he]=(0,n.useState)(!1),[xe,ge]=(0,n.useState)([]),[fe,ve]=(0,n.useState)([]),[ye,Ne]=(0,n.useState)(null),[be,De]=(0,n.useState)(1),[je,Ae]=(0,n.useState)([]);let we;const Se=Is(),[Ee,ke]=(0,n.useState)(null),[Te,Ce]=(0,n.useState)({}),[Re,Pe]=(0,n.useState)({}),[Oe,Me]=(0,n.useState)(""),[Le,Ue]=(0,n.useState)(["All"]),[Be,qe]=(0,n.useState)(!1),[He,We]=(0,n.useState)(!1),[ze,Ye]=(0,n.useState)(""),{startDate:Ve,endDate:Ge,searchQuery:Je,setSearchQuery:Ke}=(0,Fe.b)(),{selectedRows:Qe,setSelectedRows:$e,handleCheckboxChange:Ze,handleSubmit:Xe}=Os(),{createNotification:et}=_e(),{empAndWorkInfo:tt}=Bs();(0,n.useEffect)((()=>{try{const e=async()=>{try{const t=new Promise(((e,t)=>{l?e(l):setTimeout((()=>{t("No data found after waiting.")}),2e3)})),a=await t;async function r(e){let t=[],a=null;do{const r=await zs.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}const n=async()=>{try{const[e,t]=await Promise.all([r(Ie.it),r(Ie.bJ)]),n=e,s=t.map((e=>{let{sapNo:t}=e;return(0,is.A)(e,Ws)})),i=n.map((e=>{const t=s.find((t=>String(null===t||void 0===t?void 0:t.empID).toUpperCase()===String(null===e||void 0===e?void 0:e.empID).toUpperCase()));return t?(0,g.A)((0,g.A)({},e),t):null})).filter((e=>null!==e)),l=a.map((e=>{const t=i.find((t=>String(null===t||void 0===t?void 0:t.sapNo).toUpperCase()===String(null===e||void 0===e?void 0:e.NO).toUpperCase()));return(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:t?null===t||void 0===t?void 0:t.workHrs[(null===t||void 0===t?void 0:t.workHrs.length)-1]:null})}));S(l),I(l)}catch(e){}};n()}catch(e){}};e()}catch(e){}}),[l]),(0,n.useEffect)((()=>{if(h&&h.length>0){ae(!0),T(!0);const e=function(e){return e.map((e=>{var t,a,r,n;return(0,g.A)((0,g.A)({},e),{},{companyName:null===e||void 0===e?void 0:e.LOCATION,WORKINGHOURS:null!==(t=e.TOTALHOURS)&&void 0!==t?t:"0",OT:null!==(a=e.TOTALHOURS2)&&void 0!==a?a:"0",jobLocaWhrs:[{JOBCODE:"",LOCATION:e.LOCATION,OVERTIMEHRS:null!==(r=e.TOTALHOURS2)&&void 0!==r?r:"0",WORKINGHRS:null!==(n=e.TOTALHOURS)&&void 0!==n?n:"0",id:1}]})}))}(h);$e(e),S(e),I(e)}}),[h]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");"Manager"===e?L("Manager"):"Manager"!==e&&L("TimeKeeper")}),[x]);const at=e=>{if(e&&e.length>0){T(!0);const t=null===e||void 0===e?void 0:e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||"",NO:e.fidNo||"",LOCATION:e.location||"",TRADE:e.trade||"",DATE:e.date||"",TOTALHOURS:e.totalNT||0,TOTALHOURS2:e.totalOT||0,TOTALHOURS3:e.totalNTOT||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}}));S(t),I(t)}};(0,n.useEffect)((()=>{if(o&&(null===o||void 0===o?void 0:o.length)>0)(async()=>{const e=o&&o.map((e=>{const t={};for(const r in e)t[r]="string"!==typeof(a=e[r])?a:a.replace(/[^a-zA-Z0-9]/g,"");var a;return t})),t=["NAME","No","Company","TOTALHOURS"],a=await new Promise((a=>{a(e&&e.every((e=>t.every((t=>Object.values(e).map((e=>"string"===typeof e?e.toUpperCase():e)).includes(t.toUpperCase()))))))}));A(!0),ae(a),T(a),M(!1)})();else if(o||"Rejected"===u)if(o||"Rejected"!==u)T(!1),M(!1);else{(async()=>{T(!0),he(!0);try{const e=new Promise(((e,t)=>{x&&x.length>0?e(x):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"!==F){await As(t);at(t)}}catch(e){}})()}else{(async()=>{T(!0);try{const e=new Promise(((e,t)=>{f&&f.length>0?e(f):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"===F){await ys(t);at(t);const e=Array.isArray(t)&&[...new Set(t.map((e=>e.location)))];Ue([...Le,...e])}}catch(e){}})()}}),[o,f,x,F,u]);const rt=()=>{O(!P)},nt=(0,n.useCallback)((async(e,t)=>{B(e)}),[]),st=()=>{z(!W)},it=()=>{const e=null===w||void 0===w?void 0:w.filter((e=>!Qe.some((t=>t.id===e.id))));S(e),I(e),$e([]),e&&0===e.length&&window.location.reload()},lt=ds(c),ot=async e=>{if("Manager"!==F&&"Rejected"!==u&&Qe&&Qe.length>0){const t=(Qe&&Qe.length>0&&Qe.map((e=>({id:e.id,empName:e.NAME||"",fidNo:e.NO||"",companyName:e.LOCATIONATTOP?e.LOCATIONATTOP:e.LOCATION||"",location:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"Offshore",status:"Pending"})))).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:b,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="updateStoredData";const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:H,identifier:a});if(r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){H(!1);let e="updateStoredData",t=r;const a=await Ps({setNotification:ne,setShowTitle:ie,finalResult:t,toggleSFAMessage:nt,setStoringMess:ke,Position:d,action:e,handleAssignManager:it,selectedRows:Qe});if(a){const{subject:e,message:t,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=a;await et({empID:s,leaveType:"".concat(d," excel sheet submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper : \n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}}else if("Manager"===F){const e=[...xe,...fe],t=null===e||void 0===e?void 0:e.filter(((e,t,a)=>t===a.findIndex((t=>t.id===e.id))));let a=t&&t.length>0?t.map((e=>({id:e.id,empName:e.NAME||"",fidNo:e.NO||"",location:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"Offshore",status:e.status}))):[],r=[],n="update";const s=await Ps({finalResult:a,toggleSFAMessage:nt,setStoringMess:ke,setData:S,Position:d,action:n,setShowTitle:ie,setNotification:ne,setAllApprovedData:ge,setAllRejectedData:ve,storeApproveRej:r});s&&s.length>0&&(s.forEach((async e=>{let{subject:t,message:a,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u,sheetStatus:h}=e;await et({empID:s,leaveType:"".concat(d," Time Sheet ").concat(h),message:"The ".concat(d," timesheet for the period ").concat(p," to ").concat(m," has been ").concat(h," by Manager : ").concat(o,"."),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})})),r=[],We(!1),gt(),await(async()=>{let e=[...xe,...fe];const t=null===w||void 0===w?void 0:w.filter((t=>!e.some((e=>e.id===t.id))));S(t),I(t),t&&0===t.length&&(N("/timeSheet"),window.location.reload())})())}else if("Manager"!==F&&"Rejected"===u&&Qe&&Qe.length>0){const t=(Qe&&Qe.length>0?Qe.map((e=>({id:e.id,empName:e.NAME||"",fidNo:e.NO||"",location:e.LOCATION||"",companyName:e.LOCATIONATTOP?e.LOCATIONATTOP:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"Offshore",status:"Pending"}))):[]).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:b,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="ResubmitRejectedItems";const r=await Ps({setNotification:ne,setShowTitle:ie,finalResult:t,toggleSFAMessage:nt,setStoringMess:ke,Position:d,action:a,handleAssignManager:it,selectedRows:Qe});if(r){const{subject:e,message:t,fromAddress:a,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=r;await et({empID:s,leaveType:"Corrected ".concat(d," Time Sheet Submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}};(0,n.useEffect)((()=>{G&&G.length>0?Q({message:"Some data in the uploaded Excel sheet has already been submitted by the Time Keeper. You may proceed to submit only the remaining unmatched data.",buttonName:"Save"}):G&&0===G.length&&Q({message:"All data in the uploaded Excel sheet has already been submitted by the Time Keeper.",buttonName:"OK"})}),[G]);const dt=async e=>{if("Denied"===e)return;let t=w&&w.length>0&&w.map((e=>({fileName:m,empName:e.NAME||"",fidNo:e.NO||"N/A",companyName:e.LOCATIONATTOP?e.LOCATIONATTOP:e.LOCATION||"",location:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||"0",actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,assignBy:b,fileType:"Offshore",status:"Unsubmitted"}))),a=await(async(e,t)=>{if("Allowed"===t)return!1;let a=!1,r="";for(let c of e){var n,s,i,l,o,d;const e=null===(n=c.fidNo)||void 0===n||null===(s=n.toString())||void 0===s?void 0:s.trim(),t=null===(i=c.normalWorkHrs)||void 0===i||null===(l=i.toString())||void 0===l?void 0:l.trim(),p=null===c||void 0===c||null===(o=c.date)||void 0===o||null===(d=o.toString())||void 0===d?void 0:d.trim();if(!e||"N/A"===e||"0"===e){a=!0,r="Some records are missing the FID or SAP NO. Please update the Excel sheet accordingly.";break}if(!p||"N/A"===p||"0"===p){a=!0,r="Some records are missing the 'DATE'. Please update the Excel sheet accordingly.";break}if(!t||"0"===t||"N/A"===t){a=!0,r="One or more records have missing 'Normal Working Hours Per Day'.";break}}return a?(ee(r),Z(!0),!0):(console.log("All required fields are filled. Proceeding..."),!1)})(t,e);if(a)return;const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:H,identifier:"create",setShowDuplicateAlert:e=>{y.current=e,oe(e)},setCancelAction:e=>{v.current=e,ce(e)}});if(J(r),r.length===t.length&&ce(!1),r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){me({finalResult:r,toggleSFAMessage:nt,setStoringMess:ke,setData:S,Position:d,action:"create"})}else H(!1)},ct=()=>{V(!Y)};(0,n.useEffect)((()=>{le||de||Array.isArray(null===pe||void 0===pe?void 0:pe.finalResult)&&(null===pe||void 0===pe?void 0:pe.finalResult.length)>0&&(async e=>{let{storePreSubmitData:t}=e;const{finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}=t;Array.isArray(a)&&0===a.length||(await Ps({finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}),H(!1),me(null))})({storePreSubmitData:pe})}),[le,de,pe]);const pt=(e,t)=>{"Approved"===t?ge((t=>[...t.filter((t=>t.id!==e.id)),(0,g.A)((0,g.A)({},e),{},{status:"Approved"})])):"Rejected"===t&&(Ne(e),ve((t=>[...t.filter((t=>t.id!==e.id)),e])))},mt=(e,t)=>{if("Approved"===t){const t=xe.filter((t=>t.id!==e.id));ge(t)}else if("Rejected"===t){const t=fe.filter((t=>t.id!==e.id));ve(t)}},ut=(0,n.useCallback)((()=>{const e=[...xe,...fe],t=null===w||void 0===w?void 0:w.filter((t=>!e.some((e=>t.id===e.id))));S(t)}),[xe,fe,w]),ht=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};(0,n.useEffect)((()=>{if(E&&E.length>0){De(1);let e=[...E];if(Je&&(e=Je),Ve&&Ge){const t=new Date(Ve),a=new Date(Ge);e=e.filter((e=>{const r=new Date(e.DATE);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}ze&&("All"===ze||(e=e.filter((e=>e.LOCATION===ze)))),S(e)}}),[Ve,Ge,E,Je,ze]);const xt=(0,n.useCallback)((()=>{if(!w||!Array.isArray(w))return;const e=w.map((e=>(0,g.A)((0,g.A)({},e),{},{status:"Approved"})));ge(e);const t=w.reduce(((e,t)=>(e[t.id]=!0,e)),{});Ce((e=>(0,g.A)((0,g.A)({},e),t)))}),[w,ge,Ce]),gt=(0,n.useCallback)((()=>{if(!w||!Array.isArray(w))return;ge([]);const e=w.reduce(((e,t)=>(e[t.id]=!1,e)),{});Ce((t=>(0,g.A)((0,g.A)({},t),e)))}),[w,ge,Ce]);(0,n.useEffect)((()=>{try{if(!Array.isArray(tt)||!Array.isArray(w))return;const e=new Map;Array.isArray(tt)&&tt.forEach((t=>{const a=String(null===t||void 0===t?void 0:t.sapNo).toUpperCase();e.set(a,t)}));const t=Array.isArray(w)&&w.map((t=>{var a;const r=String(null===t||void 0===t?void 0:t.NO).toUpperCase(),n=e.get(r),s=null!==n&&void 0!==n&&n.workHrs&&Array.isArray(null===n||void 0===n?void 0:n.workHrs)?null===n||void 0===n?void 0:n.workHrs[(null===n||void 0===n||null===(a=n.workHrs)||void 0===a?void 0:a.length)-1]:"0";return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:s})}));Ae(t)}catch(e){console.log("ERROR : ",e);const t=Array.isArray(w)&&w.map((e=>(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:"0"})));Ae(t)}}),[tt,w]);const ft=je||[],vt=25*be,yt=vt-25,Nt=ft.slice(yt,vt),bt=Math.ceil(ft.length/25);return we=Nt,(0,i.jsxs)("div",{onClick:()=>qe(!1),children:[k?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full mr-7",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ws,{})}),(0,i.jsxs)("div",{className:"flex justify-between items-center gap-5 pt-5",children:[Array.isArray(f)&&f.length>0&&Array.isArray(we)&&we.length>0?(0,i.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,i.jsx)("p",{className:"text_size_5 text-dark_grey",children:"Approve All"}),(0,i.jsx)("input",{type:"checkbox",id:"exampleCheckbox",className:"h-4 w-4 cursor-pointer",checked:He,onChange:e=>{const t=e.target.checked;We(t),t?xt():gt()}})]}):"",Array.isArray(Le)&&(null===Le||void 0===Le?void 0:Le.length)>0&&Array.isArray(f)&&(null===f||void 0===f?void 0:f.length)>0?(0,i.jsx)(Hs,{handleSelectItem:e=>{Ye(e)},storeLocation:Le,setIsOpen:qe,isOpen:Be}):null,(0,i.jsx)(ls,{allEmpDetails:w,searchResult:async e=>{try{const t=await e;Ke(t)}catch(t){}},secondaryData:E,Position:d,placeholder:"Sap No / Name"})]})]}),(0,i.jsx)("div",{className:"table-container ",children:(0,i.jsxs)("table",{className:"styled-table w-[100%]",children:[(0,i.jsx)("thead",{className:"sticky-header border ",children:(0,i.jsxs)("tr",{className:"text_size_5 h-16",children:[(0,i.jsx)("td",{className:"px-5 flex-1 text_size_7",children:"S No."}),null!==(a=null===lt||void 0===lt?void 0:lt.tableHeader.map(((e,t)=>(0,i.jsx)("td",{className:"px-5 flex-1 text_size_7",children:e},t))))&&void 0!==a?a:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center",children:"No headers available"})}),!te&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"STATUS"}),(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"APPROVE"}),(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"REJECT"})]}),h&&h.length>0||ue&&ue?(0,i.jsx)("td",{children:"Edited"}):""]})}),(0,i.jsx)("tbody",{children:we&&we.length>0?we.map(((e,t)=>{const a=(e,a)=>{const r="Pending"===(null===e||void 0===e?void 0:e.status),s=25*(be-1)+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[50px] text-sm rounded-sm shadow-md border-b-2 border-[#CECECE] bg-white hover:bg-[#f1f5f9] ".concat(l&&l.length>0?"":"cursor-pointer"),onClick:()=>{l&&l.length>0||(rt(),(e=>{R(e)})(e),Me("Manager"===d?"View Form":"Edit Form"))},children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:s}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.NAME}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.TRADE}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.NO}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.LOCATION}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:ht(null===e||void 0===e?void 0:e.DATE)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS2)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS3)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.REMARKS}),r&&(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1 ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"text-[#0CB100]":"text_size_8"),children:null===e||void 0===e?void 0:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4 cursor-pointer",type:"checkbox",checked:Te[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Ce((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Pe((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Approved"),mt(e,"Rejected")):(Ce((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Approved"))}})}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4 cursor-pointer",type:"checkbox",checked:Re[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Pe((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Ce((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Rejected"),ct(),mt(e,"Approved")):(Pe((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Rejected"))}})})]}),h&&h.length>0||ue&&ue?(0,i.jsx)("td",{className:"cursor-pointer px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,i.jsx)("input",{type:"checkbox",disabled:!Qe.some((t=>t.id===e.id)),checked:Qe.some((t=>t.id===e.id)),onChange:()=>Ze(e)})}):""]},t+1)};return("Manager"===F||"Manager"!==F)&&a(e)})):null!==(s=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})}))&&void 0!==s?s:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center my-5 mt-10 ".concat(we&&we.length>0?"":"hidden"),children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center",children:(0,i.jsx)("button",{className:"rounded px-3 py-2.5 w-52 bg-[#FEF116] text_size_5 text-dark_grey ".concat(Qe&&Qe.length>0||xe&&xe.length>0||fe&&fe.length>0||l?"bg-[#FEF116]":"bg-[#eee542] cursor-not-allowed"),disabled:"Manager"!==F?!((null===Qe||void 0===Qe?void 0:Qe.length)>0||l):!((null===xe||void 0===xe?void 0:xe.length)>0||(null===fe||void 0===fe?void 0:fe.length)>0),onClick:()=>{if("Manager"!==F)if(Qe&&Qe.length>0){let e=null;if(Array.isArray(we)&&we.length>0&&we.forEach((t=>{parseFloat(null===t||void 0===t?void 0:t.WORKINGHOURS)>parseFloat(null===t||void 0===t?void 0:t.NORMALWORKINGHRSPERDAY)&&!e&&(e=!0)})),!0===e)return void alert("Working hours cannot be greater than 'Normal Working Hrs Per Day");st()}else l&&l&&dt();else"Manager"===F&&(ut(),ot())},children:"Manager"===F?"Finalize and Submit":h&&h.length>0||"Rejected"===u?"Assign Manager":"Submit"})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Ss,{totalPages:bt,currentPage:be,paginate:e=>De(e)})})]})]}):"",!1===k&&!0===D&&(0,i.jsx)(os,{setClosePopup:A}),!0===P&&(0,i.jsx)(hs,{toggleFunction:rt,editObject:C,fieldObj:(null===lt||void 0===lt?void 0:lt.fieldObj)||{},fields:(null===lt||void 0===lt?void 0:lt.fields)||[],tableHeader:(null===lt||void 0===lt?void 0:lt.tableHeader)||[],editFunction:e=>{try{var t;const a=Array.isArray(null===(t=w[0])||void 0===t?void 0:t.data)?((e,t)=>e.map((e=>({id:e.id,data:e.data.map((e=>e.NO===t.NO?t:e))}))))(w,e):((e,t)=>e.map((e=>e.NO===t.NO?t:e)))(w,e),r=null===a||void 0===a?void 0:a.map((e=>{var t,a;Array.isArray(null===e||void 0===e?void 0:e.jobLocaWhrs)&&(null===e||void 0===e||null===(t=e.jobLocaWhrs)||void 0===t?void 0:t.length)>0?e.LOCATIONATTOP=null===e||void 0===e||null===(a=e.jobLocaWhrs[0])||void 0===a?void 0:a.LOCATION:e.LOCATIONATTOP=null;return e}));S(r)}catch(a){}},titleName:c,Position:d,handleSubmit:Xe,editFormTitle:Oe,empAndWorkInfo:tt}),!0===Ee?(0,i.jsx)(xs,{toggleSFAMessage:nt,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Processing...",message:"Data is being saved, ",messageTwo:"This might take a few seconds..."}):!1===Ee?(0,i.jsx)(gs,{successMess:U,toggleSFAMessage:nt,setExcelData:p,userIdentification:F}):"",!0===W&&(0,i.jsx)(Ns,{toggleFunctionForAssiMana:st,renameKeysFunctionAndSubmit:ot,mergedData:Se}),!0===Y&&(0,i.jsx)(bs,{toggleForRemarkFunc:ct,addRemarks:e=>{const t=fe.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},e),{},{REMARKS:e.REMARKS}):t));ve(t)},passSelectedData:ye,addEditedRemarks:e=>{const t=w&&w.length>0&&w.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{REMARKS:e.REMARKS}):t));S(t)}}),re&&(0,i.jsx)(_s,{text:se}),q&&(0,i.jsx)(_s,{text:"Please wait a few seconds..."}),le&&K?(0,i.jsx)(Fs,{onClose:()=>{y.current=!1,oe(!1)},setCancelAction:e=>{v.current=e,ce(e),T(null)},fileNameForSuccessful:m,title:"Duplicate Detection",message:K.message,buttonName:K.buttonName,popupIdentification:"duplicateRecords",onClearData:()=>{T(null),S(null),p(null)}}):"",$&&(0,i.jsx)(qs,{handleDecision:e=>{Z(!1),dt(e)},alertMessage:X})]})},Vs=["sapNo"],Gs=(0,Ee.D)(),Js=e=>{var t,a,s;let{excelData:l,returnedTHeader:o,convertedStringToArrayObj:d,titleName:c,setExcelData:p,Position:m,fileName:u,showRejectedItemTable:h,submittedData:x,wholeData:f,ManagerData:v}=e;const y=(0,n.useRef)(!1),N=(0,n.useRef)(!1),b=(0,r.Zp)(),D=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toUpperCase(),[A,w]=(0,n.useState)(!1),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)(null),[T,C]=(0,n.useState)(null),[R,P]=(0,n.useState)(),[O,_]=(0,n.useState)(!1),[M,F]=(0,n.useState)(!1),[L,U]=(0,n.useState)(""),[B,q]=(0,n.useState)(null),[H,W]=(0,n.useState)(null),[z,Y]=(0,n.useState)(null),[V,G]=(0,n.useState)(null),[J,K]=(0,n.useState)(!1),[Q,$]=(0,n.useState)(""),[Z,X]=(0,n.useState)(!1),[ee,te]=(0,n.useState)(!1),[ae,re]=(0,n.useState)(null),[ne,se]=(0,n.useState)(!1),[ie,le]=(0,n.useState)(""),[oe,de]=(0,n.useState)(["All"]),[ce,pe]=(0,n.useState)(!1),[me,ue]=(0,n.useState)(!1),[he,xe]=(0,n.useState)(""),[ge,fe]=(0,n.useState)(null),[ve,ye]=(0,n.useState)({}),[Ne,be]=(0,n.useState)(!1),[De,je]=(0,n.useState)(""),[Ae,we]=(0,n.useState)(null),[Se,Ee]=(0,n.useState)([]),[ke,Te]=(0,n.useState)([]),[Ce,Re]=(0,n.useState)(null),[Pe,Oe]=(0,n.useState)(null),[Me,Le]=(0,n.useState)({}),[Ue,Be]=(0,n.useState)({}),[qe,He]=(0,n.useState)(1);let We;const[ze,Ye]=(0,n.useState)([]),Ve=Is(),[Ge,Je]=(0,n.useState)(null),{startDate:Ke,endDate:Qe,searchQuery:$e,setSearchQuery:Ze}=(0,Fe.b)(),{selectedRows:Xe,setSelectedRows:et,handleCheckboxChange:tt,handleSubmit:at}=Os(),{createNotification:rt}=_e(),{empAndWorkInfo:nt}=Bs();(0,n.useEffect)((()=>{try{if(l){const e=async()=>{try{const t=new Promise(((e,t)=>{l?e(l):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),a=await t;async function r(e){let t=[],a=null;do{const r=await Gs.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}const n=async()=>{try{const[e,t]=await Promise.all([r(Ie.it),r(Ie.bJ)]),n=e,s=t.map((e=>{let{sapNo:t}=e;return(0,is.A)(e,Vs)})),i=n.map((e=>{const t=s.find((t=>String(null===t||void 0===t?void 0:t.empID).toUpperCase()===String(null===e||void 0===e?void 0:e.empID).toUpperCase()));return t?(0,g.A)((0,g.A)({},e),t):null})).filter((e=>null!==e)),l=a.map((e=>{const t=i.find((t=>String(null===t||void 0===t?void 0:t.sapNo).toUpperCase()===String(null===e||void 0===e?void 0:e.FID).toUpperCase()));return(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:t?null===t||void 0===t?void 0:t.workHrs[t.workHrs.length-1]:null})}));E(l),k(l)}catch(e){}};n()}catch(e){}};e()}}catch(e){}}),[l]),(0,n.useEffect)((()=>{x&&x.length>0&&(G(!0),C(!0),E(x),k(x))}),[x]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");"Manager"===e?U("Manager"):"TimeKeeper"===e&&U("TimeKeeper")}),[d]);const st=e=>{if(e&&e.length>0){C(!0);const t=1e3;let a=0;const r=[],n=()=>{const s=e.slice(a,a+t).map((e=>{var t,a;let r=[];try{Array.isArray(e.empWorkInfo)&&(r=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(n){}return{id:e.id,fileName:e.fileName,FID:e.fidNo||0,NAMEFLAST:e.empName||"",ENTRANCEDATEUSED:e.date||"",ENTRANCEDATETIME:(null===(t=e.inTime)||void 0===t?void 0:t.replace(/[\[\]]/g,""))||"",EXITDATETIME:(null===(a=e.outTime)||void 0===a?void 0:a.replace(/[\[\]]/g,""))||"",AVGDAILYTOTALBYDAY:e.avgDailyTD||"",AHIGHLIGHTDAILYTOTALBYGROUP:e.totalHrs||"",ADININWORKSENGINEERINGSDNBHD:e.aweSDN||"",WORKINGHOURS:e.actualWorkHrs||0,OT:e.otTime||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:r.flat()||[],fileType:e.fileType,timeKeeper:e.assignBy,manager:e.assignTo,REMARKS:e.remarks||"",status:e.status||""}}));r.push(...s),a+=t,a<e.length?setTimeout(n,0):(E(r),k(r))};n()}};(0,n.useEffect)((()=>{if(o&&(null===o||void 0===o?void 0:o.length)>0)(async()=>{const e=o.map((e=>Object.keys(e).reduce(((t,a)=>(t[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()]=e[a],t)),{}))),t=["ADININWORKSENGINEERINGSDNBHD","FID","NameFLAST","EntranceDateUsed","EntranceDatetime","ExitDatetime","DayDifference","AvgDailyTotalByDay","AHighlightDailyTotalByGroup"],a=await new Promise((a=>{a(e.every((e=>t.every((t=>Object.keys(e).map((e=>e.toLowerCase())).includes(t.toLowerCase()))))))}));w(!0),G(a),C(a)})();else if(o||"Rejected"===h)if(o||"Rejected"!==h)C(!1);else{(async()=>{C(!0),se(!0);try{const e=new Promise(((e,t)=>{f&&f.length>0?e(f):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"!==L){await As(t);st(t)}}catch(e){}})()}else{(async()=>{C(!0);try{const e=new Promise(((e,t)=>{v&&v.length>0?e(v):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"===L){await ys(t);st(t);const e=Array.isArray(t)&&[...new Set(t.flatMap((e=>JSON.parse(e.empWorkInfo).map((e=>e.LOCATION)))))];de([...oe,...e])}}catch(e){}})()}}),[o,v,f,L,h]);const it=()=>{_(!O)},lt=(0,n.useCallback)((async(e,t)=>{q(e)}),[]),ot=()=>{F(!M)},dt=()=>{const e=null===S||void 0===S?void 0:S.filter((e=>!Xe.some((t=>t.id===e.id))));E(e),k(e),et([]),e&&0===e.length&&window.location.reload()},ct=ds(c),pt=async e=>{if("Manager"!==L&&"Rejected"!==h&&Xe&&Xe.length>0){const t=(Xe&&Xe.length>0&&Xe.map(((e,t)=>({id:e.id,fidNo:(null===e||void 0===e?void 0:e.FID)||0,empName:(null===e||void 0===e?void 0:e.NAMEFLAST)||"",date:(null===e||void 0===e?void 0:e.ENTRANCEDATEUSED)||"",inTime:(null===e||void 0===e?void 0:e.ENTRANCEDATETIME)||"",outTime:(null===e||void 0===e?void 0:e.EXITDATETIME)||"",avgDailyTD:(null===e||void 0===e?void 0:e.AVGDAILYTOTALBYDAY)||"",totalHrs:(null===e||void 0===e?void 0:e.AHIGHLIGHTDAILYTOTALBYGROUP)||"",aweSDN:(null===e||void 0===e?void 0:e.ADININWORKSENGINEERINGSDNBHD)||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"BLNG",status:"Pending",remarks:(null===e||void 0===e?void 0:e.REMARKS)||"",companyName:null===e||void 0===e?void 0:e.LOCATION})))).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:D,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="updateStoredData";const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:W,identifier:a});if(r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){W(!1);let e="updateStoredData",t=r;const a=await Ps({setNotification:K,setShowTitle:$,finalResult:t,toggleSFAMessage:lt,setStoringMess:Je,Position:m,action:e,handleAssignManager:dt,selectedRows:Xe});if(a){const{subject:e,message:t,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=a;await rt({empID:s,leaveType:"".concat(d," excel sheet submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper : \n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}}else if("Manager"===L){const e=[...Se,...ke],t=null===e||void 0===e?void 0:e.filter(((e,t,a)=>t===a.findIndex((t=>t.id===e.id))));let a=t&&t.length>0?t.map((e=>({id:e.id,fidNo:(null===e||void 0===e?void 0:e.FID)||0,empName:(null===e||void 0===e?void 0:e.NAMEFLAST)||"",date:(null===e||void 0===e?void 0:e.ENTRANCEDATEUSED)||"",inTime:(null===e||void 0===e?void 0:e.ENTRANCEDATETIME)||"",outTime:(null===e||void 0===e?void 0:e.EXITDATETIME)||"",avgDailyTD:(null===e||void 0===e?void 0:e.AVGDAILYTOTALBYDAY)||"",totalHrs:(null===e||void 0===e?void 0:e.AHIGHLIGHTDAILYTOTALBYGROUP)||"",aweSDN:(null===e||void 0===e?void 0:e.ADININWORKSENGINEERINGSDNBHD)||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"BLNG",status:e.status,remarks:(null===e||void 0===e?void 0:e.REMARKS)||""}))):[],r=[],n="update";const s=await Ps({finalResult:a,toggleSFAMessage:lt,setStoringMess:Je,setData:E,Position:m,action:n,setShowTitle:$,setNotification:K,setAllApprovedData:Ee,setAllRejectedData:Te,storeApproveRej:r});s&&s.length>0&&(s.forEach((async e=>{let{subject:t,message:a,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u,sheetStatus:h}=e;await rt({empID:s,leaveType:"".concat(d," Time Sheet ").concat(h),message:"The ".concat(d," timesheet for the period ").concat(p," to ").concat(m," has been ").concat(h," by Manager : ").concat(o,"."),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})})),r=[],ue(!1),Nt(),await(async()=>{let e=[...Se,...ke];const t=null===S||void 0===S?void 0:S.filter((t=>!e.some((e=>e.id===t.id))));E(t),k(t),t&&0===t.length&&(b("/timeSheet"),window.location.reload())})())}else if("Manager"!==L&&"Rejected"===h&&Xe&&Xe.length>0){const t=(Xe&&Xe.length>0?Xe.map((e=>({id:e.id,fidNo:(null===e||void 0===e?void 0:e.FID)||0,empName:(null===e||void 0===e?void 0:e.NAMEFLAST)||"",date:(null===e||void 0===e?void 0:e.ENTRANCEDATEUSED)||"",inTime:(null===e||void 0===e?void 0:e.ENTRANCEDATETIME)||"",outTime:(null===e||void 0===e?void 0:e.EXITDATETIME)||"",avgDailyTD:(null===e||void 0===e?void 0:e.AVGDAILYTOTALBYDAY)||"",totalHrs:(null===e||void 0===e?void 0:e.AHIGHLIGHTDAILYTOTALBYGROUP)||"",aweSDN:(null===e||void 0===e?void 0:e.ADININWORKSENGINEERINGSDNBHD)||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"BLNG",status:"Pending",companyName:null===e||void 0===e?void 0:e.LOCATION,remarks:(null===e||void 0===e?void 0:e.REMARKS)||""}))):[]).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:D,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="ResubmitRejectedItems";const r=await Ps({setNotification:K,setShowTitle:$,finalResult:t,toggleSFAMessage:lt,setStoringMess:Je,Position:m,action:a,handleAssignManager:dt,selectedRows:Xe});if(r){const{subject:e,message:t,fromAddress:a,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=r;await rt({empID:s,leaveType:"Corrected ".concat(d," Time Sheet Submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}};(0,n.useEffect)((()=>{ge&&ge.length>0?ye({message:"Some data in the uploaded Excel sheet has already been submitted by the Time Keeper. You may proceed to submit only the remaining unmatched data.",buttonName:"Save"}):ge&&0===ge.length&&ye({message:"All data in the uploaded Excel sheet has already been submitted by the Time Keeper.",buttonName:"OK"})}),[ge]);const mt=async e=>{if("Denied"===e)return;let t=S&&S.length>0&&S.map((e=>({fileName:u,fidNo:(null===e||void 0===e?void 0:e.FID)||"N/A",empName:(null===e||void 0===e?void 0:e.NAMEFLAST)||"",date:(null===e||void 0===e?void 0:e.ENTRANCEDATEUSED)||"",inTime:(null===e||void 0===e?void 0:e.ENTRANCEDATETIME)||"",outTime:(null===e||void 0===e?void 0:e.EXITDATETIME)||"",avgDailyTD:(null===e||void 0===e?void 0:e.AVGDAILYTOTALBYDAY)||"",totalHrs:(null===e||void 0===e?void 0:e.AHIGHLIGHTDAILYTOTALBYGROUP)||"",aweSDN:(null===e||void 0===e?void 0:e.ADININWORKSENGINEERINGSDNBHD)||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||"0",actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,assignBy:D,fileType:"BLNG",status:"Unsubmitted",remarks:(null===e||void 0===e?void 0:e.REMARKS)||"",companyName:null===e||void 0===e?void 0:e.LOCATION}))),a=await(async(e,t)=>{if("Allowed"===t)return!1;let a=!1,r="";for(let c of e){var n,s,i,l,o,d;const e=null===c||void 0===c||null===(n=c.fidNo)||void 0===n||null===(s=n.toString())||void 0===s?void 0:s.trim(),t=null===c||void 0===c||null===(i=c.normalWorkHrs)||void 0===i||null===(l=i.toString())||void 0===l?void 0:l.trim(),p=null===c||void 0===c||null===(o=c.date)||void 0===o||null===(d=o.toString())||void 0===d?void 0:d.trim();if(!e||"N/A"===e||"0"===e){a=!0,r="Some records are missing the FID or SAP NO. Please update the Excel sheet accordingly.";break}if(!p||"N/A"===p||"0"===p){a=!0,r="Some records are missing the 'DATE'. Please update the Excel sheet accordingly.";break}if(!t||"0"===t||"N/A"===t){a=!0,r="One or more records have missing 'Normal Working Hours Per Day'.";break}}return a?(je(r),be(!0),!0):(console.log("All required fields are filled. Proceeding..."),!1)})(t,e);if(a)return;const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:W,identifier:"create",setShowDuplicateAlert:e=>{N.current=e,X(e)},setCancelAction:e=>{y.current=e,te(e)}});if(fe(r),r.length===t.length&&te(!1),r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){re({finalResult:r,toggleSFAMessage:lt,setStoringMess:Je,setData:E,Position:m,action:"create"})}else W(!1)},ut=()=>{we(!Ae)};(0,n.useEffect)((()=>{Z||ee||Array.isArray(null===ae||void 0===ae?void 0:ae.finalResult)&&(null===ae||void 0===ae?void 0:ae.finalResult.length)>0&&(async e=>{let{storePreSubmitData:t}=e;const{finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}=t;Array.isArray(a)&&0===a.length||(await Ps({finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}),W(!1),re(null))})({storePreSubmitData:ae})}),[Z,ee,ae]);const ht=(e,t)=>{"Approved"===t?Ee((t=>[...t.filter((t=>t.id!==e.id)),(0,g.A)((0,g.A)({},e),{},{status:"Approved"})])):"Rejected"===t&&(Re(e),Te((t=>[...t.filter((t=>t.id!==e.id)),e])))},xt=(e,t)=>{if("Approved"===t){const t=Se.filter((t=>t.id!==e.id));Ee(t)}else if("Rejected"===t){const t=ke.filter((t=>t.id!==e.id));Te(t)}},gt=(0,n.useCallback)((()=>{const e=[...Se,...ke],t=null===S||void 0===S?void 0:S.filter((t=>!e.some((e=>t.id===e.id))));E(t)}),[Se,ke,S]),ft=e=>{try{const[t,a,r]=null===e||void 0===e?void 0:e.split("/"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(n,"/").concat(s,"/").concat(r)}catch(t){console.log("Error : ",t)}},vt=e=>{try{const t=String(e),a=new Date(t),r=a.getDate(),n=a.getMonth()+1,s=a.getFullYear(),i=(null===t||void 0===t?void 0:t.split(" ")[1])+" "+(null===t||void 0===t?void 0:t.split(" ")[2]);return"".concat(r,"/").concat(n,"/").concat(s," ").concat(i)}catch(t){console.log("Error : ",t)}};(0,n.useEffect)((()=>{if(I&&I.length>0){He(1);let e=[...I];if($e&&(e=$e),Ke&&Qe){const t=new Date(Ke),a=new Date(Qe);e=e.filter((e=>{const r=new Date(e.ENTRANCEDATEUSED);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}he&&("All"===he||(e=e.filter((e=>{const t=null===e||void 0===e?void 0:e.jobLocaWhrs;return Array.isArray(t)&&t.some((e=>(null===e||void 0===e?void 0:e.LOCATION)===he))})))),E(e)}}),[Ke,Qe,I,$e,he]);const yt=(0,n.useCallback)((()=>{if(!S||!Array.isArray(S))return;const e=S.map((e=>(0,g.A)((0,g.A)({},e),{},{status:"Approved"})));Ee(e);const t=S.reduce(((e,t)=>(e[t.id]=!0,e)),{});Le((e=>(0,g.A)((0,g.A)({},e),t)))}),[S,Ee,Le]),Nt=(0,n.useCallback)((()=>{if(!S||!Array.isArray(S))return;Ee([]);const e=S.reduce(((e,t)=>(e[t.id]=!1,e)),{});Le((t=>(0,g.A)((0,g.A)({},t),e)))}),[S,Ee,Le]);(0,n.useEffect)((()=>{try{if(!Array.isArray(nt)||!Array.isArray(S))return;const e=new Map;Array.isArray(nt)&&nt.forEach((t=>{const a=String(null===t||void 0===t?void 0:t.sapNo).toUpperCase();e.set(a,t)}));const t=Array.isArray(S)&&S.map((t=>{var a;const r=String(null===t||void 0===t?void 0:t.FID).toUpperCase(),n=e.get(r),s=null!==n&&void 0!==n&&n.workHrs&&Array.isArray(null===n||void 0===n?void 0:n.workHrs)?null===n||void 0===n?void 0:n.workHrs[(null===n||void 0===n||null===(a=n.workHrs)||void 0===a?void 0:a.length)-1]:"0";return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:s})}));Ye(t)}catch(e){console.log("ERROR : ",e);const t=Array.isArray(S)&&S.map((e=>(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:"0"})));Ye(t)}}),[nt,S]);const bt=ze||[],Dt=1e3,jt=qe*Dt,At=jt-Dt,wt=bt.slice(At,jt),St=Math.ceil(bt.length/Dt);return We=wt,(0,i.jsxs)("div",{onClick:()=>pe(!1),children:[(0,i.jsx)("div",{children:!0===T?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full mr-7",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ws,{})}),(0,i.jsxs)("div",{className:"flex justify-between items-center gap-5 pt-5",children:[Array.isArray(v)&&v.length>0&&Array.isArray(We)&&We.length>0?(0,i.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,i.jsx)("p",{className:"text_size_5 text-dark_grey",children:"Approve All"}),(0,i.jsx)("input",{type:"checkbox",id:"exampleCheckbox",className:"h-4 w-4 cursor-pointer",checked:me,onChange:e=>{const t=e.target.checked;ue(t),t?yt():Nt()}})]}):"",Array.isArray(oe)&&(null===oe||void 0===oe?void 0:oe.length)>0&&Array.isArray(v)&&(null===v||void 0===v?void 0:v.length)>0?(0,i.jsx)(Hs,{handleSelectItem:e=>{xe(e)},storeLocation:oe,setIsOpen:pe,isOpen:ce}):null,(0,i.jsx)(ls,{allEmpDetails:S,searchResult:async e=>{try{const t=await e;Ze(t)}catch(t){}},secondaryData:I,Position:m,placeholder:"FID / NAME"})]})]}),(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("table",{className:"styled-table ",children:[(0,i.jsx)("thead",{className:"sticky-header w-[100%]",children:(0,i.jsxs)("tr",{className:"text_size_5 h-16",children:[(0,i.jsx)("td",{className:"px-4 text-center text_size_7",children:"S No."}),null!==(a=null===ct||void 0===ct?void 0:ct.tableHeader.map(((e,t)=>(0,i.jsx)("td",{className:"px-4 flex-1 text_size_7",children:e},t))))&&void 0!==a?a:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center",children:"No headers available"})}),!V&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"".concat("Rejected"===h?"hidden":"px-5 flex-1 text_size_7"),children:"STATUS"}),(0,i.jsx)("td",{className:"".concat("Rejected"===h?"hidden":"px-5 flex-1 text_size_7"),children:"APPROVE"}),(0,i.jsx)("td",{className:"".concat("Rejected"===h?"hidden":"px-5 flex-1 text_size_7"),children:"REJECT"})]}),x&&x.length>0||ne&&ne?(0,i.jsx)("td",{children:"Edited"}):""]})}),(0,i.jsx)("tbody",{children:We&&(null===(s=We)||void 0===s?void 0:s.length)>0?We.map(((e,t)=>{const a=(e,a)=>{const r="Pending"===(null===e||void 0===e?void 0:e.status),s=(qe-1)*Dt+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[50px] text-sm rounded-sm shadow-md border-b-2 border-[#CECECE] bg-white hover:bg-[#f1f5f9] ".concat(l&&l.length>0?"":"cursor-pointer"),onClick:()=>{l&&l.length>0||(it(),(e=>{P(e)})(e),le("Manager"===m?"View Form":"Edit Form"))},children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:s}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.FID}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.NAMEFLAST}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:ft(null===e||void 0===e?void 0:e.ENTRANCEDATEUSED)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:vt(null===e||void 0===e?void 0:e.ENTRANCEDATETIME)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:vt(null===e||void 0===e?void 0:e.EXITDATETIME)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.AVGDAILYTOTALBYDAY}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.AHIGHLIGHTDAILYTOTALBYGROUP)||""}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.ADININWORKSENGINEERINGSDNBHD)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.REMARKS}),r&&(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1 ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"text-[#0CB100]":"text_size_8"),children:null===e||void 0===e?void 0:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:Me[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Le((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Be((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),ht(e,"Approved"),xt(e,"Rejected")):(Le((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),xt(e,"Approved"))}})}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:Ue[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Be((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Le((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),ht(e,"Rejected"),ut(),xt(e,"Approved")):(Be((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),xt(e,"Rejected"))}})})]}),x&&x.length>0||ne&&ne?(0,i.jsx)("td",{className:"cursor-pointer px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,i.jsx)("input",{type:"checkbox",disabled:!Xe.some((t=>t.id===e.id)),checked:Xe.some((t=>t.id===e.id)),onChange:()=>tt(e)})}):""]},t+1)};return("Manager"===L||"Manager"!==L)&&a(e)})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center my-5 mt-10 ".concat(We&&We.length>0?"":"hidden"),children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center ",children:(0,i.jsx)("button",{className:"rounded px-3 py-2.5 w-52 bg-[#FEF116] text_size_5 text-dark_grey ".concat(Xe&&Xe.length>0||Se&&Se.length>0||ke&&ke.length>0||l?"bg-[#FEF116]":"bg-[#eee542] cursor-not-allowed"),disabled:"Manager"!==L?!((null===Xe||void 0===Xe?void 0:Xe.length)>0||l):!((null===Se||void 0===Se?void 0:Se.length)>0||(null===ke||void 0===ke?void 0:ke.length)>0),onClick:()=>{"Manager"!==L?Xe&&Xe.length>0?ot():l&&l&&mt():"Manager"===L&&(pt(),gt())},children:"Manager"===L?"Finalize and Submit":x&&x.length>0||"Rejected"===h?"Assign Manager":"Submit"})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Ss,{totalPages:St,currentPage:qe,paginate:e=>He(e)})})]})]}):!1===T&&!0===A?(0,i.jsx)(os,{setClosePopup:w}):""}),!0===O&&(0,i.jsx)(hs,{toggleFunction:it,editObject:R,fieldObj:(null===ct||void 0===ct?void 0:ct.fieldObj)||{},fields:(null===ct||void 0===ct?void 0:ct.fields)||[],tableHeader:(null===ct||void 0===ct?void 0:ct.tableHeader)||[],editFunction:e=>{try{var t;const a=Array.isArray(null===(t=S[0])||void 0===t?void 0:t.data)?((e,t)=>e.map((e=>({id:e.id,data:e.data.map((e=>e.FID===t.FID&&e.ENTRANCEDATEUSED===t.ENTRANCEDATEUSED?t:e))}))))(S,e):((e,t)=>e.map((e=>e.FID===t.FID&&e.ENTRANCEDATEUSED===t.ENTRANCEDATEUSED?t:e)))(S,e),r=null===a||void 0===a?void 0:a.map((e=>{var t,a;Array.isArray(null===e||void 0===e?void 0:e.jobLocaWhrs)&&(null===e||void 0===e||null===(t=e.jobLocaWhrs)||void 0===t?void 0:t.length)>0?e.LOCATION=null===e||void 0===e||null===(a=e.jobLocaWhrs[0])||void 0===a?void 0:a.LOCATION:e.LOCATION=null;return e}));E(r)}catch(a){}},titleName:c,Position:m,handleSubmit:at,editFormTitle:ie,empAndWorkInfo:nt}),!0===Ge?(0,i.jsx)(xs,{toggleSFAMessage:lt,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Processing...",message:"Data is being saved, ",messageTwo:"This might take a few seconds..."}):!1===Ge?(0,i.jsx)(gs,{successMess:B,toggleSFAMessage:lt,setExcelData:p,userIdentification:L}):"",!0===M&&(0,i.jsx)(Ns,{toggleFunctionForAssiMana:ot,renameKeysFunctionAndSubmit:pt,mergedData:Ve}),!0===Ae&&(0,i.jsx)(bs,{toggleForRemarkFunc:ut,addRemarks:e=>{const t=ke.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},e),{},{REMARKS:e.REMARKS}):t));Te(t)},passSelectedData:Ce,addEditedRemarks:e=>{const t=S&&S.length>0&&S.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{REMARKS:e.REMARKS}):t));E(t)}}),J&&(0,i.jsx)(_s,{text:Q}),H&&(0,i.jsx)(_s,{text:"Please wait a few seconds..."}),Z&&ve?(0,i.jsx)(Fs,{onClose:()=>{N.current=!1,X(!1)},setCancelAction:e=>{y.current=e,te(e),C(null)},fileNameForSuccessful:u,title:"Duplicate Detection",message:ve.message,buttonName:ve.buttonName,popupIdentification:"duplicateRecords",onClearData:()=>{C(null),E(null),p(null)}}):"",Ne&&(0,i.jsx)(qs,{handleDecision:e=>{be(!1),mt(e)},alertMessage:De})]})},Ks=(0,Ee.D)(),Qs=e=>{const t=localStorage.getItem("userType"),[a,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{if("Manager"!==t){async function a(e){let t=[],a=null;do{const r=await Ks.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}async function n(){try{const[t,n]=await Promise.all([a(Ie.it),a(Ie.bJ)]),s=n,i=t.map((e=>{const t=s.find((t=>String(t.empID).toUpperCase()===String(e.empID).toUpperCase()));return t?(0,g.A)((0,g.A)({},e),t):null})).filter((e=>null!==e)),l=new Promise(((t,a)=>{e?t(e):setTimeout((()=>{a("No data found after waiting.")}),5e3)})),o=await l;(async()=>{const e=null===o||void 0===o?void 0:o.map((e=>{const t=null===i||void 0===i?void 0:i.find((t=>String(t.empBadgeNo).toUpperCase()===String(e.BADGE).toUpperCase()));return(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:t?t.workHrs[t.workHrs.length-1]:null})}));r(e)})()}catch(t){}}n()}}),[e]),{data:a}},$s=e=>{var t,a,s,l;let{excelData:o,returnedTHeader:d,titleName:c,setExcelData:p,Position:m,fileName:u,showRejectedItemTable:h,submittedData:x,wholeData:f,ManagerData:v}=e;const y=(0,n.useRef)(!1),N=(0,n.useRef)(!1),b=(0,r.Zp)(),D=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toUpperCase(),[A,w]=(0,n.useState)(!1),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)(null),[T,C]=(0,n.useState)(null),[R,P]=(0,n.useState)(),[O,_]=(0,n.useState)(!1),[M,F]=(0,n.useState)(!1),[L,U]=(0,n.useState)({}),[B,q]=(0,n.useState)({}),[H,W]=(0,n.useState)(""),[z,Y]=(0,n.useState)(["All"]),[V,G]=(0,n.useState)(!1),[J,K]=(0,n.useState)(!1),[Q,$]=(0,n.useState)(""),[Z,X]=(0,n.useState)(!0),[ee,te]=(0,n.useState)(""),[ae,re]=(0,n.useState)(null),[ne,se]=(0,n.useState)(null),[ie,le]=(0,n.useState)(null),[oe,de]=(0,n.useState)(!1),[ce,pe]=(0,n.useState)(""),[me,ue]=(0,n.useState)(!1),[he,xe]=(0,n.useState)(!1),[ge,fe]=(0,n.useState)(null),[ve,ye]=(0,n.useState)(!1),[Ne,be]=(0,n.useState)(null),[De,je]=(0,n.useState)([]),[Ae,we]=(0,n.useState)([]),[Se,Ie]=(0,n.useState)(null),[ke,Te]=(0,n.useState)(null),[Ce,Re]=(0,n.useState)(null),[Pe,Oe]=(0,n.useState)({}),[Me,Le]=(0,n.useState)(!1),[Ue,Be]=(0,n.useState)(""),[qe,He]=(0,n.useState)(1);(0,Ee.D)();let We;const[ze,Ye]=(0,n.useState)([]),{startDate:Ve,endDate:Ge,searchQuery:Je,setSearchQuery:Ke,setGetNotifyCenterData:Qe,getNotifyCenterData:$e}=(0,Fe.b)(),{selectedRows:Ze,setSelectedRows:Xe,handleCheckboxChange:et,handleSubmit:tt}=Os(),{createNotification:at}=_e(),{data:rt}=Qs(o),{empAndWorkInfo:nt}=Bs(),st=Is();(0,n.useEffect)((()=>{rt&&rt.length>0&&(E(rt),k(rt))}),[rt]);(0,n.useEffect)((()=>{x&&x.length>0&&(re(!0),C(!0),E(x),k(x))}),[x]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");"Manager"===e?te("Manager"):"Manager"!==e&&te("TimeKeeper")}),[f]);const it=e=>{if(e&&e.length>0){C(!0);const t=e&&(null===e||void 0===e?void 0:e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||0,DEPTDIV:e.empDept||"",BADGE:e.empBadgeNo||"",DATE:e.date||"",IN:e.inTime||"",OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINHRS:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}})));E(t),k(t)}};(0,n.useEffect)((()=>{if(d&&d.length>0)(async()=>{const e=d.map((e=>Object.keys(e).reduce(((t,a)=>(t[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()]=e[a],t)),{}))),t=["deptdiv","name","badge"],a=await new Promise((a=>{a(e.every((e=>t.every((t=>Object.keys(e).map((e=>e.toLowerCase())).includes(t.toLowerCase()))))))}));w(!0),C(a),re(a)})();else if(d||"Rejected"===h)if(d||"Rejected"!==h)C(!1),X(!1);else{(async()=>{C(!0),ye(!0);try{const e=new Promise(((e,t)=>{f&&f.length>0?e(f):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"!==ee){await As(t);it(t)}}catch(e){}})()}else{(async()=>{C(!0);try{const e=new Promise(((e,t)=>{v&&v.length>0?e(v):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"===ee){await ys(t);it(t);const e=Array.isArray(t)&&[...new Set(t.flatMap((e=>JSON.parse(e.empWorkInfo).map((e=>e.LOCATION)))))];Y([...z,...e])}}catch(e){}})()}}),[d,v,f,ee,h]);const lt=()=>{F(!M)},ot=(0,n.useCallback)((async(e,t)=>{se(e)}),[]),dt=()=>{_(!O)},ct=()=>{const e=null===S||void 0===S?void 0:S.filter((e=>!Ze.some((t=>t.id===e.id))));E(e),k(e),Xe([]),e&&0===e.length&&window.location.reload()},pt=ds(c),mt=async e=>{if("Manager"!==ee&&"Rejected"!==h&&Ze&&Ze.length>0){const t=(await Promise.all(Ze.map((async e=>({id:e.id,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",companyName:null===e||void 0===e?void 0:e.LOCATION,remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"SBW",status:"Pending"}))))).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:D,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="updateStoredData";const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:le,identifier:a});if(r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){le(!1);let e="updateStoredData",t=r;const a=await Ps({setNotification:de,setShowTitle:pe,finalResult:t,toggleSFAMessage:ot,setStoringMess:Te,Position:m,action:e,handleAssignManager:ct,selectedRows:Ze});if(a){const{subject:e,message:t,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=a;await at({empID:s,leaveType:"".concat(d," excel sheet submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper :\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}}else if("Manager"===ee){const e=[...De,...Ae],t=null===e||void 0===e?void 0:e.filter(((e,t,a)=>t===a.findIndex((t=>t.id===e.id))));let a=t&&t.length>0?t.map((e=>({id:e.id,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"SBW",status:e.status}))):[],r=[],n="update";const s=await Ps({finalResult:a,toggleSFAMessage:ot,setStoringMess:Te,setData:E,Position:m,action:n,setShowTitle:pe,setNotification:de,setAllApprovedData:je,setAllRejectedData:we,storeApproveRej:r});s&&s.length>0&&(s.forEach((async e=>{let{subject:t,message:a,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u,sheetStatus:h}=e;await at({empID:s,leaveType:"".concat(d," Time Sheet ").concat(h),message:"The ".concat(d," timesheet for the period ").concat(p," to ").concat(m," has been ").concat(h," by Manager : ").concat(o,"."),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})})),r=[],K(!1),Nt(),await(async()=>{let e=[...De,...Ae];const t=null===S||void 0===S?void 0:S.filter((t=>!e.some((e=>e.id===t.id))));E(t),k(t),t&&0===t.length&&(b("/timeSheet"),window.location.reload())})())}else if("Manager"!==ee&&"Rejected"===h&&Ze&&Ze.length>0){const t=(Ze&&Ze.length>0?Ze.map((e=>({id:e.id,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"SBW",status:"Pending",companyName:null===e||void 0===e?void 0:e.LOCATION}))):[]).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:D,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="ResubmitRejectedItems";const r=await Ps({setNotification:de,setShowTitle:pe,finalResult:t,toggleSFAMessage:ot,setStoringMess:Te,Position:m,action:a,handleAssignManager:ct,selectedRows:Ze});if(r){const{subject:e,message:t,fromAddress:a,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=r;await at({empID:s,leaveType:"Corrected ".concat(d," Time Sheet Submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}};(0,n.useEffect)((()=>{Ce&&Ce.length>0?Oe({message:"Some data in the uploaded Excel sheet has already been submitted by the Time Keeper. You may proceed to submit only the remaining unmatched data.",buttonName:"Save"}):Ce&&0===Ce.length&&Oe({message:"All data in the uploaded Excel sheet has already been submitted by the Time Keeper.",buttonName:"OK"})}),[Ce]);const ut=async e=>{if("Denied"===e)return;let t=S&&S.length>0&&S.map((e=>({fileName:u,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"N/A",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||"0",actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",companyName:null===e||void 0===e?void 0:e.LOCATION,remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,assignBy:D,fileType:"SBW",status:"Unsubmitted"}))),a=await(async(e,t)=>{if("Allowed"===t)return!1;let a=!1,r="";for(let c of e){var n,s,i,l,o,d;const e=null===(n=c.empBadgeNo)||void 0===n||null===(s=n.toString())||void 0===s?void 0:s.trim(),t=null===(i=c.normalWorkHrs)||void 0===i||null===(l=i.toString())||void 0===l?void 0:l.trim(),p=null===(o=c.date)||void 0===o||null===(d=o.toString())||void 0===d?void 0:d.trim();if(!e||"N/A"===e||"0"===e){a=!0,r="Some records are missing the Badge Number. Please update the Excel sheet accordingly.";break}if(!p||"N/A"===p||"0"===p){a=!0,r="Some records are missing the 'DATE'. Please update the Excel sheet accordingly.";break}if(!t||"0"===t||"N/A"===t){a=!0,r="One or more records have missing 'Normal Working Hours Per Day'.";break}}return a?(Be(r),Le(!0),!0):(console.log("All required fields are filled. Proceeding..."),!1)})(t,e);if(a)return;const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:le,identifier:"create",setShowDuplicateAlert:e=>{N.current=e,ue(e)},setCancelAction:e=>{y.current=e,xe(e)}});if(Re(r),r.length===t.length&&xe(!1),r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){fe({finalResult:r,toggleSFAMessage:ot,setStoringMess:Te,setData:E,Position:m,action:"create"})}else le(!1)},ht=()=>{be(!Ne)};(0,n.useEffect)((()=>{me||he||Array.isArray(null===ge||void 0===ge?void 0:ge.finalResult)&&(null===ge||void 0===ge?void 0:ge.finalResult.length)>0&&(async e=>{let{storePreSubmitData:t}=e;const{finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}=t;Array.isArray(a)&&0===a.length||(await Ps({finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}),le(!1),fe(null))})({storePreSubmitData:ge})}),[me,he,ge]);const xt=(e,t)=>{"Approved"===t?je((t=>[...t.filter((t=>t.id!==e.id)),(0,g.A)((0,g.A)({},e),{},{status:"Approved"})])):"Rejected"===t&&(Ie(e),we((t=>[...t.filter((t=>t.id!==e.id)),e])))},gt=(e,t)=>{if("Approved"===t){const t=De.filter((t=>t.id!==e.id));je(t)}else if("Rejected"===t){const t=Ae.filter((t=>t.id!==e.id));we(t)}},ft=(0,n.useCallback)((()=>{const e=[...De,...Ae],t=null===S||void 0===S?void 0:S.filter((t=>!e.some((e=>t.id===e.id))));E(t)}),[De,Ae,S]),vt=e=>{try{const[t,a,r]=null===e||void 0===e?void 0:e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};(0,n.useEffect)((()=>{if(I&&I.length>0){He(1);let e=[...I];if(Je&&(e=Je),Ve&&Ge){const t=new Date(Ve),a=new Date(Ge);e=e.filter((e=>{const r=new Date(e.DATE);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}Q&&("All"===Q||(e=e.filter((e=>{const t=null===e||void 0===e?void 0:e.jobLocaWhrs;return Array.isArray(t)&&t.some((e=>(null===e||void 0===e?void 0:e.LOCATION)===Q))})))),E(e)}}),[Ve,Ge,I,Je,Q]);const yt=(0,n.useCallback)((()=>{if(!S||!Array.isArray(S))return;const e=S.map((e=>(0,g.A)((0,g.A)({},e),{},{status:"Approved"})));je(e);const t=S.reduce(((e,t)=>(e[t.id]=!0,e)),{});U((e=>(0,g.A)((0,g.A)({},e),t)))}),[S,je,U]),Nt=(0,n.useCallback)((()=>{if(!S||!Array.isArray(S))return;je([]);const e=S.reduce(((e,t)=>(e[t.id]=!1,e)),{});U((t=>(0,g.A)((0,g.A)({},t),e)))}),[S,je,U]);(0,n.useEffect)((()=>{try{if(!Array.isArray(nt)||!Array.isArray(S))return;const e=new Map;Array.isArray(nt)&&nt.forEach((t=>{e.set(String(t.empBadgeNo).toUpperCase(),t)}));const t=Array.isArray(S)&&S.map((t=>{var a;const r=String(t.BADGE).toUpperCase(),n=e.get(r),s=null!==n&&void 0!==n&&n.workHrs&&Array.isArray(null===n||void 0===n?void 0:n.workHrs)?null===n||void 0===n?void 0:n.workHrs[(null===n||void 0===n||null===(a=n.workHrs)||void 0===a?void 0:a.length)-1]:"0";return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:s})}));Ye(t)}catch(e){console.log("ERROR : ",e);const t=Array.isArray(S)&&S.map((e=>(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:"0"})));Ye(t)}}),[nt,S]);const bt=ze||[],Dt=25*qe,jt=Dt-25,At=null===bt||void 0===bt?void 0:bt.slice(jt,Dt),wt=Math.ceil(bt.length/25);return We=At,(0,i.jsxs)("div",{onClick:()=>G(!1),children:[(0,i.jsx)("div",{children:!0===T?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full mr-7",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ws,{})}),(0,i.jsxs)("div",{className:"flex justify-between items-center gap-5 pt-5",children:[Array.isArray(v)&&v.length>0&&Array.isArray(We)&&We.length>0?(0,i.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,i.jsx)("p",{className:"text_size_5 text-dark_grey",children:"Approve All"}),(0,i.jsx)("input",{type:"checkbox",id:"exampleCheckbox",className:"h-4 w-4 cursor-pointer",checked:J,onChange:e=>{const t=e.target.checked;K(t),t?yt():Nt()}})]}):"",Array.isArray(z)&&(null===z||void 0===z?void 0:z.length)>0&&Array.isArray(v)&&(null===v||void 0===v?void 0:v.length)>0?(0,i.jsx)(Hs,{handleSelectItem:e=>{$(e)},storeLocation:z,setIsOpen:G,isOpen:V}):null,(0,i.jsx)(ls,{allEmpDetails:S,searchResult:async e=>{try{const t=await e;Ke(t)}catch(t){}},secondaryData:I,Position:m,placeholder:"Badge No / Name"})]})]}),(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("table",{className:"styled-table w-[100%]",children:[(0,i.jsx)("thead",{className:"sticky-header",children:(0,i.jsxs)("tr",{className:"text_size_5 h-16",children:[(0,i.jsx)("td",{className:"px-4 text-center text_size_7",children:"S No."}),null!==(a=null===pt||void 0===pt?void 0:pt.tableHeader.map(((e,t)=>(0,i.jsx)("td",{className:"px-4 flex-1 text_size_7",children:e},t))))&&void 0!==a?a:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text_size_7",children:"No headers available"})}),!ae&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"".concat("Rejected"===h?"hidden":"px-5 flex-1 text_size_7"),children:"STATUS"}),(0,i.jsx)("td",{className:"".concat("Rejected"===h?"hidden":"px-5 flex-1 text_size_7"),children:"APPROVE"}),(0,i.jsx)("td",{className:"".concat("Rejected"===h?"hidden":"px-5 flex-1 text_size_7"),children:"REJECT"})]}),x&&x.length>0||ve&&ve?(0,i.jsx)("td",{children:"Edited"}):""]})}),(0,i.jsx)("tbody",{children:We&&(null===(s=We)||void 0===s?void 0:s.length)>0?We.map(((e,t)=>{const a=(e,a)=>{const r="Pending"===(null===e||void 0===e?void 0:e.status),s=25*(qe-1)+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[50px] text-sm rounded-sm shadow-md border-b-2 border-[#CECECE] bg-white hover:bg-[#f1f5f9] ".concat(o&&o.length>0?"":"cursor-pointer"),onClick:()=>{o&&o.length>0||(lt(),(e=>{P(e)})(e),W("Manager"===m?"View Form":"Edit Form"))},children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:s}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.NAME}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.DEPTDIV}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.BADGE}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:vt(null===e||void 0===e?void 0:e.DATE)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.IN)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OUT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALINOUT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.ALLDAYMINHRS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NETMINUTES)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.REMARKS}),r&&(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1 ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"text-[#0CB100]":"text_size_8"),children:null===e||void 0===e?void 0:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:L[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(U((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),q((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),xt(e,"Approved"),gt(e,"Rejected")):(U((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),gt(e,"Approved"))}})}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:B[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(q((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),U((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),xt(e,"Rejected"),ht(),gt(e,"Approved")):(q((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),gt(e,"Rejected"))}})})]}),x&&x.length>0||ve&&ve?(0,i.jsx)("td",{className:"cursor-pointer px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,i.jsx)("input",{type:"checkbox",disabled:!Ze.some((t=>t.id===e.id)),checked:Ze.some((t=>t.id===e.id)),onChange:()=>et(e)})}):""]},t+1)};return("Manager"===ee||"Manager"!==ee)&&a(e)})):null!==(l=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})}))&&void 0!==l?l:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center my-5 mt-10 ".concat(We&&We.length>0?"":"hidden"),children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center",children:(0,i.jsx)("button",{className:"rounded px-3 py-2.5 w-52 bg-[#FEF116] text_size_5 text-dark_grey ".concat(Ze&&Ze.length>0||De&&De.length>0||Ae&&Ae.length>0||o?"bg-[#FEF116]":"bg-[#eee542] cursor-not-allowed"),disabled:"Manager"!==ee?!((null===Ze||void 0===Ze?void 0:Ze.length)>0||o):!((null===De||void 0===De?void 0:De.length)>0||(null===Ae||void 0===Ae?void 0:Ae.length)>0),onClick:()=>{"Manager"!==ee?Ze&&Ze.length>0?dt():o&&o&&ut():"Manager"===ee&&(ft(),mt())},children:"Manager"===ee?"Finalize and Submit":x&&x.length>0||"Rejected"===h?"Assign Manager":"Submit"})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Ss,{totalPages:wt,currentPage:qe,paginate:e=>He(e)})})]})]}):!1===T&&!0===A?(0,i.jsx)(os,{setClosePopup:w}):""}),!0===M&&(0,i.jsx)(hs,{toggleFunction:lt,editObject:R,fieldObj:(null===pt||void 0===pt?void 0:pt.fieldObj)||{},fields:(null===pt||void 0===pt?void 0:pt.fields)||[],tableHeader:(null===pt||void 0===pt?void 0:pt.tableHeader)||[],editFunction:e=>{try{var t;const a=Array.isArray(null===(t=S[0])||void 0===t?void 0:t.data)?((e,t)=>e.map((e=>({id:e.id,data:e.data.map((e=>e.BADGE===t.BADGE&&e.DATE===t.DATE?t:e))}))))(S,e):((e,t)=>e.map((e=>e.BADGE===t.BADGE&&e.DATE===t.DATE?t:e)))(S,e),r=null===a||void 0===a?void 0:a.map((e=>{var t,a;Array.isArray(null===e||void 0===e?void 0:e.jobLocaWhrs)&&(null===e||void 0===e||null===(t=e.jobLocaWhrs)||void 0===t?void 0:t.length)>0?e.LOCATION=null===e||void 0===e||null===(a=e.jobLocaWhrs[0])||void 0===a?void 0:a.LOCATION:e.LOCATION=null;return e}));E(r)}catch(a){}},titleName:c,Position:m,handleSubmit:tt,editFormTitle:H,empAndWorkInfo:nt}),!0===ke?(0,i.jsx)(xs,{toggleSFAMessage:ot,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Processing...",message:"Data is being saved, ",messageTwo:"This might take a few seconds..."}):!1===ke?(0,i.jsx)(gs,{successMess:ne,toggleSFAMessage:ot,setExcelData:p,userIdentification:ee}):"",!0===O&&(0,i.jsx)(Ns,{toggleFunctionForAssiMana:dt,renameKeysFunctionAndSubmit:mt,mergedData:st}),!0===Ne&&(0,i.jsx)(bs,{toggleForRemarkFunc:ht,addRemarks:e=>{const t=Ae.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},e),{},{REMARKS:e.REMARKS}):t));we(t)},passSelectedData:Se,addEditedRemarks:e=>{const t=S&&S.length>0&&S.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{REMARKS:e.REMARKS}):t));E(t)}}),oe&&(0,i.jsx)(_s,{text:ce}),ie&&(0,i.jsx)(_s,{text:"Please wait a few seconds..."}),me&&Pe?(0,i.jsx)(Fs,{onClose:()=>{N.current=!1,ue(!1)},setCancelAction:e=>{y.current=e,xe(e),C(null)},fileNameForSuccessful:u,title:"Duplicate Detection",message:Pe.message,buttonName:Pe.buttonName,popupIdentification:"duplicateRecords",onClearData:()=>{C(null),E(null),p(null)}}):"",Me&&(0,i.jsx)(qs,{handleDecision:e=>{Le(!1),ut(e)},alertMessage:Ue})]})},Zs=((0,Ee.D)(),e=>{var t,a,s;let{excelData:l,returnedTHeader:o,titleName:d,setExcelData:c,Position:p,fileName:m,showRejectedItemTable:u,submittedData:h,wholeData:x,ManagerData:f}=e;const v=(0,n.useRef)(!1),y=(0,n.useRef)(!1),N=(0,r.Zp)(),b=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toUpperCase(),[D,A]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),[E,I]=(0,n.useState)(null),[k,T]=(0,n.useState)(null),[C,R]=(0,n.useState)({}),[P,O]=(0,n.useState)({}),[_,M]=(0,n.useState)(""),[F,L]=(0,n.useState)(["All"]),[U,B]=(0,n.useState)(!1),[q,H]=(0,n.useState)(!1),[W,z]=(0,n.useState)(""),[Y,V]=(0,n.useState)(!1),[G,J]=(0,n.useState)(""),[K,Q]=(0,n.useState)(!1),[$,Z]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(null),[te,ae]=(0,n.useState)(!1),[re,ne]=(0,n.useState)(),[se,ie]=(0,n.useState)(!1),[le,oe]=(0,n.useState)(!1),[de,ce]=(0,n.useState)(!0),[pe,me]=(0,n.useState)(""),[ue,he]=(0,n.useState)(null),[xe,ge]=(0,n.useState)(null),[fe,ve]=(0,n.useState)(null),[ye,Ne]=(0,n.useState)(null),[be,De]=(0,n.useState)({}),[je,Ae]=(0,n.useState)(!1),[we,Se]=(0,n.useState)(""),[Ee,Ie]=(0,n.useState)(null),[ke,Te]=(0,n.useState)([]),[Ce,Re]=(0,n.useState)([]),[Pe,Oe]=(0,n.useState)(null),[Me,Le]=(0,n.useState)(1);let Ue;const[Be,qe]=(0,n.useState)([]),[He,We]=(0,n.useState)(null),{data:ze}=Qs(l),{empAndWorkInfo:Ye}=Bs(),Ve=Is(),{startDate:Ge,endDate:Je,searchQuery:Ke,setSearchQuery:Qe}=(0,Fe.b)(),{selectedRows:$e,setSelectedRows:Ze,handleCheckboxChange:Xe,handleSubmit:et}=Os(),{createNotification:tt}=_e();(0,n.useEffect)((()=>{try{ze&&ze.length>0&&(S(ze),I(ze))}catch(e){}}),[ze]);(0,n.useEffect)((()=>{h&&h.length>0&&(he(!0),T(!0),S(h),I(h))}),[h]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");"Manager"===e?me("Manager"):"Manager"!==e&&me("TimeKeeper")}),[x]);const at=e=>{if(e&&e.length>0){T(!0);const t=e&&(null===e||void 0===e?void 0:e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||0,DEPTDIV:e.empDept||"",BADGE:e.empBadgeNo||"",DATE:e.date||"",IN:e.inTime||"",OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINHRS:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}})));S(t),I(t)}};(0,n.useEffect)((()=>{try{const e=async()=>{const e=o.map((e=>Object.keys(e).reduce(((t,a)=>(t[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()]=e[a],t)),{}))),t=["name"],a=await new Promise((a=>{a(e.every((e=>t.every((t=>Object.keys(e).map((e=>e.toLowerCase())).includes(t.toLowerCase()))))))}));A(!0),T(a),he(a)};if(o&&o.length>0)e();else if(o||"Rejected"===u)if(o||"Rejected"!==u)T(!1),ce(!1);else{(async()=>{T(!0),ae(!0);try{const e=new Promise(((e,t)=>{x&&x.length>0?e(x):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"!==pe){await As(t);at(t)}}catch(e){}})()}else{(async()=>{T(!0);try{const e=new Promise(((e,t)=>{f&&f.length>0?e(f):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"===p){await ys(t);at(t);const e=Array.isArray(t)&&[...new Set(t.flatMap((e=>JSON.parse(e.empWorkInfo).map((e=>e.LOCATION)))))];L([...F,...e])}}catch(e){}})()}}catch(e){}}),[o,f,x,pe,u]);const rt=()=>{ie(!se)},nt=(0,n.useCallback)((async(e,t)=>{ge(e)}),[]),st=()=>{oe(!le)},it=()=>{const e=null===w||void 0===w?void 0:w.filter((e=>!$e.some((t=>t.id===e.id))));S(e),I(e),Ze([]),e&&0===e.length&&window.location.reload()},lt=ds(d),ot=async e=>{if("Manager"!==pe&&"Rejected"!==u&&$e&&$e.length>0){const t=($e&&$e.length>0&&$e.map((e=>({id:e.id,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"ORMC",status:"Pending",companyName:null===e||void 0===e?void 0:e.LOCATION})))).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:b,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="updateStoredData";const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:ve,identifier:a});if(r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){ve(!1);let e="updateStoredData",t=r;const a=await Ps({setNotification:V,setShowTitle:J,finalResult:t,toggleSFAMessage:nt,setStoringMess:We,Position:p,action:e,handleAssignManager:it,selectedRows:$e});if(a){const{subject:e,message:t,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=a;await tt({empID:s,leaveType:"".concat(d," excel sheet submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper : \n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}}else if("Manager"===pe){V(!1);const e=[...ke,...Ce],t=null===e||void 0===e?void 0:e.filter(((e,t,a)=>t===a.findIndex((t=>t.id===e.id))));let a=t&&t.length>0?t.map((e=>({id:e.id,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"ORMC",status:e.status}))):[],r="update",n=[];const s=await Ps({finalResult:a,toggleSFAMessage:nt,setStoringMess:We,setData:S,Position:p,action:r,setShowTitle:J,setNotification:V,setAllApprovedData:Te,setAllRejectedData:Re,storeApproveRej:n});s&&s.length>0&&(s.forEach((async e=>{let{subject:t,message:a,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u,sheetStatus:h}=e;await tt({empID:s,leaveType:"".concat(d," Time Sheet ").concat(h),message:"The ".concat(d," timesheet for the period ").concat(p," to ").concat(m," has been ").concat(h," by Manager : ").concat(o,"."),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})})),n=[],H(!1),gt(),await(async()=>{let e=[...ke,...Ce];const t=null===w||void 0===w?void 0:w.filter((t=>!e.some((e=>e.id===t.id))));S(t),I(t),t&&0===t.length&&(N("/timeSheet"),window.location.reload())})())}else if("Manager"!==pe&&"Rejected"===u&&$e&&$e.length>0){let t=($e&&$e.length>0?$e.map((e=>({id:e.id,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"ORMC",status:"Pending",companyName:null===e||void 0===e?void 0:e.LOCATION}))):[]).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:b,fromDate:e.mfromDate,untilDate:e.muntilDate}))),a="ResubmitRejectedItems";const r=await Ps({setNotification:V,setShowTitle:J,finalResult:t,toggleSFAMessage:nt,setStoringMess:We,Position:p,action:a,handleAssignManager:it,selectedRows:$e});if(r){const{subject:e,message:t,fromAddress:a,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=r;await tt({empID:s,leaveType:"Corrected ".concat(d," Time Sheet Submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}};(0,n.useEffect)((()=>{ye&&ye.length>0?De({message:"Some data in the uploaded Excel sheet has already been submitted by the Time Keeper. You may proceed to submit only the remaining unmatched data.",buttonName:"Save"}):ye&&0===ye.length&&De({message:"All data in the uploaded Excel sheet has already been submitted by the Time Keeper.",buttonName:"OK"})}),[ye]);const dt=async e=>{if("Denied"===e)return;let t=w&&w.length>0&&w.map((e=>({fileName:m,empName:e.NAME||"",empDept:e.DEPTDIV||"",empBadgeNo:e.BADGE||"N/A",date:e.DATE||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINHRS||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||"0",actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,assignBy:b,fileType:"ORMC",status:"Unsubmitted",companyName:null===e||void 0===e?void 0:e.LOCATION}))),a=await(async(e,t)=>{if("Allowed"===t)return!1;let a=!1,r="";for(let c of e){var n,s,i,l,o,d;const e=null===(n=c.empBadgeNo)||void 0===n||null===(s=n.toString())||void 0===s?void 0:s.trim(),t=null===(i=c.normalWorkHrs)||void 0===i||null===(l=i.toString())||void 0===l?void 0:l.trim(),p=null===(o=c.date)||void 0===o||null===(d=o.toString())||void 0===d?void 0:d.trim();if(!e||"N/A"===e||"0"===e){a=!0,r="Some records are missing the Badge Number. Please update the Excel sheet accordingly.";break}if(!p||"N/A"===p||"0"===p){a=!0,r="Some records are missing the 'DATE'. Please update the Excel sheet accordingly.";break}if(!t||"0"===t||"N/A"===t){a=!0,r="One or more records have missing 'Normal Working Hours Per Day'.";break}}return a?(Se(r),Ae(!0),!0):(console.log("All required fields are filled. Proceeding..."),!1)})(t,e);if(a)return;const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:ve,identifier:"create",setShowDuplicateAlert:e=>{y.current=e,Q(e)},setCancelAction:e=>{v.current=e,Z(e)}});if(Ne(r),r.length===t.length&&Z(!1),r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){ee({finalResult:r,toggleSFAMessage:nt,setStoringMess:We,setData:S,Position:p,action:"create"})}else ve(!1)},ct=()=>{Ie(!Ee)};(0,n.useEffect)((()=>{K||$||Array.isArray(null===X||void 0===X?void 0:X.finalResult)&&(null===X||void 0===X?void 0:X.finalResult.length)>0&&(async e=>{let{storePreSubmitData:t}=e;const{finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}=t;Array.isArray(a)&&0===a.length||(await Ps({finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}),ve(!1),ee(null))})({storePreSubmitData:X})}),[K,$,X]);const pt=(e,t)=>{"Approved"===t?Te((t=>[...t.filter((t=>t.id!==e.id)),(0,g.A)((0,g.A)({},e),{},{status:"Approved"})])):"Rejected"===t&&(Oe(e),Re((t=>[...t.filter((t=>t.id!==e.id)),e])))},mt=(e,t)=>{if("Approved"===t){const t=ke.filter((t=>t.id!==e.id));Te(t)}else if("Rejected"===t){const t=Ce.filter((t=>t.id!==e.id));Re(t)}},ut=(0,n.useCallback)((()=>{const e=[...ke,...Ce],t=null===w||void 0===w?void 0:w.filter((t=>!e.some((e=>t.id===e.id))));S(t)}),[ke,Ce,w]),ht=e=>{try{const[t,a,r]=null===e||void 0===e?void 0:e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};(0,n.useEffect)((()=>{if(E&&E.length>0){Le(1);let e=[...E];if(Ke&&(e=Ke),Ge&&Je){const t=new Date(Ge),a=new Date(Je);e=e.filter((e=>{const r=new Date(e.DATE);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}W&&("All"===W||(e=e.filter((e=>{const t=null===e||void 0===e?void 0:e.jobLocaWhrs;return Array.isArray(t)&&t.some((e=>(null===e||void 0===e?void 0:e.LOCATION)===W))})))),S(e)}}),[Ge,Je,E,Ke,W]);const xt=(0,n.useCallback)((()=>{if(!w||!Array.isArray(w))return;const e=w.map((e=>(0,g.A)((0,g.A)({},e),{},{status:"Approved"})));Te(e);const t=w.reduce(((e,t)=>(e[t.id]=!0,e)),{});R((e=>(0,g.A)((0,g.A)({},e),t)))}),[w,Te,R]),gt=(0,n.useCallback)((()=>{if(!w||!Array.isArray(w))return;Te([]);const e=w.reduce(((e,t)=>(e[t.id]=!1,e)),{});R((t=>(0,g.A)((0,g.A)({},t),e)))}),[w,Te,R]);(0,n.useEffect)((()=>{try{if(!Array.isArray(Ye)||!Array.isArray(w))return;const e=new Map;Array.isArray(Ye)&&Ye.forEach((t=>{e.set(String(t.empBadgeNo).toUpperCase(),t)}));const t=Array.isArray(w)&&w.map((t=>{var a;const r=String(t.BADGE).toUpperCase(),n=e.get(r),s=null!==n&&void 0!==n&&n.workHrs&&Array.isArray(null===n||void 0===n?void 0:n.workHrs)?null===n||void 0===n?void 0:n.workHrs[(null===n||void 0===n||null===(a=n.workHrs)||void 0===a?void 0:a.length)-1]:"0";return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:s})}));qe(t)}catch(e){console.log("ERROR : ",e);const t=Array.isArray(w)&&w.map((e=>(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:"0"})));qe(t)}}),[Ye,w]);const ft=Be||[],vt=25*Me,yt=vt-25,Nt=ft.slice(yt,vt),bt=Math.ceil(ft.length/25);return Ue=Nt,(0,i.jsxs)("div",{onClick:()=>B(!1),children:[(0,i.jsx)("div",{children:!0===k?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full mr-7",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ws,{})}),(0,i.jsxs)("div",{className:"flex justify-between items-center gap-5 pt-5",children:[Array.isArray(f)&&f.length>0&&Array.isArray(Ue)&&Ue.length>0?(0,i.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,i.jsx)("p",{className:"text_size_5 text-dark_grey",children:"Approve All"}),(0,i.jsx)("input",{type:"checkbox",id:"exampleCheckbox",className:"h-4 w-4 cursor-pointer",checked:q,onChange:e=>{const t=e.target.checked;H(t),t?xt():gt()}})]}):"",Array.isArray(F)&&(null===F||void 0===F?void 0:F.length)>0&&Array.isArray(f)&&(null===f||void 0===f?void 0:f.length)>0?(0,i.jsx)(Hs,{handleSelectItem:e=>{z(e)},storeLocation:F,setIsOpen:B,isOpen:U}):null,(0,i.jsx)(ls,{allEmpDetails:w,searchResult:async e=>{try{const t=await e;Qe(t)}catch(t){}},secondaryData:E,Position:p,placeholder:"Badge No / Name"})]})]}),(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("table",{className:"styled-table w-[100%]",children:[(0,i.jsx)("thead",{className:"sticky-header",children:(0,i.jsxs)("tr",{className:"text_size_5 h-16",children:[(0,i.jsx)("td",{className:"px-5 text-center text_size_7",children:"S No."}),null!==(a=null===lt||void 0===lt?void 0:lt.tableHeader.map(((e,t)=>(0,i.jsx)("td",{className:"px-5 flex-1 text_size_7",children:e},t))))&&void 0!==a?a:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text_size_7",children:"No headers available"})}),!ue&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"STATUS"}),(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"APPROVE"}),(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"REJECT"})]}),h&&h.length>0||te&&te?(0,i.jsx)("td",{children:"Edited"}):""]})}),(0,i.jsx)("tbody",{children:Ue&&Ue.length>0?Ue.map(((e,t)=>{const a=(e,a)=>{const r="Pending"===(null===e||void 0===e?void 0:e.status),s=25*(Me-1)+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[50px] text-sm rounded-sm shadow-md border-b-2 border-[#CECECE] bg-white hover:bg-[#f1f5f9] ".concat(l&&l.length>0?"":"cursor-pointer"),onClick:()=>{l&&l.length>0||(rt(),(e=>{ne(e)})(e),M("Manager"===p?"View Form":"Edit Form"))},children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:s}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.NAME}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.DEPTDIV}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.BADGE}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:ht(null===e||void 0===e?void 0:e.DATE)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.IN)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OUT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALINOUT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.ALLDAYMINHRS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NETMINUTES)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.REMARKS}),r&&(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1 ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"text-[#0CB100]":"text_size_8"),children:null===e||void 0===e?void 0:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:C[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(R((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),O((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Approved"),mt(e,"Rejected")):(R((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Approved"))}})}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:P[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(O((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),R((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Rejected"),ct(),mt(e,"Approved")):(O((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Rejected"))}})})]}),h&&h.length>0||te&&te?(0,i.jsx)("td",{className:"cursor-pointer px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,i.jsx)("input",{type:"checkbox",disabled:!$e.some((t=>t.id===e.id)),checked:$e.some((t=>t.id===e.id)),onChange:()=>Xe(e)})}):""]},t+1)};return("Manager"===pe||"Manager"!==pe)&&a(e)})):null!==(s=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white ",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})}))&&void 0!==s?s:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center my-5 mt-10  ".concat(Ue&&Ue.length>0?"":"hidden"),children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center",children:(0,i.jsx)("button",{className:"rounded px-3 py-2.5 w-52 bg-[#FEF116] text_size_5 text-dark_grey ".concat($e&&$e.length>0||ke&&ke.length>0||Ce&&Ce.length>0||l?"bg-[#FEF116]":"bg-[#eee542] cursor-not-allowed"),disabled:"Manager"!==pe?!((null===$e||void 0===$e?void 0:$e.length)>0||l):!((null===ke||void 0===ke?void 0:ke.length)>0||(null===Ce||void 0===Ce?void 0:Ce.length)>0),onClick:()=>{"Manager"!==pe?$e&&$e.length>0?st():l&&l&&dt():"Manager"===pe&&(ut(),ot())},children:"Manager"===pe?"Finalize and Submit":h&&h.length>0||"Rejected"===u?"Assign Manager":"Submit"})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Ss,{totalPages:bt,currentPage:Me,paginate:e=>Le(e)})})]})]}):!1===k&&!0===D?(0,i.jsx)(os,{setClosePopup:A}):""}),!0===se&&(0,i.jsx)(hs,{toggleFunction:rt,editObject:re,fieldObj:(null===lt||void 0===lt?void 0:lt.fieldObj)||{},fields:(null===lt||void 0===lt?void 0:lt.fields)||[],tableHeader:(null===lt||void 0===lt?void 0:lt.tableHeader)||[],editFunction:e=>{try{var t;const a=Array.isArray(null===(t=w[0])||void 0===t?void 0:t.data)?((e,t)=>e.map((e=>({id:e.id,data:e.data.map((e=>e.IN===t.IN&&e.OUT===t.OUT&&e.BADGE===t.BADGE&&e.DATE===t.DATE?t:e))}))))(w,e):((e,t)=>e.map((e=>e.IN===t.IN&&e.OUT===t.OUT&&e.BADGE===t.BADGE&&e.DATE===t.DATE?t:e)))(w,e),r=null===a||void 0===a?void 0:a.map((e=>{var t,a;Array.isArray(null===e||void 0===e?void 0:e.jobLocaWhrs)&&(null===e||void 0===e||null===(t=e.jobLocaWhrs)||void 0===t?void 0:t.length)>0?e.LOCATION=null===e||void 0===e||null===(a=e.jobLocaWhrs[0])||void 0===a?void 0:a.LOCATION:e.LOCATION=null;return e}));S(r)}catch(a){}},titleName:d,Position:p,handleSubmit:et,editFormTitle:_,empAndWorkInfo:Ye}),!0===He?(0,i.jsx)(xs,{toggleSFAMessage:nt,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Processing...",message:"Data is being saved, ",messageTwo:"This might take a few seconds..."}):!1===He?(0,i.jsx)(gs,{successMess:xe,toggleSFAMessage:nt,setExcelData:c,userIdentification:pe}):"",!0===le&&(0,i.jsx)(Ns,{toggleFunctionForAssiMana:st,renameKeysFunctionAndSubmit:ot,mergedData:Ve}),!0===Ee&&(0,i.jsx)(bs,{toggleForRemarkFunc:ct,addRemarks:e=>{const t=Ce.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},e),{},{REMARKS:e.REMARKS}):t));Re(t)},passSelectedData:Pe,addEditedRemarks:e=>{const t=w&&w.length>0&&w.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{REMARKS:e.REMARKS}):t));S(t)}}),Y&&(0,i.jsx)(_s,{text:G}),fe&&(0,i.jsx)(_s,{text:"Please wait a few seconds..."}),K&&be?(0,i.jsx)(Fs,{onClose:()=>{y.current=!1,Q(!1)},setCancelAction:e=>{v.current=e,Z(e),T(null)},fileNameForSuccessful:m,title:"Duplicate Detection",message:be.message,buttonName:be.buttonName,popupIdentification:"duplicateRecords",onClearData:()=>{T(null),S(null),c(null)}}):"",je&&(0,i.jsx)(qs,{handleDecision:e=>{Ae(!1),dt(e)},alertMessage:we})]})}),Xs=((0,Ee.D)(),e=>{var t,a,s,l,o;let{setExcelData:d,excelData:c,returnedTHeader:p,Position:m,titleName:u,fileName:h,showRejectedItemTable:x,submittedData:f,wholeData:v,ManagerData:y}=e;const N=(0,n.useRef)(!1),b=(0,n.useRef)(!1),D=(0,r.Zp)(),A=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toUpperCase(),[w,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)(null),[k,T]=(0,n.useState)(null),[C,R]=(0,n.useState)(),[P,O]=(0,n.useState)(!1),[_,M]=(0,n.useState)(null),[F,L]=(0,n.useState)(!1),[U,B]=(0,n.useState)(""),[q,H]=(0,n.useState)(null),[W,z]=(0,n.useState)(null),[Y,V]=(0,n.useState)(null),[G,J]=(0,n.useState)({}),[K,Q]=(0,n.useState)({}),[$,Z]=(0,n.useState)(""),[X,ee]=(0,n.useState)(["All"]),[te,ae]=(0,n.useState)(!1),[re,ne]=(0,n.useState)(!1),[se,ie]=(0,n.useState)(""),[le,oe]=(0,n.useState)(!1),[de,ce]=(0,n.useState)(null),[pe,me]=(0,n.useState)({}),[ue,he]=(0,n.useState)(!1),[xe,ge]=(0,n.useState)(""),[fe,ve]=(0,n.useState)(null),[ye,Ne]=(0,n.useState)([]),[be,De]=(0,n.useState)([]),[je,Ae]=(0,n.useState)(null),[we,Se]=(0,n.useState)(!1),[Ee,Ie]=(0,n.useState)(""),[ke,Te]=(0,n.useState)(!1),[Ce,Re]=(0,n.useState)(!1),[Pe,Oe]=(0,n.useState)(null),[Me,Le]=(0,n.useState)(1);let Ue;const[Be,qe]=(0,n.useState)([]),[He,We]=(0,n.useState)(null),{data:ze}=Qs(c),{empAndWorkInfo:Ye}=Bs(),Ve=Is(),{startDate:Ge,endDate:Je,searchQuery:Ke,setSearchQuery:Qe}=(0,Fe.b)(),{selectedRows:$e,setSelectedRows:Ze,handleCheckboxChange:Xe,handleSubmit:et}=Os(),{createNotification:tt}=_e();(0,n.useEffect)((()=>{f&&f.length>0&&(H(!0),M(!0),I(f),T(f))}),[f]),(0,n.useEffect)((()=>{ze&&ze.length>0&&(I(ze),T(ze))}),[ze]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");"Manager"===e?B("Manager"):"Manager"!==e&&B("TimeKeeper")}),[v]);const at=e=>{if(e&&(null===e||void 0===e?void 0:e.length)>0){M(!0);const t=e&&(null===e||void 0===e?void 0:e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,REC:e.rec||0,CTR:e.ctr||"",DEPT:e.empDept||"",EMPLOYEEID:e.empID||"",BADGE:e.empBadgeNo||"",NAME:e.empName||0,DATE:e.date||"",ONAM:e.onAM||"",OFFAM:e.offAM||"",ONPM:e.onPM||0,OFFPM:e.offPM||0,IN:(null===e||void 0===e?void 0:e.inTime)||0,OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINUTES:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||"",NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:(null===e||void 0===e?void 0:e.actualWorkHrs)||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,TOTALACTUALHOURS:e.actualWorkHrs||"",jobLocaWhrs:t.flat()||[],fileType:e.fileType,timeKeeper:e.assignBy,manager:e.assignTo,REMARKS:e.remarks||"",status:e.status||""}})));I(t),T(t)}};(0,n.useEffect)((()=>{if(p&&p.length>0)(async()=>{const e=p.map((e=>Object.keys(e).reduce(((t,a)=>(t[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()]=e[a],t)),{}))),t=["REC","CTR","DEPT","EMPLOYEEID","BADGE","NAME"],a=await new Promise((a=>{a(e.every((e=>t.every((t=>Object.keys(e).map((e=>e.toLowerCase())).includes(t.toLowerCase()))))))}));S(!0),M(a),H(a)})();else if(p||"Rejected"===x)if(p||"Rejected"!==x)M(!1);else{(async()=>{M(!0),oe(!0);try{const e=new Promise(((e,t)=>{v&&v.length>0?e(v):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"!==U){await As(t);at(t)}}catch(e){}})()}else{(async()=>{M(!0);try{const e=new Promise(((e,t)=>{y&&y.length>0?e(y):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"===U){await ys(t);at(t);const e=Array.isArray(t)&&[...new Set(t.flatMap((e=>JSON.parse(e.empWorkInfo).map((e=>e.LOCATION)))))];ee([...X,...e])}}catch(e){}})()}}),[p,y,v,U,x]);const rt=()=>{O(!P)},nt=(0,n.useCallback)((async(e,t)=>{z(e)}),[]),st=()=>{L(!F)},it=async()=>{const e=null===E||void 0===E?void 0:E.filter((e=>!$e.some((t=>t.id===e.id))));I(e),T(e),Ze([]),e&&0===e.length&&window.location.reload()},lt=ds(u),ot=async e=>{if("Manager"!==U&&"Rejected"!==x&&$e&&$e.length>0){const t=($e&&$e.length>0&&$e.map((e=>({id:e.id,rec:e.REC||"",ctr:e.CTR||"",empDept:e.DEPT||"",empID:e.EMPLOYEEID||"",empBadgeNo:e.BADGE||"",empName:e.NAME||"",date:e.DATE||"",onAM:e.ONAM||"",offAM:e.OFFAM||"",onPM:e.ONPM||"",offPM:e.OFFPM||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINUTES||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,actualWorkHrs:e.TOTALACTUALHOURS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"HO",status:"Pending",remarks:e.REMARKS||"",companyName:null===e||void 0===e?void 0:e.LOCATION})))).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:A,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="updateStoredData";const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:V,identifier:a});if(r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){V(!1);let e="updateStoredData",t=r;const a=await Ps({setNotification:Se,setShowTitle:Ie,finalResult:t,toggleSFAMessage:nt,setStoringMess:We,Position:m,action:e,handleAssignManager:it,selectedRows:$e});if(a){const{subject:e,message:t,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=a;await tt({empID:s,leaveType:"".concat(d," excel sheet submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper : \n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}}else if("Manager"===U){const e=[...ye,...be],t=null===e||void 0===e?void 0:e.filter(((e,t,a)=>t===a.findIndex((t=>t.id===e.id))));let a=t&&t.length>0?t.map((e=>({id:e.id,rec:e.REC||"",ctr:e.CTR||"",empDept:e.DEPT||"",empID:e.EMPLOYEEID||"",empBadgeNo:e.BADGE||"",empName:e.NAME||"",date:e.DATE||"",onAM:e.ONAM||"",offAM:e.OFFAM||"",onPM:e.ONPM||"",offPM:e.OFFPM||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINUTES||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,actualWorkHrs:e.TOTALACTUALHOURS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"HO",status:e.status,remarks:e.REMARKS||""}))):[],r=[],n="update";const s=await Ps({finalResult:a,toggleSFAMessage:nt,setStoringMess:We,setData:I,Position:m,action:n,setShowTitle:Ie,setNotification:Se,setAllApprovedData:Ne,setAllRejectedData:De,storeApproveRej:r});s&&s.length>0&&(s.forEach((async e=>{let{subject:t,message:a,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u,sheetStatus:h}=e;await tt({empID:s,leaveType:"".concat(d," Time Sheet ").concat(h),message:"The ".concat(d," timesheet for the period ").concat(p," to ").concat(m," has been ").concat(h," by Manager : ").concat(o,"."),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})})),r=[],ne(!1),gt(),await(async()=>{let e=[...ye,...be];const t=null===E||void 0===E?void 0:E.filter((t=>!e.some((e=>e.id===t.id))));I(t),T(t),t&&0===t.length&&(D("/timeSheet"),window.location.reload())})())}else if("Manager"!==U&&"Rejected"===x&&$e&&$e.length>0){const t=($e&&$e.length>0?$e.map((e=>({id:e.id,rec:e.REC||"",ctr:e.CTR||"",empDept:e.DEPT||"",empID:e.EMPLOYEEID||"",empBadgeNo:e.BADGE||"",empName:e.NAME||"",date:e.DATE||"",onAM:e.ONAM||"",offAM:e.OFFAM||"",onPM:e.ONPM||"",offPM:e.OFFPM||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINUTES||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,actualWorkHrs:e.TOTALACTUALHOURS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"HO",status:"Pending",remarks:e.REMARKS||"",companyName:null===e||void 0===e?void 0:e.LOCATION}))):[]).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:A,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="ResubmitRejectedItems";const r=await Ps({setNotification:Se,setShowTitle:Ie,finalResult:t,toggleSFAMessage:nt,setStoringMess:We,Position:m,action:a,handleAssignManager:it,selectedRows:$e});if(r){const{subject:e,message:t,fromAddress:a,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=r;await tt({empID:s,leaveType:"Corrected ".concat(d," Time Sheet Submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}};(0,n.useEffect)((()=>{de&&de.length>0?me({message:"Some data in the uploaded Excel sheet has already been submitted by the Time Keeper. You may proceed to submit only the remaining unmatched data.",buttonName:"Save"}):de&&0===de.length&&me({message:"All data in the uploaded Excel sheet has already been submitted by the Time Keeper.",buttonName:"OK"})}),[de]);const dt=async e=>{if("Denied"===e)return;let t=E&&E.map((e=>({fileName:h,rec:e.REC||"",ctr:e.CTR||"",empDept:e.DEPT||"",empID:e.EMPLOYEEID||"",empBadgeNo:e.BADGE||"N/A",empName:e.NAME||"",date:e.DATE||"",onAM:e.ONAM||"",offAM:e.OFFAM||"",onPM:e.ONPM||"",offPM:e.OFFPM||"",inTime:e.IN||"",outTime:e.OUT||"",totalInOut:e.TOTALINOUT||"",allDayHrs:e.ALLDAYMINUTES||"",netMins:e.NETMINUTES||"",totalHrs:e.TOTALHOURS||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||"0",actualWorkHrs:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0,otTime:(null===e||void 0===e?void 0:e.OT)||0,actualWorkHrs:e.TOTALACTUALHOURS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"HO",status:"Unsubmitted",assignBy:A,remarks:e.REMARKS||"",companyName:(null===e||void 0===e?void 0:e.LOCATION)||""}))),a=await(async(e,t)=>{if("Allowed"===t)return!1;let a=!1,r="";for(let c of e){var n,s,i,l,o,d;const e=null===c||void 0===c||null===(n=c.empBadgeNo)||void 0===n||null===(s=n.toString())||void 0===s?void 0:s.trim(),t=null===c||void 0===c||null===(i=c.normalWorkHrs)||void 0===i||null===(l=i.toString())||void 0===l?void 0:l.trim(),p=null===c||void 0===c||null===(o=c.date)||void 0===o||null===(d=o.toString())||void 0===d?void 0:d.trim();if(!e||"N/A"===e||"0"===e){a=!0,r="Some records are missing the Badge Number. Please update the Excel sheet accordingly.";break}if(!p||"N/A"===p||"0"===p){a=!0,r="Some records are missing the 'DATE'. Please update the Excel sheet accordingly.";break}if(!t||"0"===t||"N/A"===t){a=!0,r="One or more records have missing 'Normal Working Hours Per Day'.";break}}return a?(ge(r),he(!0),!0):(console.log("All required fields are filled. Proceeding..."),!1)})(t,e);if(a)return;const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:V,identifier:"create",setShowDuplicateAlert:e=>{b.current=e,Te(e)},setCancelAction:e=>{N.current=e,Re(e)}});if(ce(r),r.length===t.length&&Re(!1),r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){Oe({finalResult:r,toggleSFAMessage:nt,setStoringMess:We,setData:I,Position:m,action:"create"})}else V(!1)},ct=()=>{ve(!fe)};(0,n.useEffect)((()=>{ke||Ce||Array.isArray(null===Pe||void 0===Pe?void 0:Pe.finalResult)&&(null===Pe||void 0===Pe?void 0:Pe.finalResult.length)>0&&(async e=>{let{storePreSubmitData:t}=e;const{finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}=t;Array.isArray(a)&&0===a.length||(await Ps({finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}),V(!1),Oe(null))})({storePreSubmitData:Pe})}),[ke,Ce,Pe]);const pt=(e,t)=>{"Approved"===t?Ne((t=>[...t.filter((t=>t.id!==e.id)),(0,g.A)((0,g.A)({},e),{},{status:"Approved"})])):"Rejected"===t&&(Ae(e),De((t=>[...t.filter((t=>t.id!==e.id)),e])))},mt=(e,t)=>{if("Approved"===t){const t=ye.filter((t=>t.id!==e.id));Ne(t)}else if("Rejected"===t){const t=be.filter((t=>t.id!==e.id));De(t)}},ut=(0,n.useCallback)((()=>{const e=[...ye,...be],t=null===E||void 0===E?void 0:E.filter((t=>!e.some((e=>t.id===e.id))));I(t)}),[ye,be,E]),ht=e=>{if(e){const[t,a,r]=null===e||void 0===e?void 0:e.split("/"),n=parseInt(t,10),s=parseInt(a,10);return"".concat(s,"/").concat(n,"/").concat(r)}};(0,n.useEffect)((()=>{if(k&&k.length>0){Le(1);let e=[...k];if(Ke&&(e=Ke),Ge&&Je){const t=new Date(Ge),a=new Date(Je);e=e.filter((e=>{const r=new Date(e.DATE);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}se&&("All"===se||(e=e.filter((e=>{const t=null===e||void 0===e?void 0:e.jobLocaWhrs;return Array.isArray(t)&&t.some((e=>(null===e||void 0===e?void 0:e.LOCATION)===se))})))),I(e)}}),[Ge,Je,k,Ke,se]);const xt=(0,n.useCallback)((()=>{if(!E||!Array.isArray(E))return;const e=E.map((e=>(0,g.A)((0,g.A)({},e),{},{status:"Approved"})));Ne(e);const t=E.reduce(((e,t)=>(e[t.id]=!0,e)),{});J((e=>(0,g.A)((0,g.A)({},e),t)))}),[E,Ne,J]),gt=(0,n.useCallback)((()=>{if(!E||!Array.isArray(E))return;Ne([]);const e=E.reduce(((e,t)=>(e[t.id]=!1,e)),{});J((t=>(0,g.A)((0,g.A)({},t),e)))}),[E,Ne,J]);(0,n.useEffect)((()=>{try{if(!Array.isArray(Ye)||!Array.isArray(E))return;const e=new Map;Array.isArray(Ye)&&Ye.forEach((t=>{null===e||void 0===e||e.set(String(null===t||void 0===t?void 0:t.empBadgeNo).toUpperCase(),t)}));const t=Array.isArray(E)&&E.map((t=>{var a;const r=String(null===t||void 0===t?void 0:t.BADGE).toUpperCase(),n=null===e||void 0===e?void 0:e.get(r),s=null!==n&&void 0!==n&&n.workHrs&&Array.isArray(null===n||void 0===n?void 0:n.workHrs)?null===n||void 0===n?void 0:n.workHrs[(null===n||void 0===n||null===(a=n.workHrs)||void 0===a?void 0:a.length)-1]:"0";return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:s})}));qe(t)}catch(e){console.log("ERROR : ",e);const t=Array.isArray(E)&&E.map((e=>(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:"0"})));qe(t)}}),[Ye,E]);const ft=100,vt=Be||[],yt=Me*ft,Nt=yt-ft,bt=vt.slice(Nt,yt),Dt=Math.ceil(vt.length/ft);return Ue=bt,(0,i.jsxs)("div",{onClick:()=>ae(!1),children:[(0,i.jsx)("div",{children:!0===_?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full mr-7",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ws,{})}),(0,i.jsxs)("div",{className:"flex justify-between items-center gap-5 pt-5",children:[Array.isArray(y)&&y.length>0&&Array.isArray(Ue)&&Ue.length>0?(0,i.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,i.jsx)("p",{className:"text_size_5 text-dark_grey",children:"Approve All"}),(0,i.jsx)("input",{type:"checkbox",id:"exampleCheckbox",className:"h-4 w-4 cursor-pointer",checked:re,onChange:e=>{const t=e.target.checked;ne(t),t?xt():gt()}})]}):"",Array.isArray(X)&&(null===X||void 0===X?void 0:X.length)>0&&Array.isArray(y)&&(null===y||void 0===y?void 0:y.length)>0?(0,i.jsx)(Hs,{handleSelectItem:e=>{ie(e)},storeLocation:X,setIsOpen:ae,isOpen:te}):null,(0,i.jsx)(ls,{allEmpDetails:E,searchResult:async e=>{try{const t=await e;Qe(t)}catch(t){}},secondaryData:k,Position:m,placeholder:"Employee ID / Badge No / Name"})]})]}),(0,i.jsx)("div",{className:"table-container",children:(0,i.jsxs)("table",{className:"styled-table w-[100%]",children:[(0,i.jsx)("thead",{className:"sticky-header",children:(0,i.jsxs)("tr",{className:"text_size_5 h-16",children:[(0,i.jsx)("td",{className:"px-4 flex-1 text_size_7",children:"S No."}),null!==(a=null===lt||void 0===lt||null===(s=lt.tableHeader)||void 0===s?void 0:s.filter((e=>"REC#"!==e)).map(((e,t)=>(0,i.jsx)("td",{className:"px-4 flex-1 text_size_7",children:e},t))))&&void 0!==a?a:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center",children:"No headers available"})}),!q&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"".concat("Rejected"===x?"hidden":"px-5 flex-1 text_size_7"),children:"STATUS"}),(0,i.jsx)("td",{className:"".concat("Rejected"===x?"hidden":"px-5 flex-1 text_size_7"),children:"APPROVE"}),(0,i.jsx)("td",{className:"".concat("Rejected"===x?"hidden":"px-5 flex-1 text_size_7"),children:"REJECT"})]}),f&&f.length>0||le&&le?(0,i.jsx)("td",{children:"Edited"}):""]})}),(0,i.jsx)("tbody",{children:Ue&&(null===(l=Ue)||void 0===l?void 0:l.length)>0?Ue.map(((e,t)=>{const a=(e,a)=>{const r="Pending"===(null===e||void 0===e?void 0:e.status),s=(Me-1)*ft+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[50px] text-sm rounded-sm shadow-md border-b-2 border-[#CECECE] bg-white hover:bg-[#f1f5f9] ".concat(c&&c.length>0?"":"cursor-pointer"),onClick:()=>{c&&c.length>0||(rt(),(e=>{R(e)})(e),Z("Manager"===m?"View Form":"Edit Form"))},children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:s}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.CTR}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.DEPT}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.EMPLOYEEID}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.BADGE)||"N/A"}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.NAME}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:ht(null===e||void 0===e?void 0:e.DATE)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.ONAM}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.OFFAM}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.ONPM}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.OFFPM}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.IN)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OUT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALINOUT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.ALLDAYMINUTES)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NETMINUTES)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALACTUALHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.REMARKS}),r&&(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1 ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"text-[#0CB100]":"text_size_8"),children:null===e||void 0===e?void 0:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:G[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(J((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Q((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Approved"),mt(e,"Rejected")):(J((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Approved"))}})}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4",type:"checkbox",checked:K[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Q((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),J((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Rejected"),ct(),mt(e,"Approved")):(mt(e,"Rejected"),Q((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Rejected"))}})})]}),f&&f.length>0||le&&le?(0,i.jsx)("td",{className:"cursor-pointer px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,i.jsx)("input",{type:"checkbox",disabled:!$e.some((t=>t.id===e.id)),checked:$e.some((t=>t.id===e.id)),onChange:()=>Xe(e)})}):""]},t+1)};return("Manager"===U||"Manager"!==U)&&a(e)})):null!==(o=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white  ",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})}))&&void 0!==o?o:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center my-5 mt-10  ".concat(Ue&&Ue.length>0?"":"hidden"),children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center",children:(0,i.jsx)("button",{className:"rounded px-3 py-2.5 w-52 bg-[#FEF116] text_size_5 text-dark_grey ".concat($e&&$e.length>0||ye&&ye.length>0||be&&be.length>0||c?"bg-[#FEF116]":"bg-[#eee542] cursor-not-allowed"),disabled:"Manager"!==U?!((null===$e||void 0===$e?void 0:$e.length)>0||c):!((null===ye||void 0===ye?void 0:ye.length)>0||(null===be||void 0===be?void 0:be.length)>0),onClick:()=>{"Manager"!==U?$e&&$e.length>0?st():c&&c&&dt():"Manager"===U&&(ot(),ut())},children:"Manager"===U?"Finalize and Submit":f&&f.length>0||"Rejected"===x?"Assign Manager":"Submit"})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Ss,{totalPages:Dt,currentPage:Me,paginate:e=>Le(e)})})]})]}):!1===_&&!0===w?(0,i.jsx)(os,{setClosePopup:S}):""}),!0===P&&(0,i.jsx)(hs,{toggleFunction:rt,editObject:C,fieldObj:(null===lt||void 0===lt?void 0:lt.fieldObj)||{},fields:(null===lt||void 0===lt?void 0:lt.fields)||[],tableHeader:(null===lt||void 0===lt?void 0:lt.tableHeader)||[],editFunction:e=>{var t;const a=Array.isArray(null===(t=E[0])||void 0===t?void 0:t.data)?((e,t)=>e.map((e=>({id:e.id,data:e.data.map((e=>e.BADGE===t.BADGE&&e.DATE===t.DATE?t:e))}))))(E,e):((e,t)=>e.map((e=>e.EMPLOYEEID===t.EMPLOYEEID&&e.DATE===t.DATE?t:e)))(E,e),r=null===a||void 0===a?void 0:a.map((e=>{var t,a;Array.isArray(null===e||void 0===e?void 0:e.jobLocaWhrs)&&(null===e||void 0===e||null===(t=e.jobLocaWhrs)||void 0===t?void 0:t.length)>0?e.LOCATION=null===e||void 0===e||null===(a=e.jobLocaWhrs[0])||void 0===a?void 0:a.LOCATION:e.LOCATION=null;return e}));I(r)},titleName:u,Position:m,handleSubmit:et,editFormTitle:$,empAndWorkInfo:Ye}),!0===He?(0,i.jsx)(xs,{toggleSFAMessage:nt,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Processing...",message:"Data is being saved, ",messageTwo:"This might take a few seconds..."}):!1===He?(0,i.jsx)(gs,{successMess:W,toggleSFAMessage:nt,setExcelData:d,userIdentification:U}):"",!0===F&&(0,i.jsx)(Ns,{toggleFunctionForAssiMana:st,renameKeysFunctionAndSubmit:ot,mergedData:Ve}),!0===fe&&(0,i.jsx)(bs,{toggleForRemarkFunc:ct,addRemarks:e=>{const t=be.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},e),{},{REMARKS:e.REMARKS}):t));De(t)},passSelectedData:je,addEditedRemarks:e=>{const t=E&&E.length>0&&E.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{REMARKS:e.REMARKS}):t));I(t)}}),we&&(0,i.jsx)(_s,{text:Ee}),Y&&(0,i.jsx)(_s,{text:"Please wait a few seconds..."}),ke&&pe?(0,i.jsx)(Fs,{onClose:()=>{b.current=!1,Te(!1)},setCancelAction:e=>{N.current=e,Re(e),M(null)},fileNameForSuccessful:h,title:"Duplicate Detection",message:pe.message,buttonName:pe.buttonName,popupIdentification:"duplicateRecords",onClearData:()=>{M(null),I(null),d(null)}}):"",ue&&(0,i.jsx)(qs,{handleDecision:e=>{he(!1),dt(e)},alertMessage:xe})]})});var ei=a(1238);const ti=(e,t,a,r,n)=>{if(null!==e){const s=ei.LF(e,{type:"buffer"}),i=s.SheetNames,l=[];i.forEach((e=>{const t=ei.Wp.sheet_to_json(s.Sheets[e]);l.push({sheetName:e,data:t})}));const o=(e,t)=>{const a={},r={};return Object.keys(t).forEach((n=>{const s=t[n];r[s]?(r[s]+=1,a["".concat(s,"_").concat(r[s])]=e[n]||null):(r[s]=1,a[s]=e[n]||null)})),a},d=[],c=l&&l.map((e=>{const t=e.sheetName,a=e.data[0],r=e.data[2],n=e.data.slice(3,4).map((e=>o(e,r))),s=e.data[7],i=e.data[2],l=["138000","CONTRACT No:","DAILY TIME SHEET ","__EMPTY","__EMPTY_4"].map((e=>e.trim())),c=Object.fromEntries(Object.entries(i).filter((e=>{let[t,a]=e;return!l.includes(t.trim())}))),p=(0,g.A)((0,g.A)({},s),c);d.push(p);return{sheetName:t,rows:n,tbodyRows:e.data.slice(8).map((e=>o(e,p))),location:a}})),p=[];function m(e){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}c&&c.map(((e,t)=>{const a=e.rows,r=e.location.__EMPTY,n=e.tbodyRows.map(((e,t)=>(0,g.A)((0,g.A)({},e),{},{date:a.map((e=>e.DATE)),location:r})));let s=n.findIndex((e=>"TOTAL"===e.NAME));if(s>-1){const e=n.slice(0,s).filter((e=>null!==e.NAME)).flat();p.push(...e)}}));const u=e=>{const[t,a,r]=null===e||void 0===e?void 0:e.split("/"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(s,"/").concat(n,"/").concat(r)};function h(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}return t((p&&p.map((e=>{const t=m(e.date.flat()).toLocaleDateString(),a=u(t);return(0,g.A)((0,g.A)({},e),{},{date:a})}))).map((e=>{const t={};for(const a in e){t[h(a).toUpperCase()]=e[a]}return t}))),n(!1),d}r.current.value="",a(null)},ai=["FID","NAMEFLAST","ENTRANCEDATEUSED","ENTRANCEDATETIME","EXITDATETIME","AVGDAILYTOTALBYDAY","ADININWORKSENGINEERINGSDNBHD"],ri=(e,t,a,r,s)=>{const i=(0,Ee.D)(),[l,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(null);try{return(0,n.useEffect)((()=>{const r=localStorage.getItem("userType");c(r);("Manager"===r&&e||"Manager"!==r)&&(async()=>{try{null===a||void 0===a||a(!0),null===s||void 0===s||s("Please wait a few seconds...");let m=null,u=[],h=[];const x={and:"Manager"===t?[{status:{eq:"Pending"}},{fileType:{eq:e}}]:"viewTimeSheet"===t?[{fileType:{eq:e}}]:"viewSummary"===t?[{status:{eq:"Approved"}},{fileType:{eq:e}}]:"rejectedItems"===t?[{status:{eq:"Rejected"}},{fileType:{eq:e}}]:"Unsubmitted"===t?[{status:{eq:"Unsubmitted"}},{fileType:{eq:e}}]:[{status:{eq:"nothing"}},{fileType:{eq:e}}]};do{var r,n,l,d,c,p;const e=await i.graphql({query:Ie.Oy,variables:{filter:x,limit:800,nextToken:m}});null===e||void 0===e||null===(r=e.data)||void 0===r||null===(n=r.listTimeSheets)||void 0===n||n.items,h=(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(d=l.listTimeSheets)||void 0===d?void 0:d.items)||[],m=null===e||void 0===e||null===(c=e.data)||void 0===c||null===(p=c.listTimeSheets)||void 0===p?void 0:p.nextToken,h.filter((e=>null!==e&&void 0!==e)),u=[...u,...h]}while(m);o(u),0===u.length?null===s||void 0===s||s("No data available"):null===s||void 0===s||s("")}catch(m){}finally{null===a||void 0===a||a(!1)}})()}),[e,t]),{convertedStringToArrayObj:l,getPosition:d,loading:r}}catch(p){null===a||void 0===a||a(!1),s("An error occurred. Please try again.")}},ni=["sapNo"],si=(0,Ee.D)(),ii=e=>{var t,a,s;let{excelData:l,returnedTHeader:o,Position:d,titleName:c,setExcelData:p,fileName:m,showRejectedItemTable:u,submittedData:h,wholeData:x,ManagerData:f}=e;const v=(0,n.useRef)(!1),y=(0,n.useRef)(!1),N=(0,r.Zp)(),b=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toUpperCase(),[D,A]=(0,n.useState)(!1),[w,S]=(0,n.useState)(null),[E,I]=(0,n.useState)(null),[k,T]=(0,n.useState)(null),[C,R]=(0,n.useState)(),[P,O]=(0,n.useState)(!1),[_,M]=(0,n.useState)(!0),[F,L]=(0,n.useState)(""),[U,B]=(0,n.useState)(null),[q,H]=(0,n.useState)(null),[W,z]=(0,n.useState)(!1),[Y,V]=(0,n.useState)(null),[G,J]=(0,n.useState)(null),[K,Q]=(0,n.useState)(!1),[$,Z]=(0,n.useState)(""),[X,ee]=(0,n.useState)(!1),[te,ae]=(0,n.useState)(!1),[re,ne]=(0,n.useState)(null),[se,ie]=(0,n.useState)(!1),[le,oe]=(0,n.useState)(null),[de,ce]=(0,n.useState)({}),[pe,me]=(0,n.useState)(!1),[ue,he]=(0,n.useState)(""),[xe,ge]=(0,n.useState)([]),[fe,ve]=(0,n.useState)([]),[ye,Ne]=(0,n.useState)(null),[be,De]=(0,n.useState)(1),[je,Ae]=(0,n.useState)([]);let we;const Se=Is(),[Ee,ke]=(0,n.useState)(null),[Te,Ce]=(0,n.useState)({}),[Re,Pe]=(0,n.useState)({}),[Oe,Me]=(0,n.useState)(""),[Le,Ue]=(0,n.useState)(["All"]),[Be,qe]=(0,n.useState)(!1),[He,We]=(0,n.useState)(!1),[ze,Ye]=(0,n.useState)(""),{startDate:Ve,endDate:Ge,searchQuery:Je,setSearchQuery:Ke}=(0,Fe.b)(),{selectedRows:Qe,setSelectedRows:$e,handleCheckboxChange:Ze,handleSubmit:Xe}=Os(),{createNotification:et}=_e(),{empAndWorkInfo:tt}=Bs();(0,n.useEffect)((()=>{try{const e=async()=>{try{const t=new Promise(((e,t)=>{l?e(l):setTimeout((()=>{t("No data found after waiting.")}),2e3)})),a=await t;async function r(e){let t=[],a=null;do{const r=await si.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}const n=async()=>{try{const[e,t]=await Promise.all([r(Ie.it),r(Ie.bJ)]),n=e,s=t.map((e=>{let{sapNo:t}=e;return(0,is.A)(e,ni)})),i=n.map((e=>{const t=s.find((t=>(null===t||void 0===t?void 0:t.empID)===(null===e||void 0===e?void 0:e.empID)));return t?(0,g.A)((0,g.A)({},e),t):null})).filter((e=>null!==e)),l=a.map((e=>{const t=i.find((t=>String(null===t||void 0===t?void 0:t.sapNo)===String(null===e||void 0===e?void 0:e.NO)));return(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:t?null===t||void 0===t?void 0:t.workHrs[(null===t||void 0===t?void 0:t.workHrs.length)-1]:null})}));S(l),I(l)}catch(e){}};await n()}catch(e){}};e()}catch(e){}}),[l]),(0,n.useEffect)((()=>{if(h&&h.length>0){J(!0),T(!0);const e=function(e){return e.map((e=>{var t,a,r,n;return(0,g.A)((0,g.A)({},e),{},{companyName:null===e||void 0===e?void 0:e.LOCATION,WORKINGHOURS:null!==(t=e.TOTALHOURS)&&void 0!==t?t:"0",OT:null!==(a=e.TOTALHOURS2)&&void 0!==a?a:"0",jobLocaWhrs:[{JOBCODE:"",LOCATION:e.LOCATION,OVERTIMEHRS:null!==(r=e.TOTALHOURS2)&&void 0!==r?r:"0",WORKINGHRS:null!==(n=e.TOTALHOURS)&&void 0!==n?n:"0",id:1}]})}))}(h);$e(e),S(e),I(e)}}),[h]),(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");"Manager"===e?L("Manager"):"Manager"!==e&&L("TimeKeeper")}),[x]);const at=e=>{if(e&&e.length>0){T(!0);const t=null===e||void 0===e?void 0:e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||"",NO:e.fidNo||"",LOCATION:e.location||"",TRADE:e.trade||"",DATE:e.date||"",TOTALHOURS:e.totalNT||0,TOTALHOURS2:e.totalOT||0,TOTALHOURS3:e.totalNTOT||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}}));S(t),I(t)}};(0,n.useEffect)((()=>{if(o&&(null===o||void 0===o?void 0:o.length)>0)(async()=>{const e=o&&o.map((e=>{const t={};for(const r in e)t[r]="string"!==typeof(a=e[r])?a:a.replace(/[^a-zA-Z0-9]/g,"");var a;return t})),t=["NAME","No","Company","TOTALHOURS"],a=await new Promise((a=>{a(e&&e.every((e=>t.every((t=>Object.values(e).map((e=>"string"===typeof e?e.toUpperCase():e)).includes(t.toUpperCase()))))))}));A(!0),J(a),T(a),M(!1)})();else if(o||"Rejected"===u)if(o||"Rejected"!==u)T(!1),M(!1);else{(async()=>{T(!0),ie(!0);try{const e=new Promise(((e,t)=>{x&&x.length>0?e(x):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"!==F){await As(t);at(t)}}catch(e){}})()}else{(async()=>{T(!0);try{const e=new Promise(((e,t)=>{f&&f.length>0?e(f):setTimeout((()=>{t("No data found after waiting.")}),5e3)})),t=await e;if("Manager"===F){await ys(t);at(t);const e=Array.isArray(t)&&[...new Set(t.map((e=>e.location)))];Ue([...Le,...e])}}catch(e){}})()}}),[o,f,x,F,u]);const rt=()=>{O(!P)},nt=(0,n.useCallback)((async(e,t)=>{B(e)}),[]),st=()=>{z(!W)},it=()=>{const e=null===w||void 0===w?void 0:w.filter((e=>!Qe.some((t=>t.id===e.id))));S(e),I(e),$e([]),e&&0===e.length&&window.location.reload()},lt=ds(c),ot=async e=>{if("Manager"!==F&&"Rejected"!==u&&Qe&&Qe.length>0){const t=(Qe&&Qe.length>0&&Qe.map((e=>({id:e.id,empName:e.NAME||"",fidNo:e.NO||"",companyName:null!==e&&void 0!==e&&e.LOCATIONATTOP?null===e||void 0===e?void 0:e.LOCATIONATTOP:e.LOCATION||"",location:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"Offshore's ORMC",status:"Pending"})))).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:b,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="updateStoredData";const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:H,identifier:a});if(r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){H(!1);let e=r,t="updateStoredData";const a=await Ps({setNotification:Q,setShowTitle:Z,finalResult:e,toggleSFAMessage:nt,setStoringMess:ke,Position:d,action:t,handleAssignManager:it,selectedRows:Qe});if(a){const{subject:e,message:t,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=a;await et({empID:s,leaveType:"".concat(d," excel sheet submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper : \n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}}else if("Manager"===F){const e=[...xe,...fe],t=null===e||void 0===e?void 0:e.filter(((e,t,a)=>t===a.findIndex((t=>t.id===e.id))));let a=t&&t.length>0?t.map((e=>({id:e.id,empName:e.NAME||"",fidNo:e.NO||"",location:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"Offshore's ORMC",status:e.status}))):[],r=[],n="update";const s=await Ps({finalResult:a,toggleSFAMessage:nt,setStoringMess:ke,setData:S,Position:d,action:n,setShowTitle:Z,setNotification:Q,setAllApprovedData:ge,setAllRejectedData:ve,storeApproveRej:r});s&&s.length>0&&(s.forEach((async e=>{let{subject:t,message:a,fromAddress:r,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u,sheetStatus:h}=e;await et({empID:s,leaveType:"".concat(d," Time Sheet ").concat(h),message:"The ".concat(d," timesheet for the period ").concat(p," to ").concat(m," has been ").concat(h," by Manager : ").concat(o,"."),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})})),r=[],We(!1),gt(),await(async()=>{let e=[...xe,...fe];const t=null===w||void 0===w?void 0:w.filter((t=>!e.some((e=>e.id===t.id))));S(t),I(t),t&&0===t.length&&(N("/timeSheet"),window.location.reload())})())}else if("Manager"!==F&&"Rejected"===u&&Qe&&Qe.length>0){const t=(Qe&&Qe.length>0?Qe.map((e=>({id:e.id,empName:e.NAME||"",fidNo:e.NO||"",location:e.LOCATION||"",companyName:null!==e&&void 0!==e&&e.LOCATIONATTOP?null===e||void 0===e?void 0:e.LOCATIONATTOP:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0,actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,fileType:"Offshore's ORMC",status:"Pending"}))):[]).map((t=>(0,g.A)((0,g.A)({},t),{},{assignTo:e.mbadgeNo,assignBy:b,fromDate:e.mfromDate,untilDate:e.muntilDate})));let a="ResubmitRejectedItems";const r=await Ps({setNotification:Q,setShowTitle:Z,finalResult:t,toggleSFAMessage:nt,setStoringMess:ke,Position:d,action:a,handleAssignManager:it,selectedRows:Qe});if(r){const{subject:e,message:t,fromAddress:a,toAddress:n,empID:s,timeKeeperEmpID:i,ManagerEmpID:l,managerName:o,fileType:d,timeKeeperName:c,fromDate:p,untilDate:m,senderEmail:u}=r;await et({empID:s,leaveType:"Corrected ".concat(d," Time Sheet Submitted for Approval"),message:"The ".concat(d," timesheet for the period from ").concat(p," until ").concat(m," has been submitted by Timekeeper\n          ").concat(c),senderEmail:u,receipentEmail:n,receipentEmpID:s,status:"Unread"})}}};(0,n.useEffect)((()=>{le&&le.length>0?ce({message:"Some data in the uploaded Excel sheet has already been submitted by the Time Keeper. You may proceed to submit only the remaining unmatched data.",buttonName:"Save"}):le&&0===le.length&&ce({message:"All data in the uploaded Excel sheet has already been submitted by the Time Keeper.",buttonName:"OK"})}),[le]);const dt=async e=>{if("Denied"===e)return;let t=w&&w.length>0&&w.map((e=>({fileName:m,empName:e.NAME||"",fidNo:e.NO||"N/A",companyName:null!==e&&void 0!==e&&e.LOCATIONATTOP?e.LOCATIONATTOP:(null===e||void 0===e?void 0:e.LOCATION)||"",location:e.LOCATION||"",trade:e.TRADE||"",date:e.DATE||"",totalNT:e.TOTALHOURS||"",totalOT:e.TOTALHOURS2||"",totalNTOT:e.TOTALHOURS3||"",normalWorkHrs:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||"0",actualWorkHrs:e.WORKINGHOURS||"",otTime:e.OT||"",remarks:e.REMARKS||"",empWorkInfo:[JSON.stringify(null===e||void 0===e?void 0:e.jobLocaWhrs)]||0,assignBy:b,fileType:"Offshore's ORMC",status:"Unsubmitted"}))),a=await(async(e,t)=>{if("Allowed"===t)return!1;let a=!1,r="";for(let c of e){var n,s,i,l,o,d;const e=null===(n=c.fidNo)||void 0===n||null===(s=n.toString())||void 0===s?void 0:s.trim(),t=null===(i=c.normalWorkHrs)||void 0===i||null===(l=i.toString())||void 0===l?void 0:l.trim(),p=null===(o=c.date)||void 0===o||null===(d=o.toString())||void 0===d?void 0:d.trim();if(!e||"N/A"===e||"0"===e){a=!0,r="Some records are missing the FID or SAP NO. Please update the Excel sheet accordingly.";break}if(!p||"N/A"===p||"0"===p){a=!0,r="Some records are missing the 'DATE'. Please update the Excel sheet accordingly.";break}if(!t||"0"===t||"N/A"===t){a=!0,r="One or more records have missing 'Normal Working Hours Per Day'.";break}}return a?(he(r),me(!0),!0):(console.log("All required fields are filled. Proceeding..."),!1)})(t,e);if(a)return;const{filteredResults:r,deleteDuplicateData:n}=await Ms({finalResult:t,setLoadingMessForDelay:H,identifier:"create",setShowDuplicateAlert:e=>{y.current=e,ee(e)},setCancelAction:e=>{v.current=e,ae(e)}});if(oe(r),r.length===t.length&&ae(!1),r&&r.length>0||r&&0===r.length||"DuplicateDataDeletedSuccessfully"===n){ne({finalResult:r,toggleSFAMessage:nt,setStoringMess:ke,setData:S,Position:d,action:"create"})}else H(!1)},ct=()=>{V(!Y)};(0,n.useEffect)((()=>{X||te||Array.isArray(null===re||void 0===re?void 0:re.finalResult)&&(null===re||void 0===re?void 0:re.finalResult.length)>0&&(async e=>{let{storePreSubmitData:t}=e;const{finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}=t;Array.isArray(a)&&0===a.length||(await Ps({finalResult:a,toggleSFAMessage:r,setStoringMess:n,setData:s,Position:i,action:l}),H(!1),ne(null))})({storePreSubmitData:re})}),[X,te,re]);const pt=(e,t)=>{"Approved"===t?ge((t=>[...t.filter((t=>t.id!==e.id)),(0,g.A)((0,g.A)({},e),{},{status:"Approved"})])):"Rejected"===t&&(Ne(e),ve((t=>[...t.filter((t=>t.id!==e.id)),e])))},mt=(e,t)=>{if("Approved"===t){const t=xe.filter((t=>t.id!==e.id));ge(t)}else if("Rejected"===t){const t=fe.filter((t=>t.id!==e.id));ve(t)}},ut=(0,n.useCallback)((()=>{const e=[...xe,...fe],t=null===w||void 0===w?void 0:w.filter((t=>!e.some((e=>t.id===e.id))));S(t)}),[xe,fe,w]),ht=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};(0,n.useEffect)((()=>{if(E&&E.length>0){De(1);let e=[...E];if(Je&&(e=Je),Ve&&Ge){const t=new Date(Ve),a=new Date(Ge);e=e.filter((e=>{const r=new Date(e.DATE);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}ze&&("All"===ze||(e=e.filter((e=>e.LOCATION===ze)))),S(e)}}),[Ve,Ge,E,Je,ze]);const xt=(0,n.useCallback)((()=>{if(!w||!Array.isArray(w))return;const e=w.map((e=>(0,g.A)((0,g.A)({},e),{},{status:"Approved"})));ge(e);const t=w.reduce(((e,t)=>(e[t.id]=!0,e)),{});Ce((e=>(0,g.A)((0,g.A)({},e),t)))}),[w,ge,Ce]),gt=(0,n.useCallback)((()=>{if(!w||!Array.isArray(w))return;ge([]);const e=w.reduce(((e,t)=>(e[t.id]=!1,e)),{});Ce((t=>(0,g.A)((0,g.A)({},t),e)))}),[w,ge,Ce]);(0,n.useEffect)((()=>{try{if(!Array.isArray(tt)||!Array.isArray(w))return;const e=new Map;Array.isArray(tt)&&tt.forEach((t=>{const a=String(null===t||void 0===t?void 0:t.sapNo).toUpperCase();e.set(a,t)}));const t=Array.isArray(w)&&w.map((t=>{var a;const r=String(null===t||void 0===t?void 0:t.NO).toUpperCase(),n=e.get(r),s=null!==n&&void 0!==n&&n.workHrs&&Array.isArray(null===n||void 0===n?void 0:n.workHrs)?null===n||void 0===n?void 0:n.workHrs[(null===n||void 0===n||null===(a=n.workHrs)||void 0===a?void 0:a.length)-1]:"0";return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:s})}));Ae(t)}catch(e){console.log("ERROR : ",e);const t=Array.isArray(w)&&w.map((e=>(0,g.A)((0,g.A)({},e),{},{NORMALWORKINGHRSPERDAY:"0"})));Ae(t)}}),[tt,w]);const ft=je||[],vt=25*be,yt=vt-25,Nt=ft.slice(yt,vt),bt=Math.ceil(ft.length/25);return we=Nt,(0,i.jsxs)("div",{onClick:()=>qe(!1),children:[k?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between w-full mr-7",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ws,{})}),(0,i.jsxs)("div",{className:"flex justify-between items-center gap-5 pt-5",children:[Array.isArray(f)&&f.length>0&&Array.isArray(we)&&we.length>0?(0,i.jsxs)("div",{className:"flex justify-between items-center gap-3",children:[(0,i.jsx)("p",{className:"text_size_5 text-dark_grey",children:"Approve All"}),(0,i.jsx)("input",{type:"checkbox",id:"exampleCheckbox",className:"h-4 w-4 cursor-pointer",checked:He,onChange:e=>{const t=e.target.checked;We(t),t?xt():gt()}})]}):"",Array.isArray(Le)&&(null===Le||void 0===Le?void 0:Le.length)>0&&Array.isArray(f)&&(null===f||void 0===f?void 0:f.length)>0?(0,i.jsx)(Hs,{handleSelectItem:e=>{Ye(e)},storeLocation:Le,setIsOpen:qe,isOpen:Be}):null,(0,i.jsx)(ls,{allEmpDetails:w,searchResult:async e=>{try{const t=await e;Ke(t)}catch(t){}},secondaryData:E,Position:d,placeholder:"Sap No / Name"})]})]}),(0,i.jsx)("div",{className:"table-container ",children:(0,i.jsxs)("table",{className:"styled-table w-[100%]",children:[(0,i.jsx)("thead",{className:"sticky-header border ",children:(0,i.jsxs)("tr",{className:"text_size_5 h-16",children:[(0,i.jsx)("td",{className:"px-5 flex-1 text_size_7",children:"S No."}),null!==(a=null===lt||void 0===lt?void 0:lt.tableHeader.map(((e,t)=>(0,i.jsx)("td",{className:"px-5 flex-1 text_size_7",children:e},t))))&&void 0!==a?a:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center",children:"No headers available"})}),!G&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"STATUS"}),(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"APPROVE"}),(0,i.jsx)("td",{className:"".concat("Rejected"===u?"hidden":"px-5 flex-1 text_size_7"),children:"REJECT"})]}),h&&h.length>0||se&&se?(0,i.jsx)("td",{children:"Edited"}):""]})}),(0,i.jsx)("tbody",{children:we&&we.length>0?we.map(((e,t)=>{const a=(e,a)=>{const r="Pending"===(null===e||void 0===e?void 0:e.status),s=25*(be-1)+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[50px] text-sm rounded-sm shadow-md border-b-2 border-[#CECECE] bg-white hover:bg-[#f1f5f9] ".concat(l&&l.length>0?"":"cursor-pointer"),onClick:()=>{l&&l.length>0||(rt(),(e=>{R(e)})(e),Me("Manager"===d?"View Form":"Edit Form"))},children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:s}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.NAME}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.TRADE}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.NO}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.LOCATION}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:ht(null===e||void 0===e?void 0:e.DATE)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS2)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.TOTALHOURS3)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.NORMALWORKINGHRSPERDAY)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.WORKINGHOURS)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.OT)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.REMARKS}),r&&(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("td",{className:"text-center px-4 flex-1 ".concat("Approved"===(null===e||void 0===e?void 0:e.status)?"text-[#0CB100]":"text_size_8"),children:null===e||void 0===e?void 0:e.status}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4 cursor-pointer",type:"checkbox",checked:Te[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Ce((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Pe((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Approved"),mt(e,"Rejected")):(Ce((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Approved"))}})}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{className:"h-4 w-4 cursor-pointer",type:"checkbox",checked:Re[e.id]||!1,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?(Pe((a=>(0,g.A)((0,g.A)({},a),{},{[e.id]:t.target.checked}))),Ce((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),pt(e,"Rejected"),ct(),mt(e,"Approved")):(Pe((t=>(0,g.A)((0,g.A)({},t),{},{[e.id]:!1}))),mt(e,"Rejected"))}})})]}),h&&h.length>0||se&&se?(0,i.jsx)("td",{className:"cursor-pointer px-4 py-2",onClick:e=>e.stopPropagation(),children:(0,i.jsx)("input",{type:"checkbox",disabled:!Qe.some((t=>t.id===e.id)),checked:Qe.some((t=>t.id===e.id)),onChange:()=>Ze(e)})}):""]},t+1)};return("Manager"===F||"Manager"!==F)&&a(e)})):null!==(s=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})}))&&void 0!==s?s:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"px-6 py-6 text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"px-6 py-6",children:"Please wait few seconds."})})})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center my-5 mt-10 ".concat(we&&we.length>0?"":"hidden"),children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center",children:(0,i.jsx)("button",{className:"rounded px-3 py-2.5 w-52 bg-[#FEF116] text_size_5 text-dark_grey ".concat(Qe&&Qe.length>0||xe&&xe.length>0||fe&&fe.length>0||l?"bg-[#FEF116]":"bg-[#eee542] cursor-not-allowed"),disabled:"Manager"!==F?!((null===Qe||void 0===Qe?void 0:Qe.length)>0||l):!((null===xe||void 0===xe?void 0:xe.length)>0||(null===fe||void 0===fe?void 0:fe.length)>0),onClick:()=>{"Manager"!==F?Qe&&Qe.length>0?st():l&&l&&dt():"Manager"===F&&(ut(),ot())},children:"Manager"===F?"Finalize and Submit":h&&h.length>0||"Rejected"===u?"Assign Manager":"Submit"})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Ss,{totalPages:bt,currentPage:be,paginate:e=>De(e)})})]})]}):"",!1===k&&!0===D&&(0,i.jsx)(os,{setClosePopup:A}),!0===P&&(0,i.jsx)(hs,{toggleFunction:rt,editObject:C,fieldObj:(null===lt||void 0===lt?void 0:lt.fieldObj)||{},fields:(null===lt||void 0===lt?void 0:lt.fields)||[],tableHeader:(null===lt||void 0===lt?void 0:lt.tableHeader)||[],editFunction:e=>{try{var t;const a=Array.isArray(null===(t=w[0])||void 0===t?void 0:t.data)?((e,t)=>e.map((e=>({id:e.id,data:e.data.map((e=>e.NO===t.NO?t:e))}))))(w,e):((e,t)=>e.map((e=>e.NO===t.NO?t:e)))(w,e),r=null===a||void 0===a?void 0:a.map((e=>{var t,a;Array.isArray(null===e||void 0===e?void 0:e.jobLocaWhrs)&&(null===e||void 0===e||null===(t=e.jobLocaWhrs)||void 0===t?void 0:t.length)>0?e.LOCATIONATTOP=null===e||void 0===e||null===(a=e.jobLocaWhrs[0])||void 0===a?void 0:a.LOCATION:e.LOCATIONATTOP=null;return e}));S(r)}catch(a){}},titleName:c,Position:d,handleSubmit:Xe,editFormTitle:Oe,empAndWorkInfo:tt}),!0===Ee?(0,i.jsx)(xs,{toggleSFAMessage:nt,icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Processing...",message:"Data is being saved, ",messageTwo:"This might take a few seconds..."}):!1===Ee?(0,i.jsx)(gs,{successMess:U,toggleSFAMessage:nt,setExcelData:p,userIdentification:F}):"",!0===W&&(0,i.jsx)(Ns,{toggleFunctionForAssiMana:st,renameKeysFunctionAndSubmit:ot,mergedData:Se}),!0===Y&&(0,i.jsx)(bs,{toggleForRemarkFunc:ct,addRemarks:async e=>{const t=fe&&fe.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},e),{},{REMARKS:e.REMARKS}):t));ve(t)},passSelectedData:ye,addEditedRemarks:e=>{const t=w&&w.length>0&&w.map((t=>t.id===e.id?(0,g.A)((0,g.A)({},t),{},{REMARKS:e.REMARKS}):t));S(t)}}),K&&(0,i.jsx)(_s,{text:$}),q&&(0,i.jsx)(_s,{text:"Please wait a few seconds..."}),X&&de?(0,i.jsx)(Fs,{onClose:()=>{y.current=!1,ee(!1)},setCancelAction:e=>{v.current=e,ae(e),T(null)},fileNameForSuccessful:m,title:"Duplicate Detection",message:de.message,buttonName:de.buttonName,popupIdentification:"duplicateRecords",onClearData:()=>{T(null),S(null),p(null)}}):"",pe&&(0,i.jsx)(qs,{handleDecision:e=>{me(!1),dt(e)},alertMessage:ue})]})},li=async e=>{let{fileNameForSuccessful:t,title:a}=e,r=null,n=[];const s=(0,Ee.D)();return t&&await(async()=>{let e=null;try{do{var i,l,o,d;const t=await s.graphql({query:Ie.Oy,variables:{limit:800,nextToken:e}}),a=(null===t||void 0===t||null===(i=t.data)||void 0===i||null===(l=i.listTimeSheets)||void 0===l?void 0:l.items)||[];e=null===t||void 0===t||null===(o=t.data)||void 0===o||null===(d=o.listTimeSheets)||void 0===d?void 0:d.nextToken,n=[...n,...a]}while(e);const c=new Map;for(const e of n){const t="".concat(e.fileName,"|").concat(e.fileType);c.set(t,e)}const p="".concat(t,"|").concat(a);r=c.has(p)?"fileNameAlreadyExistsInDB":"Not Matched"}catch(c){r="Not Matched",console.error("Error fetching timesheet:",c)}})(),{isExcelExitsOrNot:r}},oi=((0,Ee.D)(),e=>{let{title:t,submittedData:a,ManagerData:s,showing:l}=e;const o=(0,n.useRef)(null),[d,c]=(0,n.useState)(""),[p,m]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[x,f]=(0,n.useState)(""),[v,y]=(0,n.useState)(!0),[N,b]=(0,n.useState)(null),[D,j]=(0,n.useState)(null),[A,w]=(0,n.useState)(),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)(""),[T,C]=(0,n.useState)(0),[R,P]=(0,n.useState)(!1),[O,_]=(0,n.useState)(!1),[M,F]=(0,n.useState)(""),[L,U]=(0,n.useState)(!1),B=localStorage.getItem("userType"),q=(0,r.Zp)();(0,n.useEffect)((()=>{k(!0===O?"ORMC":t)}),[O]),(0,n.useEffect)((()=>{F("Manager"===B?"Manager":"rejectedItems")}),[B,T]);const{finalData:H}=((e,t)=>{const[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(null),[l,o]=(0,n.useState)(null),c=(0,Ee.D)();return(0,n.useEffect)((()=>{const a=localStorage.getItem("userType");o(a),(async()=>{r(!0);let a=null,n=[];const s={and:["Manager"===t?{status:{eq:"Pending"}}:"viewTimeSheet"===t?{fileType:{eq:e}}:"viewSummary"===t?{status:{eq:"Approved"},fileType:{eq:e}}:"rejectedItems"===t?{status:{eq:"Rejected"},fileType:{eq:e}}:"All"===t?{status:{eq:"All"},fileType:{eq:e}}:{status:{eq:"nothing"},fileType:{eq:e}}].filter(Boolean)};try{do{var l,o,p,m;const e=await c.graphql({query:Ie.Oy,variables:{filter:s,limit:800,nextToken:a}}),t=(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(o=l.listTimeSheets)||void 0===o?void 0:o.items)||[];a=null===e||void 0===e||null===(p=e.data)||void 0===p||null===(m=p.listTimeSheets)||void 0===m?void 0:m.nextToken;const r=t.filter((e=>null!==e&&void 0!==e));n=[...n,...r]}while(a);0===n.length?i([]):i(n)}catch(d){i([])}finally{r(!1)}})()}),[e,t]),{finalData:s}})(I,M),{wholeData:W,loadingState:z,showRejectTable:Y}=(e=>{let{finalData:t}=e;const a=localStorage.getItem("userType"),[r,s]=(0,n.useState)({isLoading:!0,message:"Loading..."}),[i,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)([]);return(0,n.useEffect)((()=>{"Manager"!==a&&t&&t.length>0?(async()=>{const e=await As(t);e&&e.length>0?(d(e),l(!0),s({isLoading:!1,message:"Working..."})):s({isLoading:!0,message:"No Data Available"})})():"Manager"!==a&&t&&0===t.length?s({isLoading:!0,message:"No Data Available"}):"Manager"===a||t||s({isLoading:!0,message:"Please wait few seconds..."})}),[t,a]),{wholeData:o,loadingState:r,showRejectTable:i}})({finalData:H}),{managerWholeData:V,loadingStateManager:G,showManagerTable:J}=(e=>{let{ManagerData:t}=e;const a=localStorage.getItem("userType"),[r,s]=(0,n.useState)({isLoading:!0,message:"Loading..."}),[i,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)([]);return(0,n.useEffect)((()=>{"Manager"===a&&t&&t.length>0?(async()=>{const e=await ys(t);e&&e.length>0?(d(e),l(!0),s({isLoading:!1,message:"Working..."})):s({isLoading:!0,message:"No Data Available"})})():"Manager"===a&&t&&0===t.length?s({isLoading:!0,message:"No Data Available"}):"Manager"!==a||t||s({isLoading:!0,message:"Please wait few seconds..."})}),[t,a]),{managerWholeData:o,loadingStateManager:r,showManagerTable:i}})({ManagerData:s}),K=async()=>{try{if("Offshore"===I){const e=ti(N,E,b,o,P);w(e),o.current.value="",b(null)}else if("ORMC"===I){const e=((e,t,a,r,n)=>{try{if(null!==e){const l=ei.LF(e,{type:"buffer"}),o=l.SheetNames,c=[],p=[];var s=!1;o.map((e=>{const t=ei.Wp.sheet_to_json(l.Sheets[e]);c.push({sheetName:e,data:t})}));const m=c&&c.map((e=>{const t=e.data;var a=t.slice(0,1);const r=a.some((e=>["NAME","DATE"].every((t=>t in e))));s=r;var n=t.slice(0);return p.push(n),a}));if(!0===s){const u=(e,t)=>{if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}};function h(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const x=p.flat().map((e=>{const t={};for(const a in e)t[h(a)]=e[a];return t})),g=x&&x.map((e=>{if("number"===typeof e.IN&&(e.IN=u(e.IN,"time")),"number"===typeof e.OUT&&(e.OUT=u(e.OUT,"time")),"number"===typeof e.DATE){const t=u(e.DATE,"date"),a=new Date(t);e.DATE=a.toLocaleDateString()}return e})),f=(async e=>{try{const t={},a=null===e||void 0===e?void 0:e.reduce(((e,a)=>{var r;const n=null===(r=a.BADGE)||void 0===r?void 0:r.trim();if(a.DATE&&(t[n]=a.DATE),a.IN&&a.OUT&&!a.DATE){const e=t[n];e&&(a.DATE=e)}return e.push(a),e}),[]),r=e=>{var t;return null===e||void 0===e||null===(t=e.replace(/\(\w+\)/,""))||void 0===t?void 0:t.trim()},n=e=>{const[t,a,r]=e.split("/"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(s,"/").concat(n,"/").concat(r," ")};return a.forEach((e=>{if(e.DATE&&"string"===typeof e.DATE){const t=r(e.DATE);try{e.DATE=n(t)}catch(d){console.error("Date format error in:",t)}}})),a}catch(t){console.log("Error : ",t)}})(g),v=f&&f.length>0?f:g&&g.length>0?g:[];return t(null===v||void 0===v?void 0:v.filter((e=>e.IN&&e.OUT))),n(!1),m.flat()}return s}r.current.value="",a(null)}catch(i){}})(N,E,b,o,P);if(w(e),!1===e){const e=await((e,t,a,r,n)=>{if(null!==e){const s=ei.LF(e,{type:"buffer"}),i=s.SheetNames,l=[],o=[];i.map((e=>{const t=ei.Wp.sheet_to_json(s.Sheets[e]);l.push({sheetName:e,data:t})}));const c=l&&l.map((e=>{const t=e.data;var a=t.slice(1,2);const r=a.map((e=>Object.entries(e).map((e=>{let[t,a]=e;return[{key:t,value:a}]})))).flat().flat();return t.slice(2).forEach((e=>{const t={};Object.entries(e).forEach((e=>{let[a,n]=e;const s=r.find((e=>e.key===a));s&&(t[s.value]=n)})),o.push(t)})),a})),p=(e,t)=>{if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}};function m(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const u=o.map((e=>{const t={};for(const a in e)t[m(a)]=e[a];return t})),h=u&&u.map((e=>{if("number"===typeof e.IN&&(e.IN=p(e.IN,"time")),"number"===typeof e.OUT&&(e.OUT=p(e.OUT,"time")),"number"===typeof e.DATE){const t=p(e.DATE,"date"),a=new Date(t);e.DATE=a.toLocaleDateString()}return e})),x=(async e=>{try{const t={},a=null===e||void 0===e?void 0:e.reduce(((e,a)=>{var r;const n=null===(r=a.BADGE)||void 0===r?void 0:r.trim();if(a.DATE&&(t[n]=a.DATE),a.IN&&a.OUT&&!a.DATE){const e=t[n];e&&(a.DATE=e)}return e.push(a),e}),[]),r=e=>{var t;return null===e||void 0===e||null===(t=e.replace(/\(\w+\)/,""))||void 0===t?void 0:t.trim()},n=e=>{const[t,a,r]=e.split("/"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(s,"/").concat(n,"/").concat(r," ")};return a.forEach((e=>{if(e.DATE&&"string"===typeof e.DATE){const t=r(e.DATE);try{e.DATE=n(t)}catch(d){console.error("Date format error in:",t)}}})),a}catch(t){console.log("Error : ",t)}})(h);t((x&&x.length>0?x:h&&h.length>0?h:[]).filter((e=>e.IN&&e.OUT)));const g=(e=>e.map((e=>e.map((e=>Object.entries(e).reduce(((e,t)=>{let[a,r]=t;return e[r]=a,e}),{}))))))(c);return n(!1),g.flat()}r.current.value="",a(null)})(N,E,b,o,P);w(e)}o.current.value="",b(null)}else if("Offshore's ORMC"===I){const e=ti(N,E,b,o,P);w(e),o.current.value="",b(null)}else if("SBW"===I){const e=((e,t,a,r,n)=>{try{if(null!==e){const l=ei.LF(e,{type:"buffer"}),o=l.SheetNames,c=[],p=[];var s=!1;o.forEach((e=>{const t=ei.Wp.sheet_to_json(l.Sheets[e]);c.push({sheetName:e,data:t})}));const m=c&&c.map((e=>{const t=e.data;var a=t.slice(0,1);const r=a.some((e=>["NAME","DATE"].every((t=>t in e))));s=r;var n=t.slice(0);return p.push(n),a}));if(!0===s){const u=(e,t)=>{if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}};function h(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const x=p.flat().map((e=>{const t={};for(const a in e)t[h(a)]=e[a];return t})),g=x&&x.map((e=>{if("number"===typeof e.IN&&(e.IN=u(e.IN,"time")),"number"===typeof e.OUT&&(e.OUT=u(e.OUT,"time")),"number"===typeof e.DATE){const t=u(e.DATE,"date"),a=new Date(t);e.DATE=a.toLocaleDateString()}return e})),f=(async e=>{try{const t={},a=null===e||void 0===e?void 0:e.reduce(((e,a)=>{var r;const n=null===(r=a.BADGE)||void 0===r?void 0:r.trim();if(a.DATE&&(t[n]=a.DATE),a.IN&&a.OUT&&!a.DATE){const e=t[n];e&&(a.DATE=e)}return e.push(a),e}),[]),r=e=>{var t;return null===e||void 0===e||null===(t=e.replace(/\(\w+\)/,""))||void 0===t?void 0:t.trim()},n=e=>{const[t,a,r]=e.split("/"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(s,"/").concat(n,"/").concat(r," ")};return a.forEach((e=>{if(e.DATE&&"string"===typeof e.DATE){const t=r(e.DATE);try{e.DATE=n(t)}catch(d){console.error("Date format error in:",t)}}})),a}catch(t){console.log("Error : ",t)}})(g),v=f&&f.length>0?f:g&&g.length>0?g:[];return t(null===v||void 0===v?void 0:v.filter((e=>e.IN&&e.OUT))),n(!1),m.flat()}return s}r.current.value="",a(null)}catch(i){}})(N,E,b,o,P);if(w(e),!1===e){const e=await((e,t,a,r,n)=>{if(null!==e){const s=ei.LF(e,{type:"buffer"}),i=s.SheetNames,l=[],o=[];i.forEach((e=>{const t=ei.Wp.sheet_to_json(s.Sheets[e]);l.push({sheetName:e,data:t})}));const c=l&&l.map((e=>{const t=e.data;var a=t.slice(1,2);const r=a.map((e=>Object.entries(e).map((e=>{let[t,a]=e;return[{key:t,value:a}]})))).flat().flat();return t.slice(2).forEach((e=>{const t={};Object.entries(e).forEach((e=>{let[a,n]=e;const s=r.find((e=>e.key===a));s&&(t[s.value]=n)})),o.push(t)})),a})),p=(e,t)=>{if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}};function m(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const u=o.map((e=>{const t={};for(const a in e)t[m(a)]=e[a];return t})),h=u&&u.map((e=>{if("number"===typeof e.IN&&(e.IN=p(e.IN,"time")),"number"===typeof e.OUT&&(e.OUT=p(e.OUT,"time")),"number"===typeof e.DATE){const t=p(e.DATE,"date"),a=new Date(t);e.DATE=a.toLocaleDateString()}return e})),x=(async e=>{try{const t={},a=null===e||void 0===e?void 0:e.reduce(((e,a)=>{var r;const n=null===(r=a.BADGE)||void 0===r?void 0:r.trim();if(a.DATE&&(t[n]=a.DATE),a.IN&&a.OUT&&!a.DATE){const e=t[n];e&&(a.DATE=e)}return e.push(a),e}),[]),r=e=>{var t;return null===e||void 0===e||null===(t=e.replace(/\(\w+\)/,""))||void 0===t?void 0:t.trim()},n=e=>{const[t,a,r]=e.split("/"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(s,"/").concat(n,"/").concat(r," ")};return a.forEach((e=>{if(e.DATE&&"string"===typeof e.DATE){const t=r(e.DATE);try{e.DATE=n(t)}catch(d){console.error("Date format error in:",t)}}})),a}catch(t){console.log("Error : ",t)}})(h),g=x&&x.length>0?x:h&&h.length>0?h:[];t(null===g||void 0===g?void 0:g.filter((e=>e.IN&&e.OUT)));const f=c.map((e=>e.map((e=>Object.entries(e).reduce(((e,t)=>{let[a,r]=t;return e[r]=a,e}),{})))));return n(!1),f.flat()}r.current.value="",a(null)})(N,E,b,o,P);w(e)}o.current.value="",b(null)}else if("HO"===I){const e=((e,t,a,r,n)=>{try{if(null!==e){const l=ei.LF(e,{type:"buffer"}),o=l.SheetNames,c=[],p=[];var s=!1;o.forEach((e=>{const t=ei.Wp.sheet_to_json(l.Sheets[e]);c.push({sheetName:e,data:t})}));const m=c&&c.map((e=>{const t=e.data;var a=t.slice(0,1);const r=a.some((e=>["NAME","DATE"].every((t=>t in e))));s=r;var n=t.slice(0);return p.push(n),a}));if(!0===s){const u=(e,t)=>{if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}};function h(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const x=p.flat().map((e=>{const t={};for(const a in e)t[h(a)]=e[a];return t})),f=x&&x.map((e=>("number"===typeof e.ONAM&&(e.ONAM=u(e.ONAM,"time")),"number"===typeof e.OFFAM&&(e.OFFAM=u(e.OFFAM,"time")),"number"===typeof e.ONPM&&(e.ONPM=u(e.ONPM,"time")),"number"===typeof e.OFFPM&&(e.OFFPM=u(e.OFFPM,"time")),"number"===typeof e.IN&&(e.IN=u(e.IN,"time")),"number"===typeof e.OUT&&(e.OUT=u(e.OUT,"time")),e))),v=(e=>{try{const t=e.reduce(((e,t)=>{const a=(0,g.A)({},t);if(a.IN&&a.OUT){const t=[...e].reverse().find((e=>e.BADGE===a.BADGE&&e.DATE));t&&(a.DATE=t.DATE)}return[...e,a]}),[]),a=e=>{var t;return null===e||void 0===e||null===(t=e.replace(/\(\w+\)/,""))||void 0===t?void 0:t.trim()},r=e=>{const[t,a,r]=e.split("/"),n=parseInt(a,10),s=parseInt(r,10);return"".concat(n,"/").concat(s,"/").concat(t)};return t.forEach((e=>{if(e.DATE&&"string"===typeof e.DATE){const t=a(e.DATE);try{e.DATE=r(t)}catch(d){console.error("Date format error in:",t)}}})),t}catch(t){console.log("Error : ",t)}})(f);function y(e){return e.filter((e=>e.IN&&e.OUT))}return t(y(v&&v.length>0?v:f&&f.length>0?f:[])),n(!1),m.flat()}return s}r.current.value="",a(null)}catch(i){}})(N,E,b,o,P);if(w(e),!1===e){const e=((e,t,a,r,n)=>{try{if(null!==e){const i=ei.LF(e,{type:"buffer"}),l=i.SheetNames,o=[],c=[];l.forEach((e=>{const t=ei.Wp.sheet_to_json(i.Sheets[e]);o.push({sheetName:e,data:t})}));const p=o&&o.map((e=>{const t=e.data;var a=t.slice(1,2);const r=a.map((e=>Object.entries(e).map((e=>{let[t,a]=e;return[{key:t,value:a}]})))).flat().flat();return t.slice(2).forEach((e=>{const t={};Object.entries(e).forEach((e=>{let[a,n]=e;const s=r.find((e=>e.key===a));s&&(t[s.value]=n)})),c.push(t)})),a})),m=(e,t)=>{if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}};function u(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const h=c.map((e=>{const t={};for(const a in e)t[u(a)]=e[a];return t})),x=h&&h.map((e=>("number"===typeof e.ONAM&&(e.ONAM=m(e.ONAM,"time")),"number"===typeof e.OFFAM&&(e.OFFAM=m(e.OFFAM,"time")),"number"===typeof e.ONPM&&(e.ONPM=m(e.ONPM,"time")),"number"===typeof e.OFFPM&&(e.OFFPM=m(e.OFFPM,"time")),"number"===typeof e.IN&&(e.IN=m(e.IN,"time")),"number"===typeof e.OUT&&(e.OUT=m(e.OUT,"time")),e))),f=(e=>{try{const t=e.reduce(((e,t)=>{const a=(0,g.A)({},t);if(a.IN&&a.OUT){const t=[...e].reverse().find((e=>e.BADGE===a.BADGE&&e.DATE));t&&(a.DATE=t.DATE)}return[...e,a]}),[]),a=e=>{var t;return null===e||void 0===e||null===(t=e.replace(/\(\w+\)/,""))||void 0===t?void 0:t.trim()},r=e=>{const[t,a,r]=e.split("/"),n=parseInt(a,10),s=parseInt(r,10);return"".concat(n,"/").concat(s,"/").concat(t)};return t.forEach((e=>{if(e.DATE&&"string"===typeof e.DATE){const t=a(e.DATE);try{e.DATE=r(t)}catch(d){console.error("Date format error in:",t)}}})),t}catch(t){console.log("Error : ",t)}})(x);t((f&&f.length>0?f:x&&x.length>0?x:[]).filter((e=>e.IN&&e.OUT)));const v=(e=>e.map((e=>e.map((e=>Object.entries(e).reduce(((e,t)=>{let[a,r]=t;return e[r]=a,e}),{}))))))(p);return n(!1),v.flat()}r.current.value="",a(null)}catch(s){console.log("ERROR : ",s)}})(N,E,b,o,P);w(e)}o.current.value="",b(null)}else if("BLNG"===I){const e=((e,t,a,r,n)=>{try{if(null!==e){const i=ei.LF(e,{type:"buffer",cellStyles:!0}),l=i.SheetNames,o=[],d=[],c=[];l.forEach((e=>{const t=ei.Wp.sheet_to_json(i.Sheets[e]);o.push({sheetName:e,data:t})}));const p=o&&o.map((e=>{const t=e.data;var a=t.slice(0,1);const r=a.map((e=>Object.entries(e).map((e=>{let[t,a]=e;return[{key:t,value:a}]})))).flat().flat();return t.slice(1).forEach((e=>{const t={};Object.entries(e).forEach((e=>{let[a,n]=e;const s=r.find((e=>e.key===a));s&&(t[s.value]=n)})),c.push(t)})),a}));function m(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"")}const u=c.map((e=>{const t={};for(const a in e)t[m(a).toUpperCase()]=e[a];return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:"",WORKINGHOURS:"",OT:"",REMARKS:""})}));d.push(u);const h=(e,t)=>{if("dateTime"===t){const t=new Date(1899,11,30),a=24*e*60*60*1e3;return new Date(t.getTime()+a)}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("Avg. Daily Total By Day"===t){const t=Math.round(24*e*60),a=Math.floor(t/60),r=t%60,n=String(a).padStart(2,"0"),s=String(r).padStart(2,"0");return"".concat(n,":").concat(s)}},x=e=>e.toLocaleString("en-US",{day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),f=d.flat(),v=(f&&f.map((e=>{if("number"===typeof e.EXITDATETIME){const t=h(e.EXITDATETIME,"dateTime");e.EXITDATETIME=x(t)}if("number"===typeof e.ENTRANCEDATETIME){const t=h(e.ENTRANCEDATETIME,"dateTime");e.ENTRANCEDATETIME=x(t)}if("number"===typeof e.ENTRANCEDATEUSED){const t=h(e.ENTRANCEDATEUSED,"date"),a=new Date(t);e.ENTRANCEDATEUSED=a.toLocaleDateString()}if("number"===typeof e.AVGDAILYTOTALBYDAY){const t=h(e.AVGDAILYTOTALBYDAY,"Avg. Daily Total By Day");e.AVGDAILYTOTALBYDAY=t}if("number"===typeof e.ADININWORKSENGINEERINGSDNBHD){const t=h(e.ADININWORKSENGINEERINGSDNBHD,"Avg. Daily Total By Day");e.ADININWORKSENGINEERINGSDNBHD=t}return e}))).reduce(((e,t)=>{const{FID:a,NAMEFLAST:r,ENTRANCEDATEUSED:n,ENTRANCEDATETIME:s,EXITDATETIME:i,AVGDAILYTOTALBYDAY:l,ADININWORKSENGINEERINGSDNBHD:o}=t,d=(0,is.A)(t,ai),c=e[e.length-1]||{},p=a||c.FID,m=r||c.NAMEFLAST,u=n||c.ENTRANCEDATEUSED,h=e.find((e=>e.FID===p&&e.NAMEFLAST===m&&e.ENTRANCEDATEUSED===u));return h?(h.ENTRANCEDATETIME.push(s),h.EXITDATETIME.push(i)):e.push((0,g.A)({FID:p||"",NAMEFLAST:m||"",ENTRANCEDATEUSED:n,ENTRANCEDATETIME:[s],EXITDATETIME:[i],AVGDAILYTOTALBYDAY:l,ADININWORKSENGINEERINGSDNBHD:l},d)),e}),[]);v.forEach((e=>{e.FID&&e.ENTRANCEDATEUSED&&(e.EXITDATETIME.length>1&&(e.EXITDATETIME=[e.EXITDATETIME[e.EXITDATETIME.length-1]]),e.ENTRANCEDATETIME.length>1&&(e.ENTRANCEDATETIME=[e.ENTRANCEDATETIME[0]]))})),t(v),n(!1);return p.flat().map((e=>{let t={};return Object.values(e).forEach((e=>{t[e]=e})),t}))}r.current.value="",a(null)}catch(s){}})(N,E,b,o,P);w(e);let t=!1;if(e.forEach((e=>{Object.keys(e).forEach((e=>{Number.isInteger(Number(e))&&(t=!0)}))})),!0===t){const e=((e,t,a,r,n)=>{try{if(null!==e){const l=ei.LF(e,{type:"buffer"}),o=l.SheetNames,d=[],c=[];var s=!1;o.forEach((e=>{const t=ei.Wp.sheet_to_json(l.Sheets[e]);d.push({sheetName:e,data:t})}));const p=d&&d.map((e=>{const t=e.data;var a=t.slice(0,1);const r=a.some((e=>["FID","Name (FLAST)"].every((t=>t in e))));s=r;var n=t.slice(0);return c.push(n),a}));if(!0===s){function m(e){return"string"!==typeof e?e:e.replace(/[^a-zA-Z0-9]/g,"").toUpperCase()}const u=c.flat().map((e=>{const t={};for(const a in e)t[m(a)]=e[a];return(0,g.A)((0,g.A)({},t),{},{NORMALWORKINGHRSPERDAY:"",WORKINGHOURS:"",OT:"",REMARKS:""})}));function h(e){const t=Math.round(86400*(e-25569)*1e3),a=new Date(t),r=e=>String(e).padStart(2,"0");let n=a.getUTCHours();const s=r(a.getUTCMinutes()),i=r(a.getUTCSeconds()),l=n>=12?"PM":"AM";n=n%12||12,n=String(n);const o=a.getUTCDate(),d=a.getUTCMonth()+1,c=a.getUTCFullYear();return"".concat(d,"/").concat(o,"/").concat(c," ").concat(n,":").concat(s,":").concat(i," ").concat(l)}const x=(e,t)=>{if("dateTime"===t){const t=new Date(1899,11,30),a=24*e*60*60*1e3;return new Date(t.getTime()+a)}if("date"===t){const t=new Date(1899,11,30),a=e;return new Date(t.getTime()+24*a*60*60*1e3)}if("time"===t){const t=24*e,a=Math.floor(t),r=60*(t-a),n=Math.floor(r),s=60*(r-n),i=Math.round(s);return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))}if("Avg. Daily Total By Day"===t){const t=Math.round(24*e*60),a=Math.floor(t/60),r=t%60,n=String(a).padStart(2,"0"),s=String(r).padStart(2,"0");return"".concat(n,":").concat(s)}};function f(e){try{const t={};return e.forEach((e=>{const a="".concat(e.FID,"_").concat(e.ENTRANCEDATEUSED),r=new Date(e.ENTRANCEDATETIME),n=new Date(e.EXITDATETIME);if(t[a]){const s=new Date(t[a].ENTRANCEDATETIME);t[a].ENTRANCEDATETIME=r<s?e.ENTRANCEDATETIME:t[a].ENTRANCEDATETIME;const i=new Date(t[a].EXITDATETIME);t[a].EXITDATETIME=n>i?e.EXITDATETIME:t[a].EXITDATETIME}else t[a]=(0,g.A)({},e);t[a].AHIGHLIGHTDAILYTOTALBYGROUP=e.AVGDAILYTOTALBYDAY})),Object.values(t)}catch(t){return console.error("Error in groupAndMergeData:",t),[]}}return t(f(u&&u.map((e=>{if("number"===typeof e.EXITDATETIME&&(e.EXITDATETIME=h(e.EXITDATETIME)),"number"===typeof e.ENTRANCEDATETIME&&(e.ENTRANCEDATETIME=h(e.ENTRANCEDATETIME)),"number"===typeof e.ENTRANCEDATEUSED){const t=x(e.ENTRANCEDATEUSED,"date");let a=new Date(t).toLocaleDateString();const r=e=>{const[t,a,r]=e.split("/"),n=parseInt(t,10),s=parseInt(a,10);return"".concat(n,"/").concat(s,"/").concat(r)};e.ENTRANCEDATEUSED=r(a)}return e})))),n(!1),p.flat()}return s}r.current.value="",a(null)}catch(i){}})(N,E,b,o,P);w(e)}o.current.value="",b(null)}}catch(e){}},{setStartDate:Q,setEndDate:$,setSearchQuery:Z}=(0,Fe.b)();return 0===l&&"Manager"!==B?(0,i.jsx)("div",{className:"flex items-center justify-center h-[82vh] bg-transparent",children:(0,i.jsx)("div",{className:"flex justify-between gap-2",children:(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading "}),(0,i.jsx)("p",{children:(0,i.jsx)(Fr.TwU,{className:"animate-spin mt-[4px]",size:15})})]})})}):(0,i.jsxs)("div",{className:"p-10 bg-[#fafaf6] min-h-screen  flex-col items-center",onClick:()=>{U(!1)},children:[(0,i.jsxs)("div",{className:"flex ".concat("Manager"===B?"justify-start":"justify-between","  mt-5 "),children:[(0,i.jsx)("div",{className:"text-start ",children:(0,i.jsx)("i",{className:"text-xl flex-1 text-grey cursor-pointer",onClick:()=>{Z(null),Q(null),$(null),q("/timeSheet")},children:(0,i.jsx)(Tt.QVr,{})})}),"Manager"!==B&&(0,i.jsxs)("div",{className:"flex justify-center gap-11  pr-5",children:[a&&a.length>0?(0,i.jsx)("p",{className:"".concat(0===T&&"border-b-4 border-b-primary"," pb-1 cursor-pointer text_size_5"),onClick:()=>{C(0)},children:"".concat(t," Submitted Items")}):(0,i.jsx)("p",{className:"".concat(0===T&&"border-b-4 border-b-primary"," pb-1 cursor-pointer text_size_5"),onClick:()=>{C(0)},children:"Upload ".concat(t," Excel Sheet")}),(0,i.jsx)("p",{className:"".concat(1===T&&"border-b-4 border-b-primary"," pb-1 cursor-pointer text_size_5"),onClick:()=>{C(1)},children:"".concat(t," Rejected Items")})]}),(0,i.jsx)("div",{})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:" m-9 screen-size my-5  flex flex-col items-center gap-3",children:[(0,i.jsx)("p",{className:"".concat(0===T&&2===l||"Manager"===B?"text-2xl font-semibold text-dark_grey uppercase mt-4":"hidden"),children:t}),"Manager"!==B&&0===T&&2===l&&0===a.length&&(0,i.jsx)("div",{className:"my-2 flex flex-col gap-5",children:(0,i.jsxs)("div",{className:"flex gap-5",children:[(0,i.jsxs)("div",{className:" flex flex-col items-center  gap-5",children:[(0,i.jsx)("div",{className:"border-[#30303080] border-2",children:(0,i.jsx)("input",{className:"outline-none py-2 px-3 text-sm w-64",type:"text",placeholder:"Please Upload the Time Sheet",value:p||"",onChange:e=>{m(e.target.value)},readOnly:!0})}),(0,i.jsxs)("div",{className:"flex gap-2 p",children:[(0,i.jsx)("span",{children:(0,i.jsx)(ut.dnm,{className:"text-xs mt-1.5"})}),(0,i.jsx)("span",{className:"text-dark_grey",children:"XLS / CSV Files only"})]})]}),(0,i.jsxs)("div",{className:"",children:[!p&&(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"text_size_4 border-[#30303080] border-2 py-1 px-10 text-dark_grey rounded-md bg-[#FEF116]",onClick:()=>{(async()=>{o.current.click()})()},children:"Upload"})}),p&&(0,i.jsxs)("div",{className:"flex gap-5",children:[(0,i.jsx)("button",{className:"text_size_4 border-[#30303080] border-2 py-1 px-10 text-dark_grey rounded-md bg-[#FEF116]",onClick:()=>{P(!0),setTimeout((()=>{(async()=>{const{isExcelExitsOrNot:e}=await li({fileNameForSuccessful:x,title:t});e&&"fileNameAlreadyExistsInDB"===e?(P(!1),U(!0)):"Not Matched"===e&&await K()})()}),1e3),y(),m()},children:"Submit"}),(0,i.jsx)("button",{className:"text_size_4 border-[#30303080] border-2 py-1 px-10 text-dark_grey rounded-md ",onClick:()=>{m(""),o.current.value=""},children:"Cancel"})]})]}),(0,i.jsx)("input",{ref:o,type:"file",className:"hidden",onChange:e=>{(async e=>{var t,a;f(null===e||void 0===e||null===(t=e.target)||void 0===t||null===(a=t.files[0])||void 0===a?void 0:a.name);let r=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],n=e.target.files[0];if(n)if(m(e.target.files[0].name),e.target.files[0].name,n&&r.includes(n.type)){var s=n&&r.includes(n.type);y(s),j(null);let e=new FileReader;e.readAsArrayBuffer(n),e.onload=e=>{b(e.target.result)}}else j("Please select only excel file types"),b(null)})(e),(e=>{const t=e.target.files[0],a=["xlsx","xls"];if(t){const r=t.name.split(".").pop().toLowerCase();a.includes(r)?c(""):(c("Please upload a valid Excel file."),e.target.value="")}})(e)},accept:".xls,.xlsx"})]})}),0===l&&0===T&&(0,i.jsx)("div",{className:"flex justify-center items-center py-3  w-full",children:(0,i.jsx)("p",{className:"text-dark_grey text_size_5",children:"Loading..."})})]})}),d&&(0,i.jsx)("div",{className:"flex items-center justify-center ",children:(0,i.jsx)(ns,{fileName:p,ensureExcelFile:v,typeError:D,UploadFile:K,setEnsureExcelFile:y,setFileName:m,clearUseRefObject:()=>{o.current.value="",b(null)}})}),(0,i.jsx)("div",{children:!0===R&&(0,i.jsx)("div",{className:"flex justify-center items-center text_size_5 text-dark_grey m-2",children:(0,i.jsx)("p",{children:"Please wait a few seconds..."})})}),S&&0===T&&(0,i.jsxs)("div",{children:["Offshore"===I&&(0,i.jsx)(Ys,{setExcelData:E,excelData:S,returnedTHeader:A,Position:B,titleName:I,fileName:x}),"HO"===I&&(0,i.jsx)(Xs,{setExcelData:E,excelData:S,returnedTHeader:A,Position:B,titleName:I,fileName:x}),"SBW"===I&&(0,i.jsx)($s,{setExcelData:E,excelData:S,returnedTHeader:A,Position:B,titleName:I,fileName:x}),"ORMC"===I&&(0,i.jsx)(Zs,{setExcelData:E,excelData:S,returnedTHeader:A,Position:B,titleName:I,fileName:x}),"Offshore's ORMC"===I&&(0,i.jsx)(ii,{setExcelData:E,excelData:S,returnedTHeader:A,Position:B,titleName:I,fileName:x}),"BLNG"===I&&(0,i.jsx)(Js,{excelData:S,setExcelData:E,returnedTHeader:A,Position:B,titleName:I,fileName:x})]}),!S&&"Manager"===B&&"BLNG"===I&&!G.isLoading&&J&&(0,i.jsx)(Js,{titleName:I,returnedTHeader:null,ManagerData:V,Position:B,fileName:x}),!S&&"Manager"===B&&"HO"===I&&!G.isLoading&&J&&(0,i.jsx)(Xs,{titleName:I,returnedTHeader:null,ManagerData:V,Position:B,fileName:x}),!S&&"Manager"===B&&"SBW"===I&&!G.isLoading&&J&&(0,i.jsx)($s,{titleName:I,returnedTHeader:null,ManagerData:V,Position:B,fileName:x}),!S&&"Manager"===B&&"ORMC"===I&&!G.isLoading&&J&&(0,i.jsx)(Zs,{titleName:I,returnedTHeader:null,ManagerData:V,Position:B,fileName:x}),!S&&"Manager"===B&&"Offshore's ORMC"===I&&!G.isLoading&&J&&(0,i.jsx)(ii,{titleName:I,returnedTHeader:null,ManagerData:V,Position:B,fileName:x}),G.isLoading&&"Manager"===B&&(0,i.jsx)("div",{className:"flex justify-center items-center py-3  w-full",children:(0,i.jsx)("p",{className:"text-dark_grey text_size_5",children:G.message})}),!S&&"Manager"===B&&"Offshore"===I&&!G.isLoading&&J&&(0,i.jsx)(Ys,{titleName:I,returnedTHeader:null,ManagerData:V,Position:B,fileName:x}),z.isLoading&&1===T&&(0,i.jsx)("div",{className:"flex justify-center items-center py-3  w-full",children:(0,i.jsx)("p",{className:"text-dark_grey text_size_5",children:z.message})}),!z.isLoading&&Y&&"Offshore"===I&&"Manager"!==B&&1===T&&(0,i.jsx)(Ys,{titleName:I,showRejectedItemTable:"Rejected",wholeData:W,Position:B}),!z.isLoading&&Y&&"BLNG"===I&&"Manager"!==B&&1===T&&(0,i.jsx)(Js,{titleName:I,showRejectedItemTable:"Rejected",wholeData:W,Position:B}),!z.isLoading&&Y&&"HO"===I&&"Manager"!==B&&1===T&&(0,i.jsx)(Xs,{titleName:I,showRejectedItemTable:"Rejected",wholeData:W,Position:B}),!z.isLoading&&Y&&"ORMC"===I&&"Manager"!==B&&1===T&&(0,i.jsx)(Zs,{titleName:I,showRejectedItemTable:"Rejected",wholeData:W,Position:B}),!z.isLoading&&Y&&"Offshore's ORMC"===I&&"Manager"!==B&&1===T&&(0,i.jsx)(ii,{titleName:I,showRejectedItemTable:"Rejected",wholeData:W,Position:B}),!z.isLoading&&Y&&"SBW"===I&&"Manager"!==B&&1===T&&(0,i.jsx)($s,{titleName:I,showRejectedItemTable:"Rejected",wholeData:W,Position:B}),"Offshore"===I&&"Manager"!==B&&0===T&&1===l&&a.length>0&&(0,i.jsx)(Ys,{titleName:I,allItems:"allItems",submittedData:a,Position:B}),"BLNG"===I&&"Manager"!==B&&0===T&&1===l&&a.length>0&&(0,i.jsx)(Js,{titleName:I,allItems:"allItems",submittedData:a,Position:B}),"HO"===I&&"Manager"!==B&&0===T&&1===l&&a.length>0&&(0,i.jsx)(Xs,{titleName:I,allItems:"allItems",submittedData:a,Position:B}),"SBW"===I&&"Manager"!==B&&0===T&&1===l&&a.length>0&&(0,i.jsx)($s,{titleName:I,allItems:"allItems",submittedData:a,Position:B}),"ORMC"===I&&"Manager"!==B&&0===T&&1===l&&a.length>0&&(0,i.jsx)(Zs,{titleName:I,allItems:"allItems",submittedData:a,Position:B}),"Offshore's ORMC"===I&&"Manager"!==B&&0===T&&1===l&&a.length>0&&(0,i.jsx)(ii,{titleName:I,allItems:"allItems",submittedData:a,Position:B}),u&&(0,i.jsx)("div",{className:"flex flex-col items-center",children:(0,i.jsx)(ss,{fileNameForSuccessful:x,setCloseSavedModel:h,returnedTHeader:[]})}),L&&(0,i.jsx)(Fs,{onClose:()=>{U(!1),o.current.value=""},fileNameForSuccessful:x,title:"Duplicate Detection",message:"This Excel sheet has already been uploaded by the Time Keeper.",buttonName:"OK"})]})}),di=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,l]=(0,n.useState)(0),[o,d]=(0,n.useState)(!0),c=localStorage.getItem("userType"),p="Offshore",m="Manager"===c?"Manager":"Manager"!==c?"Unsubmitted":"",u=(0,n.useMemo)((()=>p),[p]),h=(0,n.useMemo)((()=>m),[m]),{convertedStringToArrayObj:x}=ri(u,h);return(0,n.useEffect)((()=>{if("Manager"!==c){(async()=>{d(!0);try{if(await new Promise((e=>{x&&x.length>0?e(!0):x?0===x.length&&l(2):l(0)}))){const a=await As(x);a&&a.length>0?(t((e=a)&&e.length>0?e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||"",NO:e.fidNo||"",LOCATION:e.location||"",TRADE:e.trade||"",DATE:e.date||"",TOTALHOURS:e.totalNT||0,TOTALHOURS2:e.totalOT||0,TOTALHOURS3:e.totalNTOT||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}})):[]),l(1)):l(2)}else l(2)}catch(a){l(2)}finally{d(!1)}var e})()}else"Manager"===c&&(l(null),r(x))}),[x,c]),(0,i.jsx)("div",{children:(0,i.jsx)(oi,{title:"Offshore",submittedData:e||[],showing:s,ManagerData:a})})},ci=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,l]=(0,n.useState)(0),[o,d]=(0,n.useState)(!0),c=localStorage.getItem("userType"),p="BLNG",m="Manager"===c?"Manager":"Manager"!==c?"Unsubmitted":"",u=(0,n.useMemo)((()=>p),[p]),h=(0,n.useMemo)((()=>m),[m]),{convertedStringToArrayObj:x}=ri(u,h);return(0,n.useEffect)((()=>{if("Manager"!==c){(async()=>{d(!0);try{if(await new Promise((e=>{x&&x.length>0?e(!0):x?0===x.length&&l(2):l(0)}))){const a=await As(x);a&&a.length>0?(t((e=a)&&e.length>0?e.map((e=>{var t,a;let r=[];try{Array.isArray(e.empWorkInfo)&&(r=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(n){}return{id:e.id,fileName:e.fileName,FID:e.fidNo||0,NAMEFLAST:e.empName||"",ENTRANCEDATEUSED:e.date||"",ENTRANCEDATETIME:(null===(t=e.inTime)||void 0===t?void 0:t.replace(/[\[\]]/g,""))||"",EXITDATETIME:(null===(a=e.outTime)||void 0===a?void 0:a.replace(/[\[\]]/g,""))||"",AVGDAILYTOTALBYDAY:e.avgDailyTD||"",AHIGHLIGHTDAILYTOTALBYGROUP:e.totalHrs||"",ADININWORKSENGINEERINGSDNBHD:e.aweSDN||"",WORKINGHOURS:e.actualWorkHrs||0,OT:e.otTime||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:r.flat()||[],fileType:e.fileType,timeKeeper:e.assignBy,manager:e.assignTo,REMARKS:e.remarks||"",status:e.status||""}})):[]),l(1)):l(2)}else l(2)}catch(a){l(2)}finally{d(!1)}var e})()}else"Manager"===c&&(l(null),r(x))}),[x,c]),(0,i.jsx)("div",{children:(0,i.jsx)(oi,{title:"BLNG",submittedData:e||[],showing:s,ManagerData:a})})},pi=e=>{let{handleFilterChange:t,toggleDropdown:a,isOpen:r}=e;const s=localStorage.getItem("userType"),[l,o]=(0,n.useState)("All Records"),d="Manager"===s?["All Records","Pending","Approved","Verified","Rejected"]:"SuperAdmin"===s?["All Records","Unsubmitted","Pending","Approved","Verified","Rejected"]:["All Records","Unsubmitted","Approved","Verified","Rejected"];return(0,i.jsx)("section",{className:"w-fit grid grid-cols-1",children:(0,i.jsxs)("div",{className:"center gap-2 border relative rounded-md p-[9px] text-sm text-secondary border-[#CDCDCD] bg-white cursor-pointer",onClick:a,children:[(0,i.jsx)(j.NDY,{}),(0,i.jsx)("p",{children:"Filter"}),r&&(0,i.jsx)("div",{className:"top-10 absolute w-fit shadow-xl bg-white z-50",children:(0,i.jsx)("div",{className:"p-1 shadow-md flex flex-col bg-white ",children:d.map((e=>(0,i.jsx)("button",{onClick:()=>(e=>{o(e),t(e)})(e),className:"w-full text-left px-4 py-2 text-sm border-b-2 border-white ".concat(l===e?"text-white bg-[#71717a]":"text-dark_grey hover:bg-grey hover:text-white"),children:e},e)))})})]})})},mi=e=>{let{newSearchFunction:t,visibleData:a,message:n,loading:s,totalPages:l,currentPage:o,paginate:d}=e;const{setTimeSheetFileData:c,setShowListTimeSheet:p,setSearchQuery:m}=(0,Fe.b)(),u=(0,r.Zp)(),h=e=>{const t=new Date(e),a=t.getDate(),r=t.getMonth()+1,n=t.getFullYear();return"".concat(a," - ").concat(r," - ").concat(n)};return(0,i.jsxs)("section",{children:[(0,i.jsx)("div",{className:"table-container flex justify-center ",children:(0,i.jsxs)("table",{className:"styled-table w-full",children:[(0,i.jsx)("thead",{className:"sticky-header",children:(0,i.jsxs)("tr",{className:"text_size_6 text-center h-12",children:[(0,i.jsx)("th",{children:"S No."}),(0,i.jsx)("th",{children:"File Name"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Date"}),(0,i.jsx)("th",{children:"View"}),(0,i.jsx)("th",{children:"Status"})]})}),(0,i.jsx)("tbody",{children:!s&&a&&a.length>0?a.map(((e,a)=>(0,i.jsxs)("tr",{className:"text-dark_grey h-[53px] text-[15px] bg-white  rounded-sm shadow-md text-start border-b-2 border-[#CECECE]",children:[(0,i.jsx)("td",{children:a+1}),(0,i.jsx)("td",{children:e.fileName}),(0,i.jsx)("td",{children:e.fileType}),(0,i.jsx)("td",{children:h(e.date)}),(0,i.jsx)("td",{onClick:()=>{(e=>{c(null),m(null),c(e),p(!1),u("/viewTsheetDetails")})(e),t(e)},className:"underline text-dark_skyBlue cursor-pointer",children:"View"}),(0,i.jsx)("td",{className:"Approved"===e.status?"text-[#16a34a] text-[15px] font-bold":"Rejected"===e.status?"text-[#a31f16] text-[15px] font-bold":"Unsubmitted"===e.status?"text-[#f57340] text-[15px] font-bold":"Verified"===e.status?"text-[#9226ad] text-[15px] font-bold":"text-[#272727] text-[15px] font-bold",children:e.status})]},a))):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"15",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsxs)("p",{className:"p-5",children:[!s&&n,s&&n]})})})})]})}),(0,i.jsx)("div",{className:"flex justify-center py-7",children:a.length>0&&(0,i.jsx)(Ss,{totalPages:l,currentPage:o,paginate:d})})]})};var ui=a(9223),hi=a.n(ui),xi=a(2450);const gi=()=>{const e=(0,n.useRef)(null),t=localStorage.getItem("userType"),[a,s]=(0,n.useState)(!1),[l,o]=(0,n.useState)("All Records"),[d,c]=(0,n.useState)(null),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),[x,g]=(0,n.useState)(null),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(1),{startDate:j,setStartDate:A,endDate:w,setEndDate:S,setSearchQuery:E,showListTimeSheet:I,setShowListTimeSheet:k,timeSheetFileData:T,setTimeSheetFileData:C,categoryFilter:R,setCategoryFilter:P,categoryFilters:O,setCategoryFilters:_,tableData:M,setTableData:F}=(0,Fe.b)(),{convertedStringToArrayObj:L}=ri(R,"viewTimeSheet",m,p,v);let U;(0,n.useEffect)((()=>{try{async function a(e){const t={};return e.forEach((e=>{const a=e.updatedAt.split("T")[0],r=e.status,n="".concat(a,"_").concat(r);t[n]||(t[n]={fileName:e.fileName,fileType:e.fileType,date:a,status:r,updatedAt:[]}),t[n].updatedAt.push(e)})),Object.values(t)}const r=async()=>{if("Manager"===t&&"Select Excel Sheet"!==R){var e=(await ys(L,m,v)).filter((e=>"Unsubmitted"!==e.status))}else if("SuperAdmin"===t)e=L;else{e=(await As(L,m,v)).filter((e=>"Pending"!==e.status))}const r=await a(e);g(r),h(r)};"Select Excel Sheet"===R?v("Select an Excel sheet from the dropdown to display data."):L?L&&L.length>0&&r():v("Please wait a few seconds...")}catch(e){}}),[L,R]),(0,n.useEffect)((()=>{if(!u||0===u.length)return;D(1);let e=[...u];if("All Records"!==l&&(e=e.filter((e=>e.status===l))),j){const t=new Date(j);null===t||void 0===t||t.setHours(0,0,0,0),e=e.filter((e=>{const a=new Date(e.date);return null===a||void 0===a||a.setHours(0,0,0,0),a.getTime()===t.getTime()}))}e.length>0?g(e):(g([]),v("No matching results found."))}),[u,j,l]);const B=(0,n.useCallback)((e=>{c(null===e||void 0===e?void 0:e.updatedAt)}),[]),q=x||[],H=10*b,W=H-10,z=q.slice(W,H),Y=Math.ceil(q.length/10);return U=z,(0,i.jsx)("div",{className:"bg-[#fafaf6] ".concat(I&&"h-screen"," border border-[#fafaf6] flex justify-center "),onClick:()=>{!0===a&&s(!1),!0===y&&N(!1)},children:(0,i.jsxs)("div",{className:"".concat(I?"w-[1300px]":"screen-size"," mt-9 mx-9"),children:[(0,i.jsxs)("div",{className:"flex items-center w-full",children:[(0,i.jsx)(r.N_,{to:"".concat(I?"/timeSheet":"/viewTimesheet"),className:"text-xl text-grey cursor-pointer w-1/15 flex items-center",onClick:()=>{A(""),S(""),k(!0),C(null),_(null),F(null),E(null)},children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("header",{className:"text_size_2 py-5 flex-grow text-dark_grey text-center",children:(0,i.jsx)("p",{children:"View Time Sheet"})}),null!==O&&(0,i.jsxs)("div",{className:"flex space-x-3  items-center rounded px-3 py-2 bg-[#FEF116]",onClick:()=>{((e,t)=>{try{if(e&&t){const a=document.querySelectorAll("table thead tr"),r=Array.from(a).map((e=>{const t=e.querySelectorAll("td");return Array.from(t).map((e=>e.innerText))})),n=new(hi().Workbook),s=n.addWorksheet("".concat(e)),i=s.addRow(r[0]);i.height=30,s.columns=r[0].map((e=>({header:e,width:e.length<20?20:e.length})));const l={style:"thin",color:{argb:"FF000000"}};i.eachCell((e=>{e.font={bold:!0,size:12,color:{argb:"f9f9f9"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"78716c"}},e.alignment={horizontal:"left"}})),t.forEach((e=>{s.addRow(e)})),s.eachRow(((e,t)=>{1!==t&&e.eachCell((e=>{e.font={size:12,color:{argb:"FF000000"}},e.alignment={horizontal:"left"}})),e.border={top:l,left:l,bottom:l,right:l}})),n.xlsx.writeBuffer().then((t=>{const a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,xi.saveAs)(a,"".concat(e,".xlsx"))}))}}catch(a){}})(O||"TimeSheet",M)},children:[(0,i.jsx)("button",{className:" text_size_5 text-dark_grey",children:"Download"}),(0,i.jsx)(es.qqM,{className:"text-black cursor-pointer"})]})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,i.jsxs)("div",{className:"flex justify-start gap-4",children:[(0,i.jsxs)("div",{className:"relative grid grid-cols-1",children:[(0,i.jsx)("label",{className:"text_size_6",children:I?"Choose Date":"Start Date"}),(0,i.jsx)("input",{type:"date",value:j||"",className:"border border-[#D9D9D9] rounded outline-none p-2 text-[#000000] text-sm",onChange:e=>A(e.target.value)})]}),!I&&(0,i.jsxs)("div",{className:"relative grid grid-cols-1",children:[(0,i.jsx)("label",{className:"text_size_6",children:"End Date"}),(0,i.jsx)("input",{type:"date",value:w||"",className:"border border-[#D9D9D9] rounded outline-none p-2 text-[#000000] text-sm",onChange:e=>S(e.target.value)})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-4 mt-6",children:[(0,i.jsxs)("div",{className:"".concat(I?"relative grid grid-cols-1":"hidden"),children:[(0,i.jsx)("input",{value:R,placeholder:"Select type",className:"border border-[#D9D9D9] cursor-pointer rounded outline-none p-2 text-[#1b1b1b] text_size_8",onClick:()=>{s(!a)},readOnly:!0}),(0,i.jsx)("span",{className:"absolute right-2 top-2",children:(0,i.jsx)(Tt.BNo,{className:"text-xl text-dark_ash"})}),a&&(0,i.jsx)("div",{className:"absolute border top-10 border-[#D9D9D9] mt-1 w-full text-[15px] text-dark_grey p-1 bg-white z-50",onClick:()=>{s(!a)},children:["Offshore","HO","SBW","ORMC","Offshore's ORMC","BLNG"].map((t=>(0,i.jsx)("p",{className:"p-1 cursor-pointer ".concat(e.current===t?"bg-secondary border text-white":"hover:bg-grey hover:text-white"),onClick:()=>{t!==e.current&&((e=>{P(e)})(t),g(null),h(null),e.current=t)},children:t},t)))})]}),!I&&(0,i.jsx)(ls,{placeholder:"".concat("Offshore"===(null===T||void 0===T?void 0:T.fileType)?"SAP ID":"HO"===(null===T||void 0===T?void 0:T.fileType)?"EMPLOYEE ID / BADGE NO":"SBW"===(null===T||void 0===T?void 0:T.fileType)||"ORMC"===(null===T||void 0===T?void 0:T.fileType)||"Offshore's ORMC"===(null===T||void 0===T?void 0:T.fileType)?"BADGE NO":"BLNG"===(null===T||void 0===T?void 0:T.fileType)?"FID":"Search..."),searchResult:e=>{E(e)},allEmpDetails:d,secondaryData:null===T||void 0===T?void 0:T.updatedAt,Position:"ViewTimeSheet"}),I&&(0,i.jsx)(pi,{handleFilterChange:e=>{o(e)},toggleDropdown:()=>{N(!y)},isOpen:y,setIsOpen:N})]})]}),I&&(0,i.jsx)(mi,{visibleData:U,newSearchFunction:B,loading:p,message:f,totalPages:Y,currentPage:b,paginate:e=>D(e)})]})})},fi=ka.Ik().shape({courseSelect:ka.Yj().required("Course selection is required"),courseName:ka.YO().of(ka.Yj().notRequired()),company:ka.YO().of(ka.Yj().notRequired())}),vi=(ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),empBadgeNo:ka.Yj().notRequired(),department:ka.Yj().notRequired(),blastingBadgeNo:ka.Yj().required("Blasting/Painting Badge Number is required"),blastingStartDate:ka.Yj().notRequired(),blastingEndDate:ka.Yj().notRequired(),blastingQulifiExp:ka.Yj().notRequired(),name:ka.Yj().notRequired(),position:ka.Yj().notRequired(),blastingRemarks:ka.Yj().notRequired(),blastingUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),empBadgeNo:ka.Yj().notRequired(),department:ka.Yj().notRequired(),courseCode:ka.Yj().notRequired(),courseName:ka.Yj().notRequired(),company:ka.Yj().notRequired(),orgiCertifiDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),name:ka.Yj().notRequired(),eCertifiDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),certifiExpiry:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),trainingUpCertifi:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()})),yi=(ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),empBadgeNo:ka.Yj().notRequired(),department:ka.Yj().notRequired(),weldingStampNor:ka.Yj().required("welding Stamp Number is required"),wpsNumber:ka.Yj().notRequired(),weldingProcess:ka.Yj().notRequired(),weldingPosition:ka.Yj().notRequired(),thicknessRange:ka.Yj().notRequired(),WQExpiry:ka.Yj().notRequired(),name:ka.Yj().notRequired(),position:ka.Yj().notRequired(),WQRNo:ka.Yj().notRequired(),weldingCode:ka.Yj().notRequired(),weldingMaterial:ka.Yj().notRequired(),fillerMetal:ka.Yj().notRequired(),diameterRange:ka.Yj().notRequired(),WQRemarks:ka.Yj().notRequired(),weldingUpload:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()}),ka.Ik().shape({empID:ka.Yj().required("Employee ID is required"),empBadgeNo:ka.Yj().notRequired(),name:ka.Yj().notRequired(),department:ka.Yj().notRequired(),position:ka.Yj().notRequired(),purchaseONo:ka.Yj().notRequired(),medicalName:ka.Yj().notRequired(),medicalExpiry:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),medicalAppointDate:ka.Yj().notRequired().test("validDate","Invalid date format or year must be a valid 4-digit year without leading zeros",(e=>{if(!e)return!0;if(!e.match(/^\d{4}-\d{2}-\d{2}$/))return!1;const[t,a,r]=e.split("-");if(4!==t.length)return!1;if(t.startsWith("0")&&"0000"!==t)return!1;const n=parseInt(a,10),s=parseInt(r,10);return!(n<1||n>12||s<1||s>31)})),medicalReport:ka.YO().of(ka.gl().test("fileOrUrl","Only PDF, image files, or valid URLs are allowed",(e=>e instanceof File?["application/pdf","image/jpeg","image/jpg","image/png"].includes(e.type):"string"!==typeof e||Ur(e))).notRequired()).notRequired()})),Ni=e=>{let{closeModal:t}=e;const{AddCourseData:a}=(()=>{const e=(0,Ee.D)();return{AddCourseData:(0,n.useCallback)((async t=>{let{AddCFCre:a}=t;if(!a)throw new Error("Missing required parameters");const r={courseSelect:a.courseSelect,courseName:a.courseName,company:a.company};console.log(r);try{const t=await Promise.all([e.graphql({query:ke.xw,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{AddCourseDetails:r}=(0,n.useContext)(s.Y),{AddCUpdateFun:l}=(()=>{const e=(0,Ee.D)();return{AddCUpdateFun:(0,n.useCallback)((async t=>{let{AddCFUpp:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,courseSelect:a.courseSelect,courseName:a.courseName,company:a.company};try{await Promise.all([e.graphql({query:ke.Y6,variables:{input:r}})])}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{register:o,handleSubmit:d,setValue:c,formState:{errors:p}}=(0,tt.mN)({resolver:(0,at.t)(fi)}),[m,u]=(0,n.useState)([""]),[h,x]=(0,n.useState)([""]),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1);return(0,i.jsx)("div",{className:"flex justify-center items-center",children:(0,i.jsxs)("section",{className:"w-[550px] h-[440px] overflow-y-auto p-5 bg-white shadow-lg rounded-lg scrollBar",children:[(0,i.jsx)("div",{className:"flex justify-end items-end",children:(0,i.jsx)("button",{onClick:t,className:"p-2",children:(0,i.jsx)(es.oxH,{className:"text-[32px] font-xs"})})}),(0,i.jsxs)("form",{onSubmit:d((async e=>{try{const t="string"===typeof e.courseSelect?e.courseSelect:"",n=null===r||void 0===r?void 0:r.find((e=>{const a="string"===typeof e.courseSelect?e.courseSelect:"";return t===a}));if(n){const t=[...new Set([...n.courseName,...e.courseName])],a=[...new Set([...n.company,...e.company])],r=(0,g.A)((0,g.A)({},e),{},{courseName:t,company:a,id:n.id});await l({AddCFUpp:r}),v("Training Add Course Form Updated successfully"),N(!0)}else{const t=(0,g.A)({},e);await a({AddCFCre:t}),v("Training Add Course Form Saved successfully"),N(!0)}}catch(t){console.error("Error submitting data:",t.message)}})),className:"p-7",children:[(0,i.jsxs)("div",{className:"mb-4 relative",children:[(0,i.jsx)("label",{className:"font-semibold",children:"Course Code:"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},o("courseSelect")),{},{className:"input-field"})),p.courseSelect&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:p.courseSelect.message})]}),(0,i.jsxs)("div",{className:"mb-4 relative",children:[(0,i.jsx)("label",{className:"font-semibold",children:"Course Name:"}),m.map(((e,t)=>(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",value:m[t]},o("courseName[".concat(t,"]"))),{},{onChange:e=>{const a=[...m];a[t]=e.target.value,u(a),c("courseName[".concat(t,"]"),e.target.value)},className:"input-field"})),t>0&&(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...m];t.splice(e,1),u(t),c("courseName",t)})(t),className:"ml-2 text-medium_grey",children:(0,i.jsx)(Tt.vli,{})}),p.courseName&&p.courseName[t]&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:p.courseName[t].message})]},t))),(0,i.jsx)("button",{type:"button",onClick:()=>{u((e=>[...e,""]))},className:"absolute top-10 -right-7 text-medium_grey text-[24px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsxs)("div",{className:"mb-4 relative",children:[(0,i.jsx)("label",{className:"font-semibold",children:"Training Company:"}),h.map(((e,t)=>(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",value:h[t]},o("company[".concat(t,"]"))),{},{onChange:e=>{const a=[...h];a[t]=e.target.value,x(a),c("company[".concat(t,"]"),e.target.value)},className:"input-field"})),t>0&&(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...h];t.splice(e,1),x(t),c("company",t)})(t),className:"ml-2 text-medium_grey",children:(0,i.jsx)(Tt.vli,{})}),p.company&&p.company[t]&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:p.company[t].message})]},t))),(0,i.jsx)("button",{type:"button",onClick:()=>{x((e=>[...e,""]))},className:"absolute top-10 -right-7 text-medium_grey text-[24px]",children:(0,i.jsx)(Ct.Oh0,{})})]}),(0,i.jsx)("div",{className:"center py-2",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),y&&(0,i.jsx)(Pe,{text:f,notification:y,path:"/training/AcTc"})]})})},bi=()=>{const{empPIData:e,AddCourseDetails:t}=(0,n.useContext)(s.Y),{register:a,setValue:l,formState:{errors:o}}=(0,tt.mN)({resolver:(0,at.t)(fi)}),[d,c]=(0,n.useState)(!0),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),[x,f]=(0,n.useState)([]);(0,n.useEffect)((()=>{(()=>{try{const a=e.map((e=>{const a=t.find((t=>t.empID===e.empID));return a?(0,g.A)((0,g.A)({},e),a):null})).filter(Boolean);f(a)}catch(a){console.error("Error fetching data:",a)}})()}),[e,t]);return(0,i.jsxs)("section",{className:"p-10 center flex-col gap-16 bg-[#F8F8F8] mt-10",children:[(0,i.jsxs)("div",{className:" w-full flex items-center justify-center gap-5 ",children:[(0,i.jsx)(r.N_,{to:"/training/hr",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("article",{className:"w-full  center gap-5 text-dark_grey ",children:(0,i.jsx)("p",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"Add Course"})})]}),(0,i.jsx)("div",{className:"screen-size center  w-full h-full",children:(0,i.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-2xl w-full  max-h-[400px] h-full",children:[(0,i.jsx)("div",{className:"flex justify-end items-center py-2",children:(0,i.jsx)("button",{type:"button",className:"bg-primary font-bold py-2 px-5 text-dark_grey rounded-md",onClick:()=>m(!0),children:"Add Course"})}),(0,i.jsxs)("form",{children:[(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsx)("label",{htmlFor:"courseSelect",className:"text_size_5",children:"Course Code:"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},a("courseSelect")),{},{onChange:e=>{const a=e.target.value,r=t.find((e=>String(e.courseSelect)===String(a)));h(r||null),r?(l("courseName",r.courseName||""),l("company",r.company||"")):(l("courseName",""),l("company",""))},className:"input-field select-custom",children:[(0,i.jsx)("option",{value:"",children:"Select Course"}),t.map((e=>(0,i.jsx)("option",{value:e.courseSelect,children:e.courseSelect},e.courseSelect)))]}))]}),(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Course Name"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({},a("courseName")),{},{className:"input-field select-custom",children:u&&Array.isArray(u.courseName)?u.courseName.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t))):(0,i.jsx)("option",{value:(null===u||void 0===u?void 0:u.courseName)||"",children:(null===u||void 0===u?void 0:u.courseName)||"No Course Name Available"})}))]}),(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Training Company"}),(0,i.jsx)("select",(0,g.A)((0,g.A)({},a("company")),{},{className:"input-field select-custom",children:u&&Array.isArray(u.company)?u.company.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t))):(0,i.jsx)("option",{value:(null===u||void 0===u?void 0:u.company)||"",children:(null===u||void 0===u?void 0:u.company)||"No Company Available"})}))]})]})]})}),p&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center border mt-20",children:(0,i.jsx)(Ni,{closeModal:()=>m(!1)})})]})};var Di=a(5765),ji=a(4954);const Ai=()=>{const{empPIData:e,workInfoData:t,AddCourseDetails:a,AddEmpReq:l}=(0,n.useContext)(s.Y);(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{createNotification:o}=_e(),{AddEmpData:d}=(0,Di.r)(),{TrReqUp:c}=(0,ji.J)(),{formattedPermissions:p}=qt(),[m,u]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""),[f,v]=(0,n.useState)(""),[N,b]=(0,n.useState)(""),[D,A]=(0,n.useState)({managerEmpID:"",managerOfficialMail:"",managerName:"",hrOfficialmail:""}),[w,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)([]),[k,T]=(0,n.useState)({}),[C,R]=(0,n.useState)([]),[P,O]=(0,n.useState)([]),[_,M]=(0,n.useState)([]),[F,L]=(0,n.useState)(""),[U,B]=(0,n.useState)({medicalReport:!1}),[q,H]=(0,n.useState)({medicalReport:[]}),[W,z]=(0,n.useState)({}),[Y,V]=(0,n.useState)({}),G=localStorage.getItem("userID"),{register:J,handleSubmit:K,setValue:Q,reset:$,getValues:Z,watch:X,control:ee,formState:{errors:te}}=(0,tt.mN)({resolver:(0,at.t)(yi),defaultValues:{trainingreq:[{mediRequired:!1,courseCode:"",courseName:"",company:"",traineeSD:"",traineeED:"",traineeStatus:"",MRNo:"",traineeCourseFee:"",medicalName:"",medicalExpiry:"",medicalAppointDate:"",medicalReport:[]}]}}),{fields:ae,append:re,remove:ne}=(0,tt.jz)({control:ee,name:"trainingreq"});(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");v(e);const t=localStorage.getItem("userType");b(t)}),[]);const{personalInfo:se}=Be(f);(0,n.useEffect)((()=>{(async()=>{try{const r=e.map((e=>{const r=t?t.find((t=>t.empID===e.empID)):{},n=a?a.find((t=>t.empID===e.empID)):{},s=l?l.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),n),s)})).filter(Boolean);R(r),O(r)}catch(r){console.log(r)}})()}),[e,t,a,l]);const ie=X("empID"),le=e=>{const t=e.target.value,r=a.find((e=>String(e.courseSelect)===String(t)));I(r||null),r&&(Q("courseName",r.courseName||""),Q("company",r.company||""))},oe=(X("medicalReport",""),async(e,t,a)=>{if(!ie)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/trainingReq/add");const r=e.target.files[0];if(!r)return;if(["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type)){Q("trainingreq[".concat(a,"].medicalReport"),r);try{n=t,s=!0,i=a,B((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(i,"_").concat(n)]:s}))),await ct(r,t,H,ie,a),z((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(a,"_").concat(t)]:[r.name]})))}catch(l){console.log(l)}var n,s,i}else alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")}),de=()=>{u(!m)},ce=async(e,t,a,r)=>{try{if(!ie)return void alert("Please provide the Employee ID before deleting files.");const a=await(0,_a.k)(e,t,ie),r=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"DeleteDocsTriningEmpR in employe info")}})(e,t,ie,z,V,H);if(!a)return void console.error("Failed to delete file: ".concat(t,", dynamodb."));if(r)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));x("".concat(t)),de()}catch(n){console.error("Error deleting file:",n),alert("Error processing the file deletion.")}},pe=(X("mediRequired"),e=>{try{let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(t){return console.error("Error normalizing traineeTrackData:",t),[]}}),me=()=>{re({courseCode:"",courseName:"",company:"",traineeSD:"",traineeED:"",traineeStatus:"",MRNo:"",traineeCourseFee:"",medicalName:"",medicalExpiry:"",medicalAppointDate:"",medicalReport:[]})},ue=["Training Requestor"];return(0,i.jsxs)("section",{className:"bg-[#F8F8F8] p-10 center flex-col w-full ",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/trainingReq",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("article",{className:"flex-1 flex gap-5 text-dark_grey",children:(0,i.jsx)("h1",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"Add Employee"})})]}),(0,i.jsxs)("section",{className:" mt-16 mb-14 w-full bg-white px-20 py-10",children:[(0,i.jsx)("div",{className:"flex-1 w-[30%] mt-5",children:(0,i.jsx)(ea,{searchResult:a=>{if(!a)return void console.warn("Search result is undefined or null");const r=t.find((e=>e.empID===a.empID));if(r){var n;const t=(null===(n=r.manager)||void 0===n?void 0:n[r.manager.length-1])||null,a="hr-training@adininworks.com";if(A((e=>(0,g.A)((0,g.A)({},e),{},{hrOfficialmail:a}))),t){const a=e.find((e=>e.empID===String(t)));a&&A((e=>(0,g.A)((0,g.A)({},e),{},{managerOfficialMail:a.officialEmail||"",managerName:a.name||"",managerEmpID:a.empID||""})))}}["empID","empBadgeNo","name"].forEach((e=>{const t=a[e]||null;Q(e,t)})),["department","position"].forEach((e=>{const t=(e=>Array.isArray(e)?e[e.length-1]:e)(a[e])||null;Q(e,t)}));const s=null===a||void 0===a?void 0:a.traineeTrack;if(s)try{const e=null===a||void 0===a?void 0:a.traineeTrack,t=pe(e);if(t.length>0){Q("trainingreq",t),I(t.map(((e,t)=>({index:t,courseName:e.courseName,company:e.company}))));const e=t.reduce(((e,t,a)=>(e[a]=t.mediRequired,e)),{});T(e),t.forEach(((e,t)=>{if(null!==e&&void 0!==e&&e.medicalReport)try{const a=e.medicalReport;if(Array.isArray(a)&&0===a.length)return;const r="string"===typeof a?JSON.parse(a):a;if(!Array.isArray(r))return void console.error("Invalid traineeTrackUpload format:",a);const n=r.map((e=>{try{return"string"===typeof e?JSON.parse(e):e}catch(t){return null}})).filter(Boolean);H((e=>(0,g.A)((0,g.A)({},e),{},{medicalReport:(0,g.A)((0,g.A)({},e.medicalReport),{},{[t]:n})})));const s=n.map((e=>e&&e.upload?e.upload.split("/").pop():""));z((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(t,"_medicalReport")]:s})))}catch(a){console.error("Error parsing medicalReport JSON:",e.medicalReport)}}))}}catch(i){console.error("Error parsing traineeTrackData:",i,s)}else $({empID:Z("empID"),empBadgeNo:Z("empBadgeNo"),name:Z("name"),department:Z("department"),position:Z("position"),trainingreq:[{courseName:"",company:"",mediRequired:!1,medicalReport:[]}]}),T({0:!1}),H({medicalReport:{0:[]}}),z({"0_medicalReport":[]})},newFormData:P,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:_,setFilteredEmployees:M})}),(0,i.jsxs)("form",{onSubmit:K((async e=>{try{const n=(new Date).toISOString().split("T")[0],s=l?l.filter((t=>t.empID===e.empID))[0]:{};if(s){var t;const a=pe(null===s||void 0===s?void 0:s.traineeTrack)||[];let r={empID:s.empID,oldTrainings:a||[]};const i={empID:e.empID,trainingreq:(null===e||void 0===e?void 0:e.trainingreq)||[]},l=(null===i||void 0===i?void 0:i.empID)===(null===r||void 0===r?void 0:r.empID)&&(null===i||void 0===i?void 0:i.trainingreq.length)>0;let d=[];if(l&&(d=null===i||void 0===i?void 0:i.trainingreq),d.length>0){const t=d.map(((e,t)=>"\n              <tr>\n                <td>".concat(t+1,"</td>\n                <td>").concat(e.courseName,"</td>\n                <td>").concat(e.company,"</td>\n                 <td>").concat(e.MRNo,"</td>\n                <td>").concat(y(e.traineeSD),"</td>\n                <td>").concat(y(e.traineeED),"</td>\n                <td>").concat(e.traineeStatus||"-","</td>\n              </tr>\n            "))).join(""),a='\n  <table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse;">\n    <thead>\n      <tr>\n        <th>S.No</th>\n        <th>Course Name</th>\n        <th>Company</th>\n           <th>MR No</th>\n        <th>Start Date</th>\n        <th>End Date</th>\n        <th>Status</th>\n      </tr>\n    </thead>\n    <tbody>\n      '.concat(t,"\n    </tbody>\n  </table>\n"),r="Employee Training Notification - ".concat(e.name),n="\n  <p>Dear ".concat(D.managerName,",</p>\n  <p>Please be informed that ").concat(e.name," is scheduled for the following training(s):</p>\n  ").concat(a,"\n  <p>Regards,<br/>Training Team</p>\n"),s="\n  <p>Dear HR,</p>\n  <p>Please be informed that ".concat(e.name," is scheduled for the following training(s):</p>\n  ").concat(a,"\n  <p>Regards,<br/>Training Team</p>\n");await Me(r,n,"hr_no-reply@adininworks.com",D.managerOfficialMail),await Me(r,s,"hr_no-reply@adininworks.com",D.hrOfficialmail),await Me(r,s,"hr_no-reply@adininworks.com","hr-training@adininworks.com");await o({empID:e.empID,leaveType:"Training Requestor",message:"Employee Training Notification - ".concat(e.name,". Dear Hr, Please be informed that ").concat(e.name," is scheduled for training on\n          ").concat(JSON.stringify(null===e||void 0===e?void 0:e.trainingreq),"."),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:D.hrOfficialmail,status:"Unread"}),await o({empID:e.empID,leaveType:"Training Requestor",message:"Employee Training Notification - ".concat(e.name,". Dear ").concat(D.managerName,", Please be informed that ").concat(e.name," is scheduled for training on\n          ").concat(JSON.stringify(null===e||void 0===e?void 0:e.trainingreq),"."),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:D.managerOfficialMail,receipentEmpID:D.managerEmpID,status:"Unread"})}const p=[...null!==s&&void 0!==s&&s.updatedBy?JSON.parse(null===s||void 0===s?void 0:s.updatedBy):[],{userID:G,date:n}],m=null===p||void 0===p?void 0:p.map((e=>({userID:e.userID,date:e.date}))),u={trainingTrack:null===e||void 0===e||null===(t=e.trainingreq)||void 0===t?void 0:t.map(((e,t)=>{var a;return(0,g.A)((0,g.A)({},e),{},{medicalReport:JSON.stringify(null===q||void 0===q||null===(a=q.medicalReport)||void 0===a?void 0:a[t])||[]})})),department:e.department,empBadgeNo:e.empBadgeNo,empID:e.empID,id:s.id,updatedBy:JSON.stringify(m)};await c({TMRDataUp:u}),L("Training details Updated successfully"),S(!0)}else{var a,r;const t={trainingTrack:null===e||void 0===e||null===(a=e.trainingreq)||void 0===a?void 0:a.map(((e,t)=>{var a;return(0,g.A)((0,g.A)({},e),{},{medicalReport:JSON.stringify(null===q||void 0===q||null===(a=q.medicalReport)||void 0===a?void 0:a[t])||[]})})),department:e.department,empBadgeNo:e.empBadgeNo,empID:e.empID,createdBy:JSON.stringify([{userID:G,date:n}])};await d({AddEmpValue:t});const s=null===e||void 0===e||null===(r=e.trainingreq)||void 0===r?void 0:r.map(((e,t)=>"\n        <tr>\n          <td>".concat(t+1,"</td>\n          <td>").concat(e.courseName,"</td>\n          <td>").concat(e.company,"</td>\n             <td>").concat(e.MRNo,"</td>\n          <td>").concat(y(e.traineeSD),"</td>\n          <td>").concat(y(e.traineeED),"</td>\n          <td>").concat(e.traineeStatus||"-","</td>\n        </tr>\n      "))).join(""),i='\n<table border="1" cellpadding="5" cellspacing="0" style="border-collapse: collapse;">\n<thead>\n  <tr>\n    <th>S.No</th>\n    <th>Course Name</th>\n    <th>Company</th>\n       <th>MR No</th>\n    <th>Start Date</th>\n    <th>End Date</th>\n    <th>Status</th>\n  </tr>\n</thead>\n<tbody>\n  '.concat(s,"\n</tbody>\n</table>\n"),l="Employee Training Notification - ".concat(e.name," "),c="\n    <p>Dear ".concat(D.managerName,",</p>\n    <p>\n      Please be informed that ").concat(e.name," is scheduled for the following training(s)\n    :</p>\n").concat(i,"\n<p>Regards,<br/>Training Team</p>\n    </p>\n  "),p="\n<p>Dear HR,</p>\n<p>Please be informed that ".concat(e.name," is scheduled for the following training(s):</p>\n").concat(i,"\n<p>Regards,<br/>Training Team</p>");await Me(l,c,"hr_no-reply@adininworks.com",D.managerOfficialMail),await Me(l,p,"hr_no-reply@adininworks.com",D.hrOfficialmail),await Me(l,p,"hr_no-reply@adininworks.com","hr-training@adininworks.com");await o({empID:e.empID,leaveType:"Training Requestor",message:"Employee Training Notification - ".concat(e.name,". Dear Hr, Please be informed that ").concat(e.name," is scheduled for training on\n      ").concat(JSON.stringify(null===e||void 0===e?void 0:e.trainingreq),"."),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:D.hrOfficialmail,status:"Unread"}),await o({empID:e.empID,leaveType:"Training Requestor",message:"Employee Training Notification - ".concat(e.name,". Dear ").concat(D.managerName,", Please be informed that ").concat(e.name," is scheduled for training on\n      ").concat(JSON.stringify(null===e||void 0===e?void 0:e.trainingreq),"."),senderEmail:"hr_no-reply@adininworks.com",receipentEmail:D.managerOfficialMail,receipentEmpID:D.managerEmpID,status:"Unread"}),L("Training details Saved successfully"),S(!0)}}catch(n){console.log(n)}})),children:[(0,i.jsx)("div",{className:"flex justify-end items-center py-5 mt-2",children:(0,i.jsxs)("div",{className:"max-w-sm",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee ID"})," ",(0,i.jsx)("br",{}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field"},J("empID"))),te.empID&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:te.empID.message})]})}),(0,i.jsx)("div",{className:"flex flex-col gap-6",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee Badge Number"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field "},J("empBadgeNo"))),te.empBadgeNo&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.empBadgeNo.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee Name"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field "},J("name")))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Department"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field "},J("department")))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Position"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field "},J("position")))]})]})}),ae.map(((e,t)=>{var r,n,s,l,o,d,c,m;return(0,i.jsxs)("div",{className:"my-10 border border-[#E9E7E7] rounded-lg px-5  pt-6",children:[(0,i.jsxs)("div",{className:"mb-6 flex justify-between ",children:[(0,i.jsxs)("h3",{className:"col-span-2 text-lg font-semibold",children:["Training Requirement #",t+1]}),(0,i.jsxs)("div",{className:"my-auto center",children:[0===t&&(0,i.jsx)("button",{type:"button",onClick:me,className:"text-grey text-xl",children:(0,i.jsx)(Tt.fFF,{})}),0!==t&&(0,i.jsx)("button",{type:"button",onClick:()=>{return ne(e=t),z((t=>{const a={};return Object.entries(t).forEach((t=>{let[r,n]=t;const[s,i]=r.split("_"),l=parseInt(s,10);l<e?a["".concat(l,"_").concat(i)]=n:l>e&&(a["".concat(l-1,"_").concat(i)]=n)})),a})),H((t=>{const a={};return Object.entries(t.medicalReport||{}).forEach((t=>{let[r,n]=t;const s=Number(r);s<e?a[s]=n:s>e&&(a[s-1]=n)})),{medicalReport:a}})),void T((t=>{const a={};return Object.entries(t).forEach((t=>{let[r,n]=t;const s=Number(r);s<e?a[s]=n:s>e&&(a[s-1]=n)})),a}));var e},className:"text-xl text-grey",children:(0,i.jsx)(Tt.vli,{})})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-6 ",children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{htmlFor:"courseSelect",className:"font-semibold",children:"Course Code"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},J("trainingreq.".concat(t,".courseCode"))),{},{onChange:le,className:"input-field select-custom",children:[(0,i.jsx)("option",{value:"",children:"Training Course Select"}),a.map(((e,t)=>(0,i.jsx)("option",{value:e.courseSelect,children:e.courseSelect},"".concat(e.courseSelect,"-").concat(t))))]})),te.courseCode&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.courseCode.message})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Course Name"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},J("trainingreq.".concat(t,".courseName"))),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{children:"Select"}),E&&Array.isArray(E.courseName)?E.courseName.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t))):E&&null!==(r=E[t])&&void 0!==r&&r.courseName?(0,i.jsx)("option",{value:E[t].courseName,children:E[t].courseName}):(0,i.jsx)("option",{value:(null===E||void 0===E?void 0:E.courseName)||"",children:(null===E||void 0===E?void 0:E.courseName)||"No Course Name Available"})]})),te.courseName&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.courseName.message})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Training Company"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},J("trainingreq.".concat(t,".company"))),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{children:"Select"}),E&&Array.isArray(E.company)?E.company.map(((e,t)=>(0,i.jsx)("option",{value:e,children:e},t))):E&&null!==(n=E[t])&&void 0!==n&&n.company?(0,i.jsx)("option",{value:E[t].company,children:E[t].company}):(0,i.jsx)("option",{value:(null===E||void 0===E?void 0:E.company)||"",children:(null===E||void 0===E?void 0:E.company)||"No Company Available"})]})),te.company&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.company.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"MR Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},J("trainingreq.".concat(t,".MRNo"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Course Fee"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},J("trainingreq.".concat(t,".traineeCourseFee"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Status"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},J("trainingreq.".concat(t,".traineeStatus"))),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:"",children:"Select Status"}),(0,i.jsx)("option",{value:"Mandatory",children:"Mandatory"}),(0,i.jsx)("option",{value:"Supplementary",children:"Supplementary"})]}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Start Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},J("trainingreq.".concat(t,".traineeSD"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"End Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},J("trainingreq.".concat(t,".traineeED"))),{},{className:"input-field"}))]}),(0,i.jsx)("div",{className:"col-span-2 flex items-center gap-5 my-5",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"checkbox",id:"mediRequired-".concat(t)},J("trainingreq.".concat(t,".mediRequired"))),{},{onChange:e=>{const a=e.target.checked;T((e=>(0,g.A)((0,g.A)({},e),{},{[t]:a})))},className:"w-[18px] h-[18px] border border-grey rounded appearance-none flex items-center justify-center cursor-pointer"})),k[t]&&(0,i.jsx)("svg",{className:"w-5 h-5 text-[white] bg-[#42e742] -ml-[26px] pointer-events-none rounded",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),(0,i.jsx)("label",{htmlFor:"mediRequired",className:"cursor-pointer",children:"If Medical Required"})]})}),k[t]&&(0,i.jsxs)("div",{className:"col-span-2 grid grid-cols-2 w-full gap-6 mb-10",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Medical Name"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field"},J("trainingreq.".concat(t,".medicalName")))),(null===te||void 0===te||null===(s=te.trainingreq)||void 0===s||null===(l=s[t])||void 0===l?void 0:l.medicalName)&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.trainingreq[t].medicalName.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Medical Appointment Date"}),(0,i.jsx)("input",(0,g.A)({type:"date",className:"input-field"},J("trainingreq.".concat(t,".medicalAppointDate")))),(null===te||void 0===te||null===(o=te.trainingreq)||void 0===o||null===(d=o[t])||void 0===d?void 0:d.medicalAppointDate)&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.trainingreq[t].medicalAppointDate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Medical Expiry"}),(0,i.jsx)("input",(0,g.A)({type:"date",className:"input-field"},J("trainingreq.".concat(t,".medicalExpiry")))),(null===te||void 0===te||null===(c=te.trainingreq)||void 0===c||null===(m=c[t])||void 0===m?void 0:m.medicalExpiry)&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:te.trainingreq[t].medicalExpiry.message})]}),(0,i.jsx)("div",{className:" gap-10 w-full",children:(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsxs)("label",{className:"text_size_5",children:[" ","Upload Medical Report"]}),(0,i.jsxs)("label",{onClick:()=>{null!==U&&void 0!==U&&U["".concat(t,"_medicalReport")]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"flex items-center px-3 py-3 mt-2 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] rounded-md cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file"},J("trainingreq[".concat(t,"].medicalReport"))),{},{onChange:e=>oe(e,"medicalReport",t),accept:"application/pdf",className:"hidden ",disabled:null===U||void 0===U?void 0:U["".concat(t,"_medicalReport")]})),(0,i.jsxs)("span",{className:"ml-2  w-full font-normal flex justify-between items-center gap-10",children:["Upload Medical Report",(0,i.jsx)(ut.gwN,{})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-between ",children:null!==W&&void 0!==W&&W["".concat(t,"_medicalReport")]?(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(W["".concat(t,"_medicalReport")])&&W["".concat(t,"_medicalReport")].slice().reverse().map(((e,t)=>(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{ce("medicalReport",e)},children:(0,i.jsx)(_t.uDv,{})})]},t)))}):(null===Y||void 0===Y?void 0:Y["".concat(t,"_medicalReport")])&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(Y["".concat(t,"_medicalReport")])&&Y["".concat(t,"_medicalReport")].slice().reverse().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===p||void 0===p||null===(a=p.deleteAccess)||void 0===a||null===(r=a.Training)||void 0===r?void 0:r.some((e=>ue.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{ce("medicalReport",e)},children:(0,i.jsx)(_t.uDv,{})})]},t)}))})}),(null===te||void 0===te?void 0:te.medicalReport)&&(0,i.jsx)("p",{className:"text-red text-sm",children:te.medicalReport.message})]})})]})]})]},e.id)})),(0,i.jsx)("div",{className:"col-span-2 flex justify-center",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Submit"})})]})]}),w&&(0,i.jsx)(Pe,{text:F,notification:w,path:"/trainingReq/add"}),m&&(0,i.jsx)(Wt,{handleDeleteMsg:de,title1:h})]})},wi=e=>{let{dropDownData:t,permissionData:a,deletePermissionData:r}=e;const[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)({Dashboard:[],Recruitment:[],User:[],Employee:[],Insurance:[],Training:[],TimeSheet:[],LeaveManagement:[],Notification:[],Report:[],BenefitsAndRewards:[]}),[c,p]=(0,n.useState)({});(0,n.useEffect)((()=>{a&&(d(a),p(null===r||void 0===r?void 0:r.deleteAccess))}),[a,r]);const m=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(a.length>0){const e=a.every((e=>o[t]&&o[t].includes(e)));d(e?e=>(0,g.A)((0,g.A)({},e),{},{[t]:e[t].filter((e=>!a.includes(e)))}):e=>(0,g.A)((0,g.A)({},e),{},{[t]:[...e[t]||[],...a.filter((a=>!(e[t]||[]).includes(a)))]}))}else d((a=>(0,g.A)((0,g.A)({},a),{},{[t]:a[t]?a[t].includes(e)?a[t].filter((t=>t!==e)):[...a[t]||[],e]:[e]})))};(0,n.useEffect)((()=>{const e=Object.fromEntries(Object.entries(o).filter((e=>{let[t,a]=e;return a.length>0})));t(e,c)}),[o,c]);const u={Recruitment:["Status","WorkPass Tracking","Candidate","Local CV","Non Local CV","Hiring Job"],User:["User"],Insurance:["Insurance"],Employee:["Employee Info","Work Info","Work Pass","Medical & Dependent Info","Insurance"],Training:["HR","Training Requestor"]};return(0,i.jsxs)("section",{className:"w-full",children:[(0,i.jsxs)("div",{className:"flex  text_size_3 p-3 ",children:[(0,i.jsx)("div",{className:"w-4/6 pl-5",children:"Module"}),(0,i.jsx)("div",{className:"w-1/6 text-right",children:"Delete"}),(0,i.jsx)("div",{className:"w-1/6 text-right",children:"Access"})]}),[{Dashboard:["Employee count","Recent Notifications","Application Received","User Action","Birthday Reminder","New Joinee"]},{User:["User"]},{Recruitment:["Employee Requisition","Candidate","Apply Employee Requisition","Local CV","Non Local CV","Status","WorkPass Tracking","Hiring Job"]},{Employee:["All Employee","Employee Info","Work Info","Work Pass","Medical & Dependent Info","Insurance","Non-Local Accommodation in Brunei"]},{Insurance:["Insurance"]},{Training:["HR","Training Requestor","BLNG","OME"]},{TimeSheet:["HO","SBW","ORMC","Offshore","Offshore's ORMC","BLNG","View Time Sheet","View Summary"]},{LeaveManagement:["LeaveManagement"]},{Notification:["Notification"]},{Report:["Recruitment & Mobilization","Resignation","Termination","Probation Review","Probation Form Update","Contract Expiry Review","Contract Expiry Form Update","Employment Pass Expiry","LD Expiry","Passport Expiry","Employment Medical","New Recruitment","Training Records","LBD KPI","Group H&S","Leave Passage","Promotion"]},{BenefitsAndRewards:["BenefitsAndRewards"]}].map(((e,t)=>{const a=Object.keys(e)[0]||[],r=e[a]||[],n=r.every((e=>!!o[a]&&o[a].includes(e)));return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center cursor-pointer py-1 px-2 justify-between",children:[(0,i.jsxs)("div",{onClick:()=>{return e=a,void(s.includes(e)?l(s.filter((t=>t!==e))):l([...s,e]));var e},className:"flex items-center w-full",children:[s.includes(a)?(0,i.jsx)(es.q2p,{className:"text-2xl"}):(0,i.jsx)(es.c_e,{className:"text-2xl"}),(0,i.jsx)("p",{className:"font-semibold text-lg flex justify-between items-center px-2 w-full",children:a})]}),s.includes(a)&&(0,i.jsx)("span",{className:"text-dark_grey cursor-pointer pr-7",onClick:()=>m(null,a,r),children:n?(0,i.jsx)(Tt.A7C,{}):(0,i.jsx)(_t.H4D,{className:"text-lg"})})]}),(null===s||void 0===s?void 0:s.includes(a))&&(0,i.jsx)("ul",{className:"pl-6 space-y-1 pr-7",children:null===r||void 0===r?void 0:r.map(((e,t)=>{var r,n;return(0,i.jsxs)("li",{className:"flex justify-between items-center cursor-pointer p-2 gap-20",children:[(0,i.jsx)("span",{className:"w-full",children:e}),(null===u||void 0===u||null===(r=u[a])||void 0===r?void 0:r.includes(e))&&(0,i.jsx)("span",{className:"text-dark_grey cursor-pointer",onClick:()=>((e,t)=>{p((a=>{var r;const n=null===a||void 0===a||null===(r=a[t])||void 0===r?void 0:r.includes(e);return(0,g.A)((0,g.A)({},a),{},{[t]:n?null===a||void 0===a?void 0:a[t].filter((t=>t!==e)):[...(null===a||void 0===a?void 0:a[t])||[],e]})}))})(e,a),children:null!==c&&void 0!==c&&null!==(n=c[a])&&void 0!==n&&n.includes(e)?(0,i.jsx)(_t.lEn,{}):(0,i.jsx)(ia.XiU,{className:"text-lg"})}),(0,i.jsx)("span",{className:"text-dark_grey w",onClick:()=>m(e,a),children:o[a]&&o[a].includes(e)?(0,i.jsx)(Tt.A7C,{}):(0,i.jsx)(_t.H4D,{className:"text-lg"})})]},t)}))})]},t)}))]})};var Si=a(7355);const Ei=(0,Ee.D)(),Ii=()=>{var e,t,a,s,l,o,d,c,p,m,u,h,x,f,v,y,N,b,D,A,w,S,E,I,k,T,C,R,P,O,_,M,F,L,U;const[B,q]=(0,n.useState)(""),[H,W]=(0,n.useState)(!1),[z,Y]=(0,n.useState)([]),[V,G]=(0,n.useState)(null),[J,K]=(0,n.useState)(null),Q=(0,r.zy)(),$=null===(e=Q.state)||void 0===e?void 0:e.editUserData,Z=null===(t=Q.state)||void 0===t?void 0:t.addUserData,[X,ee]=(0,n.useState)(null),[te,ae]=(0,n.useState)(!1),[re,ne]=(0,n.useState)([]),[se,ie]=(0,n.useState)(""),le=(null===$||void 0===$?void 0:$.userValue)||(null===Z||void 0===Z?void 0:Z.userValue),oe=(null===$||void 0===$?void 0:$.workValue)||(null===Z||void 0===Z?void 0:Z.workValue),[de,ce]=(0,n.useState)(!1);(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{register:pe,handleSubmit:me,setValue:ue,watch:he,formState:{errors:xe},reset:ge}=(0,tt.mN)({resolver:(0,at.t)(rt.h4),defaultValues:{password:B}});(0,n.useEffect)((()=>{var e,t,a,r;(async()=>{const e=(e=>{const t=new Uint8Array(e);window.crypto.getRandomValues(t);const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$()_{}";let r="";for(let n=0;n<e;n++)r+=a[t[n]%71];return r})(12);q(e)})();const n=function(e){var t,a,r;if(!e)return null;let n=null===e||void 0===e?void 0:e.replace(/=/g,":");n=null===(t=n)||void 0===t?void 0:t.replace(/([a-zA-Z]+):/g,'"$1":'),n=null===(a=n)||void 0===a?void 0:a.replace(/\[([^\]]+)\]/g,(function(e,t){let a=t.split(",").map((e=>'"'.concat(e.trim(),'"')));return"[".concat(a.join(", "),"]")})),n="{".concat(null===(r=n)||void 0===r?void 0:r.slice(1,-1),"}");try{return JSON.parse(n)}catch(s){return console.error("Error parsing JSON:",s),null}}(null===$||void 0===$||null===(e=$.storedValue)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.setPermissions[0]);G(n);const[s]=[null===$||void 0===$||null===(a=$.storedValue)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.setPermissions[1]].map((e=>{if(!e||"{}"===e)return{};try{let t=e.replace(/(\w+)=/g,'"$1":').replace(/\[([^\]]+)\]/g,((e,t)=>"[".concat(t.split(", ").map((e=>'"'.concat(e,'"'))).join(", "),"]"))).replace(/"{/g,"{").replace(/}"/g,"}");return JSON.parse(t)}catch(t){return console.error("Parsing error:",t,"Original String:",e),{}}}));K(s)}),[]);const fe=e=>Array.isArray(e)?e[e.length-1]:e;(0,n.useEffect)((()=>{var e,t,a,r,n,s,i,l;const o=null===Z||void 0===Z?void 0:Z.employeeValue.map((e=>{const t=oe.find((t=>t.empID===e.empID));return(0,g.A)((0,g.A)({},e),t)})).filter((e=>null!==e));ee(o),ue("password",B),ue("selectType",null===$||void 0===$||null===(e=$.storedValue)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.selectType),ue("contactNo",fe(null===$||void 0===$||null===(a=$.storedValue)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.contactNo)),ue("department",fe(null===$||void 0===$||null===(n=$.storedValue)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.department)),ue("position",fe(null===$||void 0===$||null===(i=$.storedValue)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.position))}),[B,ue,$,Z,oe]);const ve=me((async e=>{const t=(new Date).toISOString().split("T")[0],a=localStorage.getItem("userID");try{var r,n;const s=le.some((t=>t.empID===e.empID)),i=await le.filter((t=>t.empID===e.empID)).map((e=>e)),l=null!==(r=i[0])&&void 0!==r&&r.updatedBy?JSON.parse(null===(n=i[0])||void 0===n?void 0:n.updatedBy):[],o=[...l,{userID:a,date:t}].map((e=>({userID:e.userID,date:e.date})));if(s){const t={id:i[0].id,password:e.password,selectType:e.selectType,setPermissions:z,updatedBy:JSON.stringify(o)};await Ei.graphql({query:ke.TK,variables:{input:t}}).then((e=>{ie("User updated Successfully"),ae(!0)})).catch((e=>{console.log(e)}))}else{const r=e.name.charAt(0).toUpperCase()+e.name.slice(1).toLowerCase(),n=e.empID,s=e.password,i=e.officialEmail;await(0,Si.H)({username:n,password:s,options:{userAttributes:{email:i},autoSignIn:!0}}).then((async l=>{const o={empID:e.empID,password:e.password,selectType:e.selectType,setPermissions:z,status:"Active",createdBy:JSON.stringify([{userID:a,date:t}])};await Ei.graphql({query:ke.kg,variables:{input:o}}).then((async e=>{await Me("Verify Your Email to Activate Your Account","\n                  <html>\n                    <body>\n                      <p>Dear ".concat(r,",</p>\n                      <p>Please verify your email to activate your account before attempting to log in or change your password. <br/>\n                      You must complete the email verification process using the verification email sent to you earlier. <br/>\n                      Once verified, you can log in using the credentials provided below:\n                      </p>\n                      <p><strong>Username:</strong> ").concat(n," <br /><strong>Temporary Password:</strong> ").concat(s,'</p>\n                    \n                      <p>Visit <a href="http://employee.adininworks.co"> http://employee.adininworks.co </a> to log in. <br />Please note that changing your password is mandatory for account security. <br />Update your password immediately after logging in for the first time.</p>\n                      <p><strong>Important:</strong> Ensure you verify your email first to avoid any issues during login or password changes.</p>\n                    \n                      <p>Best regards,</p>\n                      <p>AWE Team</p>\n                    </body>\n                  </html>\n                '),"hr_no-reply@adininworks.com",i),ie("Created a User Successfully"),ae(!0)})).catch((e=>{console.log(e)}))})).catch((e=>{alert(e)}))}ge(),Y([]),G({})}catch(s){console.log(s)}}));return(0,i.jsxs)("div",{className:"flex items-center justify-center bg-[#F8F8F8] flex-col p-10",onClick:()=>{ne([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5",children:[(0,i.jsx)(r.N_,{to:"/user",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("h2",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:(null===$||void 0===$||null===(a=$.storedValue)||void 0===a?void 0:a.title)||"Add New User"}),(0,i.jsx)("div",{className:"flex-1",children:"Edit User"!==(null===$||void 0===$||null===(s=$.storedValue)||void 0===s?void 0:s.title)&&(0,i.jsx)(ea,{searchResult:e=>{e.empID&&ce(!0),ue("name",e.name),ue("officialEmail",e.officialEmail),ue("empID",e.empID),ue("userID",e.empID),ue("contactNo",fe(e.contactNo)),ue("department",fe(e.department)),ue("position",fe(e.position))},newFormData:X,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:re,setFilteredEmployees:ne})})]}),(0,i.jsxs)("form",{className:"bg-white py-10 my-16 px-14 w-full",onSubmit:ve,children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Name"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",value:(null===$||void 0===$||null===(l=$.storedValue)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.name)||he("name")||""},pe("name")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(d=xe.name)||void 0===d?void 0:d.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee Id"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",value:(null===$||void 0===$||null===(c=$.storedValue)||void 0===c||null===(p=c.data)||void 0===p?void 0:p.empID)||he("empID")||""},pe("empID")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(m=xe.empID)||void 0===m?void 0:m.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Phone Number"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",value:he("contactNo")||(null===$||void 0===$||null===(u=$.storedValue)||void 0===u||null===(h=u.data)||void 0===h?void 0:h.contactNoValue)||""},pe("contactNo")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(x=xe.contactNo)||void 0===x?void 0:x.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Official Email Id"}),(0,i.jsx)("input",(0,g.A)({type:"officialEmail",className:"input-field",value:(null===$||void 0===$||null===(f=$.storedValue)||void 0===f||null===(v=f.data)||void 0===v?void 0:v.officialEmail)||he("officialEmail")||""},pe("officialEmail")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(y=xe.officialEmail)||void 0===y?void 0:y.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"User ID"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",value:(null===$||void 0===$||null===(N=$.storedValue)||void 0===N||null===(b=N.data)||void 0===b?void 0:b.empID)||he("userID")||""},pe("userID")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(D=xe.userID)||void 0===D?void 0:D.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Temporary Password"}),(0,i.jsxs)("div",{className:"input-field flex items-center gap-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:H?"text":"password",className:"outline-none w-full bg-[transparent]",value:(null===$||void 0===$||null===(A=$.storedValue)||void 0===A||null===(w=A.data)||void 0===w?void 0:w.password)||B},pe("password")),{},{readOnly:!0})),H?(0,i.jsx)("div",{className:"text-2xl text-dark_grey",onClick:()=>{W(!H)},children:(0,i.jsx)(j.GNz,{})}):(0,i.jsx)("div",{className:"text-2xl text-dark_grey",onClick:()=>{W(!H)},children:(0,i.jsx)(j.Rds,{})})]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(S=xe.password)||void 0===S?void 0:S.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Position"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",value:he("position")||(null===$||void 0===$||null===(E=$.storedValue)||void 0===E||null===(I=E.data)||void 0===I?void 0:I.positionValue)||(null===$||void 0===$||null===(k=$.employeeValue)||void 0===k||null===(T=k.data)||void 0===T?void 0:T.position)||""},pe("position")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(C=xe.position)||void 0===C?void 0:C.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Department"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field",value:he("department")||(null===$||void 0===$||null===(R=$.storedValue)||void 0===R||null===(P=R.data)||void 0===P?void 0:P.departmentValue)||""},pe("department")))]}),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(O=xe.department)||void 0===O?void 0:O.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Select Type"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({className:"input-field"},pe("selectType")),{},{children:[(0,i.jsx)("option",{value:(null===$||void 0===$||null===(_=$.storedValue)||void 0===_||null===(M=_.data)||void 0===M?void 0:M.selectType)||he("selectType")||"",children:(null===$||void 0===$||null===(F=$.storedValue)||void 0===F||null===(L=F.data)||void 0===L?void 0:L.selectType)||"Select access"}),(0,i.jsx)("option",{value:"SuperAdmin",children:"SuperAdmin"}),(0,i.jsx)("option",{value:"GM",children:"GM"}),(0,i.jsx)("option",{value:"HR",children:"HR"}),(0,i.jsx)("option",{value:"Manager",children:"Manager"}),(0,i.jsx)("option",{value:"Supervisor",children:"Supervisor"}),(0,i.jsx)("option",{value:"Training Requestor",children:"Training Requestor"}),(0,i.jsx)("option",{value:"TimeKeeper",children:"TimeKeeper"}),(0,i.jsx)("option",{value:"QA \\ QC",children:"QA \\ QC"}),(0,i.jsx)("option",{value:"User",children:"User"}),(0,i.jsx)("option",{value:"Employee",children:"Employee"})]})),(0,i.jsx)("p",{className:"text-[red] text-[12px] mt-1",children:null===(U=xe.selectType)||void 0===U?void 0:U.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Set Permission"}),(0,i.jsx)("div",{className:"p-2 my-2 border border-[#dedbdb] rounded-md",children:(0,i.jsx)(wi,{dropDownData:(e,t)=>{Y([e,{deleteAccess:t}])},permissionData:V,deletePermissionData:J})})]})]}),(0,i.jsx)("div",{className:"mt-10 w-full center",children:(0,i.jsx)("button",{type:"submit",className:"p-3 text-white rounded-md primary_btn",children:"Submit"})})]}),te&&(0,i.jsx)(Pe,{text:se,notification:te,path:"/user"})]})},ki=()=>{const{formattedPermissions:e}=qt(),{searchResultData:t}=(0,r.KC)(),{SubmitMPData:a}=(()=>{const e=(0,Ee.D)();return{SubmitMPData:(0,n.useCallback)((async t=>{let{SawpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,sawpEmpLtrReq:[a.sawpEmpLtrReq],sawpEmpLtrReci:[a.sawpEmpLtrReci],sawpEmpUpload:[a.sawpEmpUpload],createdBy:a.createdBy};try{const t=await Promise.all([e.graphql({query:ke.MT,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{SawpDetails:l}=(0,n.useContext)(s.Y),{SawpUpdateFun:o}=(()=>{const e=(0,Ee.D)();return{SawpUpdateFun:(0,n.useCallback)((async t=>{let{SawpUpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,sawpEmpLtrReq:a.sawpEmpLtrReq,sawpEmpLtrReci:a.sawpEmpLtrReci,sawpEmpUpload:a.sawpEmpUpload,updatedBy:a.updatedBy};try{const t=await Promise.all([e.graphql({query:ke.Z5,variables:{input:r}})]);console.log(t,"successfully Updated data")}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}})(),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[x,f]=(0,n.useState)(""),[v,y]=(0,n.useState)([]),[N,b]=(0,n.useState)([]),[D,j]=(0,n.useState)(""),[A,w]=(0,n.useState)({sawpEmpUpload:!1}),[S,E]=(0,n.useState)({sawpEmpUpload:null}),[I,k]=(0,n.useState)({sawpEmpUpload:[]}),{register:T,handleSubmit:C,watch:R,setValue:P,control:O,formState:{errors:_}}=(0,tt.mN)({resolver:(0,at.t)(tn),defaultValues:{sawpEmpLtrReq:[],sawpEmpLtrReci:[]}}),M=R("sawpEmpLtrReq"),F=R("sawpEmpLtrReci"),L=R("empID"),U=localStorage.getItem("userID"),B=(new Date).toISOString().split("T")[0],q=async(e,t)=>{const a=R("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=R(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{P(t,[...n,r]);try{((e,t)=>{w((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t}))),console.log(t)})(t,!0),await dt(r,t,k,a),E((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},H=()=>{c(!d)};(0,n.useEffect)((()=>{P("empID",t.empID),P("sawpEmpLtrReq",t.sawpEmpLtrReq||[]),y(t.sawpEmpLtrReq||[]),P("sawpEmpLtrReci",t.sawpEmpLtrReci||[]),b(t.sawpEmpLtrReci||[]);if(["sawpEmpLtrReci","sawpEmpLtrReq","sawpEmpUpload"].forEach((e=>{const a=(e=>Array.isArray(e)?e[e.length-1]:e)(t[e]);P(e,a)})),t&&t.sawpEmpUpload)try{const e=JSON.parse(t.sawpEmpUpload).map((e=>"string"===typeof e?JSON.parse(e):e));P("sawpEmpUpload",e),j(t.empID),k((t=>(0,g.A)((0,g.A)({},t),{},{sawpEmpUpload:e}))),E((t=>(0,g.A)((0,g.A)({},t),{},{sawpEmpUpload:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(e){console.error("Failed to parse ".concat(t.sawpEmpUpload,":"),e)}}),[t,P]);return(0,i.jsxs)("form",{onSubmit:C((async e=>{try{const t=l?l.find((t=>t.empID===e.empID)):{},r=e=>e?new Date(e).toLocaleDateString("en-CA"):null,n=r(e.sawpEmpLtrReq),s=r(e.sawpEmpLtrReci);if(t){const a=[...new Set([...t.sawpEmpLtrReq||[],n])],i=[...new Set([...t.sawpEmpLtrReci||[],s])],l=t.updatedBy?JSON.parse(t.updatedBy):[],d=[...l,{userID:U,date:B}].map((e=>({userID:e.userID,date:e.date}))),c=(0,g.A)((0,g.A)({},e),{},{id:t.id,sawpEmpLtrReq:a.map(r),sawpEmpLtrReci:i.map(r),sawpEmpUpload:JSON.stringify(I.sawpEmpUpload),updatedBy:JSON.stringify(d)});await o({SawpUpValue:c}),f("SAWP Info Updated Successfully"),h(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{sawpEmpLtrReq:n,sawpEmpLtrReci:s,sawpEmpUpload:JSON.stringify(I.sawpEmpUpload),createdBy:JSON.stringify([{userID:U,date:B}])});await a({SawpValue:t}),f("SAWP Info Created Successfully"),h(!0)}}catch(t){console.error("Error submitting data:",t)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:T,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:_,watch:L})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 my-10 gap-5",children:[(0,i.jsx)(mt,{label:"Client Support Letter Requested Date",register:T,name:"sawpEmpLtrReq",type:"date",errors:_,control:O,watch:M}),(0,i.jsx)(mt,{label:"Client Support Letter Received Date",register:T,name:"sawpEmpLtrReci",type:"date",errors:_,control:O,watch:F})]}),(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>q(e,"sawpEmpUpload"),register:T,name:"sawpEmpUpload",error:_.sawpEmpUpload,fileName:S.sawpEmpUpload||"",handleFileChange:q,uploadedFileNames:S,deleteFile:async(e,t)=>{try{const a=R("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,E,k,w);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));m("".concat(t)),H()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},isUploading:A,field:{title:"sawpEmpUpload"},formattedPermissions:e,requiredPermissions:["Work Pass"],access:"Employee"}),(0,i.jsx)("div",{className:"center",children:(0,i.jsx)("button",{type:"submit",className:"mt-10 py-2 px-4 primary_btn",children:"Save"})}),u&&(0,i.jsx)(Pe,{text:x,notification:u,path:"/sawp"}),d&&(0,i.jsx)(Wt,{handleDeleteMsg:H,title1:p})]})},Ti=()=>{const e=(0,Ee.D)();return{UpdateMPData:(0,n.useCallback)((async t=>{let{DoeUpValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const t={id:a.id,empID:a.empID,doeEmpSubmit:a.doeEmpSubmit,doeEmpApproval:a.doeEmpApproval,doeEmpValid:a.doeEmpValid,doeEmpRefNo:a.doeEmpRefNo,doeEmpUpload:a.doeEmpUpload,updatedBy:a.updatedBy},r=await e.graphql({query:ke.u_,variables:{input:t}});console.log("Data successfully updated:",r)}catch(r){throw console.error("Error updating data:",r),r}}),[])}},Ci=()=>{const e=(0,Ee.D)();return{CrerDoeFunData:(0,n.useCallback)((async t=>{let{DoeValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const t={empID:a.empID,doeEmpSubmit:a.doeEmpSubmit,doeEmpApproval:a.doeEmpApproval,doeEmpValid:a.doeEmpValid,doeEmpRefNo:a.doeEmpRefNo,doeEmpUpload:a.doeEmpUpload,createdBy:a.createdBy},r=await e.graphql({query:ke.vW,variables:{input:t}});console.log("Data successfully updated:",r)}catch(r){throw console.error("Error updating data:",r),r}}),[e])}},Ri=()=>{(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{searchResultData:e}=(0,r.KC)(),{DNData:t}=(0,n.useContext)(s.Y),{CrerDoeFunData:a}=Ci(),{UpdateMPData:l}=Ti(),{formattedPermissions:o}=qt(),{register:d,handleSubmit:c,formState:{errors:p},setValue:m,watch:u}=(0,tt.mN)({resolver:(0,at.t)(an),doeEmpSubmit:[],doeEmpApproval:[],doeEmpValid:[]}),[h,x]=(0,n.useState)(!1),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(""),[j,A]=(0,n.useState)({doeEmpUpload:!1}),[w,S]=(0,n.useState)({doeEmpUpload:null}),[E,I]=(0,n.useState)({doeEmpUpload:[]}),k=localStorage.getItem("userID"),T=(new Date).toISOString().split("T")[0],C=async(e,t)=>{const a=u("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=u(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{m(t,[...n,r]);try{((e,t)=>{A((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t}))),console.log(t)})(t,!0),await dt(r,t,I,a),S((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},R=()=>{x(!h)};(0,n.useEffect)((()=>{m("empID",e.empID);if(["doeEmpSubmit","doeEmpApproval","doeEmpValid","doeEmpRefNo","doeEmpUpload"].forEach((t=>{return m(t,(a=e[t],Array.isArray(a)?a[a.length-1]:a));var a})),e&&e.doeEmpUpload)try{const t=JSON.parse(e.doeEmpUpload).map((e=>"string"===typeof e?JSON.parse(e):e));m("doeEmpUpload",t),I((e=>(0,g.A)((0,g.A)({},e),{},{doeEmpUpload:t}))),S((e=>(0,g.A)((0,g.A)({},e),{},{doeEmpUpload:t.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(t){console.error("Failed to parse ".concat(e.doeEmpUpload,":"),t)}}),[e,m]);return(0,i.jsxs)("form",{onSubmit:c((async e=>{try{const r=t.find((t=>t.empID===e.empID)),n=e=>e?new Date(e).toLocaleDateString("en-CA"):null,s=n(e.doeEmpSubmit),i=n(e.doeEmpApproval),o=n(e.doeEmpValid);if(r){const t=[...new Set([...r.doeEmpSubmit||[],s])],a=[...new Set([...r.doeEmpApproval||[],i])],d=[...new Set([...r.doeEmpValid||[],o])],c=r.updatedBy?JSON.parse(r.updatedBy):[],p=[...c,{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),m=(0,g.A)((0,g.A)({},e),{},{id:r.id,doeEmpSubmit:t.map(n),doeEmpApproval:a.map(n),doeEmpValid:d.map(n),doeEmpUpload:JSON.stringify(E.doeEmpUpload),updatedBy:JSON.stringify(p)});await l({DoeUpValue:m}),D("DOE Info Updated Successfully"),N(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{doeEmpSubmit:s,doeEmpApproval:i,doeEmpValid:o,doeEmpUpload:JSON.stringify(E.doeEmpUpload),createdBy:JSON.stringify([{userID:k,date:T}])});await a({DoeValue:t}),D("DOE Info Created Successfully"),N(!0)}}catch(r){console.error("Error submitting data:",r)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:d,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:p})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5 ",children:[(0,i.jsx)(mt,{label:"Date Of Submission",register:d,name:"doeEmpSubmit",type:"date",errors:p}),(0,i.jsx)(mt,{label:"Date Of Approval",register:d,name:"doeEmpApproval",type:"date",errors:p}),(0,i.jsx)(mt,{label:"Valid Until",register:d,name:"doeEmpValid",type:"date",errors:p}),(0,i.jsx)(mt,{label:"DOE Reference Number",register:d,name:"doeEmpRefNo",type:"text",errors:p}),(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>C(e,"doeEmpUpload"),register:d,name:"doeEmpUpload",error:p.doeEmpUpload,fileName:w.doeEmpUpload||"",handleFileChange:C,uploadedFileNames:w,isUploading:j,deleteFile:async(e,t)=>{try{const a=u("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,S,I,A);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));v("".concat(t)),R()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},field:{title:"doeEmpUpload"},formattedPermissions:o,requiredPermissions:["Work Pass"],access:"Employee"})]}),(0,i.jsx)("div",{className:"flex justify-center items-center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),y&&(0,i.jsx)(Pe,{text:b,notification:y,path:"/sawp/doe"}),h&&(0,i.jsx)(Wt,{handleDeleteMsg:R,title1:f})]})},Pi=()=>{const e=(0,Ee.D)();return{uploadNlmsFun:(0,n.useCallback)((async t=>{let{DoeValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const{nlmsEmpSubmit:t,nlmsEmpSubmitRefNo:r,nlmsEmpApproval:n,nlmsRefNo:s,permitType:i,nlmsEmpValid:l,nlmsEmpUpload:o,id:d,updatedBy:c}=a,p={id:d,nlmsEmpSubmit:t,nlmsEmpSubmitRefNo:r,nlmsEmpApproval:n,nlmsRefNo:s,permitType:i,nlmsEmpValid:l,nlmsEmpUpload:o,updatedBy:c},m=await e.graphql({query:ke.u_,variables:{input:p}});console.log("Data successfully updated:",m)}catch(r){throw console.error("Error updating data:",r),r}}),[])}},Oi=()=>{var e;const{searchResultData:t}=(0,r.KC)(),{formattedPermissions:a}=qt(),{DNData:l,dropDownVal:o}=(0,n.useContext)(s.Y),{CrerDoeFunData:d}=Ci(),{uploadNlmsFun:c}=Pi(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),[N,b]=(0,n.useState)({nlmsEmpUpload:!1}),[D,j]=(0,n.useState)({nlmsEmpUpload:null}),[A,w]=(0,n.useState)({nlmsEmpUpload:[]}),[S,E]=(0,n.useState)("nlmsEmpUpload"),{register:I,handleSubmit:k,watch:T,setValue:C,formState:{errors:R}}=(0,tt.mN)({resolver:(0,at.t)(rn),nlmsEmpSubmit:[],nlmsEmpApproval:[],nlmsEmpValid:[]}),P=(T("empID"),localStorage.getItem("userID")),O=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const _=async(e,t)=>{const a=T("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=T(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{C(t,[...n,r]);try{((e,t)=>{b((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t}))),console.log(t)})(t,!0),await dt(r,t,w,a),j((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},M=()=>{m(!p)};(0,n.useEffect)((()=>{C("empID",t.empID);if(["nlmsEmpApproval","nlmsEmpSubmit","nlmsEmpSubmitRefNo","nlmsEmpUpload","nlmsEmpValid","nlmsRefNo","permitType"].forEach((e=>C(e,((e,t)=>"nlmsEmpValid"===t||"nlmsEmpApproval"===t||"nlmsEmpValid"===t?e:Array.isArray(e)?e[e.length-1]:e)(t[e])))),null!==t&&void 0!==t&&t.nlmsEmpUpload)try{const e=JSON.parse(t.nlmsEmpUpload).map((e=>"string"===typeof e?JSON.parse(e):e));C("nlmsEmpUpload",e),w({nlmsEmpUpload:e}),j({nlmsEmpUpload:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})}catch(e){console.error("Error parsing nlmsEmpUpload:",e)}}),[t,C]);const F=e=>e?new Date(e).toLocaleDateString("en-CA"):null,L=null===(e=o[0])||void 0===e?void 0:e.permitWorkDD.map((e=>({value:e,label:e})));return(0,i.jsxs)("form",{onSubmit:k((async e=>{try{const t=F(e.nlmsEmpSubmit),a=F(e.nlmsEmpApproval),r=F(e.nlmsEmpValid),n=l.find((t=>t.empID===e.empID)),s=[...new Set([...n.nlmsEmpSubmit||[],t])];if(n){const t=[...new Set([...n.nlmsEmpApproval||[],a])],i=[...new Set([...n.nlmsEmpValid||[],r])],l=n.updatedBy?JSON.parse(n.updatedBy):[],o=[...l,{userID:P,date:O}].map((e=>({userID:e.userID,date:e.date}))),d=(0,g.A)((0,g.A)({},e),{},{id:null===n||void 0===n?void 0:n.id,nlmsEmpSubmit:s.map(F),nlmsEmpApproval:t.map(F),nlmsEmpValid:i.map(F),nlmsEmpUpload:JSON.stringify(A.nlmsEmpUpload),updatedBy:JSON.stringify(o)});await c({DoeValue:d}),y("NLMS Info Stored Successfully"),f(!0)}else{const n=(0,g.A)((0,g.A)({},e),{},{nlmsEmpSubmit:t,nlmsEmpApproval:a,nlmsEmpValid:r,nlmsEmpUpload:JSON.stringify(A.nlmsEmpUpload),createdBy:JSON.stringify([{userID:P,date:O}])});await d({DoeValue:n}),y("NLMS Info Stored Successfully"),f(!0)}}catch(t){console.error("Error submitting data:",t)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:I,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:R})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5",children:[(0,i.jsx)(mt,{label:"Type of Work Permit Application",register:I,name:"permitType",type:"select",options:L,errors:R}),(0,i.jsx)(mt,{label:"Date Of Submission",register:I,name:"nlmsEmpSubmit",type:"date",errors:R}),(0,i.jsx)(mt,{label:"Submission Reference Number",register:I,name:"nlmsEmpSubmitRefNo",type:"text",errors:R}),(0,i.jsx)(mt,{label:"Date Of Approval",register:I,name:"nlmsEmpApproval",type:"date",errors:R}),(0,i.jsx)(mt,{label:"LD Reference Number",register:I,name:"nlmsRefNo",type:"text",errors:R}),(0,i.jsx)(mt,{label:"Valid Until",register:I,name:"nlmsEmpValid",type:"date",errors:R}),(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>_(e,S),register:I,name:"nlmsEmpUpload",error:R.nlmsEmpUpload,fileName:D.nlmsEmpUpload||"",uploadedFileNames:D,handleFileChange:_,isUploading:N,deleteFile:async(e,t)=>{try{const a=T("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,j,w,b);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));h("".concat(t)),M()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},field:{title:"nlmsEmpUpload"},formattedPermissions:a,requiredPermissions:["Work Pass"],access:"Employee"})]}),(0,i.jsx)("div",{className:"flex justify-center items-center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),x&&(0,i.jsx)(Pe,{text:v,notification:x,path:"/sawp/nlms"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:M,title1:u})]})},_i=()=>{const e=(0,Ee.D)();return{BGData:(0,n.useCallback)((async t=>{let{BJLValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,bankSubmit:[a.bankSubmit],bankRece:[a.bankRece],bankRefNo:[a.bankRefNo],bankAmt:[a.bankAmt],bankValid:[a.bankValid],bankEndorse:[a.bankEndorse],bankEmpUpload:[a.bankEmpUpload],createdBy:a.createdBy};try{const t=await Promise.all([e.graphql({query:ke.Pu,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}},Mi=()=>{const e=(0,Ee.D)();return{UpdateBJLFun:(0,n.useCallback)((async t=>{let{BJLUpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,bankSubmit:a.bankSubmit,bankRece:a.bankRece,bankRefNo:[a.bankRefNo],bankAmt:[a.bankAmt],bankValid:a.bankValid,bankEndorse:a.bankEndorse,bankEmpUpload:[a.bankEmpUpload],updatedBy:a.updatedBy};try{const t=await Promise.all([e.graphql({query:ke.Yc,variables:{input:r}})]);console.log(t,"successfully Updated data")}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}},Fi=()=>{const{formattedPermissions:e}=qt(),{searchResultData:t}=(0,r.KC)(),{BGData:a}=_i(),{BJLData:l}=(0,n.useContext)(s.Y),{UpdateBJLFun:o}=Mi();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{register:d,handleSubmit:c,watch:p,formState:{errors:m},setValue:u}=(0,tt.mN)({resolver:(0,at.t)(nn),bankSubmit:[],bankRece:[],bankValid:[],bankEndorse:[]}),[h,x]=(0,n.useState)(!1),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(""),[j,A]=(0,n.useState)({bankEmpUpload:!1}),[w,S]=(0,n.useState)({bankEmpUpload:null}),[E,I]=(0,n.useState)({bankEmpUpload:[]}),k=localStorage.getItem("userID"),T=(new Date).toISOString().split("T")[0],C=async(e,t)=>{const a=p("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=p(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{u(t,[...n,r]);try{((e,t)=>{A((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dt(r,t,I,a),S((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},R=()=>{x(!h)};(0,n.useEffect)((()=>{u("empID",t.empID);if(["bankSubmit","bankRece","bankRefNo","bankAmt","bankValid","bankEndorse","bankEmpUpload"].forEach((e=>{const a=(e=>Array.isArray(e)?e[e.length-1]:e)(t[e]);u(e,a)})),t&&t.bankEmpUpload)try{const e=JSON.parse(t.bankEmpUpload).map((e=>"string"===typeof e?JSON.parse(e):e));u("bankEmpUpload",e),I((t=>(0,g.A)((0,g.A)({},t),{},{bankEmpUpload:e}))),S((t=>(0,g.A)((0,g.A)({},t),{},{bankEmpUpload:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(e){console.error("Failed to parse ".concat(t.bankEmpUpload,":"),e)}}),[t,u]);return(0,i.jsxs)("form",{onSubmit:c((async e=>{try{const t=l.find((t=>t.empID===e.empID)),r=e=>e?new Date(e).toLocaleDateString("en-CA"):null,n=r(e.bankEndorse),s=r(e.bankSubmit),i=r(e.bankRece),d=r(e.bankValid);if(t){const a=[...new Set([...t.bankEndorse||[],n])],l=[...new Set([...t.bankRece,i])],c=[...new Set([...t.bankValid,d])],p=[...new Set([...t.bankSubmit,s])],m=t.updatedBy?JSON.parse(t.updatedBy):[],u=[...m,{userID:k,date:T}].map((e=>({userID:e.userID,date:e.date}))),h=(0,g.A)((0,g.A)({},e),{},{id:t.id,bankEndorse:a.map(r),bankRece:l.map(r),bankSubmit:p.map(r),bankValid:c.map(r),bankEmpUpload:JSON.stringify(E.bankEmpUpload),updatedBy:JSON.stringify(u)});await o({BJLUpValue:h}),D("Bank Guarantee Info Updated Successfully"),N(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{bankEndorse:n,bankRece:i,bankSubmit:s,bankValid:d,bankEmpUpload:JSON.stringify(E.bankEmpUpload),createdBy:JSON.stringify([{userID:k,date:T}])});await a({BJLValue:t}),D("Bank Guarantee Info Saved Successfully"),N(!0)}}catch(t){console.error("Error submitting data:",t)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:d,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:m})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5",children:[(0,i.jsx)(mt,{label:"Date Of Submission",register:d,name:"bankSubmit",type:"date",errors:m}),(0,i.jsx)(mt,{label:"Date Received",register:d,name:"bankRece",type:"date",errors:m}),(0,i.jsx)(mt,{label:"BG Reference Number",register:d,name:"bankRefNo",type:"text",errors:m}),(0,i.jsx)(mt,{label:"Bank Guarantee Amount",register:d,name:"bankAmt",type:"text",errors:m}),(0,i.jsx)(mt,{label:"Valid Until",register:d,name:"bankValid",type:"date",errors:m}),(0,i.jsx)(mt,{label:"Date Endorsement Of BG",register:d,name:"bankEndorse",type:"date",errors:m}),(0,i.jsx)("div",{children:(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>C(e,"bankEmpUpload"),register:d,name:"bankEmpUpload",error:m.bankEmpUpload,fileName:w.bankEmpUpload||"",handleFileChange:C,uploadedFileNames:w,isUploading:j,deleteFile:async(e,t)=>{try{const a=p("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,S,I,A);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));v("".concat(t)),R()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},field:{title:"bankEmpUpload"},formattedPermissions:e,requiredPermissions:["Work Pass"],access:"Employee"})})]}),(0,i.jsxs)("div",{className:"flex justify-center items-center my-10",children:[(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"}),y&&(0,i.jsx)(Pe,{text:b,notification:y,path:"/sawp/bankGuarantee"})]}),h&&(0,i.jsx)(Wt,{handleDeleteMsg:R,title1:f})]})},Li=()=>{const{formattedPermissions:e}=qt(),{searchResultData:t}=(0,r.KC)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{BJLData:a}=(0,n.useContext)(s.Y),{UpdateJitpaData:l}=(()=>{const e=(0,Ee.D)();return{UpdateJitpaData:(0,n.useCallback)((async t=>{let{JitpaValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const{tbaPurchase:t,jitpaAmt:r,jpValid:n,jpEndorse:s,jpEmpUpload:i,id:l,updatedBy:o}=a,d={id:l,tbaPurchase:t,jitpaAmt:r,jpValid:n,jpEndorse:s,jpEmpUpload:i,updatedBy:o};await e.graphql({query:ke.Yc,variables:{input:d}})}catch(r){throw console.error("Error updating data:",r),r}}),[])}})(),{JitpaCreData:o}=(()=>{const e=(0,Ee.D)();return{JitpaCreData:(0,n.useCallback)((async t=>{let{creJitpaValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,tbaPurchase:[a.tbaPurchase],jitpaAmt:[a.jitpaAmt],jpValid:[a.jpValid],jpEndorse:[a.jpEndorse],jpEmpUpload:[a.jpEmpUpload],createdBy:a.createdBy};try{const t=await Promise.all([e.graphql({query:ke.Pu,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{register:d,handleSubmit:c,watch:p,formState:{errors:m},setValue:u}=(0,tt.mN)({resolver:(0,at.t)(sn)}),[h,x]=(0,n.useState)(!1),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(""),[j,A]=(0,n.useState)({jpEmpUpload:!1}),[w,S]=(0,n.useState)({jpEmpUpload:null}),[E,I]=(0,n.useState)({jpEmpUpload:[]}),k=p("jpEmpUpload",""),T=localStorage.getItem("userID"),C=(new Date).toISOString().split("T")[0],R=async(e,t)=>{const a=p("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=p(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{u(t,[...n,r]);try{((e,t)=>{A((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t}))),console.log(t)})(t,!0),await dt(r,t,I,a),S((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},P=()=>{x(!h)};(0,n.useEffect)((()=>{u("empID",t.empID);if(["tbaPurchase","jitpaAmt","jpValid","jpEndorse","jpEmpUpload"].forEach((e=>{return u(e,(a=t[e],Array.isArray(a)?a[a.length-1]:a));var a})),t&&t.jpEmpUpload)try{const e=JSON.parse(t.jpEmpUpload).map((e=>"string"===typeof e?JSON.parse(e):e));u("jpEmpUpload",e),I((t=>(0,g.A)((0,g.A)({},t),{},{jpEmpUpload:e}))),S((t=>(0,g.A)((0,g.A)({},t),{},{jpEmpUpload:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(e){console.error("Failed to parse ".concat(t.jpEmpUpload,":"),e)}}),[t,u]);p("empID");return(0,i.jsxs)("form",{onSubmit:c((async e=>{try{const t=a.find((t=>t.empID===e.empID)),r=e=>e?new Date(e).toLocaleDateString("en-CA"):null,n=r(e.tbaPurchase),s=r(e.jpValid),i=r(e.jpEndorse);if(t){const a=[...new Set([...t.tbaPurchase||[],n])],o=[...new Set([...t.jpEndorse||[],i])],d=[...new Set([...t.jpValid||[],s])],c=t.updatedBy?JSON.parse(t.updatedBy):[],p=[...c,{userID:T,date:C}].map((e=>({userID:e.userID,date:e.date}))),m=(0,g.A)((0,g.A)({},e),{},{id:t.id,jpValid:d.map(r),tbaPurchase:a.map(r),jpEndorse:o.map(r),jpEmpUpload:JSON.stringify(E.jpEmpUpload),updatedBy:JSON.stringify(p)});await l({JitpaValue:m}),D("JITPA Info Updated Successfully"),N(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{jpValid:s,tbaPurchase:n,jpEndorse:i,jpEmpUpload:JSON.stringify(E.jpEmpUpload),createdBy:JSON.stringify([{userID:T,date:C}])});await o({creJitpaValue:t}),D("JITPA Info Saved Successfully"),N(!0)}}catch(t){console.error("Error submitting data:",t)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:d,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:m})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5",children:[(0,i.jsx)(mt,{label:"TBA Purchase Date",register:d,name:"tbaPurchase",type:"date",errors:m}),(0,i.jsx)(mt,{label:"JITPA Amount",register:d,name:"jitpaAmt",type:"text",errors:m}),(0,i.jsx)(mt,{label:"Valid Until",register:d,name:"jpValid",type:"date",errors:m}),(0,i.jsx)(mt,{label:"Date Endorsement Of JITPA",register:d,name:"jpEndorse",type:"date",errors:m}),(0,i.jsx)("div",{children:(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>R(e,"jpEmpUpload"),name:"jpEmpUpload",register:d,error:m.jpEmpUpload,fileName:w.jpEmpUpload||(O=k,"string"===typeof O&&O?O.split("/").pop():""),uploadedFileNames:w,handleFileChange:R,isUploading:j,deleteFile:async(e,t)=>{try{const a=p("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,S,I,A);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));v("".concat(t)),P()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},field:{title:"jpEmpUpload"},formattedPermissions:e,requiredPermissions:["Work Pass"],access:"Employee"})})]}),(0,i.jsx)("div",{className:"flex justify-center items-center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),y&&(0,i.jsx)(Pe,{text:b,notification:y,path:"/sawp/jitpa"}),h&&(0,i.jsx)(Wt,{handleDeleteMsg:P,title1:f})]});var O},Ui=()=>{const{formattedPermissions:e}=qt(),{searchResultData:t}=(0,r.KC)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{BJLData:a}=(0,n.useContext)(s.Y),{UpdateLDData:l}=(()=>{const e=(0,Ee.D)();return{UpdateLDData:(0,n.useCallback)((async t=>{let{LDValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const{lbrReceiptNo:t,lbrDepoAmt:r,lbrDepoSubmit:n,lbrDepoUpload:s,id:i,updatedBy:l}=a,o={id:i,lbrReceiptNo:t,lbrDepoAmt:r,lbrDepoSubmit:n,lbrDepoUpload:s,updatedBy:l},d=await e.graphql({query:ke.Yc,variables:{input:o}});console.log("Data successfully updated:",d)}catch(r){throw console.error("Error updating data:",r),r}}),[])}})(),{LabourCreData:o}=(()=>{const e=(0,Ee.D)();return{LabourCreData:(0,n.useCallback)((async t=>{let{creLabpaValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,lbrReceiptNo:[a.lbrReceiptNo],lbrDepoAmt:[a.lbrDepoAmt],lbrDepoSubmit:[a.lbrDepoSubmit],lbrDepoUpload:[a.lbrDepoUpload],createdBy:a.createdBy};try{const t=await Promise.all([e.graphql({query:ke.Pu,variables:{input:r}})]);console.log(t,"successfully Save data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{register:d,handleSubmit:c,watch:p,formState:{errors:m},setValue:u}=(0,tt.mN)({resolver:(0,at.t)(ln)}),[h,x]=(0,n.useState)(!1),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)(""),[j,A]=(0,n.useState)({lbrDepoUpload:!1}),[w,S]=(0,n.useState)({lbrDepoUpload:null}),[E,I]=(0,n.useState)({lbrDepoUpload:[]}),k=p("lbrDepoUpload",""),T=localStorage.getItem("userID"),C=(new Date).toISOString().split("T")[0],R=async(e,t)=>{const a=p("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=p(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{u(t,[...n,r]);try{((e,t)=>{A((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t}))),console.log(t)})(t,!0),await dt(r,t,I,a),S((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},P=()=>{x(!h)};(0,n.useEffect)((()=>{u("empID",t.empID);if(["lbrReceiptNo","lbrDepoAmt","lbrDepoSubmit","lbrDepoUpload"].forEach((e=>{return u(e,(a=t[e],Array.isArray(a)?a[a.length-1]:a));var a})),t&&t.lbrDepoUpload)try{const e=JSON.parse(t.lbrDepoUpload).map((e=>"string"===typeof e?JSON.parse(e):e));u("lbrDepoUpload",e),I((t=>(0,g.A)((0,g.A)({},t),{},{lbrDepoUpload:e}))),S((t=>(0,g.A)((0,g.A)({},t),{},{lbrDepoUpload:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(e){console.error("Failed to parse ".concat(t.lbrDepoUpload,":"),e)}}),[t,u]);p("empID");return(0,i.jsxs)("form",{onSubmit:c((async e=>{try{const t=a.find((t=>t.empID===e.empID)),r=e=>e?new Date(e).toLocaleDateString("en-CA"):null,n=r(e.lbrDepoSubmit);if(t){const a=[...new Set([...t.lbrDepoSubmit||[],n])],s=t.updatedBy?JSON.parse(t.updatedBy):[],i=[...s,{userID:T,date:C}].map((e=>({userID:e.userID,date:e.date}))),o=(0,g.A)((0,g.A)({},e),{},{id:t.id,lbrDepoSubmit:a.map(r),lbrDepoUpload:JSON.stringify(E.lbrDepoUpload),updatedBy:JSON.stringify(i)});await l({LDValue:o}),D("Labour Info Updated Successfully"),N(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{lbrDepoSubmit:n,lbrDepoUpload:JSON.stringify(E.lbrDepoUpload),createdBy:JSON.stringify([{userID:T,date:C}])});await o({creLabpaValue:t}),D("Labour Info Saved Successfully"),N(!0)}}catch(t){console.error("Error submitting data:",t)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:d,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:m})})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5",children:[(0,i.jsx)(mt,{label:"Labour Deposit Receipt Number",register:d,name:"lbrReceiptNo",type:"text",errors:m}),(0,i.jsx)(mt,{label:"Deposit Amount",register:d,name:"lbrDepoAmt",type:"text",errors:m}),(0,i.jsx)(mt,{label:"Date Endorsement Of Labour Deposit",register:d,name:"lbrDepoSubmit",type:"date",errors:m}),(0,i.jsx)("div",{children:(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>R(e,"lbrDepoUpload"),name:"lbrDepoUpload",register:d,error:m.lbrDepoUpload,fileName:w.lbrDepoUpload||(O=k,"string"===typeof O&&O?O.split("/").pop():""),uploadedFileNames:w,handleFileChange:R,isUploading:j,deleteFile:async(e,t)=>{try{const a=p("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,S,I,A);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));v("".concat(t)),P()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},field:{title:"lbrDepoUpload"},formattedPermissions:e,requiredPermissions:["Work Pass"],access:"Employee"})})]}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),y&&(0,i.jsx)(Pe,{text:b,notification:y,path:"/sawp/labourDeposit"}),h&&(0,i.jsx)(Wt,{handleDeleteMsg:P,title1:f})]});var O},Bi=()=>{const e=(0,Ee.D)();return{ImmigrationData:(0,n.useCallback)((async t=>{let{ImmiValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,ppLocation:a.ppLocation,arrivStampUpload:a.arrivStampUpload,immigEmpUpload:a.immigEmpUpload,reEntryUpload:a.reEntryUpload,arrivStampExp:a.arrivStampExp,immigRefNo:a.immigRefNo,ppSubmit:a.ppSubmit,empPassExp:a.empPassExp,empPassStatus:a.empPassStatus,airTktStatus:a.airTktStatus,reEntryVisa:a.reEntryVisa,immigApproval:a.immigApproval,reEntryVisaExp:a.reEntryVisaExp,remarkImmig:a.remarkImmig,createdBy:a.createdBy};try{const t=await Promise.all([e.graphql({query:ke.zY,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}},qi=()=>{const e=(0,Ee.D)();return{UpdateImmigraData:(0,n.useCallback)((async t=>{let{UpImmiValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,ppLocation:a.ppLocation,arrivStampUpload:a.arrivStampUpload,immigEmpUpload:a.immigEmpUpload,reEntryUpload:a.reEntryUpload,arrivStampExp:a.arrivStampExp,immigRefNo:a.immigRefNo,ppSubmit:a.ppSubmit,empPassExp:a.empPassExp,empPassStatus:a.empPassStatus,airTktStatus:a.airTktStatus,reEntryVisa:a.reEntryVisa,immigApproval:a.immigApproval,reEntryVisaExp:a.reEntryVisaExp,remarkImmig:a.remarkImmig,updatedBy:a.updatedBy};try{const t=await Promise.all([e.graphql({query:ke.c9,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}},Hi=()=>{const{formattedPermissions:e}=qt(),{searchResultData:t}=(0,r.KC)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{ImmigrationData:a}=Bi(),{PPValidsData:l}=(0,n.useContext)(s.Y),{UpdateImmigraData:o}=qi(),{register:d,handleSubmit:c,watch:p,trigger:m,formState:{errors:u},setValue:h}=(0,tt.mN)({resolver:(0,at.t)(on),arrivStampExp:[],empPassExp:[],immigApproval:[],ppSubmit:[],reEntryVisaExp:[]}),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)(""),[N,b]=(0,n.useState)(!1),[D,j]=(0,n.useState)(""),[A,w]=(0,n.useState)({arrivStampUpload:!1,immigEmpUpload:!1,reEntryUpload:!1}),[S,E]=(0,n.useState)({arrivStampUpload:null,immigEmpUpload:null,reEntryUpload:null}),[I,k]=(0,n.useState)({arrivStampUpload:[],immigEmpUpload:[],reEntryUpload:[]}),T=localStorage.getItem("userID"),C=(new Date).toISOString().split("T")[0];(0,n.useEffect)((()=>{if(!t)return;h("empID",t.empID);["ppLocation","arrivStampUpload","immigEmpUpload","reEntryUpload","arrivStampExp","immigRefNo","ppSubmit","empPassExp","empPassStatus","airTktStatus","reEntryVisa","immigApproval","reEntryVisaExp","remarkImmig"].forEach((e=>{return h(e,(a=t[e],Array.isArray(a)?a[a.length-1]:a));var a}));const e=e=>{if(t&&t[e])try{const a=JSON.parse(t[e]).map((e=>"string"===typeof e?JSON.parse(e):e));h(e,a),k((t=>(0,g.A)((0,g.A)({},t),{},{[e]:a}))),E((t=>(0,g.A)((0,g.A)({},t),{},{[e]:a.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(a){console.error("Failed to parse ".concat(t[e],":"),a)}};e("arrivStampUpload"),e("immigEmpUpload"),e("reEntryUpload")}),[t,h]);const R=async(e,t)=>{const a=p("empID");if(!a)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/employeeInfo");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=p(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{h(t,[...n,r]);try{((e,t)=>{w((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t}))),console.log(t)})(t,!0),await dt(r,t,k,a),E((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},P=()=>{f(!x)},O=async(e,t)=>{try{const a=p("empID");if(!a)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,a),n=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,a,E,k,w);if(!r||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));y("".concat(t)),P()}catch(a){console.error("Error deleting file:",a),alert("Error processing the file deletion.")}},_=["Work Pass"],M="Employee";return(0,i.jsxs)("form",{onSubmit:c((async e=>{try{const t=l.find((t=>t.empID===e.empID)),r=e=>e?new Date(e).toLocaleDateString("en-CA"):null,n=r(e.arrivStampExp),s=r(e.ppSubmit),i=r(e.empPassExp),d=r(e.immigApproval),c=r(e.reEntryVisaExp);if(t){const a=[...new Set([...t.arrivStampExp||[],n])],l=[...new Set([...t.ppSubmit||[],s])],p=[...new Set([...t.empPassExp||[],i])],m=[...new Set([...t.immigApproval||[],d])],u=[...new Set([...t.reEntryVisaExp||[],c])],h=t.updatedBy?JSON.parse(t.updatedBy):[],x=[...h,{userID:T,date:C}].map((e=>({userID:e.userID,date:e.date}))),f=(0,g.A)((0,g.A)({},e),{},{id:t.id,immigRefNo:"IMMBD/1382",arrivStampExp:a.map(r),ppSubmit:l.map(r),empPassExp:p.map(r),immigApproval:m.map(r),reEntryVisaExp:u.map(r),arrivStampUpload:JSON.stringify(I.arrivStampUpload),immigEmpUpload:JSON.stringify(I.immigEmpUpload),reEntryUpload:JSON.stringify(I.reEntryUpload),updatedBy:JSON.stringify(x)});await o({UpImmiValue:f}),j("Immigration Info Updated successfully"),b(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{immigRefNo:"IMMBD/1382",arrivStampExp:n,ppSubmit:s,empPassExp:i,immigApproval:d,reEntryVisaExp:c,arrivStampUpload:JSON.stringify(I.arrivStampUpload),immigEmpUpload:JSON.stringify(I.immigEmpUpload),reEntryUpload:JSON.stringify(I.reEntryUpload),createdBy:JSON.stringify([{userID:T,date:C}])});await a({ImmiValue:t}),j("Immigration Info Saved Successfully"),b(!0)}}catch(t){console.error("Error submitting data:",t)}})),className:"mx-auto min-h-screen p-2 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsx)("div",{className:"max-w-sm",children:(0,i.jsx)(mt,{label:"Employee ID",register:d,name:"empID",type:"text",placeholder:"Enter Employee ID",errors:u})})}),(0,i.jsxs)("div",{className:"grid grid-cols-3 mt-10 gap-5",children:[(0,i.jsxs)("div",{className:"  ",children:[(0,i.jsx)("label",{className:"mb-1 text_size_6",children:"Original Passport Location"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},d("ppLocation")),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"HRD",children:"HRD"}),(0,i.jsx)("option",{value:"Immigration",children:"Immigration"}),(0,i.jsx)("option",{value:"Employee",children:"Employee"}),(0,i.jsx)("option",{value:"Vacation",children:"Vacation"})]})),u.ppLocation&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:u.ppLocation.message})]}),(0,i.jsx)(mt,{label:"Date Of Arrival Stamping Expiry",register:d,name:"arrivStampExp",type:"date",errors:u}),(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>R(e,"arrivStampUpload"),name:"arrivStampUpload",register:d,error:u,fileName:S.arrivStampUpload||"",uploadedFileNames:S,handleFileChange:R,isUploading:A,deleteFile:O,field:{title:"arrivStampUpload"},formattedPermissions:e,requiredPermissions:_,access:M})]}),(0,i.jsx)("hr",{className:"text-lite_grey mt-7"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5",children:[(0,i.jsx)(mt,{label:"Immigration Reference Number",register:d,name:"immigRefNo",value:"IMMBD/1382",type:"text",errors:u}),(0,i.jsx)(mt,{label:"Passport Submit Date To Immigration Dept",register:d,name:"ppSubmit",type:"date",errors:u}),(0,i.jsx)(mt,{label:"Employment Pass Expiry",register:d,name:"empPassExp",type:"date",errors:u}),(0,i.jsx)(mt,{label:"Employment Pass Status",register:d,name:"empPassStatus",type:"text",errors:u}),(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>R(e,"immigEmpUpload"),register:d,name:"immigEmpUpload",error:u,fileName:S.immigEmpUpload||"",uploadedFileNames:S,handleFileChange:R,isUploading:A,deleteFile:O,field:{title:"immigEmpUpload"},formattedPermissions:e,requiredPermissions:_,access:M})]}),(0,i.jsx)("hr",{className:"text-lite_grey mt-5"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 mt-10 gap-5 ",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_6 ",children:"Air Ticket Status"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},d("airTktStatus")),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"Company",children:"Company"}),(0,i.jsx)("option",{value:"Own",children:"Own"})]})),u.airTktStatus&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:u.airTktStatus.message})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_6",children:"Re-entry Visa Application"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},d("reEntryVisa")),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"Single",children:"Single"}),(0,i.jsx)("option",{value:"Multiple",children:"Multiple"})]})),u.reEntryVisa&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:u.reEntryVisa.message})]}),(0,i.jsx)(mt,{label:"Date Approved by Immigration Dept",register:d,name:"immigApproval",type:"date",errors:u}),(0,i.jsx)(mt,{label:"Re-Entry Visa Expiry",register:d,name:"reEntryVisaExp",type:"date",errors:u}),(0,i.jsx)(Ft,{label:"Upload File",onChangeFunc:e=>R(e,"reEntryUpload"),register:d,name:"reEntryUpload",error:u,fileName:S.reEntryUpload||"",uploadedFileNames:S,handleFileChange:R,isUploading:A,deleteFile:O,field:{title:"reEntryUpload"},formattedPermissions:e,requiredPermissions:_,access:M})]}),(0,i.jsxs)("div",{className:"mt-5",children:[(0,i.jsx)("label",{className:"mb-1 text_size_6",children:"Remarks for Immigration"}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},d("remarkImmig")),{},{className:"resize-none w-full  p-2 mt-1 border bg-lite_skyBlue border-lite_grey rounded-md outline-none",rows:"4"})),u.remarkImmig&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:u.remarkImmig.message})]}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),N&&(0,i.jsx)(Pe,{text:D,notification:N,path:"/sawp/immigration"}),x&&(0,i.jsx)(Wt,{handleDeleteMsg:P,title1:v})]})},Wi=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,l]=(0,n.useState)(0),[o,d]=(0,n.useState)(!0),c=localStorage.getItem("userType"),p="Manager"===c?"Manager":"Manager"!==c?"Unsubmitted":"",m=(0,n.useMemo)((()=>"HO"),["HO"]),u=(0,n.useMemo)((()=>p),[p]),{convertedStringToArrayObj:h}=ri(m,u);return(0,n.useEffect)((()=>{if("Manager"!==c){(async()=>{d(!0);try{if(await new Promise((e=>{h&&h.length>0?e(!0):h?0===h.length&&l(2):l(0)}))){const a=await As(h);a&&a.length>0?(t((e=a)&&e.length>0?e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,REC:e.rec||0,CTR:e.ctr||"",DEPT:e.empDept||"",EMPLOYEEID:e.empID||"",BADGE:e.empBadgeNo||"",NAME:e.empName||0,DATE:e.date||"",ONAM:e.onAM||"",OFFAM:e.offAM||"",ONPM:e.onPM||0,OFFPM:e.offPM||0,IN:(null===e||void 0===e?void 0:e.inTime)||0,OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINUTES:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||"",NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:(null===e||void 0===e?void 0:e.actualWorkHrs)||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,TOTALACTUALHOURS:e.actualWorkHrs||"",jobLocaWhrs:t.flat()||[],fileType:e.fileType,timeKeeper:e.assignBy,manager:e.assignTo,REMARKS:e.remarks||"",status:e.status||""}})):[]),l(1)):l(2)}else l(2)}catch(a){l(2)}finally{d(!1)}var e})()}else"Manager"===c&&(l(null),r(h))}),[h,c]),(0,i.jsx)("div",{children:(0,i.jsx)(oi,{title:"HO",submittedData:e||[],showing:s,ManagerData:a})})},zi=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,l]=(0,n.useState)(0),[o,d]=(0,n.useState)(!0),c=localStorage.getItem("userType"),p="Manager"===c?"Manager":"Manager"!==c?"Unsubmitted":"",m=(0,n.useMemo)((()=>"SBW"),["SBW"]),u=(0,n.useMemo)((()=>p),[p]),{convertedStringToArrayObj:h}=ri(m,u);return(0,n.useEffect)((()=>{if("Manager"!==c){(async()=>{d(!0);try{if(await new Promise((e=>{h&&h.length>0?e(!0):h?0===h.length&&l(2):l(0)}))){const a=await As(h);a&&a.length>0?(t((e=a)&&e.length>0?e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||0,DEPTDIV:e.empDept||"",BADGE:e.empBadgeNo||"",DATE:e.date||"",IN:e.inTime||"",OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINHRS:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}})):[]),l(1)):l(2)}else l(2)}catch(a){l(2)}finally{d(!1)}var e})()}else"Manager"===c&&(l(null),r(h))}),[h,c]),(0,i.jsx)("div",{children:(0,i.jsx)(oi,{title:"SBW",submittedData:e||[],showing:s,ManagerData:a})})},Yi=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,l]=(0,n.useState)(0),[o,d]=(0,n.useState)(!0),c=localStorage.getItem("userType"),p="ORMC",m="Manager"===c?"Manager":"Manager"!==c?"Unsubmitted":"",u=(0,n.useMemo)((()=>p),[p]),h=(0,n.useMemo)((()=>m),[m]),{convertedStringToArrayObj:x}=ri(u,h);return(0,n.useEffect)((()=>{if("Manager"!==c){(async()=>{d(!0);try{if(await new Promise((e=>{x&&x.length>0?e(!0):x?0===x.length&&l(2):l(0)}))){const a=await As(x);a&&a.length>0?(t((e=a)&&e.length>0?e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||0,DEPTDIV:e.empDept||"",BADGE:e.empBadgeNo||"",DATE:e.date||"",IN:e.inTime||"",OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINHRS:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}})):[]),l(1)):l(2)}else l(2)}catch(a){l(2)}finally{d(!1)}var e})()}else"Manager"===c&&(l(null),r(x))}),[x,c]),(0,i.jsx)("div",{children:(0,i.jsx)(oi,{title:"ORMC",submittedData:e||[],showing:s,ManagerData:a})})},Vi=()=>{var e,t;const{empPDData:a,IVSSDetails:l}=(0,n.useContext)(s.Y),[o,d]=(0,n.useState)(null),{setTempID:c}=(0,Fe.b)(),{handleDeletePDDetails:p}=pa(),{formattedPermissions:m}=qt(),[u,h]=(0,n.useState)(!1),[x,g]=(0,n.useState)(""),[f,v]=(0,n.useState)([]),[y,N]=(0,n.useState)([]),[b,D]=(0,n.useState)([]),[A,w]=(0,n.useState)(""),S=(0,r.Zp)(),[E,I]=(0,n.useState)([]),[k,T]=(0,n.useState)(!0),[C,R]=(0,n.useState)(null),P=null===a||void 0===a?void 0:a.map((e=>e.tempID)),O=null===l||void 0===l?void 0:l.map((e=>e.tempID)),_=null===l||void 0===l?void 0:l.filter((e=>null===a||void 0===a?void 0:a.some((t=>t.tempID===e.tempID)))),M=null===P||void 0===P?void 0:P.filter((e=>null===O||void 0===O?void 0:O.includes(e)));(0,n.useEffect)((()=>{const e=null===a||void 0===a?void 0:a.filter((e=>{const t=null===_||void 0===_?void 0:_.find((t=>t.tempID===e.tempID)),a=t&&"Candidate List"===t.status&&"Inactive"!==e.status;return!M.includes(e.tempID)&&"Inactive"!==e.status||a}));N(e),T(!1)}),[a,l,A]);const F=()=>{h(!u)},L=["Candidate"];return(0,i.jsxs)("section",{className:"screen-size min-h-screen w-full my-5",children:[(0,i.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("button",{className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold",children:"List Of All Candidates"})}),(0,i.jsx)("div",{className:"flex-1 flex justify-end ",children:(0,i.jsx)(ya,{allEmpDetails:a,searchUserList:N,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Search",border:"rounded-full",shadow:"shadow-[0_1px_6px_1px_rgba(0,0,0,0.2)]",onChange:e=>w(e.target.value)})})]}),(0,i.jsxs)("div",{className:"flex mb-3 gap-3 justify-end",children:[(0,i.jsx)("div",{className:"text-2xl hover:text-3xl flex items-center cursor-pointer",onClick:()=>{1===f.length?((()=>{if(1===f.length){var e;const t=null===(e=y[f[0]])||void 0===e?void 0:e.tempID;D(t),c(t)}})(),S("/addCandidates",{})):f.length>1?alert("Please select only one row to edit."):alert("Please select a row before editing.")},disabled:0===f.length,children:(0,i.jsx)(Tt.uO9,{className:"mr-2"})}),(null===m||void 0===m||null===(e=m.deleteAccess)||void 0===e||null===(t=e.Recruitment)||void 0===t?void 0:t.some((e=>L.includes(e))))&&(0,i.jsx)("div",{className:"text-3xl hover:text-4xl cursor-pointer text-[#f42232cc] flex items-center",onClick:async()=>{const e=f.map((e=>y[e]));await e.forEach((async(e,t)=>{await p(e.id)}));g("".concat(e.length," candidates.")),await F(),v([])},children:(0,i.jsx)(_t.b6i,{className:"mr-2"})})]}),k?(0,i.jsx)("div",{className:"text-center py-10",children:"Loading..."}):C?(0,i.jsx)("div",{className:"text-center py-10",children:"".concat(C)}):(0,i.jsx)(da,{columns:["Name","Gender","Nationality","TempID","Position","Email","Contact"],rowClickHandler:e=>{d(e.id)},data:y,selectedRows:f,onRowSelect:e=>{v(e);e.map((e=>{var t;return null===(t=y[e])||void 0===t?void 0:t.tempID}))},edited:e=>{I(e)}}),u&&(0,i.jsx)(Wt,{handleDeleteMsg:F,title1:x,path:"/recrutiles/listofcandi"})]})},Gi=(0,Ee.D)(),Ji=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!1),[s,l]=(0,n.useState)(""),[o,d]=(0,n.useState)(!1),[c,p]=(0,n.useState)(null),[m,u]=(0,n.useState)(null),[h,x]=(0,n.useState)(10),[g,f]=(0,n.useState)(1),v=localStorage.getItem("userType");(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");l(e)}),[]);(0,n.useEffect)((()=>{(async()=>{try{const s=localStorage.getItem("userID");if(!s)throw new Error("User ID is not available in localStorage");let i=[],l=null,o=!0;do{var e,a,r,n;const t=await Gi.graphql({query:Ie.Kc,variables:{filter:{requestorID:{eq:s}},nextToken:l}}),d=(null===t||void 0===t||null===(e=t.data)||void 0===e||null===(a=e.listEmpRequisitions)||void 0===a?void 0:a.items)||[];i=[...i,...d],l=null===t||void 0===t||null===(r=t.data)||void 0===r||null===(n=r.listEmpRequisitions)||void 0===n?void 0:n.nextToken,o=!!l}while(o);t(i),u(null)}catch(s){u("Failed to fetch requisition data"),t([])}})()}),[]);(0,n.useEffect)((()=>(document.body.style.overflow=a||o?"hidden":"auto",()=>{document.body.style.overflow="auto"})),[a,o]);const y=Math.ceil(e.length/h),N=(g-1)*h,b=g*h,j=e.slice(N,b);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("section",{className:"bg-[#F5F6F1]",children:(0,i.jsxs)("div",{className:"screen-size",children:[(0,i.jsxs)("div",{className:"flex justify-between my-8",children:[(0,i.jsx)("p",{className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold",children:"My Requisition List"}),"Manager"===v&&(0,i.jsx)("button",{className:"hover:bg-[#f4bf71] border-2 border-[#f4bf71] py-2 px-3 rounded-lg text-[18px] font-semibold",onClick:()=>r(!0),children:"Apply New Requisition"})]}),m&&(0,i.jsx)("div",{className:"text-[red]",children:m}),j.length>0?(0,i.jsx)("div",{className:"recruitmentTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-lg",children:(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0 rounded-lg",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"py-4",children:"S.No"}),(0,i.jsx)("th",{className:"py-4",children:"Position"}),(0,i.jsx)("th",{className:"py-4",children:"Project"}),(0,i.jsx)("th",{className:"py-4",children:"Quantity"}),(0,i.jsx)("th",{className:"py-4",children:"Submitted Date"}),(0,i.jsx)("th",{className:"py-4",children:"Form"}),(0,i.jsx)("th",{className:"py-4",children:"Status"}),(0,i.jsx)("th",{className:"py-4",children:"Remarks"})]})}),(0,i.jsx)("tbody",{className:"bg-white text-center",children:j.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).map(((e,t)=>{return(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-4",children:N+t+1}),(0,i.jsx)("td",{className:"py-4 max-w-[200px] text-ellipsis overflow-hidden",children:e.position}),(0,i.jsx)("td",{className:"py-4 max-w-[200px] text-ellipsis overflow-hidden",children:e.project}),(0,i.jsx)("td",{className:"py-4 ",children:e.quantity}),(0,i.jsx)("td",{className:"py-4 ",children:(0,D.GP)(new Date(e.createdAt),"dd-MM-yyyy")}),(0,i.jsx)("td",{className:"py-4",children:(0,i.jsx)("a",{href:"#",className:"text-[blue] font-semibold border-b-2 cursor-pointer",onClick:()=>(p(e),void d(!0)),children:"View"})}),(0,i.jsx)("td",{className:"py-4 font-semibold ".concat((a=e.status,"Rejected"===a?"text-[red]":"Approved"===a?"text-[#339933]":"text-[#E8A317]")),children:e.status?e.status:"Pending"}),(0,i.jsx)("td",{className:"py-4 max-w-[200px] text-ellipsis overflow-hidden",children:e.remarkReq})]},e.id);var a}))})]})}):(0,i.jsx)("p",{className:"text-center py-4",children:"No Requisitions Found"}),a&&(0,i.jsx)("div",{className:"fixed inset-0 bg-grey bg-opacity-75 flex items-center justify-center z-50",children:(0,i.jsx)("div",{className:"bg-white p-8 rounded-lg shadow-lg w-[90%] max-w-xl",children:(0,i.jsx)(Fn,{userID:s,onClose:()=>r(!1)})})}),o&&c&&(0,i.jsx)(Da,{isVisible:o,onClose:()=>{d(!1)},selectedRequest:c})]})}),j.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center py-10",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:g,totalPages:y,onPageChange:e=>{e>0&&e<=y&&f(e)}})})})]})};var Ki=a(9342);const Qi=e=>{var t,a,r;let{register:s,formData:l,handleInputChange:o,userType:d,gmPosition:c,workInfoData:p,employeeData:m,HRMPosition:u,skillPool:h,probData:x,isExtended:f,handleCheckboxChange:v}=e;const[y,N]=n.useState(""),[b,D]=n.useState(!0),{setSupervisorCheck:j}=(0,Fe.b)();(0,n.useEffect)((()=>{if(l&&l.probData){const e=l.probData.recommendation||"";N(e)}}),[l]);x.filter((e=>(null===e||void 0===e?void 0:e.empID)===(null===m||void 0===m?void 0:m.empID)));(0,n.useEffect)((()=>{if(!p.length||null===m||void 0===m||!m.empID)return;const e=p.find((e=>e.empID===(null===m||void 0===m?void 0:m.empID)));if(e){const t=!!e.supervisor&&"null"!==e.supervisor&&(Array.isArray(e.supervisor)?0!==e.supervisor.length&&"N/A"!==e.supervisor[e.supervisor.length-1]&&!!e.supervisor[0]&&"null"!==e.supervisor[0]:"string"===typeof e.supervisor&&""!==e.supervisor.trim()&&"null"!==e.supervisor&&"N/A"!==e.supervisor);D(t),j(t)}}),[p,null===m||void 0===m?void 0:m.empID]);return(0,i.jsxs)("div",{className:"w-full mx-auto mt-5",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("p",{className:"mb-4",children:"Please indicate any additional information or unusual circumstances considered relevant to the staff performance or assessment. Please specify accordingly."}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},s("additionalInfo")),{},{name:"additionalInfo",value:(null===l||void 0===l||null===(t=l.probData)||void 0===t?void 0:t.additionalInfo)||"",onChange:o,className:"w-full h-32 border p-2 rounded resize-none outline-none",placeholder:"Enter additional information here"}))]}),(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h2",{className:"font-bold bg-black text-white p-2",children:"RECOMMENDATION"}),(0,i.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,i.jsxs)("label",{className:"flex items-center relative",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio"},s("recommendation")),{},{name:"recommendation",value:"confirmed",checked:"confirmed"===y,onChange:o,className:"mr-2 w-6 h-6 border-2 bg-white appearance-none rounded-none"})),(0,i.jsxs)("span",{className:"radio-label flex items-center",children:["confirmed"===y&&(0,i.jsx)(Ki.RXm,{className:"text-[#4ad84a] text-[28px] absolute bottom-0 -left-0.5"}),"The appointment to be confirmed"]})]}),(0,i.jsxs)("label",{className:"flex items-center relative",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio"},s("recommendation")),{},{name:"recommendation",value:"extended",checked:"extended"===y,onChange:o,className:"mr-2 w-6 h-6 border-2 bg-white appearance-none rounded-none"})),(0,i.jsxs)("span",{className:"radio-label flex items-center",children:["extended"===y&&(0,i.jsx)(Ki.RXm,{className:"text-[#4ad84a] text-[28px] absolute bottom-0 -left-0.5"}),"The appointment to be extended for a further probationary period of",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"extendProbED"},s("extendProbED")),{},{value:(null===l||void 0===l||null===(a=l.probData)||void 0===a?void 0:a.extendProbED)||"",onChange:o,className:"w-12 border-b outline-none text-center ml-2",placeholder:"0"}))," ","months"]})]}),(0,i.jsxs)("label",{className:"flex items-center relative",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio"},s("recommendation")),{},{name:"recommendation",value:"terminated",checked:"terminated"===y,onChange:o,className:"mr-2 w-6 h-6 border-2 bg-white appearance-none rounded-none"})),(0,i.jsxs)("span",{className:"radio-label flex items-center",children:["terminated"===y&&(0,i.jsx)(Ki.RXm,{className:"text-[#4ad84a] text-[28px] absolute bottom-0 -left-0.5"}),"The appointment to be terminated"]})]})]})]}),(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("p",{children:"Comments that you would like to include into the probation/employment confirmation letter:"}),(0,i.jsxs)("p",{className:"italic",children:["(It is ",(0,i.jsx)("strong",{children:"compulsory"})," for you to fill in your comment for the ",(0,i.jsx)("strong",{children:"staff level"})," considering his/her attitude, approach, and ability in performing the duties or responsibilities assigned.)"]}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},s("extensionPeriod")),{},{name:"extensionPeriod",value:(null===l||void 0===l||null===(r=l.probData)||void 0===r?void 0:r.extensionPeriod)||"",onChange:o,className:"w-full h-32 border p-2 rounded resize-none outline-none"}))]}),(0,i.jsxs)("div",{className:"mt-20 space-y-16",children:[b&&(0,i.jsxs)("div",{className:"flex justify-between items-center space-x-8",children:[(0,i.jsxs)("div",{className:"flex justify-center items-center w-[380px]",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Name of Supervisor :"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"supervisorName"},s("supervisorName")),{},{value:l.probData.supervisorName||"",onChange:o,disabled:"Supervisor"!==d,className:"border-b outline-none px-1 w-full"}))]}),(0,i.jsxs)("div",{className:"flex items-center space-x-10 border-b",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 ",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",name:"supervisorApproved",value:"Approved"},s("supervisorApproved")),{},{checked:"Approved"===l.probData.supervisorApproved,onChange:o,id:"saApproved",disabled:"Supervisor"!==d,className:"h-4 w-4 form-checkbox"})),(0,i.jsx)("label",{htmlFor:"saApproved",className:"text-sm py-2",children:"Approved"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",name:"supervisorApproved",value:"Rejected"},s("supervisorApproved")),{},{checked:"Rejected"===l.probData.supervisorApproved,onChange:o,id:"saReject",disabled:"Supervisor"!==d,className:"h-4 w-4 form-checkbox"})),(0,i.jsx)("label",{htmlFor:"saReject",className:"text-sm py-2",children:"Rejected"})]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2 border-b",children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date",name:"supervisorDate"},s("supervisorDate")),{},{value:l.probData.supervisorDate||"",onChange:o,disabled:"Supervisor"!==d,className:"outline-none"}))})]}),(0,i.jsxs)("div",{className:"flex justify-between items-center space-x-8",children:[(0,i.jsxs)("div",{className:"flex justify-center items-center w-[380px]",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Name of Manager :"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"managerName"},s("managerName")),{},{value:l.probData.managerName||"",onChange:o,disabled:"Supervisor"===d||"HR"===d||"Manager"===d&&("HR MANAGER"===u||"GENERAL MANAGER"===c),className:"border-b outline-none px-1 w-full"}))]}),(0,i.jsxs)("div",{className:"flex items-center space-x-10 border-b",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",value:"Approved",name:"managerApproved"},s("managerApproved")),{},{checked:"Approved"===l.probData.managerApproved,onChange:o,id:"managerApproved",disabled:"Manager"!==d,className:"h-4 w-4 form-checkbox"})),(0,i.jsx)("label",{htmlFor:"managerApproved",className:"text-sm py-2",children:"Approved"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",value:"Rejected",name:"managerApproved"},s("managerApproved")),{},{checked:"Rejected"===l.probData.managerApproved,onChange:o,id:"managerReject",disabled:"Manager"!==d,className:"h-4 w-4 form-checkbox"})),(0,i.jsx)("label",{htmlFor:"managerReject",className:"text-sm py-2",children:"Rejected"})]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2 border-b",children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date",name:"managerDate"},s("managerDate")),{},{value:l.probData.managerDate||"",onChange:o,disabled:"Manager"!==d,className:"outline-none"}))})]}),null===h&&(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{className:"w-[380px]",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Concurred By GM :"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"gmName"},s("gmName")),{},{value:l.probData.gmName||"",onChange:o,disabled:"GENERAL MANAGER"!==c,className:"border-b outline-none px-1 w-[250px]"})),(0,i.jsx)("p",{className:"text-[12px]",children:"(For Staff Category Only)"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-10 border-b",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2 ",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",value:"Approved",name:"gmApproved"},s("gmApproved")),{},{checked:"Approved"===l.probData.gmApproved,onChange:o,id:"gmApproved",disabled:"GENERAL MANAGER"!==c,className:"h-4 w-4 form-checkbox"})),(0,i.jsx)("label",{htmlFor:"gmApproved",className:"text-sm py-2",children:"Approved"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"radio",value:"Rejected",name:"gmApproved"},s("gmApproved")),{},{checked:"Rejected"===l.probData.gmApproved,onChange:o,id:"gmReject",disabled:"GENERAL MANAGER"!==c,className:"h-4 w-4 form-checkbox"})),(0,i.jsx)("label",{htmlFor:"gmReject",className:"text-sm py-2",children:"Rejected"})]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2 border-b ",children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date",name:"gmDate"},s("gmDate")),{},{value:l.probData.gmDate||"",onChange:o,disabled:"GENERAL MANAGER"!==c,className:"outline-none"}))})]})]}),"HR"===d&&(0,i.jsxs)("div",{className:"mt-10 flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",id:"probExtendStatus",checked:f,onChange:v,className:"mr-2 h-4 w-4"}),(0,i.jsx)("label",{htmlFor:"probExtendStatus",className:"text-lg font-medium",children:"Extend probation"})]}),(0,i.jsxs)("div",{className:"border pt-4 mt-5",children:[(0,i.jsx)("h3",{className:"font-bold underline p-2",children:"Human Resources Department"}),(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"font-semibold border-b p-2",children:"Received & Action By :"})}),(0,i.jsxs)("div",{className:"flex justify-evenly items-center border-b py-5",children:[(0,i.jsxs)("div",{className:"flex justify-center items-center",children:[(0,i.jsx)("label",{className:"text-sm font-medium",children:"Name :"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"hrName"},s("hrName")),{},{value:l.probData.hrName||"",onChange:o,disabled:"HR MANAGER"!==u&&"HR"!==d,className:"border-b outline-none px-1"}))]}),(0,i.jsx)("div",{className:"flex items-center space-x-2 border-b",children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date",name:"hrDate"},s("hrDate")),{},{value:l.probData.hrDate||"",onChange:o,disabled:"HR MANAGER"!==u&&"HR"!==d,className:"outline-none"}))})]})]})]})},$i=e=>{let{title:t,name:a,register:s,formData:l,handleInputChange:o}=e;const[d,c]=(0,n.useState)(""),[p,m]=(0,n.useState)(""),u=(0,r.zy)(),{employeeData:h}=u.state||{};(0,n.useEffect)((()=>{null!==l&&void 0!==l&&l.probData?(c(l.probData[a]||""),m(l.probData["".concat(a,"Details")]||"")):(c(""),m(""))}),[l,a]);const x=e=>{const{name:t,value:a}=e.target;c(a),o(e)};return(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"font-semibold",children:t}),(0,i.jsxs)("div",{className:"mt-2 flex flex-wrap items-start justify-between",children:[(0,i.jsx)("div",{className:"flex flex-col space-y-2",children:[{value:"exceeding",label:"Exceeding expectations"},{value:"meeting",label:"Meeting expectations"},{value:"notMeeting",label:"Not meeting expectations (provide details)"}].map((e=>(0,i.jsxs)("label",{htmlFor:"".concat(a,"_").concat(e.value),className:"flex items-center relative",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({id:"".concat(a,"_").concat(e.value),type:"radio",name:a},s(a)),{},{value:e.value,checked:d===e.value,onChange:x,className:"mr-2 appearance-none w-5 h-5 border rounded-sm"})),e.label,d===e.value&&(0,i.jsx)(Ki.RXm,{className:"text-[#4ad84a] text-[28px] absolute -bottom-0.5 -left-0.5"})]},e.value)))}),"notMeeting"===d&&(0,i.jsx)("div",{className:"ml-6 w-1/2",children:(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},s("".concat(a,"Details"),{required:!0})),{},{value:p,onChange:e=>{const{name:t,value:a}=e.target;m(a),o({target:{name:t,value:a}})},placeholder:"Please provide details",name:"".concat(a,"Details"),className:"w-full border p-4 rounded resize-none outline-none scrollBar"}))})]})]})},Zi=e=>{let{register:t,formData:a,handleInputChange:r}=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Employee Performance"}),(0,i.jsx)($i,{title:"1) Communication and Inter-personal Skill",name:"communication",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"2) Quality of Work",name:"quality",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"3) Pace of Work",name:"pace",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"4) Initiative",name:"initiative",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"5) Attitude and professionalism",name:"attitude",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"6) Adaptability",name:"adaptability",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"7) Teamwork",name:"teamwork",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"8) Responsible and dependable",name:"responsibility",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"9) Diligent",name:"diligent",register:t,formData:a,handleInputChange:r}),(0,i.jsx)($i,{title:"10) Commitment towards the job",name:"commitment",register:t,formData:a,handleInputChange:r})]})};var Xi=a(5239),el=a.n(Xi),tl=a(7762);const al=e=>{const t=document.getElementById(e);if(!t)return void console.error("Element with ID ".concat(e," not found"));const a=t.querySelectorAll('input[type="date"]'),r=[];a.forEach(((e,t)=>{const a=new Date(e.value).toLocaleDateString("en-GB").replace(/\//g,"-"),n=document.createElement("span");n.textContent=a,n.style.font=window.getComputedStyle(e).font,n.style.padding=window.getComputedStyle(e).padding,r.push({input:e,value:e.value,parent:e.parentNode,sibling:e.nextSibling,replacement:n}),e.style.display="none",e.parentNode.insertBefore(n,e.nextSibling)}));const n=t.parentElement,s=n.style.height;n.style.height="auto",el()(t,{useCORS:!0,scale:2,scrollY:-window.scrollY}).then((e=>{n.style.height=s,r.forEach((e=>{let{input:t,replacement:a}=e;t.style.display="",a.remove()}));const t=new tl.default({orientation:"portrait",unit:"mm",format:"a4"}),a=t.internal.pageSize.getWidth(),i=t.internal.pageSize.getHeight(),l=a-0-0,o=(e.height,e.width,i-4-4),d=e.width/l*o;let c=0,p=0;for(;c<e.height;){const a=document.createElement("canvas"),r=a.getContext("2d");a.width=e.width,a.height=Math.min(d,e.height-c),r.drawImage(e,0,c,e.width,a.height,0,0,e.width,a.height);const n=a.toDataURL("image/jpeg",1);p>0&&t.addPage();const s=a.height*l/e.width;t.addImage(n,"JPEG",0,4,l,s),c+=d,p++}t.save("ProbationForm.pdf")})).catch((e=>{console.error("Error generating PDF:",e)}))},rl=()=>{const e=(0,Ee.D)();return{ProbFormsData:(0,n.useCallback)((async t=>{let{ProbValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,adaptability:a.adaptability,additionalInfo:a.additionalInfo,attention:a.attention,attitude:a.attitude,commitment:a.commitment,communication:a.communication,deadline:a.deadline,extendDate:a.extendDate,diligent:a.diligent,extendProbED:a.extendProbED,extensionPeriod:a.extensionPeriod,gmApproved:a.gmApproved,gmDate:a.gmDate,hrDate:a.hrDate,hrName:a.hrName,initiative:a.initiative,managerApproved:a.managerApproved,managerDate:a.managerDate,managerName:a.managerName,pace:a.pace,quality:a.quality,recommendation:a.recommendation,responsibility:a.responsibility,supervisorApproved:a.supervisorApproved,supervisorDate:a.supervisorDate,supervisorName:a.supervisorName,teamwork:a.teamwork,communicationDetails:a.communicationDetails,qualityDetails:a.qualityDetails,paceDetails:a.paceDetails,initiativeDetails:a.initiativeDetails,attitudeDetails:a.attitudeDetails,adaptabilityDetails:a.adaptabilityDetails,teamworkDetails:a.teamworkDetails,responsibilityDetails:a.responsibilityDetails,diligentDetails:a.diligentDetails,commitmentDetails:a.commitmentDetails,probStatus:a.probStatus,probExtendStatus:a.probExtendStatus,prevProbExDate:a.prevProbExDate};try{await Promise.all([e.graphql({query:ke.ye,variables:{input:r}})])}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}},nl=()=>{const e=(0,Ee.D)();return{UpdateProb:(0,n.useCallback)((async t=>{let{PbFDataUp:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,adaptability:a.adaptability,additionalInfo:a.additionalInfo,attention:a.attention,attitude:a.attitude,commitment:a.commitment,communication:a.communication,deadline:a.deadline,extendDate:a.extendDate,diligent:a.diligent,extendProbED:a.extendProbED,extensionPeriod:a.extensionPeriod,gmName:a.gmName,gmApproved:a.gmApproved,gmDate:a.gmDate,hrDate:a.hrDate,hrName:a.hrName,initiative:a.initiative,managerApproved:a.managerApproved,managerDate:a.managerDate,managerName:a.managerName,pace:a.pace,quality:a.quality,recommendation:a.recommendation,responsibility:a.responsibility,supervisorApproved:a.supervisorApproved,supervisorDate:a.supervisorDate,supervisorName:a.supervisorName,teamwork:a.teamwork,communicationDetails:a.communicationDetails,qualityDetails:a.qualityDetails,paceDetails:a.paceDetails,initiativeDetails:a.initiativeDetails,attitudeDetails:a.attitudeDetails,adaptabilityDetails:a.adaptabilityDetails,teamworkDetails:a.teamworkDetails,responsibilityDetails:a.responsibilityDetails,diligentDetails:a.diligentDetails,commitmentDetails:a.commitmentDetails,probStatus:a.probStatus,probExtendStatus:a.probExtendStatus,prevProbExDate:a.prevProbExDate};try{await Promise.all([e.graphql({query:ke.Vm,variables:{input:r}})])}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}},sl=ka.Ik({extendDate:ka.Yj().notRequired()}),il=(ka.Ik({empID:ka.Yj().required("UserID is mandatory"),adaptability:ka.Yj().notRequired()}),e=>{let{userID:t,userType:a}=e;const l=(0,r.zy)(),{gmPosition:o,supervisorCheck:d,PDInfo:c,HRMPosition:p}=(0,Fe.b)(),{createNotification:m}=_e(),{employeeData:u}=l.state||{},h=null===u||void 0===u?void 0:u.probationEndDate,{ProbFormsData:x}=rl(),{UpdateProb:f}=nl(),[v,y]=(0,n.useState)(!1),[N,b]=(0,n.useState)(!1),[D,j]=(0,n.useState)(!1),{empPIData:A,workInfoData:w,ProbFData:S}=(0,n.useContext)(s.Y),[E,I]=(0,n.useState)({supervisorEmpID:"",supervisorName:"",managerEmpID:"",supervisorOfficialMail:"",managerOfficialMail:"",managerName:"",hrOfficialmail:"",gmOfficialMail:"",gmName:"",skilledAndUnskilled:null}),[k,T]=(0,n.useState)({probData:{id:"",adaptability:"",additionalInfo:"",attention:"",attitude:"",commitment:"",communication:"",deadline:"",diligent:"",extensionPeriod:"",gmDate:"",hrDate:"",hrName:null,initiative:"",managerDate:"",managerName:"",gmName:null,pace:"",quality:"",recommendation:"",responsibility:"",supervisorDate:"",supervisorName:"",teamwork:"",extendProbED:"",gmApproved:"",managerApproved:null,supervisorApproved:null,communicationDetails:"",qualityDetails:"",paceDetails:"",initiativeDetails:"",attitudeDetails:"",adaptabilityDetails:"",teamworkDetails:"",responsibilityDetails:"",diligentDetails:"",createdAt:"",commitmentDetails:"",extendDate:"",probExtendStatus:"Review"}}),[C,R]=(0,n.useState)(!1),[P,O]=(0,n.useState)(""),_="GENERAL MANAGER",{register:M,handleSubmit:F,formState:{errors:L}}=(0,tt.mN)({resolver:(0,at.t)(sl),defaultValues:k});(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);let U="Invalid Date";if(h){const e=h.includes("/")?"/":"-",[t,a,r]=h.split(e),n="".concat(r,"-").concat(a,"-").concat(t),s=new Date(n);isNaN(s)||(U=s.toLocaleDateString("en-US",{month:"long",year:"numeric"}))}(0,n.useEffect)((()=>{if(!w.length||!A.length||null===u||void 0===u||!u.empID)return;const e=w.find((e=>e.empID===u.empID));if(e){const t=e.supervisor[e.supervisor.length-1],a=e.manager[e.manager.length-1],r=e.hr[e.hr.length-1];if(I((e=>(0,g.A)((0,g.A)({},e),{},{supervisorEmpID:t,managerEmpID:a,hrOfficialmail:r}))),a){const e=A.find((e=>e.empID===String(a)));e?I((t=>(0,g.A)((0,g.A)({},t),{},{managerOfficialMail:e.officialEmail,managerName:e.name}))):console.log("Manager Info not found.")}if(t){const e=A.find((e=>e.empID===String(t)));e?I((t=>(0,g.A)((0,g.A)({},t),{},{supervisorOfficialMail:e.officialEmail,supervisorName:e.name}))):console.log("Supervisor Info not found.")}e.skillPool&&(e.skillPool.includes("SKILLED")||e.skillPool.includes("UNSKILLED"))&&I((t=>(0,g.A)((0,g.A)({},t),{},{skilledAndUnskilled:e.skillPool})));const n=null===w||void 0===w?void 0:w.filter((e=>{var t,a,r;return null===e||void 0===e||null===(t=e.position)||void 0===t||null===(a=t[(null===e||void 0===e||null===(r=e.position)||void 0===r?void 0:r.length)-1])||void 0===a?void 0:a.includes("GENERAL MANAGER")}));if((null===n||void 0===n?void 0:n.length)>0){const e=[],t=[];null===n||void 0===n||n.forEach((a=>{const r=A.find((e=>e.empID===String(a.empID)));r?(e.push(r.officialEmail),t.push(r.name),I((a=>(0,g.A)((0,g.A)({},a),{},{gmOfficialMail:e,gmName:t})))):console.log("GM Info not found.")}))}else console.log("No General Manager positions found.")}else console.log("No work info found for employee ID:",null===u||void 0===u?void 0:u.empID)}),[w,null===u||void 0===u?void 0:u.empID,A]),(0,n.useEffect)((()=>{}),[E]),(0,n.useEffect)((()=>{if(0===S.length||null===u||void 0===u||!u.empID)return;const e=S.filter((e=>e.empID===u.empID));if(0===e.length)return;const t=e.find((e=>e.createdAt===u.probCreatedAt));if(!t)return;const a=Object.keys(t).reduce(((e,a)=>(e[a]=t[a]||"",e)),{});T({probData:a}),j("Extended"===a.probExtendStatus)}),[S,null===u||void 0===u?void 0:u.empID,null===u||void 0===u?void 0:u.probCreatedAt]);const B=e=>{if(!e.target)return void console.error("Event target is undefined");const{name:t,value:a}=e.target;T((e=>(0,g.A)((0,g.A)({},e),{},{probData:(0,g.A)((0,g.A)({},e.probData),{},{[t]:a})})))},q="hr_no-reply@adininworks.com",H="Probation Period Expiry Notification",W=async(e,t,r,n,s,i,l,d)=>{try{if("Supervisor"===a&&(await Me("Probation Assessment Review","<html>\n          <body>\n            <p>Your Employee Mr./Ms. ".concat(null===t||void 0===t?void 0:t.name,"'s probation period ending on ").concat(r||"Not Mentioned","</p>\n            <p>has been ").concat((null===e||void 0===e?void 0:e.supervisorApproved)||n.supervisorApproved," by Supervisor, ").concat(c||"Not Mentioned",".</p>\n            <p>Click here https://hr.adininworks.co to view the assessment form.</p>\n          </body>\n        </html>"),q,E.managerOfficialMail),await m({empID:u.empID,leaveType:s,message:i,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:E.managerOfficialMail})),"Manager"===a&&o!==_)if(null===E.skilledAndUnskilled){if(Array.isArray(E.gmOfficialMail))for(let a of E.gmOfficialMail)await Me("Probation Assessment Review","<html>\n                <body>\n                  <p>Your Employee Mr./Ms. ".concat(null===t||void 0===t?void 0:t.name,"'s probation period ending on ").concat(r||"Not Mentioned","</p>\n                  <p>has been reviewed and ").concat((null===e||void 0===e?void 0:e.managerApproved)||n.managerApproved," by the Manager, ").concat(c||"Not Mentioned",".</p>\n                  <p>Click here https://hr.adininworks.co to view the assessment form.</p>\n                </body>\n              </html>"),q,a);if(Array.isArray(E.gmOfficialMail))for(let e of E.gmOfficialMail)await m({empID:u.empID,leaveType:s,message:d,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:e})}else await Me(H,"<html>\n            <body>\n              <p>Your Employee Mr./Ms. ".concat((null===t||void 0===t?void 0:t.name)||"Not mentioned","'s probation period ending on ").concat(r||"Not Mentioned","</p>\n              <p>has been reviewed and ").concat((null===e||void 0===e?void 0:e.managerApproved)||n.managerApproved," by the Manager, ").concat(c||"Not Mentioned",".</p>\n              <p>Please proceed with the necessary actions.</p>\n              <p>Click here https://hr.adininworks.co to view the updates.</p>\n            </body>\n          </html>"),q,E.hrOfficialmail),await m({empID:u.empID,leaveType:s,message:l,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:E.hrOfficialmail});else o===_&&(await Me(H,"<html>\n          <body>\n            <p>Your Employee Mr./Ms. ".concat((null===t||void 0===t?void 0:t.name)||"Not mentioned","'s probation period ending on ").concat(r||"Not Mentioned","</p>\n            <p>has been reviewed and ").concat((null===e||void 0===e?void 0:e.gmApproved)||n.gmApproved," by the General Manager, ").concat(c||"Not Mentioned",".</p>\n            <p>Please proceed with the necessary actions.</p>\n            <p>Click here https://hr.adininworks.co to view the updates.</p>\n          </body>\n        </html>"),q,E.hrOfficialmail),await m({empID:u.empID,leaveType:s,message:l,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:E.hrOfficialmail}))}catch(p){console.error("Error sending email:",p),alert("An error occurred while sending the email.")}},z=(0,n.useRef)(),Y=(0,Ir.useReactToPrint)({content:()=>z.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete")});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{id:"capture-section",ref:z,children:[(0,i.jsx)("style",{children:(0,i.jsx)("style",{children:"\n      @media print {\n        @page {\n          // size: A4 portrait;\n          margin: 0.2cm;\n        }\n        \n        body {\n          zoom: 85%;\n        }\n        \n        #capture-section {\n          page-break-inside: avoid;\n        }\n        \n        form {\n          padding: 10px !important;\n        }\n        \n        .mb-10, .my-10, .mt-5 {\n          margin: 0.5rem !important;\n        }\n        \n        table {\n          font-size: 12px;\n          page-break-inside: avoid;\n        }\n        \n        .no-print, .no-print-parent {\n          display: none !important;\n        }\n        \n        /* Reduce logo size for printing */\n        img {\n          max-width: 300px !important;\n        }\n        \n        /* Compact form sections */\n        .text-lg {\n          font-size: 16px;\n        }\n      }\n    "})}),(0,i.jsxs)("form",{onSubmit:F((async e=>{console.log("Data",e),y(!0);try{const t=["id","adaptability","additionalInfo","attention","attitude","commitment","communication","deadline","extendDate","diligent","extensionPeriod","gmDate","hrDate","hrName","initiative","managerDate","managerName","gmName","pace","quality","recommendation","responsibility","supervisorDate","supervisorName","teamwork","extendProbED","gmApproved","managerApproved","supervisorApproved","communicationDetails","qualityDetails","paceDetails","initiativeDetails","attitudeDetails","adaptabilityDetails","teamworkDetails","responsibilityDetails","diligentDetails","commitmentDetails","probStatus","createdAt","probExtendStatus","prevProbExDate"].reduce(((e,t)=>(e[t]=k.probData[t],e)),{}),r=S.find((e=>e.id===t.id)),n=A.find((t=>t.empID===e.empID)),s=w.find((t=>t.empID===e.empID)),i=Array.isArray(s.probationEnd)&&s.probationEnd.length>0?s.probationEnd[s.probationEnd.length-1].split("-").reverse().join("/"):"Not mentioned",l=Array.isArray(s.probationEnd)&&s.probationEnd.length>0?s.probationEnd[s.probationEnd.length-1]:"Not mentioned",m="Probation Assessment Review",u="Your Employee Mr./Ms. ".concat(null===n||void 0===n?void 0:n.name,"'s probation period ending on ").concat(i||"Not Mentioned"," has been ").concat((null===e||void 0===e?void 0:e.supervisorApproved)||(null===r||void 0===r?void 0:r.supervisorApproved)," by Supervisor, ").concat(c||"Not Mentioned","."),h="Your Employee Mr./Ms. ".concat(null===n||void 0===n?void 0:n.name,"'s probation period ending on ").concat(i||"Not Mentioned","\n      has been reviewed and ").concat((null===e||void 0===e?void 0:e.managerApproved)||(null===r||void 0===r?void 0:r.managerApproved)," by the Manager, ").concat((null===E||void 0===E?void 0:E.managerName)||"Not Mentioned","."),v="Your Employee Mr./Ms. ".concat(null===n||void 0===n?void 0:n.name,"'s probation period ending on ").concat(i||"Not Mentioned","\n      has been reviewed and ").concat((null===e||void 0===e?void 0:e.gmApproved)||(null===r||void 0===r?void 0:r.gmApproved)," by the General Manager, ").concat((null===E||void 0===E?void 0:E.managerName)||"Not Mentioned",".");if(r){const s=(0,g.A)((0,g.A)({id:r.id},t),{},{probStatus:!0});if("Manager"===a&&o!==_&&null===k.probData.supervisorApproved&&!0===d)return alert("Supervisor approval or rejection required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerName)return alert("Manager name is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerApproved)return alert("Manager approval or rejection is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerDate)return alert("Manager date is required!"),void y(!1);if(o===_&&null===k.probData.managerApproved)return alert("Manager approval or rejection is required!"),void y(!1);if(o===_&&!k.probData.gmName)return alert("GM name is required!"),void y(!1);if(o===_&&!k.probData.gmApproved)return alert("GM approval or rejection is required!"),void y(!1);if(o===_&&!k.probData.gmDate)return alert("GM date is required!"),void y(!1);if("HR MANAGER"===p&&!k.probData.gmApproved)return alert("GM approval or rejection is required!"),void y(!1);if("HR MANAGER"===p&&!k.probData.hrName)return alert("HR name is required!"),void y(!1);if("HR MANAGER"===p&&!k.probData.hrDate)return alert("HR date is required!"),void y(!1);await f({PbFDataUp:s}),y(!1),setTimeout((()=>{R(!0),O("Probation form updated successfully")}),1e3),W(e,n,i,r,m,u,h,v)}else{const r=(0,g.A)((0,g.A)((0,g.A)({},e),t),{},{probStatus:!0,prevProbExDate:l,probExtendStatus:"In Probation"});if("Supervisor"===a&&!k.probData.supervisorApproved&&!k.probData.supervisorDate)return alert("Supervisor approval or Rejection and date is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&null===k.probData.supervisorApproved&&!0===d)return console.log("Supervisor approval block triggered"),alert("Supervisor Approval required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerApproved)return alert("Manager approval or Rejection is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerDate)return alert("Manager date is required!"),void y(!1);await x({ProbValue:r}),y(!1),setTimeout((()=>{R(!0),O("Probation form created successfully")}),1e3),W(e,n,i,m,u,h,v)}}catch(t){y(!1),console.error("Error submitting form:",t)}})),className:"p-10 bg-white shadow-md w-full px-20 mx-auto",children:[(0,i.jsxs)("section",{className:"flex items-center mb-6",children:[(0,i.jsx)(r.N_,{to:"/reports",id:"left-button",className:"no-print left-button text-xl text-start w-[50px] text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("div",{className:" w-full center pr-10",children:(0,i.jsx)("img",{className:" max-w-[400px]",src:Se.A,alt:"Logo not found"})})]}),(0,i.jsx)("div",{className:"text-center text-lg font-bold uppercase w-full",children:"Probation Completion Form for the Month of ".concat(U)}),(0,i.jsxs)("div",{className:"mb-10 mt-6",children:[(0,i.jsxs)("p",{className:"text-md mt-2",children:["For the attention of:"," ",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"attention"},M("attention")),{},{value:k.probData.attention,onChange:B,className:"border-b border-black focus:outline-none px-1"}))]}),(0,i.jsxs)("p",{className:"text-md mt-3",children:["Deadline submit to Human Resources Department by:"," ",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"deadline"},M("deadline")),{},{value:k.probData.deadline||(null===u||void 0===u?void 0:u.deadline),onChange:B,className:"border-b border-black outline-none px-1"}))]})]}),(0,i.jsxs)("div",{className:"w-full mx-auto mb-10",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Employee Details:"}),(0,i.jsx)("table",{className:"w-full border border-black table-fixed",children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Employee Name"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.name)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Employee ID"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.empID)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Badge Number"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.empBadgeNo)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Department"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.department)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Position"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.position)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Date Joined"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:null!==u&&void 0!==u&&u.dateOfJoin?null===u||void 0===u?void 0:u.dateOfJoin:(null===u||void 0===u?void 0:u.doj)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Probation End Date"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:null!==u&&void 0!==u&&u.prevProbExDate?function(e){if(/^\d{2}-\d{2}-\d{4}$/.test(e))return e;if(/^\d{2}\/\d{2}\/\d{4}$/.test(e))return e.replace(/\//g,"-");const t=new Date(e);if(isNaN(t))return e;const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)}(null===u||void 0===u?void 0:u.prevProbExDate):(null===u||void 0===u?void 0:u.probationEndDate)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Extended Probation End Date"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date",name:"extendDate"},M("extendDate")),{},{value:k.probData.extendDate,onChange:B,className:"w-full px-1"}))})]})]})})]}),(0,i.jsx)(Zi,{register:M,formData:k,handleInputChange:B}),(0,i.jsx)(Qi,{employeeData:u,workInfoData:w,register:M,formData:k,handleInputChange:B,skillPool:E.skilledAndUnskilled,errors:L,userType:a,gmPosition:o,HRMPosition:p,probData:S,handleCheckboxChange:e=>{const{checked:t}=e.target;j(t),T((e=>(0,g.A)((0,g.A)({},e),{},{probData:(0,g.A)((0,g.A)({},e.probData),{},{probExtendStatus:t?"Extended":"Not Extended"})})))},isExtended:D}),"SuperAdmin"!==a&&(0,i.jsx)("div",{className:"flex justify-center gap-4 py-8 no-print-parent text-center",children:N?(0,i.jsx)("p",{className:"text-lg font-semibold",children:"Downloading..."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{id:"save-button",onClick:()=>F(),disabled:v,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:v?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Submitting"}),(0,i.jsx)("span",{className:"ml-1 animate-spin border-2 border-t-2 border-t-white border-gray-300 rounded-full w-4 h-4"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Submit"}),(0,i.jsx)(Tt.dIn,{className:"ml-2 mt-1"})]})}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{id:"download-button",onClick:e=>(e=>{e.preventDefault(),e.stopPropagation(),b(!0);const t=document.getElementById("left-button"),a=document.getElementById("download-button"),r=document.getElementById("print-button"),n=document.getElementById("save-button");t&&(t.style.visibility="hidden"),a&&(a.style.visibility="hidden"),r&&(r.style.visibility="hidden"),n&&(n.style.visibility="hidden"),al("capture-section"),setTimeout((()=>{t&&(t.style.visibility="visible"),a&&(a.style.visibility="visible"),r&&(r.style.visibility="visible"),n&&(n.style.visibility="visible"),b(!1)}),500)})(e),className:"border-yellow border-2 text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:[(0,i.jsx)("span",{children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]}),(0,i.jsxs)("button",{id:"print-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),Y()},className:"border-yellow border-2 text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:[(0,i.jsx)("span",{children:"Print"}),(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})]})]})}),C&&(0,i.jsx)(Pe,{text:P,notification:C,path:"/reports"})]})]})})}),ll=e=>{let{userID:t,userType:a}=e;const l=(0,r.zy)(),{gmPosition:o,supervisorCheck:d,PDInfo:c,HRMPosition:p}=(0,Fe.b)(),{createNotification:m}=_e(),{employeeData:u}=l.state||{},h=null===u||void 0===u?void 0:u.probationEndDate,{ProbFormsData:x}=rl(),{UpdateProb:f}=nl(),[v,y]=(0,n.useState)(!1),[N,b]=(0,n.useState)(!1),[D,j]=(0,n.useState)(!1),{empPIData:A,workInfoData:w,ProbFData:S}=(0,n.useContext)(s.Y),[E,I]=(0,n.useState)({supervisorEmpID:"",supervisorName:"",managerEmpID:"",supervisorOfficialMail:"",managerOfficialMail:"",managerName:"",hrOfficialmail:"",gmOfficialMail:"",gmName:"",skilledAndUnskilled:null}),[k,T]=(0,n.useState)({probData:{adaptability:"",additionalInfo:"",attention:"",attitude:"",commitment:"",communication:"",deadline:"",diligent:"",extensionPeriod:"",gmDate:"",hrDate:"",hrName:null,initiative:"",managerDate:"",managerName:"",gmName:null,pace:"",quality:"",recommendation:"",responsibility:"",supervisorDate:"",supervisorName:"",teamwork:"",extendProbED:"",gmApproved:"",managerApproved:null,supervisorApproved:null,communicationDetails:"",qualityDetails:"",paceDetails:"",initiativeDetails:"",attitudeDetails:"",adaptabilityDetails:"",teamworkDetails:"",responsibilityDetails:"",diligentDetails:"",createdAt:"",commitmentDetails:"",extendDate:"",probExtendStatus:"Review"}}),[C,R]=(0,n.useState)(!1),[P,O]=(0,n.useState)(""),_="GENERAL MANAGER",{register:M,handleSubmit:F,formState:{errors:L}}=(0,tt.mN)({resolver:(0,at.t)(sl),defaultValues:k});(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);let U="Invalid Date";if(h){const[e,t,a]=h.split("-"),r=new Date("".concat(a,"-").concat(t,"-").concat(e));isNaN(r)||(U=r.toLocaleDateString("en-US",{month:"long",year:"numeric"}))}(0,n.useEffect)((()=>{if(!w.length||!A.length||null===u||void 0===u||!u.empID)return;const e=w.find((e=>e.empID===u.empID));if(e){const t=e.supervisor[e.supervisor.length-1],a=e.manager[e.manager.length-1],r=e.hr[e.hr.length-1];if(I((e=>(0,g.A)((0,g.A)({},e),{},{supervisorEmpID:t,managerEmpID:a,hrOfficialmail:r}))),a){const e=A.find((e=>e.empID===String(a)));e&&I((t=>(0,g.A)((0,g.A)({},t),{},{managerOfficialMail:e.officialEmail,managerName:e.name})))}if(t){const e=A.find((e=>e.empID===String(t)));e&&I((t=>(0,g.A)((0,g.A)({},t),{},{supervisorOfficialMail:e.officialEmail,supervisorName:e.name})))}e.skillPool&&(e.skillPool.includes("SKILLED")||e.skillPool.includes("UNSKILLED"))&&I((t=>(0,g.A)((0,g.A)({},t),{},{skilledAndUnskilled:e.skillPool})));const n=null===w||void 0===w?void 0:w.filter((e=>{var t,a,r;return null===e||void 0===e||null===(t=e.position)||void 0===t||null===(a=t[(null===e||void 0===e||null===(r=e.position)||void 0===r?void 0:r.length)-1])||void 0===a?void 0:a.includes("GENERAL MANAGER")}));if((null===n||void 0===n?void 0:n.length)>0){const e=[],t=[];null===n||void 0===n||n.forEach((a=>{const r=A.find((e=>e.empID===String(a.empID)));r?(e.push(r.officialEmail),t.push(r.name),I((a=>(0,g.A)((0,g.A)({},a),{},{gmOfficialMail:e,gmName:t})))):console.log("GM Info not found.")}))}else console.log("No General Manager positions found.")}else console.log("No work info found for employee ID:",null===u||void 0===u?void 0:u.empID)}),[w,null===u||void 0===u?void 0:u.empID,A]),(0,n.useEffect)((()=>{}),[E]),(0,n.useEffect)((()=>{if(0===S.length||null===u||void 0===u||!u.empID)return void console.log(0===S.length?"No data in ProbFData":"No employee ID found");const e=S.filter((e=>e.empID===u.empID));if(!e)return void console.log("No matching contract data found");if("Extended"===e.probExtendStatus)return void console.log("Contract extended data found");const t=Object.keys(e).reduce(((t,a)=>(t[a]=e[a]||"",t)),{});T({probData:t}),j("Extended"===t.probExtendStatus)}),[S,null===u||void 0===u?void 0:u.empID]);const B=e=>{if(!e.target)return void console.error("Event target is undefined");const{name:t,value:a}=e.target;T((e=>(0,g.A)((0,g.A)({},e),{},{probData:(0,g.A)((0,g.A)({},e.probData),{},{[t]:a})})))},q="hr_no-reply@adininworks.com",H="Probation Period Expiry Notification",W=async(e,t,r,n,s,i,l,d)=>{try{if("Supervisor"===a&&(await Me("Probation Assessment Review","<html>\n          <body>\n            <p>Your Employee Mr./Ms. ".concat(null===t||void 0===t?void 0:t.name,"'s probation period ending on ").concat(r||"Not Mentioned","</p>\n            <p>has been ").concat((null===e||void 0===e?void 0:e.supervisorApproved)||n.supervisorApproved," by Supervisor, ").concat(c||"Not Mentioned",".</p>\n            <p>Click here https://hr.adininworks.co to view the assessment form.</p>\n          </body>\n        </html>"),q,E.managerOfficialMail),await m({empID:u.empID,leaveType:s,message:i,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:E.managerOfficialMail})),"Manager"===a&&o!==_)if(null===E.skilledAndUnskilled){if(Array.isArray(E.gmOfficialMail))for(let a of E.gmOfficialMail)await Me("Probation Assessment Review","<html>\n                <body>\n                  <p>Your Employee Mr./Ms. ".concat(null===t||void 0===t?void 0:t.name,"'s probation period ending on ").concat(r||"Not Mentioned","</p>\n                  <p>has been reviewed and ").concat((null===e||void 0===e?void 0:e.managerApproved)||n.managerApproved," by the Manager, ").concat(c||"Not Mentioned",".</p>\n                  <p>Click here https://hr.adininworks.co to view the assessment form.</p>\n                </body>\n              </html>"),q,a);if(Array.isArray(E.gmOfficialMail))for(let e of E.gmOfficialMail)await m({empID:u.empID,leaveType:s,message:d,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:e})}else await Me(H,"<html>\n            <body>\n              <p>Your Employee Mr./Ms. ".concat((null===t||void 0===t?void 0:t.name)||"Not mentioned","'s probation period ending on ").concat(r||"Not Mentioned","</p>\n              <p>has been reviewed and ").concat((null===e||void 0===e?void 0:e.managerApproved)||n.managerApproved," by the Manager, ").concat(c||"Not Mentioned",".</p>\n              <p>Please proceed with the necessary actions.</p>\n              <p>Click here https://hr.adininworks.co to view the updates.</p>\n            </body>\n          </html>"),q,E.hrOfficialmail),await m({empID:u.empID,leaveType:s,message:l,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:E.hrOfficialmail});else o===_&&(console.log("HR Block"),await Me(H,"<html>\n          <body>\n            <p>Your Employee Mr./Ms. ".concat((null===t||void 0===t?void 0:t.name)||"Not mentioned","'s probation period ending on ").concat(r||"Not Mentioned","</p>\n            <p>has been reviewed and ").concat((null===e||void 0===e?void 0:e.gmApproved)||n.gmApproved," by the General Manager, ").concat(c||"Not Mentioned",".</p>\n            <p>Please proceed with the necessary actions.</p>\n            <p>Click here https://hr.adininworks.co to view the updates.</p>\n          </body>\n        </html>"),q,E.hrOfficialmail),await m({empID:u.empID,leaveType:s,message:l,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:E.hrOfficialmail}))}catch(p){console.error("Error sending email:",p),alert("An error occurred while sending the email.")}},z=(0,n.useRef)(),Y=(0,Ir.useReactToPrint)({content:()=>z.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete")});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{id:"capture-section",ref:z,children:[(0,i.jsx)("style",{children:(0,i.jsx)("style",{children:"\n      @media print {\n        @page {\n          // size: A4 portrait;\n          margin: 0.2cm;\n        }\n        \n        body {\n          zoom: 85%;\n        }\n        \n        #capture-section {\n          page-break-inside: avoid;\n        }\n        \n        form {\n          padding: 10px !important;\n        }\n        \n        .mb-10, .my-10, .mt-5 {\n          margin: 0.5rem !important;\n        }\n        \n        table {\n          font-size: 12px;\n          page-break-inside: avoid;\n        }\n        \n        .no-print, .no-print-parent {\n          display: none !important;\n        }\n        \n        /* Reduce logo size for printing */\n        img {\n          max-width: 300px !important;\n        }\n        \n        /* Compact form sections */\n        .text-lg {\n          font-size: 16px;\n        }\n      }\n    "})}),(0,i.jsxs)("form",{onSubmit:F((async e=>{y(!0);try{const t=S.filter((t=>t.empID===e.empID)).find((e=>{var t;return"extended"===(null===(t=e.probExtendStatus)||void 0===t?void 0:t.trim().toLowerCase())})),r=S.find((t=>t.empID===e.empID)),n=A.find((t=>t.empID===e.empID)),s=w.find((t=>t.empID===e.empID)),i=Array.isArray(s.probationEnd)&&s.probationEnd.length>0?s.probationEnd[s.probationEnd.length-1].split("-").reverse().join("/"):"Not mentioned",l=Array.isArray(s.probationEnd)&&s.probationEnd.length>0?s.probationEnd[s.probationEnd.length-1]:"Not mentioned",m="Probation Assessment Review",u="Your Employee Mr./Ms. ".concat(null===n||void 0===n?void 0:n.name,"'s probation period ending on ").concat(i||"Not Mentioned"," has been ").concat((null===e||void 0===e?void 0:e.supervisorApproved)||(null===r||void 0===r?void 0:r.supervisorApproved)," by Supervisor, ").concat(c||"Not Mentioned","."),h="Your Employee Mr./Ms. ".concat(null===n||void 0===n?void 0:n.name,"'s probation period ending on ").concat(i||"Not Mentioned","\n      has been reviewed and ").concat((null===e||void 0===e?void 0:e.managerApproved)||(null===r||void 0===r?void 0:r.managerApproved)," by the Manager, ").concat((null===E||void 0===E?void 0:E.managerName)||"Not Mentioned","."),v="Your Employee Mr./Ms. ".concat(null===n||void 0===n?void 0:n.name,"'s probation period ending on ").concat(i||"Not Mentioned","\n      has been reviewed and ").concat((null===e||void 0===e?void 0:e.gmApproved)||(null===r||void 0===r?void 0:r.gmApproved)," by the General Manager, ").concat((null===E||void 0===E?void 0:E.managerName)||"Not Mentioned","."),N=["adaptability","additionalInfo","attention","attitude","commitment","communication","deadline","extendDate","diligent","extensionPeriod","gmDate","hrDate","hrName","initiative","managerDate","managerName","gmName","pace","quality","recommendation","responsibility","supervisorDate","supervisorName","teamwork","extendProbED","gmApproved","managerApproved","supervisorApproved","communicationDetails","qualityDetails","paceDetails","initiativeDetails","attitudeDetails","adaptabilityDetails","teamworkDetails","responsibilityDetails","diligentDetails","commitmentDetails","probStatus","createdAt","probExtendStatus","prevProbExDate"].reduce(((e,t)=>(e[t]=k.probData[t],e)),{}),b=(0,g.A)((0,g.A)((0,g.A)({},e),N),{},{probStatus:!0,prevProbExDate:l,probExtendStatus:"probup"});if("Supervisor"===a&&!k.probData.supervisorName)return alert("Supervisor name is required!"),void y(!1);if("Supervisor"===a&&!k.probData.supervisorApproved&&!k.probData.supervisorDate)return alert("Supervisor approval or rejection required!"),void y(!1);if("Supervisor"===a&&!k.probData.supervisorDate)return alert("Supervisor date is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.supervisorApproved&&!0===d)return alert("Supervisor approval required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerName)return alert("Manager name is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerApproved)return alert("Manager approval or rejection is required!"),void y(!1);if("Manager"===a&&o!==_&&"HR MANAGER"!==p&&!k.probData.managerDate)return alert("Manager date is required!"),void y(!1);if(t){const e={id:t.id,probExtendStatus:"completed"};await f({PbFDataUp:e})}await x({ProbValue:b}),y(!1),setTimeout((()=>{R(!0),O("Probation form created successfully")}),1e3),W(e,n,i,m,u,h,v)}catch(t){y(!1),console.error("Error submitting form:",t)}})),className:"p-10 bg-white shadow-md w-full px-20 mx-auto",children:[(0,i.jsxs)("section",{className:"flex items-center mb-6",children:[(0,i.jsx)(r.N_,{to:"/reports",id:"left-button",className:"no-print left-button text-xl text-start w-[50px] text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("div",{className:" w-full center pr-10",children:(0,i.jsx)("img",{className:" max-w-[400px]",src:Se.A,alt:"Logo not found"})})]}),(0,i.jsx)("div",{className:"text-center text-lg font-bold uppercase w-full",children:"Probation Completion Form for the Month of ".concat(U)}),(0,i.jsxs)("div",{className:"mb-10 mt-6",children:[(0,i.jsxs)("p",{className:"text-md mt-2",children:["For the attention of:"," ",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"attention"},M("attention")),{},{value:k.probData.attention,onChange:B,className:"border-b border-black focus:outline-none px-1"}))]}),(0,i.jsxs)("p",{className:"text-md mt-3",children:["Deadline submit to Human Resources Department by:"," ",(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",name:"deadline"},M("deadline")),{},{value:k.probData.deadline||(null===u||void 0===u?void 0:u.deadline),onChange:B,className:"border-b border-black outline-none px-1"}))]})]}),(0,i.jsxs)("div",{className:"w-full mx-auto mb-10",children:[(0,i.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Employee Details:"}),(0,i.jsx)("table",{className:"w-full border border-black table-fixed",children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Employee Name"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.name)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Employee ID"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.empID)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Badge Number"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.empBadgeNo)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Department"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.department)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Position"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(null===u||void 0===u?void 0:u.position)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Date Joined"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:null!==u&&void 0!==u&&u.dateOfJoin?null===u||void 0===u?void 0:u.dateOfJoin:(null===u||void 0===u?void 0:u.doj)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Probation End Date"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:null!==u&&void 0!==u&&u.prevProbExDate?function(e){if(/^\d{2}-\d{2}-\d{4}$/.test(e))return e;if(/^\d{2}\/\d{2}\/\d{4}$/.test(e))return e.replace(/\//g,"-");const t=new Date(e);if(isNaN(t))return e;const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)}(null===u||void 0===u?void 0:u.prevProbExDate):(null===u||void 0===u?void 0:u.probationEndDate)||"-"})]}),(0,i.jsxs)("tr",{className:"border",children:[(0,i.jsx)("td",{className:"p-2 border-r border-b font-semibold w-1/2",children:"Extended Probation End Date"}),(0,i.jsx)("td",{className:"p-2 border-b w-1/2",children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date",name:"extendDate"},M("extendDate")),{},{value:k.probData.extendDate,onChange:B,className:"w-full px-1"}))})]})]})})]}),(0,i.jsx)(Zi,{register:M,formData:k,handleInputChange:B}),(0,i.jsx)(Qi,{employeeData:u,workInfoData:w,register:M,formData:k,handleInputChange:B,skillPool:E.skilledAndUnskilled,errors:L,userType:a,gmPosition:o,HRMPosition:p,probData:S,handleCheckboxChange:e=>{const{checked:t}=e.target;j(t),T((e=>(0,g.A)((0,g.A)({},e),{},{probData:(0,g.A)((0,g.A)({},e.probData),{},{probExtendStatus:t?"Extended":"Not Extended"})})))},isExtended:D}),"SuperAdmin"!==a&&(0,i.jsx)("div",{className:"flex justify-center gap-4 py-8 no-print-parent text-center",children:N?(0,i.jsx)("p",{className:"text-lg font-semibold",children:"Downloading..."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{id:"save-button",onClick:()=>F(),disabled:v,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:v?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Submitting"}),(0,i.jsx)("span",{className:"ml-1 animate-spin border-2 border-t-2 border-t-white border-gray-300 rounded-full w-4 h-4"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Submit"}),(0,i.jsx)(Tt.dIn,{className:"ml-2 mt-1"})]})}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{id:"download-button",onClick:e=>(e=>{e.preventDefault(),e.stopPropagation(),b(!0);const t=document.getElementById("left-button"),a=document.getElementById("download-button"),r=document.getElementById("print-button"),n=document.getElementById("save-button");t&&(t.style.visibility="hidden"),a&&(a.style.visibility="hidden"),r&&(r.style.visibility="hidden"),n&&(n.style.visibility="hidden"),al("capture-section"),setTimeout((()=>{t&&(t.style.visibility="visible"),a&&(a.style.visibility="visible"),r&&(r.style.visibility="visible"),n&&(n.style.visibility="visible"),b(!1)}),500)})(e),className:"border-yellow border-2 text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:[(0,i.jsx)("span",{children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]}),(0,i.jsxs)("button",{id:"print-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),Y()},className:"border-yellow border-2 text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:[(0,i.jsx)("span",{children:"Print"}),(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})]})]})}),C&&(0,i.jsx)(Pe,{text:P,notification:C,path:"/reports"})]})]})})},ol=["__typename","createdAt","updatedAt"],dl=["__typename","createdAt","updatedAt"],cl=(0,Ee.D)();a(557);const pl=(0,Ee.D)(),ml=((0,Ee.D)(),e=>{var t;let{convertedStringToArrayObj:a,ProcessedDataFunc:r,publicHoliday:s,dummyLeaveStatus:i,dayCounts:l,mergedData:o,leaveStatuses:d}=e;const{getStartDate:c,getEndDate:p}=(0,Fe.b)(),m=null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.fileType;try{(0,n.useEffect)((()=>{const e=async()=>{null===a||void 0===a||a.forEach((e=>{try{if(!(Array.isArray(e.empWorkInfo)&&e.empWorkInfo.length>0))return e.empWorkInfo=e.empWorkInfo;e.empWorkInfo=e.empWorkInfo.map((e=>{try{return JSON.parse(e)}catch(t){return null}})).map((e=>e))[0]}catch(t){return e.empWorkInfo=e.empWorkInfo}}));const e=null===d||void 0===d?void 0:d.filter((e=>"Approved"===e.managerStatus&&"Cancelled"!==e.empStatus)),t=Object.values(null===(n=a||[])||void 0===n?void 0:n.reduce(((e,t)=>{const a=t.empBadgeNo?"empBadgeNo-".concat(t.empBadgeNo):"fidNo-".concat(t.fidNo);return e[a]||(e[a]={empBadgeNo:t.empBadgeNo||null,fidNo:t.fidNo||null,data:[]}),e[a].data.push(t),e}),{}));var n;const i=function(e){const t=new Map,a=[];return e.forEach((e=>{e.data.forEach((r=>{Array.isArray(r.empWorkInfo)&&r.empWorkInfo?r.empWorkInfo.forEach((a=>{const n=(null===a||void 0===a?void 0:a.LOCATION)||"",s=(null===a||void 0===a?void 0:a.JOBCODE)||"",i=new Date(r.date),l=("".concat(i.getFullYear(),"-").concat(i.getMonth()+1),"".concat(i.getFullYear())),o="".concat(e.empBadgeNo,"-").concat(e.fidNo,"-").concat(n,"-").concat(s,"-").concat(l);t.has(o)||t.set(o,{empBadgeNo:e.empBadgeNo||null,fidNo:e.fidNo||null,data:[]});t.get(o).data.push((0,g.A)((0,g.A)({},r),{},{empWorkInfo:[a]}))})):a.push({empBadgeNo:e.empBadgeNo||null,fidNo:e.fidNo||null,data:[(0,g.A)((0,g.A)({},r),{},{empWorkInfo:[]})]})}))})),[...Array.from(t.values()),...a]}(t.map((e=>{var t;const a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.reduce(((e,t)=>{const a=new Date(t.date),r="".concat(a.getMonth()+1,"/").concat(a.getFullYear());return e[r]||(e[r]=[]),e[r].push(t),e}),{});return Object.entries(a).map((t=>{let[a,r]=t;return{empBadgeNo:e.empBadgeNo||null,fidNo:e.fidNo||null,data:r||null}}))})).flat()),u=o.flatMap((t=>{const a=e.filter((e=>String(t.empID)===String(e.empID)));return a.length>0?a.map((e=>(0,g.A)((0,g.A)({},t),e))):[t]})).filter((e=>i.some((t=>{const a=e.empBadgeNo&&t.empBadgeNo&&String(e.empBadgeNo)===String(t.empBadgeNo),r=e.sapNo&&t.fidNo&&String(e.sapNo)===String(t.fidNo);return!(!a&&!r)&&t.data.some((t=>{const a=new Date(e.toDate),r=new Date(t.date);return a.getFullYear()===r.getFullYear()}))})))),h={"Annual Leave":"AL","Compensate Leave":"CL","Unpaid Authorize - Annual":"UAL","Sick Leave":"SL","Hospitalisation Leave":"SL","Compassionate Leave":"CL","Marriage Leave":"CL","Paternity Leave":"CL","Maternity Leave":"CL","Unpaid Authorize - Sick":"UAL","Unpaid Unauthorised Sick Leave":"UAL"},x=e=>["HAL","HCL","HUAL","HSL","HCL"].some((t=>{var a;return null===e||void 0===e||null===(a=e.startsWith)||void 0===a?void 0:a.call(e,t)})),f=(e,t,a,r,n)=>{const s=new Date(e),i=new Date(t),l={},o=Array.isArray(a)&&(null===a||void 0===a?void 0:a.length)>0?a[(null===a||void 0===a?void 0:a.length)-1]:a||0,d=parseFloat(o)/2;for(;s<=i;){l["".concat(s.getDate(),"-").concat(s.getMonth()+1,"-").concat(s.getFullYear())]=n?"H".concat(r).concat(d):r,s.setDate(s.getDate()+1)}return l},v=(e=>{const t={};return e.forEach((e=>{const{empID:a,empBadgeNo:r,sapNo:n,leaveType:s,fromDate:i,toDate:l,days:o,workHrs:d}=e;t[a]||(t[a]={empBadgeNo:r,fidNo:n,leaveCounts:{},dateDifferences:[]}),x(h[s])?t[a].leaveCounts[s]=(t[a].leaveCounts[s]||0)+.5:"Compensate Leave"===s&&.5===o||(t[a].leaveCounts[s]=(t[a].leaveCounts[s]||0)+1),t[a].dateDifferences.push({leaveType:s,fromDate:i,toDate:l,listDate:f(i,l,d,h[s],.5===o),daysDifference:o})})),Object.values(t).forEach((e=>{e.dateDifferences.forEach((t=>{let{listDate:a}=t;Object.values(a).forEach((t=>{if(x(t)){const a=Object.keys(h).find((e=>t.includes(h[e])));e.leaveCounts[a]=(e.leaveCounts[a]||0)+.5}}))}))})),Object.values(t)})(u),y=null===s||void 0===s?void 0:s.CompanyHolidays2025.flatMap((e=>e.dates||[e.date])),N=null===y||void 0===y?void 0:y.map((e=>{const t=e.split(",")[1].trim(),[a,r,n]=t.split(" "),s=a.replace(/\D/g,""),i=new Date("".concat(r," 1, 2000")).getMonth()+1;return"".concat(n,"-").concat(i,"-").concat(s)})),b=i.map((e=>{const t=v.find((t=>e.empBadgeNo&&t.empBadgeNo&&e.empBadgeNo===t.empBadgeNo||e.fidNo&&t.fidNo&&e.fidNo===t.fidNo?t:void 0)),a=null===o||void 0===o?void 0:o.find((t=>e.empBadgeNo&&t.empBadgeNo&&e.empBadgeNo===t.empBadgeNo||e.fidNo&&t.sapNo&&e.fidNo===t.sapNo?t:void 0)),r=e.data.find((e=>e)),n=r.id,s=r.empWorkInfo.map((e=>null===e||void 0===e?void 0:e.LOCATION)),i=r.empWorkInfo.map((e=>null===e||void 0===e?void 0:e.JOBCODE)),d=Array.from({length:l},((e,t)=>{const a=new Date(c);return a.setDate(c.getDate()+t),a})).reduce(((r,n)=>{var s,i;const l=n.getMonth()+1,o="".concat(n.getDate(),"-").concat(l,"-").concat(n.getFullYear()),d=null===e||void 0===e?void 0:e.data.find((e=>{let{date:t}=e;const a=new Date(t);return a.getDate()===n.getDate()&&a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()})),c=new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(n),p=Array.isArray(a.workMonth)?a.workMonth[a.workMonth.length-1]:a.workMonth||0,u=Array.isArray(a.workHrs)?a.workHrs[a.workHrs.length-1]:a.workHrs||0,h=null===d||void 0===d||null===(s=d.empWorkInfo[0])||void 0===s?void 0:s.WORKINGHRS,x=null===N||void 0===N?void 0:N.some((e=>{const t=new Date(e);return"".concat(null===t||void 0===t?void 0:t.getDate(),"-").concat((null===t||void 0===t?void 0:t.getMonth())+1,"-").concat(null===t||void 0===t?void 0:t.getFullYear())===o}));let g=null;t&&t.dateDifferences.forEach((e=>{if(e.listDate.hasOwnProperty(o)){let t=e.listDate[o],a=(e=>{const[t,a,r]=e.split("-");return"".concat(r,"-").concat(a.padStart(2,"0"),"-").concat(t.padStart(2,"0"))})(o),r=new Date(a);if("Saturday"===new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(r)&&8===parseFloat(u)&&24===parseFloat(p)){let e=parseFloat(u)/2;g=null!==t&&void 0!==t&&t.startsWith("H")?t:"H".concat(t).concat(e)}else g=t}}));const f=null===(i=["Offshore","Offshore's ORMC"])||void 0===i?void 0:i.includes(m);function v(e){let t=Math.floor(e),a=Math.round(100*(e-t));return a>=100&&(t+=Math.floor(a/100),a%=100),parseFloat("".concat(t,".").concat(a.toString().padStart(2,"0")))}function y(e,t){let a;"staffLevelEmp"===t&&(a=(null===d||void 0===d?void 0:d.normalWorkHrs)/2),"normalEmp"===t&&(a=null===d||void 0===d?void 0:d.normalWorkHrs);const r=v(e),n=v(a);return v(n-r)}if(h){const e=function(e){let t=0,a=0;var r;if(null!==e&&void 0!==e&&e.includes(":"))[t,a]=null===e||void 0===e||null===(r=e.split(":"))||void 0===r?void 0:r.map(Number);else if(null!==e&&void 0!==e&&e.includes(".")){var n;[t,a]=null===e||void 0===e||null===(n=e.split("."))||void 0===n?void 0:n.map(Number)}else t=parseInt(e,10),a=0;let s=100*t+a;s=Math.round(s/2);const i=Math.floor(s/100),l=s%100;return"".concat(i,":").concat(l.toString().padStart(2,"0"))}(null===d||void 0===d?void 0:d.normalWorkHrs);if(isNaN(h)||!h)r[o]=h;else if("Saturday"===c&&8===parseFloat(null===d||void 0===d?void 0:d.normalWorkHrs)&&24===parseFloat(p)){const e=parseFloat(h);const t=y(e,"staffLevelEmp"),a=parseFloat(t).toFixed(2),n=parseFloat(e).toFixed(2);r[o]="0.00"===a?n:"x(".concat(a,")").concat(n)}else if("Saturday"===c&&parseFloat(e.split(":")[0])===parseFloat(h)&&8!==parseFloat(null===d||void 0===d?void 0:d.normalWorkHrs)&&24!==parseFloat(p)){var b;const e=null===a||void 0===a||null===(b=a.salaryType[(null===a||void 0===a?void 0:a.salaryType.length)-1])||void 0===b?void 0:b.toLowerCase();if(["monthly","month","m","MONTHLY","Monthly","MONTH"].includes(e)){const e=parseFloat(h);const t=y(e,"normalEmp"),a=parseFloat(t).toFixed(2),n=parseFloat(e).toFixed(2);r[o]="0.00"===a?n:"x(".concat(a,")").concat(n)}}else{const e=parseFloat(h);if(e<=((null===d||void 0===d?void 0:d.normalWorkHrs)||0)){const t=y(e,"normalEmp"),a=parseFloat(t).toFixed(2),n=parseFloat(e).toFixed(2);r[o]="0.00"===a?n:"x(".concat(a,")").concat(n)}else r[o]=e.toString()}}else if(x)!0===f?r[o]=g||"A":!1===f&&(r[o]="PH");else if(g)!0===f?r[o]=g:!1===f&&(r[o]="Sunday"===c?"":g);else if("Saturday"===c){var D;const e=null===a||void 0===a||null===(D=a.salaryType[(null===a||void 0===a?void 0:a.salaryType.length)-1])||void 0===D?void 0:D.toLowerCase(),t=["daily","day","d"];!h&&["monthly","month","m"].includes(e)||!h&&t.includes(e)?r[o]="A":r[o]=h}else"Sunday"===c?!0===f?r[o]="A":!1===f&&(r[o]=""):r[o]="A";return r}),{});return t?(0,g.A)((0,g.A)({},e),{},{id:n,workingHrs:d,leaveCounts:t.leaveCounts,NWHPD:null===a||void 0===a?void 0:a.workHrs,NWHPM:null===a||void 0===a?void 0:a.workMonth,newDate:r.date,location:null===s||void 0===s?void 0:s[0],jobcode:null===i||void 0===i?void 0:i[0]}):(0,g.A)((0,g.A)({},e),{},{id:n,workingHrs:d,leaveCounts:{},NWHPD:null===a||void 0===a?void 0:a.workMonth,NWHPM:null===a||void 0===a?void 0:a.workHrs,newDate:r.date,location:null===s||void 0===s?void 0:s[0],jobcode:null===i||void 0===i?void 0:i[0]})})),D=await(async e=>{const t=["OFF","PH","PHD","A"];return e.forEach(((a,r)=>{e.forEach(((e,t)=>{if(r!==t){const t=a.empBadgeNo&&e.empBadgeNo&&String(a.empBadgeNo)===String(e.empBadgeNo),r=a.fidNo&&e.fidNo&&String(a.fidNo)===String(e.fidNo);(t||r)&&a.jobcode!==e.jobcode&&Object.keys(a.workingHrs).forEach((t=>{const r=a.workingHrs[t],n=e.workingHrs[t],s=/^x\(\d+(\.\d+)?\)\d+(\.\d+)?$/;s.test(r)&&!s.test(n)?e.workingHrs[t]="":!s.test(r)&&s.test(n)&&(a.workingHrs[t]="")}))}}));const n=((e,t)=>{const a=Object.values(e);return null===t||void 0===t?void 0:t.reduce(((e,t)=>(e[t]=null===a||void 0===a?void 0:a.filter((e=>e===t)).length,e)),{})})(a.workingHrs,t);n.PHD+=.5*Object.values(a.workingHrs).filter((e=>"HPHD"===e)).length;const s=(()=>{let e={AL:0,CL:0,UAL:0,SL:0};for(const t in a.workingHrs){const r=a.workingHrs[t];null!==r&&void 0!==r&&r.startsWith("HAL")?e.AL+=.5:"AL"===r?e.AL+=1:null!==r&&void 0!==r&&r.startsWith("HCL")?e.CL+=.5:"CL"===r?e.CL+=1:null!==r&&void 0!==r&&r.startsWith("HSL")?e.SL+=.5:"SL"===r?e.SL+=1:null!==r&&void 0!==r&&r.startsWith("HUAL")?e.UAL+=.5:"UAL"===r&&(e.UAL+=1)}return e})();a.hollydayCounts=n,a.leaveCounts=s})),e})(b),j=await(async e=>{const t=null===e||void 0===e?void 0:e.map((e=>(0,g.A)((0,g.A)({},e),{},{data:e.data.filter((e=>((e,t,a)=>{const r=new Date(e),n=new Date(t),s=new Date(a);return r.setHours(0,0,0,0),n.setHours(0,0,0,0),s.setHours(0,0,0,0),r>=n&&r<=s})(e.date,c,p)))}))).filter((e=>e.data.length>0)),a=await Promise.all(t.map((async e=>{const t=await Promise.all(e.data.map((async e=>{const t=await(e=>{async function t(e){let t=[],a=null;do{const r=await pl.graphql({query:e,variables:{nextToken:a}}),n=r.data[Object.keys(r.data)[0]].items;t=[...t,...n],a=r.data[Object.keys(r.data)[0]].nextToken}while(a);return t}return async function(){try{const[a]=await Promise.all([t(Ie.it)]);return null===a||void 0===a?void 0:a.find((t=>String(t.empID)===String(e)))}catch(a){}}()})(null===e||void 0===e?void 0:e.assignBy);return(null===t||void 0===t?void 0:t.name)||null})));return(0,g.A)((0,g.A)({},e),{},{timeKeeper:t})})));return a})(D),A=null===j||void 0===j?void 0:j.map((e=>{var a,r,n,s;const i=null===o||void 0===o?void 0:o.find((t=>{const a=t.empBadgeNo&&e.empBadgeNo&&String(t.empBadgeNo)===String(e.empBadgeNo),r=t.sapNo&&e.fidNo&&String(t.sapNo)===String(e.fidNo);return a||r})),d=i?(e=>{let{empID:t,name:a,sapNo:r,empBadgeNo:n,workHrs:s,workMonth:i,salaryType:l,days:o}=e;return{empID:t,name:a,sapNo:r,empBadgeNo:n,workHrs:s,workMonth:i,salaryType:l,days:o}})(i):{},p=(e.data.find((e=>e.date)),null===e||void 0===e?void 0:e.id),m=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.map((e=>e.empName)),u=null===e||void 0===e||null===(r=e.data)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.fileType,h=null===e||void 0===e?void 0:e.data,x=null===e||void 0===e?void 0:e.leaveCounts,f=null===e||void 0===e?void 0:e.workingHrs,v=null===e||void 0===e?void 0:e.newDate,y=null===e||void 0===e?void 0:e.location,N=null===e||void 0===e?void 0:e.hollydayCounts,b=null===e||void 0===e?void 0:e.timeKeeper,D=Array.from({length:l},((e,t)=>{const a=new Date(c);return a.setDate(c.getDate()+t),a})).reduce(((t,a)=>{var r,n;const s="".concat(a.getDate(),"-").concat(a.getMonth()+1,"-").concat(a.getFullYear()),i=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.find((e=>{let{date:t}=e;const r=new Date(t);return r.getDate()===a.getDate()&&r.getMonth()===a.getMonth()&&r.getFullYear()===a.getFullYear()})),l=null!==i&&void 0!==i&&null!==(n=i.empWorkInfo[0])&&void 0!==n&&n.OVERTIMEHRS?parseFloat(null===i||void 0===i?void 0:i.empWorkInfo[0].OVERTIMEHRS):null,o=null===i||void 0===i?void 0:i.getVerify;return null!==o&&void 0!==o&&(t[s]=o),t[s]=null!==l||void 0!==l?l:0,t}),{}),j=(e,t,a,r)=>Array.from({length:t},((e,t)=>{const r=new Date(a);return r.setDate(a.getDate()+t),r})).reduce(((t,a)=>{var n;const s="".concat(a.getDate(),"-").concat(a.getMonth()+1,"-").concat(a.getFullYear()),i=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.find((e=>{let{date:t}=e;const r=new Date(t);return r.getDate()===a.getDate()&&r.getMonth()===a.getMonth()&&r.getFullYear()===a.getFullYear()}));return t[s]=r(i,a),t}),{}),A=j(e,l,c,(e=>{var t,a,r;return null!==(t=null===e||void 0===e||null===(a=e.empWorkInfo)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.verify)&&void 0!==t?t:null})),w=j(e,l,c,(e=>{var t,a;return"Yes"===(null===e||void 0===e||null===(t=e.empWorkInfo)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.verify)?e.updatedAt:null})),S=null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.map((e=>{var t;let{empWorkInfo:a}=e;return null===(t=a[0])||void 0===t?void 0:t.JOBCODE}));return(0,g.A)((0,g.A)({id:p,data:h,grouped:t,empName:m,jobcode:S[0]||"",dateForSelectMY:v},d),{},{OVERTIMEHRS:D,empLeaveCount:x,hollydayCounts:N,workingHrs:f,location:y,timeKeeper:b,getVerify:A,firstFileType:u,assignUpdaterDateTime:w})})).filter(Boolean);await r(A)};a&&a.length>0?e():r(null)}),[a])}catch(u){}}),ul=()=>{function e(e){const[t,a,r]=null===e||void 0===e?void 0:e.split(/[-\/]/),n=t.padStart(2,"0"),s=a.padStart(2,"0");return"".concat(r,"-").concat(s,"-").concat(n)}function t(e){let t=Math.floor(e),a=Math.round(100*(e-t));return a>=100&&(t+=Math.floor(a/100),a%=100),parseFloat("".concat(t,".").concat(a.toString().padStart(2,"0")))}return{calculateTotalWorkingHours:function(t){let a=0;try{var r,n,s,i;const l=null===t||void 0===t?void 0:t.workingHrs,o=null!==t&&void 0!==t&&t.workHrs&&(null===t||void 0===t||null===(r=t.workHrs)||void 0===r?void 0:r.length)>0?null===t||void 0===t?void 0:t.workHrs[(null===t||void 0===t||null===(n=t.workHrs)||void 0===n?void 0:n.length)-1]:"",d=parseFloat(o),c=null!==t&&void 0!==t&&t.workMonth&&(null===t||void 0===t||null===(s=t.workMonth)||void 0===s?void 0:s.length)>0?null===t||void 0===t?void 0:t.workMonth[(null===t||void 0===t||null===(i=t.workMonth)||void 0===i?void 0:i.length)-1]:"",p=parseFloat(c);for(const t in l){const r=l[t];let n=e(t);const s=new Date(n);let i="Saturday"===new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(s)&&8===d&&24===p;const o=/^x\((\d+(\.\d+)?)\)(\d+(\.\d+)?)$/,c=null===r||void 0===r?void 0:r.match(o);if(c){a+=parseFloat(c[3]);continue}const m=/^\d+(\.\d+)?$/;if(null!==r&&void 0!==r&&r.match(m)){a+=parseFloat(r);continue}const u=/^H[A-Z]*\d+$/;if(null!==r&&void 0!==r&&r.match(u)&&i){parseFloat(r.replace(/[^0-9]/g,""));a+=0}else if(null!==r&&void 0!==r&&r.match(u)){a+=parseFloat(r.replace(/[^0-9]/g,""))}}return a.toFixed(2)}catch(l){return console.error("Error calculating total working hours:",l),"0.00"}},calculateNormalDays:function(t){try{var a,r,n,s;const i=null===t||void 0===t?void 0:t.workingHrs,l=null!==t&&void 0!==t&&t.workHrs&&(null===t||void 0===t||null===(a=t.workHrs)||void 0===a?void 0:a.length)>0?null===t||void 0===t?void 0:t.workHrs[(null===t||void 0===t||null===(r=t.workHrs)||void 0===r?void 0:r.length)-1]:"",o=parseFloat(l),d=null!==t&&void 0!==t&&t.workMonth&&(null===t||void 0===t||null===(n=t.workMonth)||void 0===n?void 0:n.length)>0?null===t||void 0===t?void 0:t.workMonth[(null===t||void 0===t||null===(s=t.workMonth)||void 0===s?void 0:s.length)-1]:"",c=parseFloat(d);let p=0,m=0;for(const t in i){const a=i[t];let r=e(t);const n=new Date(r);let s="Saturday"===new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(n)&&8===o&&24===c;const l=/^x\((\d+(\.\d+)?)\)(\d+(\.\d+)?)$/,d=null===a||void 0===a?void 0:a.match(l);if(d&&s){p+=parseFloat(d[3])}else if(d){m+=parseFloat(d[3])}const u=/^\d+(\.\d+)?$/;null!==a&&void 0!==a&&a.match(u)&&s?p+=parseFloat(a):null!==a&&void 0!==a&&a.match(u)&&(m+=parseFloat(a));const h=/^H[A-Z]*\d+$/;if(null!==a&&void 0!==a&&a.match(h)&&s){parseFloat(a.replace(/[^0-9]/g,""));p+=0}else if(null!==a&&void 0!==a&&a.match(h)){m+=parseFloat(a.replace(/[^0-9]/g,""))}}let u=p/(o/2)+m/o;return Math.floor(u),u.toFixed(2)}catch(i){return console.error("Error calculating total working hours:",i),"0.00"}},calculateTotalAbsence:function(t,a){var r,n;const s=null===t||void 0===t?void 0:t.workingHrs,i=parseFloat(a),l=null!==t&&void 0!==t&&t.workMonth&&(null===t||void 0===t||null===(r=t.workMonth)||void 0===r?void 0:r.length)>0?null===t||void 0===t?void 0:t.workMonth[(null===t||void 0===t||null===(n=t.workMonth)||void 0===n?void 0:n.length)-1]:"";try{let t=0,r=0;for(let n in s){const o=s[n];let d=e(n);const c=new Date(d);let p="Saturday"===new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(c)&&8==a&&24==l;if(null!==o&&void 0!==o&&o.startsWith("x(")){const e=o.match(/x\(([\d.]+)\)/);e&&p?t+=parseFloat(e[1]):e&&(r+=parseFloat(e[1]))}else"A"===o&&(p?t+=i/2:r+=i)}return(t/i+r/i).toFixed(2)}catch(o){return console.error("Error in calculateTotalAbsence:",o),"0.00"}},convertNumToHours:function(e,t){const a=parseFloat(e),r=parseFloat(t);return isNaN(a)||isNaN(r)||0===r?"0.00":(a/r).toFixed(2)},workHrsAbsentCal:async function(a){const{NWHPD:r,NWHPM:n,workingHrsKey:s,workingHrs:i}=a;let l=e(s);const o=new Date(l),d=new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(o);let c=r;"Saturday"===d&&8==r&&24==n&&(c=r/2);const p=function(e){const t=null===e||void 0===e?void 0:e.toString();if(/^\d+$/.test(t))return"".concat(t,":00");if(/^\d+\.\d+$/.test(t)){const[e,a]=null===t||void 0===t?void 0:t.split("."),r=1===a.length?"".concat(a,"0"):a;return"".concat(parseInt(e),":").concat(r)}if(/^\d{1,2}:\d{1,2}$/.test(t)){const[e,a]=null===t||void 0===t?void 0:t.split(":"),r=1===a.length?"".concat(a,"0"):a;return"".concat(parseInt(e),":").concat(r)}return null}(i);if(null===p)return i;const m=function(e){const[a,r]=null===e||void 0===e?void 0:e.split(":"),n=parseInt(a),s=parseInt(r);return t(parseFloat("".concat(n,".").concat(s.toString().padStart(2,"0"))))}(p),u=t(c);if(m>u)return"Saturday"===d&&8==r&&24==n?(alert("On Saturdays, working hours cannot exceed the normal daily limit (".concat(c," hours) for staff-level employees.")),"0.00"):(alert("Working hours cannot be greater than normal daily hours (".concat(c,").")),"0.00");const h=t(u-m),x=parseFloat(h).toFixed(2),g=parseFloat(m).toFixed(2);return"0.00"===x?g:"x(".concat(x,")").concat(g)}}},hl=e=>{var t;let{summaryObject:a,toggleEditViewSummaryFunc:r,FinalEditedData:s}=e;const{workHrsAbsentCal:l}=ul(),[o,d]=(0,n.useState)({id:null===a||void 0===a?void 0:a.id,data:null===a||void 0===a?void 0:a.data,grouped:null===a||void 0===a?void 0:a.grouped,badgeNo:(null===a||void 0===a?void 0:a.empBadgeNo)||"",empName:(null===a||void 0===a?void 0:a.empName)||"",sapNo:(null===a||void 0===a?void 0:a.sapNo)||"",location:(null===a||void 0===a?void 0:a.location)||"",jobcode:(null===a||void 0===a?void 0:a.jobcode)||"",NWHPD:(null===a||void 0===a?void 0:a.workHrs)||"",NWHPM:(null===a||void 0===a?void 0:a.workMonth)||"",workingHrs:(null===a||void 0===a?void 0:a.workingHrs)||"",overtimeHrs:(null===a||void 0===a?void 0:a.ot)||"",workingHrsKey:(null===a||void 0===a?void 0:a.workingHrsKey)||"",firstFileType:null===a||void 0===a?void 0:a.firstFileType});let c=a.verify||"";const p=e=>{const{name:t,value:a}=e.target;d((0,g.A)((0,g.A)({},o),{},{[t]:a}))};return(0,i.jsx)("section",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,i.jsx)("div",{className:"bg-white w-[90%] max-w-[570px] rounded-lg shadow-lg p-7 ",children:(0,i.jsxs)("div",{className:" p-5 shadow-xl bg-[#fdfcfc]",children:[(0,i.jsxs)("div",{className:" flex items-center justify-between pb-2 ",children:[(0,i.jsx)("p",{className:"flex-1"}),(0,i.jsx)("img",{className:"max-w-[200px] flex-1 w-full",src:Se.A,alt:"not found"}),(0,i.jsx)("p",{className:"flex-1 flex justify-end",children:(0,i.jsx)(j.LwM,{className:"text-[30px]  text-dark_grey cursor-pointer ",onClick:()=>{null===r||void 0===r||r()}})})]}),(0,i.jsx)("header",{className:"flex justify-center items-center ",children:(0,i.jsx)("h2",{className:"text-dark_grey text-[22px] font-bold border-b-2",children:"Yes"===c?"View Form":"Edit Form"})}),(0,i.jsx)("main",{className:"mt-4",children:(0,i.jsxs)("form",{className:"grid grid-cols-1 gap-4",children:[(0,i.jsxs)("div",{className:"flex justify-between gap-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5 ",children:"Badge No."}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.badgeNo?"bg-lite_skyBlue":"bg-white"),name:"badgeNo",value:o.badgeNo,onChange:p,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Sap No."}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.sapNo?"bg-lite_skyBlue":"bg-white"),name:"sapNo",value:o.sapNo,onChange:p,readOnly:!0})]})]}),(0,i.jsxs)("div",{className:"flex justify-between gap-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Employee Name"}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.empName?"bg-lite_skyBlue":"bg-white"),name:"empName",value:o.empName,onChange:p,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{className:"block text-dark_grey text_size_5",children:[" ","Location"]}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.location?"bg-lite_skyBlue":"bg-white"),name:"location",value:o.location,onChange:p,readOnly:!0})]})]}),(0,i.jsxs)("div",{className:"flex justify-between gap-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Jobcode"}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.jobcode?"bg-lite_skyBlue":"bg-white"),name:"jobcode",value:o.jobcode,onChange:p,readOnly:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Normal Working Hrs Per Day"}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 ".concat(o.NWHPD?"bg-lite_skyBlue":"bg-white"),name:"NWHPD",value:Array.isArray(null===o||void 0===o?void 0:o.NWHPD)&&(null===o||void 0===o?void 0:o.NWHPD.length)>0?null===o||void 0===o?void 0:o.NWHPD[(null===o||void 0===o||null===(t=o.NWHPD)||void 0===t?void 0:t.length)-1]:(null===o||void 0===o?void 0:o.NWHPD)||"0",onChange:p,readOnly:!0})]})]}),(0,i.jsxs)("div",{className:"flex justify-between gap-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Actual working Hours"}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 bg-white",name:"workingHrs",value:o.workingHrs,onChange:p})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-dark_grey text_size_5",children:"Overtime Hours"}),(0,i.jsx)("input",{type:"text",className:"mt-1 block w-full border outline-none border-lite_grey text_size_7  rounded text-sm py-2 px-3 bg-white",name:"overtimeHrs",value:o.overtimeHrs,onChange:p})]})]})]})}),(0,i.jsx)("footer",{className:"flex justify-center mt-6 space-x-3",children:"Yes"===c?(0,i.jsx)("button",{className:"px-5 py-2 bg-[#48f748] text_size_5 text-dark_grey rounded cursor-not-allowed",children:"Verified"}):(0,i.jsx)("button",{className:"px-5 py-2 bg-[#FEF116] text_size_5 text-dark_grey rounded",onClick:async()=>{let e=Array.isArray(null===o||void 0===o?void 0:o.NWHPD)?null===o||void 0===o?void 0:o.NWHPD[(null===o||void 0===o?void 0:o.NWHPD.length)-1]:(null===o||void 0===o?void 0:o.NWHPD)||"0",t=Array.isArray(null===o||void 0===o?void 0:o.NWHPM)?null===o||void 0===o?void 0:o.NWHPM[(null===o||void 0===o?void 0:o.NWHPM.length)-1]:(null===o||void 0===o?void 0:o.NWHPM)||"0";"0.00"!==await l({NWHPD:e,NWHPM:t,workingHrsKey:null===o||void 0===o?void 0:o.workingHrsKey,workingHrs:null===o||void 0===o?void 0:o.workingHrs})&&(s(o),null===r||void 0===r||r())},children:"Verify"})})]})})})},xl=e=>{let{options:t,handleTypeSelect:a}=e;const[r,s]=(0,n.useState)(!1),[l,o]=(0,n.useState)("");return(0,i.jsxs)("div",{className:"relative w-64",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center text_size_5 bg-white border border-lite_grey ".concat(l?"text-dark_grey":"text-medium_grey","  rounded px-4 py-2 cursor-pointer"),onClick:()=>s(!r),children:[l||"Select Offshore Type",(0,i.jsx)(Tt.Vr3,{className:"text-md text-dark_grey"})]}),r&&(0,i.jsx)("ul",{className:"absolute z-10 w-full p-2 bg-white  rounded mt-1 shadow-lg max-h-60 overflow-hidden",children:t.map(((e,t)=>(0,i.jsx)("li",{onClick:()=>(e=>{o(e),a(e),s(!1)})(e),className:"px-2 py-1 hover:text-white hover:bg-grey cursor-pointer",children:e},t)))})]})},gl=e=>{let{LocationData:t,secondaryData:a,data:r,searchResult:n,resetTableFunc:s}=e;const{setStartDate:l,startDate:o,setEndDate:d,endDate:c,setSelectedLocation:p,setOffshoreType:m}=(0,Fe.b)();return(0,i.jsxs)("div",{className:"flex  justify-between items-center w-full mb-5",children:[(0,i.jsxs)("div",{className:"flex justify-start gap-4 ",children:[(0,i.jsxs)("div",{className:"relative grid grid-cols-1 ",children:[(0,i.jsx)("label",{className:"text_size_6",children:"Start Date"}),(0,i.jsx)("input",{type:"date",className:"border border-[#D9D9D9]  text_size_6 rounded outline-none p-2 text-[#252525] text-sm",onChange:e=>{const t=e.target.value,a=t.split("-");if(3===a.length&&4===a[0].length&&2===a[1].length&&2===a[2].length&&a[0].startsWith("2")){const e=new Date(t);if(!isNaN(e.getTime())){const t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),n="".concat(t,"-").concat(a,"-").concat(r);l(n)}}}})]}),(0,i.jsxs)("div",{className:"relative grid grid-cols-1 ",children:[(0,i.jsx)("label",{className:"text_size_6",children:"End Date"}),(0,i.jsx)("input",{type:"date",className:"border border-[#D9D9D9]  text_size_6 rounded outline-none p-2 text-[#252525] text-sm",onChange:e=>d(e.target.value)})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-4 mt-6",children:[(0,i.jsx)("div",{className:"relative grid grid-cols-1 ",children:(0,i.jsx)(cs,{newFormData:t,searchResult:async e=>{s(),e.location&&p(e.location)},placeholder:"Location",rounded:"rounded",searchIcon2:(0,i.jsx)(Fr.CKj,{}),identify:"viewSummary",setSelectedLocation:p})}),(0,i.jsx)(xl,{options:["Direct","Indirect"],handleTypeSelect:e=>{e&&m(e)}}),(0,i.jsx)(ls,{allEmpDetails:r,searchResult:n,secondaryData:a,placeholder:"SAP ID / BADGE",Position:"viewSummary"})]})]})};var fl=a(9804);const vl=a.p+"static/media/aweLogo.567798f6cf98b4bb07dc.png",yl=e=>{let{dayCounts:t,data:a,LocationData:s,secondaryData:l,searchResult:o,loading:d,emptyTableMess:c,resetTableFunc:p,toggleEditViewSummaryFunc:m,editViewSummaryObject:u}=e;const[h,x]=(0,n.useState)(1),[g,f]=(0,n.useState)(!1),{selectedLocation:v,setSelectedLocation:y,getStartDate:N,getEndDate:b,startDate:D,endDate:j,setStartDate:A,setEndDate:w,setOffshoreType:S}=(0,Fe.b)(),{calculateTotalWorkingHours:E,calculateNormalDays:I,calculateTotalAbsence:k,convertNumToHours:T}=ul(),C=e=>{const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},R=C(D),P=C(j),O=null===v||void 0===v?void 0:v.toUpperCase(),_=a||[],M=10*h,F=M-10,L=_.slice(F,M),U=Math.ceil(_.length/10);var B=L;return(0,i.jsx)("div",{className:"bg-[#fafaf6] h-screen",children:(0,i.jsxs)("div",{className:"screen-size p-4",children:[(0,i.jsxs)("header",{className:"my-5 flex justify-between",children:[(0,i.jsx)("div",{className:"flex items-center ",children:(0,i.jsx)(r.N_,{to:"/timeSheet",className:"text-xl flex-1 text-grey",onClick:()=>{A(""),w(""),y(""),S("")},children:(0,i.jsx)(Tt.QVr,{})})}),(0,i.jsx)("header",{className:"flex justify-center text_size_2 py-5 text-dark_grey",children:(0,i.jsx)("p",{children:"View Summary"})}),(0,i.jsxs)("div",{className:"flex space-x-3 shadow-md items-center rounded px-3  h-10 bg-[#FEF116]",onClick:()=>{((e,t,a,r)=>{const n=document.getElementById(e);if(!n)return;const s=document.createElement("iframe");s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.border="none",document.body.appendChild(s);const i=s.contentDocument||s.contentWindow.document;i.open(),i.write("<html><head><title>Print Table</title>"),i.write("<style>"),i.write("\n      body { font-family: Arial, sans-serif; margin: 20px; }\n      .content { margin-bottom: 20px; }\n      .logo { max-width: 300px; margin-bottom: 10px; }\n      table { width: 100%; border-collapse: collapse; }\n      th, td { padding: 8px; text-align: left; border: 1px solid black; }\n      th { background-color: #f2f2f2; }\n    "),i.write("</style>"),i.write("</head><body>"),i.write('\n      <div class="content">\n        <img src='.concat(Se.A,' class="logo" alt="Logo"> \n        <h2>TIMESHEET SUMMARY - ').concat(t," DIVISION</h2>\n        <h2>FOR THE PERIOD ").concat(a," TO ").concat(r,"</h2>\n      </div>\n    ")),i.body.appendChild(n.cloneNode(!0)),i.write("</body></html>"),i.close(),s.contentWindow.focus(),s.contentWindow.print(),setTimeout((()=>{document.body.removeChild(s)}),1e3)})("downloadTable",O,R,P)},children:[(0,i.jsx)("button",{className:"text_size_5 text-dark_grey ",children:"Print"}),(0,i.jsx)(fl.V8r,{className:"text-black cursor-pointer"})]})]}),(0,i.jsx)(gl,{LocationData:s,secondaryData:l,searchResult:o,resetTableFunc:p}),(0,i.jsx)("div",{className:"overflow-auto max-h-[60vh] table-container-scroll",children:(0,i.jsxs)("table",{className:"min-w-full text-sm table-fixed border-collapse bg-white",id:"downloadTable",children:[(0,i.jsx)("thead",{className:"bg-[#949393] border",children:(0,i.jsxs)("tr",{className:"border bg-[#949393] text-white ".concat(!0===g?"":"sticky -top-0.5"),children:[(0,i.jsx)("th",{className:"border px-2 py-2 border-dark_grey min-w-[200px] max-w-[400px] bg-[#949393]",rowSpan:"2",children:"Employee Name"}),(0,i.jsx)("th",{className:"border px-2 py-2 border-dark_grey bg-[#949393]",rowSpan:"2",children:"PROJECT"}),Array.from({length:t},((e,t)=>{const a=new Date(N);return a.setDate(N.getDate()+t),(0,i.jsx)("th",{className:"border px-2 py-2 border-dark_grey ",children:a.getDate()},a.toDateString())})),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"NH"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"ND"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"PH"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"PH-D"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"AL/CL"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"SL"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"OFF"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"A"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"UAL"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey ",children:"OT"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey bg-[#949393]",children:"Verified"}),(0,i.jsx)("th",{className:"border  px-2 py-2 border-dark_grey bg-[#949393]",children:"Updater"})]})}),(0,i.jsx)("tbody",{children:d&&B&&(null===B||void 0===B?void 0:B.length)>0?B.map(((e,a)=>{var r,s,l,o,d,c,p,h,x,g,f,v,y,b,D;const j=Object.values((null===e||void 0===e?void 0:e.OVERTIMEHRS)||{}).reduce(((e,t)=>e+parseFloat(t||0)),0).toFixed(2),A=E(e)||0,w=Number(A),S=Array.isArray(null===e||void 0===e?void 0:e.workHrs)&&(null===e||void 0===e||null===(r=e.workHrs)||void 0===r?void 0:r.length)>0?null===e||void 0===e?void 0:e.workHrs[(null===e||void 0===e||null===(s=e.workHrs)||void 0===s?void 0:s.length)-1]:(null===e||void 0===e?void 0:e.workHrs)||"0";let I=parseFloat(S);const T=Number(parseFloat(w))/I,C=(e=>{var t,a,r;const n=parseFloat((null===e||void 0===e||null===(t=e.workHrs)||void 0===t?void 0:t.at(-1))||"0"),s=parseFloat((null===e||void 0===e||null===(a=e.workMonth)||void 0===a?void 0:a.at(-1))||"0");var i;return 8===n&&24===s?(parseFloat(null===(i=e.hollydayCounts)||void 0===i?void 0:i.PHD)||0)/2:(null===(r=e.hollydayCounts)||void 0===r?void 0:r.PHD)||0})(e),R=k(e,S),P=Number(parseFloat(R).toFixed(2)),O=Array.from({length:t},((t,a)=>{var r;const n=new Date(N);n.setDate(N.getDate()+a);const s="".concat(n.getDate(),"-").concat(n.getMonth()+1,"-").concat(n.getFullYear());return{date:s,value:(null===e||void 0===e||null===(r=e.getVerify)||void 0===r?void 0:r[s])||""}})).reduce(((e,t)=>{let{date:a,value:r}=t;return e[a]=r,e}),{}),_=Object.values(O).every((e=>"Yes"===e)),M=parseFloat(null===e||void 0===e||null===(l=e.empLeaveCount)||void 0===l?void 0:l.AL)+parseFloat(null===e||void 0===e||null===(o=e.empLeaveCount)||void 0===o?void 0:o.CL)||0,F=null===e||void 0===e?void 0:e.timeKeeper,L=[...new Set(F)].filter((e=>null!==e)).join(", ");return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"border px-2 py-3 text-center",rowSpan:"2",children:[(0,i.jsx)("span",{children:e.name||""}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{children:"Badge# : ".concat(e.empBadgeNo||""," | SapID : ").concat(e.sapNo||"")}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{children:"Hours/Day : ".concat(null!==e&&void 0!==e&&e.workHrs&&(null===e||void 0===e?void 0:e.workHrs.length)>0?null===e||void 0===e?void 0:e.workHrs[(null===e||void 0===e||null===(d=e.workHrs)||void 0===d?void 0:d.length)-1]:"","  ")}),(0,i.jsx)("span",{children:"Days/Month : ".concat(null!==e&&void 0!==e&&e.workMonth&&(null===e||void 0===e||null===(c=e.workMonth)||void 0===c?void 0:c.length)>0?null===e||void 0===e?void 0:e.workMonth[(null===e||void 0===e?void 0:e.workMonth.length)-1]:"")}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{children:"SalaryType : ".concat(null!==e&&void 0!==e&&e.salaryType&&(null===e||void 0===e?void 0:e.salaryType.length)>0?null===e||void 0===e?void 0:e.salaryType[(null===e||void 0===e||null===(p=e.salaryType)||void 0===p?void 0:p.length)-1]:"")})]}),(0,i.jsx)("td",{className:"border px-2 py-1 ",rowSpan:"2",children:e.jobcode}),Array.from({length:t},((t,r)=>{var n,s;const l=new Date(N);l.setDate(N.getDate()+r);const o="".concat(l.getDate(),"-").concat(l.getMonth()+1,"-").concat(l.getFullYear()),d=new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(l),c=null===e||void 0===e||null===(n=e.getVerify)||void 0===n?void 0:n[o],p=Boolean(c);return(0,i.jsxs)("td",{className:"border px-2 py-1 border-dark_grey cursor-pointer\n                               ".concat(p?"bg-[#f59a51] bg-opacity-50 z-0":"Sunday"===d?"bg-yellow bg-opacity-50 z-0":""),onClick:()=>{var t,r,n,s,i,l;null===m||void 0===m||m();const d={id:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data,grouped:e.grouped,empName:null===e||void 0===e?void 0:e.name,sapNo:e.sapNo,empBadgeNo:null===e||void 0===e?void 0:e.empBadgeNo,location:null===e||void 0===e?void 0:e.location,jobcode:null===e||void 0===e?void 0:e.jobcode,workingHrs:null===e||void 0===e||null===(t=e.workingHrs)||void 0===t?void 0:t[o],ot:null===e||void 0===e||null===(r=e.OVERTIMEHRS)||void 0===r?void 0:r[o],workHrs:Array.isArray(null===e||void 0===e?void 0:e.workHrs)&&(null===e||void 0===e?void 0:e.workHrs.length)>0?null===e||void 0===e?void 0:e.workHrs[(null===e||void 0===e||null===(n=e.workHrs)||void 0===n?void 0:n.length)-1]:(null===e||void 0===e?void 0:e.workHrs)||"0",workMonth:Array.isArray(null===e||void 0===e?void 0:e.workMonth)&&(null===e||void 0===e||null===(s=e.workMonth)||void 0===s?void 0:s.length)>0?null===e||void 0===e?void 0:e.workMonth[(null===e||void 0===e||null===(i=e.workMonth)||void 0===i?void 0:i.length)-1]:(null===e||void 0===e?void 0:e.workMonth)||"0",workingHrsKey:o,verify:null===e||void 0===e||null===(l=e.getVerify)||void 0===l?void 0:l[o],firstFileType:e.firstFileType||"",index:a};u(d)},children:[(null===e||void 0===e||null===(s=e.workingHrs)||void 0===s?void 0:s[o])||""," "]},o)})),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:parseFloat(w).toFixed(2)}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:parseFloat(T).toFixed(2)}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:(null===e||void 0===e||null===(h=e.hollydayCounts)||void 0===h?void 0:h.PH)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:C||0}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:M}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:(null===(x=e.empLeaveCount)||void 0===x?void 0:x.SL)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:(null===e||void 0===e||null===(g=e.hollydayCounts)||void 0===g?void 0:g.OFF)||0}),(0,i.jsx)("td",{className:"border px-2 py-1 ",rowSpan:"2",children:parseFloat(P).toFixed(2)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:(null===e||void 0===e||null===(f=e.empLeaveCount)||void 0===f?void 0:f.UAL)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:parseFloat(j).toFixed(2)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:_?"Yes":""}),(0,i.jsx)("td",{className:"border px-2 py-1",rowSpan:"2",children:L})]}),(0,i.jsx)("tr",{children:Array.from({length:t},((t,a)=>{var r,n;const s=new Date(N);s.setDate(N.getDate()+a);const l="".concat(s.getDate(),"-").concat(s.getMonth()+1,"-").concat(s.getFullYear()),o=new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(s),d=null===e||void 0===e||null===(r=e.getVerify)||void 0===r?void 0:r[l],c=Boolean(d);return(0,i.jsxs)("td",{className:"border px-2 py-1 border-dark_grey  ".concat(c?"bg-[#f59a51] bg-opacity-50 z-0":"Sunday"===o?"bg-yellow bg-opacity-50 z-0":""),children:[(null===e||void 0===e||null===(n=e.OVERTIMEHRS)||void 0===n?void 0:n[l])||"0"," "]},l)}))}),(0,i.jsxs)("tr",{className:"border px-2 py-1 bg-white bg-opacity-50 z-0",children:[(0,i.jsx)("td",{className:"border px-2 py-1 bg-white bg-opacity-50 z-0",colSpan:1,children:" "}),(0,i.jsx)("td",{className:"bg-white bg-opacity-50 z-0"}),Array.from({length:t},((t,a)=>{var r,n;const s=new Date(N);s.setDate(N.getDate()+a);const l="".concat(s.getDate(),"-").concat(s.getMonth()+1,"-").concat(s.getFullYear()),o=null===e||void 0===e||null===(r=e.getVerify)||void 0===r?void 0:r[l],d=Boolean(o),c=new Intl.DateTimeFormat("en-BN",{weekday:"long"}).format(s),p=null===e||void 0===e||null===(n=e.assignUpdaterDateTime)||void 0===n?void 0:n[l],m={timeZone:"Asia/Brunei",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};if(p)var u=new Intl.DateTimeFormat("en-BN",m).format(new Date(p));const h=new Date(u),x=String(h.getDate()).padStart(2,"0"),g=String(h.getMonth()+1).padStart(2,"0"),f=h.getFullYear(),v=String(u).split(", ")[1],y="".concat(x,"/").concat(g,"/").concat(f," ").concat(v);return(0,i.jsx)("td",{className:"border px-2 py-2 border-dark_grey\n                              ".concat(d?"bg-[#f59a51] bg-opacity-50  z-0":"Sunday"===c?"bg-yellow bg-opacity-50 z-0":"bg-white bg-opacity-50 z-0","\n                            "),children:d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{className:"py-10",type:"checkbox",checked:d,onChange:()=>{}}),(0,i.jsx)("br",{}),(0,i.jsx)("span",{children:y||""})]})},s.toDateString())})),(0,i.jsx)("td",{className:"border px-2 py-1 ",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1",children:""}),(0,i.jsx)("td",{className:"border px-2 py-1"}),(0,i.jsx)("td",{className:"border px-2 py-1"})]}),(0,i.jsxs)("tr",{className:"bg-[#d8d3d3] bg-opacity-50",children:[(0,i.jsx)("td",{className:"border px-2 py-1",colSpan:1,children:"Total"}),Array.from({length:t+1},((e,t)=>{const a=t+1;return(0,i.jsx)("td",{className:"".concat("border")},a)})),(0,i.jsx)("td",{className:"border px-2 py-1",children:parseFloat(w).toFixed(2)}),(0,i.jsx)("td",{className:"border px-2 py-1",children:parseFloat(T).toFixed(2)}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(null===e||void 0===e||null===(v=e.hollydayCounts)||void 0===v?void 0:v.PH)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",children:C||0}),(0,i.jsx)("td",{className:"border px-2 py-1",children:M}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(null===(y=e.empLeaveCount)||void 0===y?void 0:y.SL)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(null===e||void 0===e||null===(b=e.hollydayCounts)||void 0===b?void 0:b.OFF)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",children:parseFloat(P).toFixed(2)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",children:(null===e||void 0===e||null===(D=e.empLeaveCount)||void 0===D?void 0:D.UAL)||0}),(0,i.jsx)("td",{className:"border px-2 py-1",children:j}),(0,i.jsx)("td",{className:"border px-2 py-1"}),(0,i.jsx)("td",{className:"border px-2 py-1"})]})]},a)})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"50",className:"px-6 py-3 text-center text-dark_ash text_size_5",children:(0,i.jsx)("p",{className:"px-6 py-6",children:!D||!j&&!1===d?"Your table is currently empty. Set a date range to view employee records.":D&&j&&!v&&!1===d?"Please choose a location to filter records within the selected date range.":D&&j&&v&&!0===d?"Processing your request... This may take a moment.":!0===c?"No records available. Try selecting different dates or locations.":"Unable to process your request. Kindly refresh and select valid dates and location."})})})})]})}),(0,i.jsxs)("footer",{className:"flex items-center justify-between py-6 ",children:[(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("div",{className:"flex-1 flex justify-center",children:(0,i.jsxs)("button",{className:"flex items-center space-x-2 rounded px-4 py-2  bg-[#FEF116] shadow-md",onClick:()=>{f(!0),document.querySelector(".table-container-scroll").scrollTop=0,((e,t,a,r)=>{const n=document.getElementById(e);if(!n)return;const s=n.parentElement,i=s.style.height;s.style.height="auto",el()(n,{useCORS:!0,scale:2}).then((e=>{s.style.height=i;const n=e.toDataURL("image/png"),l=new tl.default({orientation:"portrait",unit:"mm",format:"a4"}),o=vl;l.addImage(o,"SVG",5,5,30,5),l.setFontSize(4),l.setFontSize(4),l.text("TIMESHEET SUMMARY - ".concat(t," DIVISION"),5,13),l.text("FOR THE PERIOD ".concat(a," TO ").concat(r),5,15);const d=l.internal.pageSize.getWidth()-5-5,c=l.internal.pageSize.getHeight()-5-0,p=e.width,m=e.height,u=Math.min(d/p,c/m),h=5+(d-p*u)/2;l.addImage(n,"SVG",h,18,p*u,m*u),l.save("TIMESHEET SUMMARY - ".concat(t," DIVISION FOR THE PERIOD ").concat(a," TO ").concat(r,".pdf"))})).catch((e=>{}))})("downloadTable",O,R,P),f(!1)},children:[(0,i.jsx)("span",{className:"cursor-pointer text-dark_grey text_size_5",children:"Download"}),(0,i.jsx)(es.qqM,{className:"text-lg text-black"})]})}),(0,i.jsx)("div",{className:"flex-1 flex justify-end",children:B&&B.length>0&&(0,i.jsx)(Ss,{totalPages:U,currentPage:h,paginate:e=>x(e)})})]})]})})},Nl=()=>{const[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),[o,d]=(0,n.useState)(!0),[c,p]=(0,n.useState)(null),{startDate:m,endDate:u,selectedLocation:h,getStartDate:x,setGetStartDate:f,getEndDate:v,setGetEndDate:y,offshoreType:N}=(0,Fe.b)(),{workHrsAbsentCal:b}=ul(),D=(()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[s,i]=(0,n.useState)(null);return(0,n.useEffect)((()=>{fetch("https://commonfiles.s3.ap-southeast-1.amazonaws.com/Leave+Details/CompanyHolidays2025.json").then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{t(e),r(!1)})).catch((e=>{i(e),r(!1)}))}),[]),e})(),{empAndWorkInfo:A,leaveStatuses:w}=Bs(),S=async e=>{t(e),r(e)},E=async(a,n)=>{const s=await b({NWHPD:null===n||void 0===n?void 0:n.NWHPD,NWHPM:null===n||void 0===n?void 0:n.NWHPM,workingHrsKey:null===n||void 0===n?void 0:n.workingHrsKey,workingHrs:null===n||void 0===n?void 0:n.workingHrs});let i=["BLNG","Offshore","Offshore's ORMC"];const l=null===e||void 0===e?void 0:e.map((e=>{const t=new Date,r=e.grouped.map((e=>e.fidNo&&a.fidNo&&String(e.fidNo)===String(a.fidNo)||e.empBadgeNo&&a.empBadgeNo&&String(e.empBadgeNo)===String(a.empBadgeNo)?(0,g.A)((0,g.A)({},e),{},{data:e.data.map((e=>new Date(e.date).toLocaleDateString()===new Date(a.date).toLocaleDateString()?a:e))}):e));const l=function(e){let t=[];return e.forEach((e=>{e.empWorkInfo.forEach((a=>{let r=(0,g.A)((0,g.A)({},e),{},{empWorkInfo:[a]});t.push(r)}))})),t}([a]);let o=[...e.data],d=e.jobcode;const c=l.filter((e=>e.empWorkInfo.some((e=>e.JOBCODE===d))));c.length>0&&(o=[...o,...c]);let p=!1,m=!1;i.includes(null===e||void 0===e?void 0:e.firstFileType)?p=(null===n||void 0===n?void 0:n.sapNo)&&e.sapNo&&String(null===n||void 0===n?void 0:n.sapNo)===String(e.sapNo):m=(null===n||void 0===n?void 0:n.badgeNo)&&e.empBadgeNo&&String(null===n||void 0===n?void 0:n.badgeNo)===String(e.empBadgeNo);let u={};return(m||p)&&n.jobcode===e.jobcode&&n.location===e.location&&(u={getVerify:(0,g.A)((0,g.A)({},e.getVerify),{},{[n.workingHrsKey]:"Yes"}),assignUpdaterDateTime:(0,g.A)((0,g.A)({},e.assignUpdaterDateTime),{},{[n.workingHrsKey]:t}),workingHrs:(0,g.A)((0,g.A)({},e.workingHrs),{},{[n.workingHrsKey]:s}),OVERTIMEHRS:(0,g.A)((0,g.A)({},e.OVERTIMEHRS),{},{[n.workingHrsKey]:n.overtimeHrs})}),(0,g.A)((0,g.A)({},e),{},{grouped:r,data:o},u)}));t(l),r(l),d(!0)},{allData:I}=(()=>{const e=(0,Ee.D)(),[t,a]=(0,n.useState)([]);return(0,n.useEffect)((()=>{(async()=>{let t=null,r=[];do{var n,s,i,l;const a=await e.graphql({query:Ie.Oy,variables:{limit:1e3,nextToken:t}}),o=(null===a||void 0===a||null===(n=a.data)||void 0===n||null===(s=n.listTimeSheets)||void 0===s?void 0:s.items)||[];t=null===a||void 0===a||null===(i=a.data)||void 0===i||null===(l=i.listTimeSheets)||void 0===l?void 0:l.nextToken;for(const e of o)e&&r.push(e)}while(t);a(r)})()}),[]),{allData:t}})(),{convertedStringToArrayObj:k,loading:T,emptyTableMess:C,setEmptyTableMess:R,setLoading:P}=((e,t,a,r,s,i)=>{const[l,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),[p,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(null),x=(e,t,a)=>{const r=new Date(e).setHours(0,0,0,0),n=new Date(t).setHours(0,0,0,0),s=new Date(a).setHours(0,0,0,0);return r>=n&&r<=s};return(0,n.useEffect)((()=>{(async()=>{o(!1),c(!1),r(null),m(null);const n=Array.isArray(i)&&i.length>0;try{if(e&&t&&a&&n){const r=localStorage.getItem("userType");h(r);const n=1e3;let l=[];for(let a=0;a<i.length;a+=n){const r=i.slice(a,a+n);for(const a of r)null!==a&&void 0!==a&&a.status&&("Approved"===a.status||"Verified"===a.status)&&null!==a&&void 0!==a&&a.date&&x(a.date,e,t)&&l.push(a)}const d=l.flatMap((e=>{if("HO"===(null===e||void 0===e?void 0:e.fileType)){var t;const r=JSON.parse((null===(t=e.empWorkInfo)||void 0===t?void 0:t[0])||"[]").filter((e=>String(null===e||void 0===e?void 0:e.LOCATION).toUpperCase()===String(a).toUpperCase()));return 0===r.length?[]:[(0,g.A)((0,g.A)({},e),{},{companyName:a,empWorkInfo:[JSON.stringify(r)]})]}return String(null===e||void 0===e?void 0:e.companyName).toUpperCase()===String(a).toUpperCase()?[(0,g.A)({},e)]:[]})).filter(Boolean),p="Direct"===s||"Indirect"===s?d.filter((e=>e.fileName.toUpperCase().split(/[ .,\\-_]+/).includes(s.toUpperCase()))):d;0===p.length&&c(!0),p.length>0&&(m(p),o(!0),c(!1))}else console.log("startDate && endDate && location these are not have the data")}catch(l){console.error("Data fetch error:",l)}})()}),[e,t,a,s,i]),{convertedStringToArrayObj:p,getPosition:u,loading:l,emptyTableMess:d,setEmptyTableMess:c,setLoading:o}})(m,u,h,S,N,I);(0,n.useEffect)((()=>{m&&f(new Date(m.replace(/-/g,"/"))),u&&y(new Date(u.replace(/-/g,"/")))}),[m,u]);const O=(0,n.useCallback)((e=>{e&&t(e)}),[]),_=(0,n.useCallback)((()=>{P(!1)}),[]),M=()=>{l(!s)},F=Math.ceil((v-x)/864e5)+1;return(0,i.jsxs)("div",{children:[(0,i.jsx)(ml,{convertedStringToArrayObj:k,ProcessedDataFunc:S,publicHoliday:D,dummyLeaveStatus:us,dayCounts:F,mergedData:A,leaveStatuses:w}),(0,i.jsx)(yl,{dayCounts:F,data:e,LocationData:ms,secondaryData:a,searchResult:O,loading:T,emptyTableMess:C,resetTableFunc:_,toggleEditViewSummaryFunc:M,editViewSummaryObject:e=>{e&&p(e)}}),s&&(0,i.jsx)(hl,{toggleEditViewSummaryFunc:M,summaryObject:c,FinalEditedData:async a=>{const{badgeNo:n,data:s,sapNo:i,jobcode:l,location:o,NWHPD:c,NWHPM:p,workingHrsKey:m,workingHrs:u,overtimeHrs:h}=a,x=await b({NWHPD:c,NWHPM:p,workingHrsKey:m,workingHrs:u});if("0.00"===x)return;d(!1);const{resData:f,object:v,newresData:y,resDataForJobcode:N}=await(async(e,t)=>{try{var a,r;let s=[],i=[],l=[];const o=async e=>{const[t,a,r]=e.split("-"),n=parseInt(a,10),s=parseInt(t,10);return"".concat(n,"/").concat(s,"/").concat(r)},d={id:null===e||void 0===e?void 0:e.id,empName:null===e||void 0===e?void 0:e.empName,empBadgeNo:(null===e||void 0===e?void 0:e.badgeNo)||"",sapNo:(null===e||void 0===e?void 0:e.sapNo)||"",date:await o((null===e||void 0===e?void 0:e.workingHrsKey)||""),jobcode:(null===e||void 0===e?void 0:e.jobcode)||"",workingHrs:(null===e||void 0===e?void 0:e.workingHrs)||"",location:(null===e||void 0===e?void 0:e.location)||"",ot:(null===e||void 0===e?void 0:e.overtimeHrs)||"",normalWorkHrs:String(null===e||void 0===e?void 0:e.NWHPD)||""},c=async e=>{if(e){const{__typename:r,createdAt:n,updatedAt:s}=e,i=(0,is.A)(e,ol);try{var t;const e=await cl.graphql({query:ke.gB,variables:{input:i}}),a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.updateTimeSheet;if(l=[a]||0,a)return!0}catch(a){console.error(a)}}};async function p(e){try{if(!e||!e.data||!Array.isArray(e.data)||!e.workingHrsKey)return[];const t=null===e||void 0===e?void 0:e.data.find((t=>{const a=new Date(null===t||void 0===t?void 0:t.date),r=null===a||void 0===a?void 0:a.getDate(),n=(null===a||void 0===a?void 0:a.getMonth())+1,s=null===a||void 0===a?void 0:a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)===(null===e||void 0===e?void 0:e.workingHrsKey)}));if(!t){const t=await u(e,e.grouped);if(t){const e=(0,g.A)((0,g.A)({},t),{},{empWorkInfo:[JSON.stringify(t.empWorkInfo)]});return await c(e)}return!1}if(t)return t}catch(t){return console.log("error : ",t),null}}const m=e=>{const t=new Date(e),a=null===t||void 0===t?void 0:t.getDate(),r=(null===t||void 0===t?void 0:t.getMonth())+1,n=null===t||void 0===t?void 0:t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},u=async(a,r)=>{const n=null===a||void 0===a?void 0:a.data[0].empBadgeNo,s=null===a||void 0===a?void 0:a.data[0].fidNo,i=r.find((e=>(null===e||void 0===e?void 0:e.empBadgeNo)&&n&&String(null===e||void 0===e?void 0:e.empBadgeNo)===String(n)||(null===e||void 0===e?void 0:e.fidNo)&&s&&String(null===e||void 0===e?void 0:e.fidNo)===String(s))).data.find((e=>m(e.date)===(null===a||void 0===a?void 0:a.workingHrsKey)))||null;if(i){const r=i.empWorkInfo.filter((e=>e.JOBCODE!==(null===a||void 0===a?void 0:a.jobcode)));r.push({LOCATION:(null===a||void 0===a?void 0:a.location)||"",OVERTIMEHRS:(null===a||void 0===a?void 0:a.overtimeHrs)||"",JOBCODE:(null===a||void 0===a?void 0:a.jobcode)||"",WORKINGHRS:(null===a||void 0===a?void 0:a.workingHrs)||"",id:r.length+1,verify:"Yes"});const n=(0,g.A)((0,g.A)({},i),{},{empWorkInfo:r,status:"Verified"});return n&&e&&await t(n,e),n||null}return null},h=async(e,t)=>{if(null===e||void 0===e||!e.grouped||!Array.isArray(e.grouped))return null;const a=e.grouped.find((e=>(null===e||void 0===e?void 0:e.empBadgeNo)&&(null===t||void 0===t?void 0:t.empBadgeNo)&&String(null===e||void 0===e?void 0:e.empBadgeNo)===String(null===t||void 0===t?void 0:t.empBadgeNo)||(null===e||void 0===e?void 0:e.fidNo)&&(null===t||void 0===t?void 0:t.fidNo)&&String(null===e||void 0===e?void 0:e.fidNo)===String(null===t||void 0===t?void 0:t.fidNo)));return null!==a&&void 0!==a&&a.data&&Array.isArray(a.data)&&a.data.find((e=>e.date===t.date))||null},x=e&&(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.find((async e=>null!==e.fileName||void 0!==e.fileName))),f=e&&(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.find((async e=>null!==e.empDept||void 0!==e.empDept)));let v=10;const y=async()=>{const t=[{id:v++,JOBCODE:(null===e||void 0===e?void 0:e.jobcode)||"",LOCATION:(null===e||void 0===e?void 0:e.location)||"",WORKINGHRS:(null===e||void 0===e?void 0:e.workingHrs)||"",OVERTIMEHRS:(null===e||void 0===e?void 0:e.overtimeHrs)||"",verify:"Yes"}],a={empName:null===e||void 0===e?void 0:e.empName,["Offshore"===e.firstFileType||"BLNG"===e.firstFileType||"Offshore's ORMC"===e.firstFileType?"fidNo":"empBadgeNo"]:"Offshore"===e.firstFileType||"BLNG"===e.firstFileType||"Offshore's ORMC"===e.firstFileType?(null===e||void 0===e?void 0:e.sapNo)||"":(null===e||void 0===e?void 0:e.badgeNo)||"",fileName:await(null===x||void 0===x?void 0:x.fileName)||"N/A",empDept:await(null===f||void 0===f?void 0:f.empDept)||"N/A",date:await o((null===e||void 0===e?void 0:e.workingHrsKey)||""),actualWorkHrs:(null===e||void 0===e?void 0:e.workingHrs)||"",companyName:(null===e||void 0===e?void 0:e.location)||"",otTime:(null===e||void 0===e?void 0:e.overtimeHrs)||"",normalWorkHrs:String(null===e||void 0===e?void 0:e.NWHPD)||"",empWorkInfo:[JSON.stringify(t)]||0,fileType:e.firstFileType||"",status:"Verified"};try{var r;const e=await cl.graphql({query:ke.d$,variables:{input:a}}),t=null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.createTimeSheet;i=[t]}catch(n){console.log("Error : ",n)}},N=async e=>{if(e){const{__typename:r,createdAt:n,updatedAt:i}=e,l=(0,is.A)(e,dl);try{var t;const e=await cl.graphql({query:ke.gB,variables:{input:l}}),a=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.updateTimeSheet;if(s=[a],a)return!0}catch(a){console.error(a)}}};async function b(t){const a=t;function r(e){const t=null===e||void 0===e?void 0:e.match(/-?\d+(\.\d+)?/g);return t?null===t||void 0===t?void 0:t[t.length-1]:null}const n=await(async t=>{if(Array.isArray(null===t||void 0===t?void 0:t.empWorkInfo)){const a=t.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)).flat().map((t=>(0,g.A)((0,g.A)({},t),{},{JOBCODE:d.jobcode||"",LOCATION:(null===e||void 0===e?void 0:e.location)||"",WORKINGHRS:r(d.workingHrs)||"",OVERTIMEHRS:d.ot||"",verify:"Yes"})));return(0,g.A)((0,g.A)({},t),{},{verify:"Yes",empWorkInfo:[JSON.stringify(a)]})}})(a),s=await h(e,n);var i=await(async(t,a)=>{if(Array.isArray(t.empWorkInfo)){const n=t.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)),s=a.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)),i=n.flat(),l=s.map((t=>i.find((e=>t.id===e.id))?(0,g.A)((0,g.A)({},t),{},{JOBCODE:d.jobcode||"",LOCATION:(null===e||void 0===e?void 0:e.location)||"",WORKINGHRS:r(d.workingHrs)||"",OVERTIMEHRS:d.ot||"",verify:"Yes"}):t));return(0,g.A)((0,g.A)({},a),{},{status:"Verified",empWorkInfo:[JSON.stringify(l)]})}})(n,s);await N(i)}const D=await p(e);return D&&!0!==D?await b(D):!1===D&&await y(),{resData:s,object:e,newresData:i,resDataForJobcode:l}}catch(n){console.log("Error : ",n)}})(a,E);if(f&&f.length>0)try{await(async(t,a)=>{var r;null===a||void 0===a||null===(r=a.data)||void 0===r||r.forEach((t=>{const[r,n,s]=t.date.split("/");"".concat(parseInt(n),"-").concat(parseInt(r),"-").concat(s);let i=["BLNG","Offshore","Offshore's ORMC"],l=null===e||void 0===e?void 0:e.filter((e=>!0===i.includes(null===e||void 0===e?void 0:e.firstFileType)?e.sapNo:e.empBadgeNo));l&&l.forEach((e=>{e.data.forEach((r=>{const[n,s,i]=String(a.workingHrsKey).split("-"),l="".concat(parseInt(s),"/").concat(parseInt(n),"/").concat(i),o=!0===["BLNG","Offshore","Offshore's ORMC"].includes(null===a||void 0===a?void 0:a.firstFileType)?(null===e||void 0===e?void 0:e.sapNo)&&(null===a||void 0===a?void 0:a.sapNo)&&String(null===e||void 0===e?void 0:e.sapNo)===String(null===a||void 0===a?void 0:a.sapNo):(null===e||void 0===e?void 0:e.empBadgeNo)&&(null===a||void 0===a?void 0:a.badgeNo)&&String(null===e||void 0===e?void 0:e.empBadgeNo)===String(null===a||void 0===a?void 0:a.badgeNo);new Date(r.date).toLocaleDateString()===new Date(l).toLocaleDateString()&&new Date(l).toLocaleDateString()===new Date(t.date).toLocaleDateString()&&o&&Array.isArray(t.empWorkInfo)&&t.empWorkInfo.flatMap((e=>"string"===typeof e?JSON.parse(e):e)).forEach((n=>{const s=r.empWorkInfo.find((e=>e.id===n.id));s&&(s.verify="Yes",e.getVerify[a.workingHrsKey]="Yes",e.assignUpdaterDateTime[a.workingHrsKey]=t.updatedAt)}))}))}))})),d(!0)})(0,v);const a=s.flatMap((e=>e.empWorkInfo||[]));(new Date).toISOString();const l=e.map((e=>{const t=e.empBadgeNo&&n&&String(e.empBadgeNo)===String(n),r=e.sapNo&&i&&String(e.sapNo)===String(i);let s=(0,g.A)({},e);const l=e.data.some((n=>{var i;const l=a.find((e=>e.id)),o=n.empWorkInfo.find((e=>e.id));if(!l||!o)return!1;const[d,c,p]=n.date.split("/"),u="".concat(parseInt(c),"-").concat(parseInt(d),"-").concat(p),f=t||r,v=new Date(u).toLocaleDateString()===new Date(m).toLocaleDateString(),y=o.id===l.id,N=null===(i=e.workingHrs)||void 0===i?void 0:i.hasOwnProperty(m);return!!(f&&v&&y&&N)&&(s=(0,g.A)((0,g.A)({},e),{},{workingHrs:(0,g.A)((0,g.A)({},e.workingHrs),{},{[m]:x}),OVERTIMEHRS:(0,g.A)((0,g.A)({},e.OVERTIMEHRS),{},{[m]:h})}),!0)}));return l?s:e}));t(l),r(l)}catch(D){console.log("Error : ",D)}finally{d(!0)}else if(y&&y.length>0)try{y.forEach((t=>{var a;const r=t.empBadgeNo,n=t.fidNo,s=JSON.parse(t.empWorkInfo[0]),i=null===(a=s[0])||void 0===a?void 0:a.JOBCODE,l=e.find((e=>e.empBadgeNo&&r&&String(e.empBadgeNo)===String(r)&&e.jobcode===i||e.sapNo&&n&&String(e.sapNo)===String(n)&&e.jobcode===i));if(l){const[e,a,r]=t.date.split("/"),n="".concat(parseInt(a),"-").concat(parseInt(e),"-").concat(r);l.data.push((0,g.A)((0,g.A)({},t),{},{empWorkInfo:s})),l.getVerify[n]="Yes",l.assignUpdaterDateTime[n]=t.updatedAt}}));const a=e.map((e=>{const t=e.empBadgeNo&&n&&String(e.empBadgeNo)===String(n),a=e.sapNo&&i&&String(e.sapNo)===String(i);return(t||a)&&e.jobcode===l&&e.location===o&&e.workingHrs.hasOwnProperty(m)?(0,g.A)((0,g.A)({},e),{},{workingHrs:(0,g.A)((0,g.A)({},e.workingHrs),{},{[m]:x}),OVERTIMEHRS:(0,g.A)((0,g.A)({},e.OVERTIMEHRS),{},{[m]:h})}):(d(!0),e)}));t(a),r(a)}catch(D){console.log("ERROR : ",D)}finally{d(!0)}}}),!o&&(0,i.jsx)(xs,{icons:(0,i.jsx)(j.enS,{}),iconColor:"text-[#2BEE48]",textColor:"text-[#05b01f]",title:"Updating...",message:"Update request has been submitted, ",messageTwo:"This might take a few seconds..."})]})},bl=()=>{const[e,t]=(0,n.useState)([]),[a,s]=(0,n.useState)("insurance"),[l,o]=(0,n.useState)([]),[d,c]=(0,n.useState)(""),p=(0,r.Zp)(),m=(0,r.zy)();(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const u=(e,t)=>{s(e),p(t)};(0,n.useEffect)((()=>{const e=m.pathname;s("/insuranceHr"===e?"insurance":"/insuranceHr/groupHS"===e?"groupHS":"/insuranceHr/workmenComp"===e?"workmenComp":"/insuranceHr/travelling"===e?"travelling":"/insuranceHr/personalAcci"===e?"personalAcci":"/insuranceHr/insuranceClaim"===e?"insuranceClaim":"insurance")}),[m]);return(0,i.jsx)("section",{className:"w-full bg-[#F5F6F1]",children:(0,i.jsxs)("div",{className:"relative mx-auto p-5 h-full",children:[(0,i.jsx)("div",{className:"w-full",children:(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Insurance Info"})}),(0,i.jsxs)("div",{className:"flex justify-between border-b m-4 text-[16px] font-semibold",children:[(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("insurance"===a?"border-b-8 border-yellow":""),onClick:()=>u("insurance","/insuranceHr"),children:"Insurance Type"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("groupHS"===a?"border-b-8 border-yellow":""),onClick:()=>u("groupHS","/insuranceHr/groupHS"),children:"GroupH&S"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("workmenComp"===a?"border-b-8 border-yellow":""),onClick:()=>u("workmenComp","/insuranceHr/workmenComp"),children:"Workmen Compensation"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("travelling"===a?"border-b-8 border-yellow":""),onClick:()=>u("travelling","/insuranceHr/travelling"),children:"Travelling"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("personalAcci"===a?"border-b-8 border-yellow":""),onClick:()=>u("personalAcci","/insuranceHr/personalAcci"),children:"Personal Accident"}),(0,i.jsx)("button",{className:"py-2 px-4 focus:outline-none ".concat("insuranceClaim"===a?"border-b-8 border-yellow":""),onClick:()=>u("insuranceClaim","/insuranceHr/insuranceClaim"),children:"Insurance Claim"})]}),(0,i.jsx)("div",{children:(0,i.jsx)(r.sv,{context:{access:"Insurance",requiredPermissions:["Insurance"],empID:d,activeNavTab:a,handleNext:()=>{switch(a){case"insurance":p("/insuranceHr"),s("insurance");break;case"groupHS":p("/insuranceHr/groupHS"),s("groupHS");break;case"workmenComp":p("/insuranceHr/workmenComp"),s("workmenComp");break;case"travelling":p("/insuranceHr/travelling"),s("travelling");break;case"personalAcci":p("/insuranceHr/personalAcci"),s("personalAcci");break;case"insuranceClaim":p("/insuranceHr/insuranceClaim"),s("insuranceClaim")}},searchResultData:l}})})]})})},Dl=e=>{let{register:t,errors:a,index:r}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-5 flex-wrap",children:[(0,i.jsx)(mt,{label:"Clainmant Name",register:t,name:"insuranceClaims[".concat(r,"].claimantName"),type:"text",errors:a}),(0,i.jsx)(mt,{label:"Date Reported to Insurance Company",register:t,name:"insuranceClaims[".concat(r,"].dateReported"),type:"date",errors:a}),(0,i.jsx)(mt,{label:"Date of Payment Received ",register:t,name:"insuranceClaims[".concat(r,"].paymentReceived"),type:"date",errors:a}),(0,i.jsx)(mt,{label:"Date Paid to Employee ",register:t,name:"insuranceClaims[".concat(r,"].datePaid"),type:"date",errors:a})]})},jl=()=>{var e;(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{insuranceClaimsData:t,empPIData:a,dropDownVal:l}=(0,n.useContext)(s.Y),{formattedPermissions:o}=qt(),[d,c]=(0,n.useState)(!1),[p,m]=(0,n.useState)(""),[u,h]=(0,n.useState)([]),{SubmitICData:x}=(()=>{const e=(0,Ee.D)();return{SubmitICData:(0,n.useCallback)((async t=>{let{ICValuse:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,insuranceClaims:JSON.stringify(a.insuranceClaims),createdBy:a.createdBy};console.log(r);try{const t=await Promise.all([e.graphql({query:ke.rZ,variables:{input:r}})]);console.log(t,"successfully stored data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),{InsClaimUpData:f}=(()=>{const e=(0,Ee.D)();return{InsClaimUpData:(0,n.useCallback)((async t=>{let{ICValuse:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,insuranceClaims:JSON.stringify(a.insuranceClaims),id:a.id,updatedBy:a.updatedBy};try{await Promise.all([e.graphql({query:ke.i_,variables:{input:r}})])}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}})(),[v,y]=(0,n.useState)(!1),[N,b]=(0,n.useState)([]),D=localStorage.getItem("userID"),[A,w]=(0,n.useState)(!1),{register:S,handleSubmit:E,formState:{errors:I},setValue:k,watch:T,getValues:C,reset:R}=(0,tt.mN)({resolver:(0,at.t)(en),defaultValues:{insuranceClaims:[{}]}}),[P,O]=(0,n.useState)([{id:Date.now()}]),[_,M]=(0,n.useState)({}),[F,L]=(0,n.useState)({}),[U,B]=(0,n.useState)({insuranceClaims:[]}),[q,H]=(0,n.useState)({insuranceClaims:!1}),[W,z]=(0,n.useState)(P),[Y,V]=(0,n.useState)(""),G=((0,n.useRef)(!0),null===(e=l[0])||void 0===e?void 0:e.insuClaimDD.map((e=>({value:e,label:e}))));(0,n.useEffect)((()=>{(async()=>{try{const e=a.map((e=>{const a=t?t.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)({},e),a)})).filter(Boolean);b(e)}catch(e){console.error("Error fetching data:",e)}})()}),[a,t]);const J=T("empID"),K=async(e,t,a)=>{if(!J)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/insuranceHr/insuranceClaim");const r=e.target.files[0];if(!r)return;if(["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type)){k("insuranceClaims[".concat(a,"].claimUpload"),r);try{n=t,s=!0,i=a,H((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(i,"_").concat(n)]:s}))),await(async(e,t,a,r,n)=>{try{if(await(0,nt.H)()){const s=(await(0,st.C)({path:"public/".concat(t,"/").concat(r,"/").concat(e.name),data:e}).result).path,i=(new Date).toISOString().split("T")[0];"number"===typeof n?a((e=>{const a=(0,g.A)({},e);return a[t]||(a[t]=[]),Array.isArray(a[t][n])||(a[t][n]=[]),a[t][n].find((e=>e.upload===s))||a[t][n].push({upload:s,date:i}),a})):(console.log("No index provided. Appending to the array."),a((e=>(0,g.A)((0,g.A)({},e),{},{[t]:[...e[t]||[],{upload:s,date:i}]}))))}}catch(s){console.log("Error uploading ".concat(t,":"),s)}})(r,t,B,J,a),M((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(a,"_").concat(t)]:[r.name]})))}catch(l){console.log(l)}var n,s,i}else alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},Q=e=>e.split("/").pop(),$=()=>{c(!d)},Z=async(e,t,a,r)=>{try{if(!J)return void alert("Please provide the Employee ID before deleting files.");const r=await(0,_a.k)(e,t,J),n=await((e,t,a,r,n,s,i,l,o,d)=>{try{if(void 0===l||null===l)return;r((e=>{const a=(0,g.A)({},e);return Object.keys(a).forEach((e=>{a[e].includes(t)&&(a[e]=a[e].filter((e=>e!==t)))})),a})),s((r=>{const n=(0,g.A)({},r);n.insuranceClaims||(n.insuranceClaims={}),n.insuranceClaims[l]||(n.insuranceClaims[l]=[]);const s=n.insuranceClaims[l].findIndex((r=>r.upload==="public/".concat(e,"/").concat(a,"/").concat(t)));return-1!==s&&n.insuranceClaims[l].splice(s,1),0===n.insuranceClaims[l].length&&delete n.insuranceClaims[l],n}));const i="".concat(l,"_").concat(e);n((e=>{const a=(0,g.A)({},e);return Array.isArray(a[i])&&(a[i]=[...a[i]].filter((e=>e!==t)),0===a[i].length&&delete a[i]),a})),d((t=>{const a=(0,g.A)({},t),r="".concat(l,"_").concat(e);return a[r]&&(a[r]=!1),a}))}catch(c){console.log("Caught error:",c)}})(e,t,J,M,L,B,0,a,0,H);if(!r)return void console.error("Failed to delete file: ".concat(t,", dynamodb."));if(n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));m("".concat(t)),$()}catch(n){console.error("Error deleting file:",n),alert("Error processing the file deletion.")}},X=["Insurance"],ee=null===W||void 0===W?void 0:W.map((e=>{try{return"string"===typeof e?JSON.parse(e):e}catch(t){return console.error("Error parsing claims:",t),null}})).flat().filter((e=>e&&"object"===typeof e));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 px-10",children:[(0,i.jsx)(r.N_,{to:"/dashboard",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Insurance Claim"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(ea,{searchResult:e=>{e&&w(!0),k("empID",null===e||void 0===e?void 0:e.empID);const t=null===e||void 0===e?void 0:e.insuranceClaims;if(t)try{const e=JSON.parse(t);if(!Array.isArray(e))return void console.error("Invalid insuranceClaims data format:",t);e.length>0&&(z(e),k("insuranceClaims",e),e.forEach(((e,t)=>{if(null!==e&&void 0!==e&&e.claimUpload)try{const a=e.claimUpload;if(Array.isArray(a)&&0===a.length)return;const r="string"===typeof a?JSON.parse(a):a;if(!Array.isArray(r))return void console.error("Invalid claimUpload format:",a);const n=r.map((e=>{try{return"string"===typeof e?JSON.parse(e):e}catch(t){return console.error("Error parsing nested claimUpload item:",e),null}})).filter(Boolean);B((e=>(0,g.A)((0,g.A)({},e),{},{insuranceClaims:(0,g.A)((0,g.A)({},e.insuranceClaims),{},{[t]:n})})));const s=n.map((e=>e&&e.upload?Q(e.upload):""));L((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(t,"_").concat("insuranceClaims")]:s})))}catch(a){console.error("Error parsing claimUpload JSON:",e.claimUpload)}})))}catch(a){console.error("Error parsing insuranceClaimsData:",a,t)}else R({empID:C("empID")}),B({}),M({}),L({}),z([{claimantName:"",dateReported:"",paymentReceived:"",datePaid:"",claimType:"",claimInfo:"",claimUpload:[]}])},newFormData:N,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:u,setFilteredEmployees:h})})]}),(0,i.jsxs)("div",{className:"bg-[#F5F6F1CC] mx-auto p-2 py-10 px-10",onClick:()=>{h([])},children:[(0,i.jsxs)("form",{className:"flex flex-col gap-5",onSubmit:E((async e=>{try{const r=(new Date).toISOString().split("T")[0],n=t.find((t=>t.empID===e.empID));if(n){var a;const t=n.updatedBy?JSON.parse(n.updatedBy):[],s=JSON.stringify([...t,{userID:D,date:r}]),i=(0,g.A)((0,g.A)({},e),{},{insuranceClaims:null===e||void 0===e||null===(a=e.insuranceClaims)||void 0===a?void 0:a.map(((e,t)=>{var a;return(0,g.A)((0,g.A)({},e),{},{claimUpload:JSON.stringify(null===U||void 0===U||null===(a=U.insuranceClaims)||void 0===a?void 0:a[t])||[]})})),id:n.id,updatedBy:s});await f({ICValuse:i}),V("Insurance claim Updated successfully"),y(!0)}else{const t=(0,g.A)((0,g.A)({},e),{},{insuranceClaims:null===e||void 0===e?void 0:e.insuranceClaims.map(((e,t)=>(0,g.A)((0,g.A)({},e),{},{claimUpload:JSON.stringify(U.insuranceClaims[t])||[]}))),createdBy:JSON.stringify([{userID:D,date:r}])});await x({ICValuse:t}),V("Insurance claim saved successfully"),y(!0)}}catch(r){console.error("Error submitting data:",r)}})),children:[(0,i.jsx)("div",{className:"flex justify-end items-center",children:(0,i.jsxs)("div",{className:"max-w-sm",children:[(0,i.jsx)("label",{className:"text_size_6",children:"Employee ID"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",className:"w-full h-[45px] bg-lite_skyBlue pl-3 mt-2 border outline-none border-[#dedddd] rounded pr-10",placeholder:"Enter Employee ID"},S("empID")),{},{disabled:A})),I.empID&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:I.empID.message})]})}),(0,i.jsx)("button",{type:"button",onClick:()=>{const e={id:Date.now()};z((t=>[...t,e]))},className:"absolute  right-3 mt-28 text-medium_grey text-[25px] px-10",children:(0,i.jsx)(Fr.tN3,{className:"mr-1"})}),(null===ee||void 0===ee?void 0:ee.length)>0&&(null===ee||void 0===ee?void 0:ee.map(((e,t)=>{var a,r,n;return(0,i.jsxs)("div",{className:"flex flex-col gap-5 border-b py-10",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,i.jsx)(mt,{label:"Type of Insurance Claim",register:S,name:"insuranceClaims[".concat(t,"].claimType"),type:"select",options:G,errors:null===(a=I.insuranceClaims)||void 0===a?void 0:a[t]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"mb-1 text_size_6",children:"Insurance Claim For"}),(0,i.jsxs)("select",(0,g.A)((0,g.A)({},S("insuranceClaims[".concat(t,"].claimInfo"))),{},{className:"input-field select-custom",children:[(0,i.jsx)("option",{value:""}),(0,i.jsx)("option",{value:"Employee",children:"Employee"}),(0,i.jsx)("option",{value:"Spouse",children:"Spouse"}),(0,i.jsx)("option",{value:"Child",children:"Child"})]})),(null===(r=I.insuranceClaims)||void 0===r||null===(n=r[t])||void 0===n?void 0:n.depenInfo)&&(0,i.jsx)("p",{className:"text-[red] text-xs mt-1",children:I.insuranceClaims[t].depenInfo.message})]})]}),(0,i.jsx)(Dl,{register:S,errors:I,index:t}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-10",children:(0,i.jsxs)("div",{className:"",children:[(0,i.jsxs)("label",{onClick:()=>{null!==q&&void 0!==q&&q["".concat(t,"_insuranceClaims")]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"flex items-center  px-3 py-3 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] rounded-md cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file"},S("insuranceClaims[".concat(t,"].claimUpload"))),{},{onChange:e=>K(e,"insuranceClaims",t),accept:"application/pdf",className:"hidden",disabled:null===q||void 0===q?void 0:q["".concat(t,"_insuranceClaims")]})),(0,i.jsxs)("span",{className:"ml-2  w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-between ",children:null!==_&&void 0!==_&&_["".concat(t,"_insuranceClaims")]?(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(_["".concat(t,"_insuranceClaims")])&&_["".concat(t,"_insuranceClaims")].slice().reverse().map(((e,a)=>(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{Z("insuranceClaims",e,t)},children:(0,i.jsx)(_t.uDv,{})})]},a)))}):(null===F||void 0===F?void 0:F["".concat(t,"_insuranceClaims")])&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(F["".concat(t,"_insuranceClaims")])&&F["".concat(t,"_insuranceClaims")].slice().reverse().map(((e,a)=>{var r,n;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===o||void 0===o||null===(r=o.deleteAccess)||void 0===r||null===(n=r.Insurance)||void 0===n?void 0:n.some((e=>X.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{Z("insuranceClaims",e,t)},children:(0,i.jsx)(_t.uDv,{})})]},a)}))})}),(null===I||void 0===I?void 0:I.claimUpload)&&(0,i.jsx)("p",{className:"text-red text-sm",children:I.claimUpload.message})]})}),t>0&&(0,i.jsx)("button",{type:"button",onClick:()=>(async e=>{z((t=>t.filter(((t,a)=>a!==e)))),k("insuranceClaims",(t=>t.filter(((t,a)=>a!==e)))),M((t=>{const a=(0,g.A)({},t);return Object.keys(a).forEach((t=>{t.startsWith("".concat(e,"_"))&&delete a[t]})),a})),L((t=>{const a=(0,g.A)({},t);return Object.keys(a).forEach((t=>{t.startsWith("".concat(e,"_"))&&delete a[t]})),a})),B((t=>{const a=(0,g.A)({},t);return a.insuranceClaims&&delete a.insuranceClaims[e],a}))})(t),className:"text-red mt-2  flex justify-end items-end text-[25px]",children:(0,i.jsx)(Fr.prK,{})})]},t)}))),(0,i.jsx)("div",{className:"md:col-span-2 flex justify-center mt-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})}),v&&(0,i.jsx)(Pe,{text:Y,notification:v,path:"/insuranceHr/insuranceClaim"})]}),d&&(0,i.jsx)(Wt,{handleDeleteMsg:$,title1:p})]})]})},Al=e=>{let{searchResult:t,newFormData:a,searchIcon1:r,searchIcon2:s,placeholder:l,rounded:o,setDrpValue:d,searchedValue:c,id:p,filteredEmployees:m,setFilteredEmployees:u}=e;const[h,x]=(0,n.useState)(""),[g,f]=(0,n.useState)(!1);(0,n.useEffect)((()=>{d&&x(d)}),[d]);const v=(0,n.useCallback)((()=>{f(!g),!0===g?null===u||void 0===u||u([]):!1===g&&(null===u||void 0===u||u(a))}),[g,a]),y=(0,n.useCallback)((()=>{if(a&&a.length>0){const e=h.toString().toUpperCase(),r=a.find((t=>{var a,r,n,s;return(null===(a=t.groupHSNo)||void 0===a?void 0:a.toString().toUpperCase())===e||(null===(r=t.workmenCompNo)||void 0===r?void 0:r.toString().toUpperCase())===e||(null===(n=t.travelNo)||void 0===n?void 0:n.toString().toUpperCase())===e||(null===(s=t.perAccNo)||void 0===s?void 0:s.toString().toUpperCase())===e}));r&&h?t(r):h?(alert("Policy Number Not Found."),t({})):alert("Your search box is empty. Enter a value to start searching.")}}),[h,a]);return(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("div",{className:"py-2 w-full text_size_5 border text-grey bg-white border-lite_grey ".concat(o," flex items-center px-2 gap-2"),children:[(0,i.jsx)("div",{className:" text-dark_grey  text-2xl ",children:r}),(0,i.jsx)("input",{type:"text",placeholder:l,className:"outline-none w-full",value:h,onChange:e=>{const t=e.target.value.toUpperCase();if(x(t),null===c||void 0===c||c(p,t),t){const e=null===a||void 0===a?void 0:a.filter((e=>{var a,r,n,s;return(null===(a=e.groupHSNo)||void 0===a?void 0:a.toString().toUpperCase().includes(t))||(null===(r=e.workmenCompNo)||void 0===r?void 0:r.toString().toUpperCase().includes(t))||(null===(n=e.travelNo)||void 0===n?void 0:n.toString().toUpperCase().includes(t))||(null===(s=e.perAccNo)||void 0===s?void 0:s.toString().toUpperCase().includes(t))})),r=null===e||void 0===e?void 0:e.sort(((e,a)=>{var r,n,s,i,l,o,d,c;const p=null===(r=e.groupHSNo)||void 0===r?void 0:r.toString().toUpperCase(),m=null===(n=a.groupHSNo)||void 0===n?void 0:n.toString().toUpperCase(),u=null===(s=e.workmenCompNo)||void 0===s?void 0:s.toString().toUpperCase(),h=null===(i=a.workmenCompNo)||void 0===i?void 0:i.toString().toUpperCase(),x=null===(l=e.travelNo)||void 0===l?void 0:l.toString().toUpperCase(),g=null===(o=a.travelNo)||void 0===o?void 0:o.toString().toUpperCase(),f=null===(d=e.perAccNo)||void 0===d?void 0:d.toString().toUpperCase(),v=null===(c=a.perAccNo)||void 0===c?void 0:c.toString().toUpperCase(),y=p===t||u===t||x===t||f===t,N=m===t||h===t||g===t||v===t;if(y&&!N)return-1;if(!y&&N)return 1;const b=(null===p||void 0===p?void 0:p.startsWith(t))||(null===u||void 0===u?void 0:u.startsWith(t))||(null===x||void 0===x?void 0:x.startsWith(t))||(null===f||void 0===f?void 0:f.startsWith(t)),D=(null===m||void 0===m?void 0:m.startsWith(t))||(null===h||void 0===h?void 0:h.startsWith(t))||(null===g||void 0===g?void 0:g.startsWith(t))||(null===v||void 0===v?void 0:v.startsWith(t));return b&&!D?-1:!b&&D?1:0}));null===u||void 0===u||u(r)}else null===u||void 0===u||u(a)},onClick:v}),(0,i.jsx)("div",{className:" text-dark_grey  text-2xl cursor-pointer",onClick:()=>{y()},children:s})]}),(null===m||void 0===m?void 0:m.length)>0&&(0,i.jsx)("ul",{className:" absolute right-0 overflow-x-hidden  mt-2 w-full ml-auto max-h-36 overflow-y-auto rounded-lg shadow-lg bg-white z-10",children:m.map(((e,a)=>(0,i.jsx)("li",{className:"m-2 p-1 hover:bg-grey hover:text-white cursor-pointer flex justify-between items-center transition-all duration-200",onClick:()=>{e.groupHSNo?(x("".concat(e.groupHSNo)),t(e)):e.workmenCompNo?(x("".concat(e.workmenCompNo)),t(e)):e.travelNo?(x("".concat(e.travelNo)),t(e)):e.perAccNo&&(x("".concat(e.perAccNo)),t(e)),f(!1),null===u||void 0===u||u([])},children:(0,i.jsx)("div",{children:(0,i.jsx)("span",{className:" text-sm",children:(null===e||void 0===e?void 0:e.groupHSNo)||(null===e||void 0===e?void 0:e.workmenCompNo)||(null===e||void 0===e?void 0:e.travelNo)||(null===e||void 0===e?void 0:e.perAccNo)})})},a)))})]})};Je.EA.workerSrc=new URL(a(1886),a.b).toString();const wl=()=>{const{empPIData:e,groupHSData:t}=(0,n.useContext)(s.Y),a=(0,Ee.D)(),[l,o]=(0,n.useState)({groupHSUpload:!1}),[d,c]=(0,n.useState)({groupHSUpload:null}),[p,m]=(0,n.useState)({groupHSUpload:[]}),[u,h]=(0,n.useState)(!1),[x,v]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1),[b,D]=(0,n.useState)([]),[A,w]=(0,n.useState)(!0),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)(""),[T,C]=(0,n.useState)([]),[R,P]=(0,n.useState)([]),[O,_]=(0,n.useState)([]),[M,F]=(0,n.useState)(""),{formattedPermissions:L}=qt(),U=localStorage.getItem("userID"),[B,q]=(0,n.useState)(!1),{register:H,handleSubmit:W,setValue:z,watch:Y,formState:{errors:V,setError:G}}=(0,tt.mN)({resolver:(0,at.t)(Qr)}),J=e=>{const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},K=(0,n.useRef)(),Q=async(e,t)=>{const a=Y("groupHSNo");if(!a)return alert("Please enter the Policy Number before uploading files."),void(window.location.href="/insuranceHr/groupHS");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=Y(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{z(t,[...n,r]);try{((e,t)=>{o((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dt(r,t,m,a),c((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},$=()=>{h(!u)},Z=async(e,t,a)=>{try{const r=Y("groupHSNo");if(!r)return void alert("Please provide the Policy Number before deleting files.");const n=await((e,t,a,r,n,s,i)=>{try{if(!r)return;s((t=>{const r=(0,g.A)({},t);return Array.isArray(r[e])&&(r[e]=r[e].filter(((e,t)=>t!==a)),r[e]&&0!==r[e].length||(r[e]=[])),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])?n[e]=n[e].filter(((e,t)=>t!==a)):"string"===typeof n[e]&&n[e]===t&&(n[e]=[]),n[e]&&0!==n[e].length||(n[e]=[]),n})),i((t=>{const a=(0,g.A)({},t);return a[e]=!1,a}))}catch(l){console.log("Error in delete Group Insurance function:",l)}})(e,t,a,r,c,m,o);if(!await(0,_a.k)(e,t,r)||n)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));v("".concat(t)),$()}catch(r){console.error("Error deleting file:",r),alert("Error processing the file deletion.")}};(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");F(e)}),[]);(0,n.useEffect)((()=>{(async()=>{try{let s=[],i=null;do{var e,t,r,n;const l=await a.graphql({query:Ie.CT,variables:{nextToken:i}}),o=(null===l||void 0===l||null===(e=l.data)||void 0===e||null===(t=e.listGroupHandS)||void 0===t?void 0:t.items)||[];s=[...s,...o],i=null===l||void 0===l||null===(r=l.data)||void 0===r||null===(n=r.listGroupHandS)||void 0===n?void 0:n.nextToken}while(i);const l=s.filter((e=>new Date(e.groupHSExp)>=new Date));D(l),w(!1)}catch(s){console.error("Error fetching insurance data:",s),G("insuranceData",{message:"Error fetching data"}),w(!1)}})()}),[]),(0,n.useEffect)((()=>{(async()=>{try{const a=e.map((e=>{const a=t?null===t||void 0===t?void 0:t.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)({},e),a)})).filter(Boolean);C(a)}catch(a){console.log(a)}})()}),[e,t]);(0,n.useEffect)((()=>{z("id",O.id),z("groupHSNo",O.groupHSNo),z("groupHSExp",O.groupHSExp);if(["createdAt","updatedAt","groupHSExp","groupHSNo","groupHSUpload"].forEach((e=>z(e,O[e]))),O&&O.groupHSUpload)try{const e=JSON.parse(O.groupHSUpload[0]).map((e=>"string"===typeof e?JSON.parse(e):e));z("groupHSUpload",e),m((t=>(0,g.A)((0,g.A)({},t),{},{groupHSUpload:e}))),c((t=>(0,g.A)((0,g.A)({},t),{},{groupHSUpload:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(e){console.error("Failed to parse ".concat(O.groupHSUpload,":"),e)}}),[O,z]);const X=()=>{E(null)},ee=(0,Ir.useReactToPrint)({content:()=>K.current,pageStyle:"\n    @page {\n      size: auto;\n      margin: 0mm;\n    }\n    body { \n      margin: 0;\n      padding: 0;\n    }\n    .pdf-page {\n      page-break-after: always;\n    }\n  "}),te=e=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",J(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});k(t.url.href),E(e)}catch(t){console.error("Error fetching the file URL:",t)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),S===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"PDF Viewer"}),(0,i.jsx)("button",{onClick:X,className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:K,className:"flex-grow overflow-y-auto pdf-page",children:I?(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:I,renderError:e=>(0,i.jsxs)("div",{className:"p-4 text-red-500",children:["Failed to load PDF: ",e.message,(0,i.jsxs)("div",{className:"text-sm mt-2",children:["URL: ",I]})]})})}):(0,i.jsx)("div",{className:"p-4 text-center",children:"No PDF file available"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:I,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:ee,className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})}),S===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Image Viewer"}),(0,i.jsx)("button",{onClick:()=>E(null),className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:K,className:"flex-grow overflow-y-auto p-4",children:(0,i.jsx)("img",{src:I,alt:"Document Preview",className:"w-full h-auto rounded"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:I,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:ee,className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})})]},t)))}),ae=(e,t)=>{const a=e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(t){return console.error("Error parsing document data:",t),[]}})(e[0]):[],r=Array.isArray(a)&&a.length>0;return(0,i.jsxs)("div",{className:"py-4 ",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),r?te(a):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents and images available"})]})},re=["Insurance"];return(0,i.jsxs)("section",{onClick:()=>{P([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 px-10",children:[(0,i.jsx)(r.N_,{to:"/dashboard",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Group H&S Insurance"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Al,{searchResult:e=>{_(e),e&&q(!0)},newFormData:b,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Policy Number",rounded:"rounded-lg",empID:M,filteredEmployees:R,setFilteredEmployees:P})})," "]}),(0,i.jsxs)("form",{onSubmit:W((async e=>{try{const r=(new Date).toISOString().split("T")[0],n=null===t||void 0===t?void 0:t.find((e=>(null===e||void 0===e?void 0:e.id)===(null===O||void 0===O?void 0:O.id)));if(n){const t=n.updatedBy?JSON.parse(n.updatedBy):[],s=JSON.stringify([...t,{userID:U,date:r}]),i=(0,g.A)((0,g.A)({},e),{},{id:n.id,groupHSUpload:JSON.stringify(p.groupHSUpload),updatedBy:s}),l={id:i.id,groupHSExp:i.groupHSExp,groupHSNo:i.groupHSNo,groupHSUpload:i.groupHSUpload,updatedBy:i.updatedBy};await a.graphql({query:ke.t7,variables:{input:l}});N(!0)}else{const t={groupHSNo:e.groupHSNo,groupHSExp:e.groupHSExp,groupHSUpload:JSON.stringify(p.groupHSUpload),createdBy:JSON.stringify([{userID:U,date:r}])};await a.graphql({query:ke.Gr,variables:{input:t}});N(!0)}}catch(r){console.error("Error submitting data:",r)}})),className:"mx-auto py-5 px-10 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"relative mb-5",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 items-center",children:[(0,i.jsx)(mt,{name:"groupHSNo",type:"text",placeholder:"Enter H&S Policy Number",label:"Policy Number",register:H,errors:V,trackEmpID:B}),(0,i.jsx)(mt,{name:"groupHSExp",type:"date",label:"Expiry Date",register:H,errors:V}),(0,i.jsx)("div",{className:"mb-2 relative",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("label",{onClick:()=>{l.groupHSUpload&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file",className:"hidden"},H),{},{accept:".pdf, .jpg, .jpeg, .png",onChange:e=>Q(e,"groupHSUpload"),disabled:l.groupHSUpload})),(0,i.jsxs)("span",{className:"ml-2  w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),d.groupHSUpload&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(d.groupHSUpload)?d.groupHSUpload.slice().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===L||void 0===L||null===(a=L.deleteAccess)||void 0===a||null===(r=a.Insurance)||void 0===r?void 0:r.some((e=>re.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>Z("groupHSUpload",e,t),children:(0,i.jsx)(_t.uDv,{})})]},t)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[d.groupHSUpload,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>Z("groupHSUpload",d.groupHSUpload,0),children:(0,i.jsx)(_t.uDv,{})})]})})]})})]})}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),y&&(0,i.jsx)(Pe,{text:"Group H&S Saved Successfully",notification:y,path:"/insuranceHr/groupHS"}),(0,i.jsxs)("div",{className:"mt-10",children:[(0,i.jsx)("p",{className:"text-xl font-bold mb-10 p-3 rounded-lg border-2 border-[#FEF116] bg-[#FFFEF4] w-[250px]",children:"View Insurance Info"}),A?(0,i.jsx)("p",{children:"Loading..."}):b.length>0?(0,i.jsx)("div",{className:" h-[400px] overflow-y-auto scrollBar",children:(0,i.jsxs)("table",{className:"w-full text-center ",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tl-lg",children:"Policy Number"}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"Expiry Date"}),(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tr-lg",children:"Uploaded File"})]})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer  ",children:b.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)] hover:bg-medium_blue ",children:[(0,i.jsx)("td",{className:"pl-4 py-4",children:e.groupHSNo}),(0,i.jsx)("td",{className:"py-4 px-4",children:J((null===e||void 0===e?void 0:e.groupHSExp)||"N/A")}),(0,i.jsx)("td",{className:"pl-4 py-4",children:ae(e.groupHSUpload,"PDF File")})]},t)))})]})}):(0,i.jsx)("p",{className:"text-center mt-10",children:"No insurance information available."})]}),u&&(0,i.jsx)(Wt,{handleDeleteMsg:$,title1:x})]})};a(6749);Je.EA.workerSrc=new URL(a(1886),a.b).toString();const Sl=()=>{const e=(0,Ee.D)(),[t,a]=(0,n.useState)(!1),[l,o]=(0,n.useState)([]),[d,c]=(0,n.useState)(!0),[p,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),[x,v]=(0,n.useState)(""),[y,N]=(0,n.useState)({workmenComUp:!1}),[b,D]=(0,n.useState)({workmenComUp:null}),[A,w]=(0,n.useState)({workmenComUp:[]}),[S,E]=(0,n.useState)(!1),[I,k]=(0,n.useState)(""),[T,C]=(0,n.useState)(null),[R,P]=(0,n.useState)(1),[O,_]=(0,n.useState)(null),[M,F]=(0,n.useState)(""),[L,U]=(0,n.useState)(""),[B,q]=(0,n.useState)(""),[H,W]=(0,n.useState)([]),[z,Y]=(0,n.useState)([]),{formattedPermissions:V}=qt(),{workMenDetails:G}=(0,n.useContext)(s.Y),{empID:J,requiredPermissions:K,access:Q}=(0,r.KC)(),$=localStorage.getItem("userID"),[Z,X]=(0,n.useState)(!1),{register:ee,handleSubmit:te,watch:ae,setValue:re,formState:{errors:ne}}=((0,n.useRef)(),(0,tt.mN)({resolver:(0,at.t)($r)})),se=e=>{const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},ie=(0,n.useRef)(),le=async(e,t)=>{const a=ae("workmenCompNo");if(!a)return alert("Please enter the Policy Number before uploading files."),void(window.location.href="/insuranceHr/workmenComp");const r=e.target.files[0];if(!r)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const n=ae(t)||[];if(n.some((e=>e.name===r.name)))alert("This file has already been uploaded.");else{re(t,[...n,r]);try{((e,t)=>{N((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dt(r,t,w,a),D((e=>(0,g.A)((0,g.A)({},e),{},{[t]:r.name})))}catch(s){console.error(s)}}},oe=()=>{h(!u)},de=async(e,t,a)=>{try{const r=ae("workmenCompNo");if(!r)return void alert("Please provide the Policy Number before deleting files.");const n=await(0,_a.k)(e,t,r),s=await((e,t,a,r,n,s,i)=>{try{if(!r)return;s((t=>{const r=(0,g.A)({},t);return Array.isArray(r[e])&&(r[e]=r[e].filter(((e,t)=>t!==a)),r[e]&&0!==r[e].length||(r[e]=[])),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])?n[e]=n[e].filter(((e,t)=>t!==a)):"string"===typeof n[e]&&n[e]===t&&(n[e]=[]),n[e]&&0!==n[e].length||(n[e]=[]),n})),i((t=>{const a=(0,g.A)({},t);return a[e]=!1,a}))}catch(p){console.log("Error in delete workmen function:",p)}})(e,t,a,r,D,w,N);if(!n||s)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));v("".concat(t)),oe()}catch(p){console.error("Error deleting file:",p),alert("Error processing the file deletion.")}};(0,n.useEffect)((()=>{(async()=>{try{let s=[],i=null;do{var t,a,r,n;const l=await e.graphql({query:Ie.WQ,variables:{nextToken:i}}),o=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(a=t.listWorkMen)||void 0===a?void 0:a.items)||[];s=[...s,...o],i=null===l||void 0===l||null===(r=l.data)||void 0===r||null===(n=r.listWorkMen)||void 0===n?void 0:n.nextToken}while(i);const l=s.filter((e=>new Date(e.workmenCompExp)>=new Date));o(l),c(!1)}catch(p){m("insuranceData",{message:"Error fetching data"}),c(!1)}})()}),[]);(0,n.useEffect)((()=>{if(z){const e=z.empStatusType?z.empStatusType.toUpperCase():"";re("id",z.id),re("empStatusType",e);if(["workmenComUp","workmenCompExp","workmenCompNo"].forEach((e=>re(e,z[e]))),z&&z.workmenComUp)try{const e=JSON.parse(z.workmenComUp[0]).map((e=>"string"===typeof e?JSON.parse(e):e));re("workmenComUp",e),w((t=>(0,g.A)((0,g.A)({},t),{},{workmenComUp:e}))),D((t=>(0,g.A)((0,g.A)({},t),{},{workmenComUp:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(p){console.error("Failed to parse ".concat(z.workmenComUp,":"),p)}}}),[z,re]);const ce=()=>{C(null)},pe=(0,Ir.useReactToPrint)({content:()=>ie.current,pageStyle:"\n    @page {\n      size: auto;\n      margin: 0mm;\n    }\n    body { \n      margin: 0;\n      padding: 0;\n    }\n    .pdf-page {\n      page-break-after: always;\n    }\n  "}),me=e=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",se(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});F(t.url.href),C(e)}catch(p){console.error("Error fetching the file URL:",p)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),T===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"PDF Viewer"}),(0,i.jsx)("button",{onClick:ce,className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:ie,className:"flex-grow overflow-y-auto pdf-page",children:M?(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:M,renderError:e=>(0,i.jsxs)("div",{className:"p-4 text-red-500",children:["Failed to load PDF: ",e.message,(0,i.jsxs)("div",{className:"text-sm mt-2",children:["URL: ",M]})]})})}):(0,i.jsx)("div",{className:"p-4 text-center",children:"No PDF file available"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:M,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:pe,className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})}),T===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Image Viewer"}),(0,i.jsx)("button",{onClick:()=>C(null),className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:ie,className:"flex-grow overflow-y-auto p-4",children:(0,i.jsx)("img",{src:M,alt:"Document Preview",className:"w-full h-auto rounded"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:M,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:pe,className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})})]},t)))}),ue=(e,t)=>{const a=e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(p){return console.error("Error parsing document data:",p),[]}})(e[0]):[],r=Array.isArray(a)&&a.length>0;return(0,i.jsxs)("div",{className:"py-4 ",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),r?me(a):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents and images available"})]})};return(0,i.jsxs)("section",{onClick:()=>{W([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 px-10",children:[(0,i.jsx)(r.N_,{to:"/dashboard",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Workmen Compensation Insurance"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Al,{searchResult:e=>{Y(e),e&&X(!0)},newFormData:l,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Policy Number",rounded:"rounded-lg",empID:J,filteredEmployees:H,setFilteredEmployees:W})})," "]}),(0,i.jsxs)("form",{onSubmit:te((async t=>{try{const r=(new Date).toISOString().split("T")[0],n=G.find((e=>e.id===z.id));if(n){const s=n.updatedBy?JSON.parse(n.updatedBy):[],i=JSON.stringify([...s,{userID:$,date:r}]),l=(0,g.A)((0,g.A)({},t),{},{workmenComUp:JSON.stringify(A.workmenComUp),updatedBy:i});console.log("Up Value",l);const o={id:l.id,empStatusType:l.empStatusType,workmenComUp:l.workmenComUp,workmenCompExp:l.workmenCompExp,workmenCompNo:l.workmenCompNo,updatedBy:l.updatedBy};await e.graphql({query:ke.L4,variables:{input:o}});a(!0)}else{const n=(0,g.A)((0,g.A)({},t),{},{workmenComUp:JSON.stringify(A.workmenComUp),createdBy:JSON.stringify([{userID:$,date:r}])});await e.graphql({query:ke.CM,variables:{input:n}});a(!0)}}catch(p){console.error("Error submitting data:",p)}})),className:"mx-auto py-5 px-10 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"relative mb-5",children:(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4 items-center",children:[(0,i.jsx)(mt,{name:"empStatusType",label:"Employee Type",register:ee,type:"select",options:[{value:"OffShore",label:"OffShore"},{value:"OnShore",label:"OnShore"},{value:"General",label:"General"}],errors:ne}),(0,i.jsx)(mt,{name:"workmenCompNo",label:"Policy Number",type:"text",placeholder:"Enter Workmen Comp Policy No",register:ee,errors:ne,trackEmpID:Z}),(0,i.jsx)(mt,{name:"workmenCompExp",label:"Expiry Date",type:"date",register:ee,errors:ne}),(0,i.jsx)("div",{className:"mb-2 relative",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("label",{onClick:()=>{y.workmenComUp&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file",className:"hidden"},ee),{},{accept:".pdf, .jpg, .jpeg, .png",onChange:e=>le(e,"workmenComUp"),disabled:y.workmenComUp})),(0,i.jsxs)("span",{className:"ml-2 w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),b.workmenComUp&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(b.workmenComUp)?b.workmenComUp.slice().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===V||void 0===V||null===(a=V.deleteAccess)||void 0===a||null===(r=a[Q])||void 0===r?void 0:r.some((e=>K.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>de("workmenComUp",e,t),children:(0,i.jsx)(_t.uDv,{})})]},t)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[b.workmenComUp,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>de("workmenComUp",b.workmenComUp,0),children:(0,i.jsx)(_t.uDv,{})})]})})]})})]})}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),t&&(0,i.jsx)(Pe,{text:"Workmen Compensation Saved Successfully",notification:t,path:"/insuranceHr/workmenComp"}),(0,i.jsxs)("div",{className:"mt-10",children:[(0,i.jsx)("p",{className:"text-xl font-bold mb-10 p-3 rounded-lg border-2 border-[#FEF116] bg-[#FFFEF4] w-[250px]",children:"View Insurance Info"}),l.length>0?(0,i.jsx)("div",{className:" h-[400px] overflow-y-auto scrollBar",children:(0,i.jsxs)("table",{className:"w-full text-center",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tl-lg",children:"Employee Type"}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"Policy Number"}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"Expiry Date"}),(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tr-lg",children:"Uploaded File"})]})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer",children:l.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"pl-4 py-4",children:e.empStatusType}),(0,i.jsx)("td",{className:"pl-4 py-4",children:e.workmenCompNo}),(0,i.jsx)("td",{className:"py-4 px-4",children:se((null===e||void 0===e?void 0:e.workmenCompExp)||"N/A")}),(0,i.jsx)("td",{className:"pl-4 py-4",children:ue(e.workmenComUp,"PDF File")})]},t)))})]})}):(0,i.jsx)("p",{className:"text-center mt-10",children:"No insurance information available."})]}),u&&(0,i.jsx)(Wt,{handleDeleteMsg:oe,title1:x})]})};Je.EA.workerSrc=new URL(a(1886),a.b).toString();const El=()=>{const e=(0,Ee.D)(),[t,a]=(0,n.useState)({travelUp:!1}),[l,o]=(0,n.useState)({travelUp:null}),[d,c]=(0,n.useState)({travelUp:[]}),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)([]),[b,D]=(0,n.useState)(!0),[A,w]=(0,n.useState)(null),[S,E]=(0,n.useState)(!1),[I,k]=(0,n.useState)(""),[T,C]=(0,n.useState)(null),[R,P]=(0,n.useState)(1),[O,_]=(0,n.useState)(""),[M,F]=(0,n.useState)([]),[L,U]=(0,n.useState)([]),{formattedPermissions:B}=qt(),{travelInsData:q}=(0,n.useContext)(s.Y),{empID:H,requiredPermissions:W,access:z}=(0,r.KC)(),Y=localStorage.getItem("userID"),[V,G]=(0,n.useState)(!1),{register:J,handleSubmit:K,watch:Q,setValue:$,formState:{errors:Z}}=(0,tt.mN)({resolver:(0,at.t)(Zr)}),X=e=>{const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},ee=(0,n.useRef)(),te=async(e,t)=>{const r=Q("travelNo");if(!r)return alert("Please enter the Policy Number before uploading files."),void(window.location.href="/insuranceHr/travelling");const n=e.target.files[0];if(!n)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const s=Q(t)||[];if(s.some((e=>e.name===n.name)))alert("This file has already been uploaded.");else{$(t,[...s,n]);try{((e,t)=>{a((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dt(n,t,c,r),o((e=>(0,g.A)((0,g.A)({},e),{},{[t]:n.name})))}catch(i){console.error(i)}}},ae=()=>{m(!p)},re=async(e,t,r)=>{try{const n=Q("travelNo");if(!n)return void alert("Please provide the Policy Number before deleting files.");const s=await(0,_a.k)(e,t,n),i=await((e,t,a,r,n,s,i)=>{try{if(!r)return;s((t=>{const r=(0,g.A)({},t);return Array.isArray(r[e])&&(r[e]=r[e].filter(((e,t)=>t!==a)),r[e]&&0!==r[e].length||(r[e]=[])),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])?n[e]=n[e].filter(((e,t)=>t!==a)):"string"===typeof n[e]&&n[e]===t&&(n[e]=[]),n[e]&&0!==n[e].length||(n[e]=[]),n})),i((t=>{const a=(0,g.A)({},t);return a[e]=!1,a}))}catch(A){console.log("Error in delete Travel Insurance function:",A)}})(e,t,r,n,o,c,a);if(!s||i)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));h("".concat(t)),ae()}catch(A){console.error("Error deleting file:",A),alert("Error processing the file deletion.")}};(0,n.useEffect)((()=>{(async()=>{try{let s=[],i=null;do{var t,a,r,n;const l=await e.graphql({query:Ie.wQ,variables:{nextToken:i}}),o=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(a=t.listTravelIns)||void 0===a?void 0:a.items)||[];s=[...s,...o],i=null===l||void 0===l||null===(r=l.data)||void 0===r||null===(n=r.listTravelIns)||void 0===n?void 0:n.nextToken}while(i);const l=s.filter((e=>new Date(e.travelExp)>=new Date));N(l),D(!1)}catch(A){console.error("Error fetching insurance data:",A),w("insuranceData",{message:"Error fetching data"}),D(!1)}})()}),[]);(0,n.useEffect)((()=>{$("id",L.id),$("travelExp",L.travelExp),$("travelNo",L.travelNo),$("travelUp",L.travelUp);if(["travelExp","travelNo","travelUp"].forEach((e=>$(e,L[e]))),L&&L.travelUp)try{const e=JSON.parse(L.travelUp[0]).map((e=>"string"===typeof e?JSON.parse(e):e));$("travelUp",e),c((t=>(0,g.A)((0,g.A)({},t),{},{travelUp:e}))),o((t=>(0,g.A)((0,g.A)({},t),{},{travelUp:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(A){console.error("Failed to parse ".concat(L.travelUp,":"),A)}}),[L,$]);const ne=()=>{C(null)},se=(0,Ir.useReactToPrint)({content:()=>ee.current,pageStyle:"\n    @page {\n      size: auto;\n      margin: 0mm;\n    }\n    body { \n      margin: 0;\n      padding: 0;\n    }\n    .pdf-page {\n      page-break-after: always;\n    }\n  "}),ie=e=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",X(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});_(t.url.href),C(e)}catch(A){console.error("Error fetching the file URL:",A)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),T===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"PDF Viewer"}),(0,i.jsx)("button",{onClick:ne,className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:ee,className:"flex-grow overflow-y-auto pdf-page",children:O?(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:O,renderError:e=>(0,i.jsxs)("div",{className:"p-4 text-red-500",children:["Failed to load PDF: ",e.message,(0,i.jsxs)("div",{className:"text-sm mt-2",children:["URL: ",O]})]})})}):(0,i.jsx)("div",{className:"p-4 text-center",children:"No PDF file available"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:O,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:se,className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})}),T===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Image Viewer"}),(0,i.jsx)("button",{onClick:()=>C(null),className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:ee,className:"flex-grow overflow-y-auto p-4",children:(0,i.jsx)("img",{src:O,alt:"Document Preview",className:"w-full h-auto rounded"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:O,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:se,className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})})]},t)))}),le=(e,t)=>{const a=e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(A){return console.error("Error parsing document data:",A),[]}})(e[0]):[],r=Array.isArray(a)&&a.length>0;return(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),r?ie(a):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents and images available"})]})};return(0,i.jsxs)("section",{onClick:()=>{F([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 px-10",children:[(0,i.jsx)(r.N_,{to:"/dashboard",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Travelling Insurance"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Al,{searchResult:e=>{U(e),e&&G(!0)},newFormData:y,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Policy Number",rounded:"rounded-lg",empID:H,filteredEmployees:M,setFilteredEmployees:F})})," "]}),(0,i.jsxs)("form",{onSubmit:K((async t=>{try{const a=(new Date).toISOString().split("T")[0],r=q.find((e=>e.id===L.id));if(r){const n=r.updatedBy?JSON.parse(r.updatedBy):[],s=JSON.stringify([...n,{userID:Y,date:a}]),i=(0,g.A)((0,g.A)({},t),{},{travelUp:JSON.stringify(d.travelUp),updatedBy:s}),l={id:i.id,travelUp:i.travelUp,travelExp:i.travelExp,travelNo:i.travelNo,updatedBy:i.updatedBy};await e.graphql({query:ke.M9,variables:{input:l}});v(!0)}else{const r=(0,g.A)((0,g.A)({},t),{},{travelUp:JSON.stringify(d.travelUp),createdBy:JSON.stringify([{userID:Y,date:a}])});await e.graphql({query:ke.LM,variables:{input:r}});v(!0)}}catch(A){console.error("Error submitting data:",A)}})),className:"mx-auto py-5 px-10 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"relative mb-10",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 items-center",children:[(0,i.jsx)(mt,{name:"travelNo",type:"text",placeholder:"Enter Travelling Policy Number",label:"Policy Number",register:J,errors:Z,trackEmpID:V,className:"mt-2 p-[12px] bg-lite_skyBlue border border-[#dedddd] outline-none rounded"}),(0,i.jsx)(mt,{name:"travelExp",type:"date",label:"Expiry Date",register:J,errors:Z,className:"mt-2 p-2.5 bg-lite_skyBlue border border-[#dedddd] outline-none rounded"}),(0,i.jsx)("div",{className:"mb-2 relative",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("label",{onClick:()=>{t.travelUp&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file",className:"hidden"},J),{},{accept:".pdf, .jpg, .jpeg, .png",onChange:e=>te(e,"travelUp"),disabled:t.travelUp})),(0,i.jsxs)("span",{className:"ml-2  w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),l.travelUp&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(l.travelUp)?l.travelUp.slice().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===B||void 0===B||null===(a=B.deleteAccess)||void 0===a||null===(r=a[z])||void 0===r?void 0:r.some((e=>W.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>re("travelUp",e,t),children:(0,i.jsx)(_t.uDv,{})})]},t)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[l.travelUp,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>re("travelUp",l.travelUp,0),children:(0,i.jsx)(_t.uDv,{})})]})})]})})]})}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),x&&(0,i.jsx)(Pe,{text:"Travelling Info Saved Successfully",notification:x,path:"/insuranceHr/travelling"}),(0,i.jsxs)("div",{className:"mt-20",children:[(0,i.jsx)("p",{className:"text-xl font-bold mb-10 p-3 rounded-lg border-2 border-[#FEF116] bg-[#FFFEF4] w-[250px]",children:"View Insurance Info"}),b?(0,i.jsx)("p",{children:"Loading..."}):y.length>0?(0,i.jsx)("div",{className:" h-[400px] overflow-y-auto scrollBar",children:(0,i.jsxs)("table",{className:"w-full text-center",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tl-lg",children:"Policy Number"}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"Expiry Date"}),(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tr-lg",children:"Uploaded File"})]})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer",children:y.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"pl-4 py-4",children:e.travelNo}),(0,i.jsx)("td",{className:"py-4 px-4",children:X((null===e||void 0===e?void 0:e.travelExp)||"N/A")}),(0,i.jsx)("td",{className:"pl-4 py-4",children:le(e.travelUp,"PDF File")})]},t)))})]})}):(0,i.jsx)("p",{className:"text-center mt-10",children:"No insurance information available."})]}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:ae,title1:u})]})};a(1975),a(6601);Je.EA.workerSrc=new URL(a(1886),a.b).toString();const Il=()=>{const e=(0,Ee.D)(),[t,a]=(0,n.useState)({perAccUp:!1}),[l,o]=(0,n.useState)({perAccUp:null}),[d,c]=(0,n.useState)({perAccUp:[]}),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,v]=(0,n.useState)(!1),[y,N]=(0,n.useState)("auto"),[b,D]=(0,n.useState)([]),[A,w]=(0,n.useState)(!0),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)(!1),[T,C]=(0,n.useState)(""),[R,P]=(0,n.useState)(null),[O,_]=(0,n.useState)(1),[M,F]=(0,n.useState)(null),[L,U]=(0,n.useState)(""),[B,q]=(0,n.useState)(!0),[H,W]=(0,n.useState)(""),[z,Y]=(0,n.useState)(""),[V,G]=(0,n.useState)([]),[J,K]=(0,n.useState)([]),{formattedPermissions:Q}=qt(),{personalAcciData:$}=(0,n.useContext)(s.Y),{empID:Z,requiredPermissions:X,access:ee}=(0,r.KC)(),te=localStorage.getItem("userID"),[ae,re]=(0,n.useState)(!1),{register:ne,handleSubmit:se,control:ie,watch:le,setValue:oe,formState:{errors:de}}=(0,tt.mN)({resolver:(0,at.t)(Xr)}),ce=e=>{const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},pe=(0,n.useRef)(),me=async(e,t)=>{const r=le("perAccNo");if(!r)return alert("Please enter the Policy Number before uploading files."),void(window.location.href="/insuranceHr/personalAcci");const n=e.target.files[0];if(!n)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(n.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");const s=le(t)||[];if(s.some((e=>e.name===n.name)))alert("This file has already been uploaded.");else{oe(t,[...s,n]);try{((e,t)=>{a((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),await dt(n,t,c,r),o((e=>(0,g.A)((0,g.A)({},e),{},{[t]:n.name})))}catch(i){console.error(i)}}},ue=()=>{m(!p)},he=async(e,t,r)=>{try{const n=le("perAccNo");if(!n)return void alert("Please provide the Policy Number before deleting files.");const s=await(0,_a.k)(e,t,n),i=await((e,t,a,r,n,s,i)=>{try{if(!r)return;s((t=>{const r=(0,g.A)({},t);return Array.isArray(r[e])&&(r[e]=r[e].filter(((e,t)=>t!==a)),r[e]&&0!==r[e].length||(r[e]=[])),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])?n[e]=n[e].filter(((e,t)=>t!==a)):"string"===typeof n[e]&&n[e]===t&&(n[e]=[]),n[e]&&0!==n[e].length||(n[e]=[]),n})),i((t=>{const a=(0,g.A)({},t);return a[e]=!1,a}))}catch(S){console.log("Error in delete Personal Accident Insurance function:",S)}})(e,t,r,n,o,c,a);if(!s||i)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));h("".concat(t)),ue()}catch(S){console.error("Error deleting file:",S),alert("Error processing the file deletion.")}};(0,n.useEffect)((()=>{(async()=>{try{let s=[],i=null;do{var t,a,r,n;const l=await e.graphql({query:Ie.vL,variables:{nextToken:i}}),o=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(a=t.listPersonalAccidents)||void 0===a?void 0:a.items)||[];s=[...s,...o],i=null===l||void 0===l||null===(r=l.data)||void 0===r||null===(n=r.listPersonalAccidents)||void 0===n?void 0:n.nextToken}while(i);const l=s.filter((e=>new Date(e.perAccExp)>=new Date));D(l),w(!1)}catch(S){console.error("Error fetching insurance data:",S),E("insuranceData",{message:"Error fetching data"}),w(!1)}})()}),[]);(0,n.useEffect)((()=>{oe("id",J.id),oe("perAccUp",J.perAccUp),oe("perAccExp",J.perAccExp),oe("perAccNo",J.perAccNo);if(["perAccExp","perAccUp","perAccNo"].forEach((e=>oe(e,J[e]))),J&&J.perAccUp)try{const e=JSON.parse(J.perAccUp[0]).map((e=>"string"===typeof e?JSON.parse(e):e));oe("perAccUp",e),c((t=>(0,g.A)((0,g.A)({},t),{},{perAccUp:e}))),o((t=>(0,g.A)((0,g.A)({},t),{},{perAccUp:e.map((e=>(e=>{if("object"===typeof e&&e.upload){const t=e.upload,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}try{const t=new URL(e).pathname,a=decodeURIComponent(t);return a.substring(a.lastIndexOf("/")+1)}catch(t){if("string"===typeof e){const t=decodeURIComponent(e);return t.substring(t.lastIndexOf("/")+1)}return}})(e.upload)))})))}catch(S){console.error("Failed to parse ".concat(J.perAccUp,":"),S)}}),[J,oe]);const xe=()=>{P(null)},ge=(0,Ir.useReactToPrint)({content:()=>pe.current,pageStyle:"\n    @page {\n      size: auto;\n      margin: 0mm;\n    }\n    body { \n      margin: 0;\n      padding: 0;\n    }\n    .pdf-page {\n      page-break-after: always;\n    }\n  "}),fe=e=>(0,i.jsx)(i.Fragment,{children:e.map(((e,t)=>(0,i.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-4 border border-gray-200",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("span",{className:"uppercase font-semibold text-sm",children:["Uploaded on: ",ce(e.date)]}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,f.I)({path:e});U(t.url.href),P(e)}catch(S){console.error("Error fetching the file URL:",S)}})(e.upload),className:"text-dark_grey font-semibold text-sm",children:"View Document"})]}),R===e.upload&&e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"PDF Viewer"}),(0,i.jsx)("button",{onClick:xe,className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:pe,className:"flex-grow overflow-y-auto pdf-page",children:L?(0,i.jsx)(Ke.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,i.jsx)(Ke.Viewer,{fileUrl:L,renderError:e=>(0,i.jsxs)("div",{className:"p-4 text-red-500",children:["Failed to load PDF: ",e.message,(0,i.jsxs)("div",{className:"text-sm mt-2",children:["URL: ",L]})]})})}):(0,i.jsx)("div",{className:"p-4 text-center",children:"No PDF file available"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:L,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:ge,className:"px-4 py-2 bg-primary  rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})}),R===e.upload&&!e.upload.endsWith(".pdf")&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Image Viewer"}),(0,i.jsx)("button",{onClick:()=>P(null),className:"text-gray-500 hover:text-gray-700",children:(0,i.jsx)(Tt.QCr,{size:20})})]}),(0,i.jsx)("div",{ref:pe,className:"flex-grow overflow-y-auto p-4",children:(0,i.jsx)("img",{src:L,alt:"Document Preview",className:"w-full h-auto rounded"})}),(0,i.jsx)("div",{className:"flex items-center justify-center p-4 border-t",children:(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("button",{className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.WCW,{}),(0,i.jsx)("a",{href:L,download:!0,children:"Download"})]}),(0,i.jsxs)("button",{onClick:ge,className:"px-4 py-2 bg-primary rounded flex items-center gap-2",children:[(0,i.jsx)(Tt.n4o,{}),"Print"]})]})})]})})]},t)))}),ve=(e,t)=>{const a=e.length>0?(e=>{try{const t=JSON.parse(e);return Array.isArray(t)?t.map((e=>(e.upload&&(e.fileName=e.upload.split("/").pop()),e))):[]}catch(S){return console.error("Error parsing document data:",S),[]}})(e[0]):[],r=Array.isArray(a)&&a.length>0;return(0,i.jsxs)("div",{className:"py-4",children:[(0,i.jsx)("h6",{className:"uppercase text_size_5 my-3",children:t}),r?fe(a):(0,i.jsx)("p",{className:"text-dark_grey font-semibold text-sm",children:"No documents and images available"})]})};return(0,i.jsxs)("section",{onClick:()=>{G([])},children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 px-10",children:[(0,i.jsx)(r.N_,{to:"/dashboard",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Personal Accident Insurance"}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(Al,{searchResult:e=>{K(e),e&&re(!0)},newFormData:b,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Policy Number",rounded:"rounded-lg",empID:Z,filteredEmployees:V,setFilteredEmployees:G})})," "]}),(0,i.jsxs)("form",{onSubmit:se((async t=>{try{const a=(new Date).toISOString().split("T")[0],r=$.find((e=>e.id===J.id));if(r){const n=r.updatedBy?JSON.parse(r.updatedBy):[],s=JSON.stringify([...n,{userID:te,date:a}]),i=(0,g.A)((0,g.A)({},t),{},{perAccUp:JSON.stringify(d.perAccUp),updatedBy:s}),l={id:i.id,perAccUp:i.perAccUp,perAccExp:i.perAccExp,perAccNo:i.perAccNo,updatedBy:i.updatedBy};await e.graphql({query:ke.lw,variables:{input:l}});v(!0)}else{const r=(0,g.A)((0,g.A)({},t),{},{perAccUp:JSON.stringify(d.perAccUp),createdBy:JSON.stringify([{userID:te,date:a}])});await e.graphql({query:ke.qs,variables:{input:r}});v(!0)}}catch(S){console.error("Error submitting data:",S)}})),className:"mx-auto py-5 px-10 my-10 bg-[#F5F6F1CC]",children:[(0,i.jsx)("div",{className:"relative mb-5",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 items-center",children:[(0,i.jsx)(mt,{name:"perAccNo",type:"text",placeholder:"Enter Personal Accident Policy Number",label:"Policy Number",register:ne,errors:de,trackEmpID:ae}),(0,i.jsx)(mt,{name:"perAccExp",type:"date",label:"Expiry Date",register:ne,errors:de}),(0,i.jsx)("div",{className:"mb-2 relative",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("label",{onClick:()=>{t.perAccUp&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"mt-2 flex items-center px-3 py-3 text_size_7 bg-lite_skyBlue border border-[#dedddd] rounded cursor-pointer",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file",className:"hidden"},ne),{},{accept:".pdf, .jpg, .jpeg, .png",onChange:e=>me(e,"perAccUp"),disabled:t.perAccUp})),(0,i.jsxs)("span",{className:"ml-2  w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),l.perAccUp&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(l.perAccUp)?l.perAccUp.slice().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===Q||void 0===Q||null===(a=Q.deleteAccess)||void 0===a||null===(r=a[ee])||void 0===r?void 0:r.some((e=>X.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>he("perAccUp",e,t),children:(0,i.jsx)(_t.uDv,{})})]},t)})):(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[l.perAccUp,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>he("perAccUp",l.perAccUp,0),children:(0,i.jsx)(_t.uDv,{})})]})})]})})]})}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),x&&(0,i.jsx)(Pe,{text:"Personal Accident Saved Successfully",notification:x,path:"/insuranceHr/personalAcci"}),(0,i.jsxs)("div",{className:"mt-20",children:[(0,i.jsx)("p",{className:"text-xl font-bold mb-10 p-3 rounded-lg border-2 border-[#FEF116] bg-[#FFFEF4] w-[250px]",children:"View Insurance Info"}),b.length>0?(0,i.jsx)("div",{className:" h-[400px] overflow-y-auto scrollBar",children:(0,i.jsxs)("table",{className:"w-full text-center",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tl-lg",children:"Policy Number"}),(0,i.jsx)("th",{className:"pl-4 py-4",children:"Expiry Date"}),(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tr-lg",children:"Uploaded File"})]})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer",children:b.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"pl-4 py-4",children:e.perAccNo}),(0,i.jsx)("td",{className:"py-4 px-4",children:ce((null===e||void 0===e?void 0:e.perAccExp)||"N/A")}),(0,i.jsx)("td",{className:"pl-4 py-4",children:ve(e.perAccUp,"PDF File")})]},t)))})]})}):(0,i.jsx)("p",{className:"text-center mt-10",children:"No insurance information available."})]}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:ue,title1:u})]})},kl=()=>{var e;const{SubmitJobData:t}=(()=>{const e=(0,Ee.D)();return{SubmitJobData:(0,n.useCallback)((async t=>{let{jobValue:a}=t;if(!a||!a.jobTitle)throw new Error("Job title is required.");try{const t=e=>{if(!e)return null;const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},r=t(a.startDate),n=t(a.expiryDate),s={jobTitle:a.jobTitle,exper:a.experience,location:a.location,quantityPerson:a.quantity,startDate:r,expiryDate:n,jobContent:a.jobDesc,uploadJobDetails:a.uploadJobDetails},i=await e.graphql({query:ke.RH,variables:{input:s}});console.log(i)}catch(r){throw console.error("Error updating data:",r),r}}),[e])}})(),{formattedPermissions:a}=qt(),{hiringJob:s}=Sn(),[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)("");(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{register:x,handleSubmit:f,watch:v,setValue:y,formState:{errors:N}}=(0,tt.mN)({resolver:(0,at.t)(rt._K)}),[b,D]=(0,n.useState)({uploadJobDetails:!1}),[j,A]=(0,n.useState)(null),[w,S]=(0,n.useState)({}),E=null===(e=v("jobTitle"))||void 0===e?void 0:e.replace(/\s+/g,""),I=()=>{o(!l)},k=f((e=>{try{const a=(0,g.A)((0,g.A)({},e),{},{uploadJobDetails:j});t({jobValue:a}),h("Posted Job successfully"),m(!0)}catch(a){console.log(a)}}));return(0,i.jsxs)("section",{className:"bg-[#F5F6F1CC] mx-auto p-10",children:[(0,i.jsxs)("div",{className:"w-full flex items-center gap-5 mb-10",children:[(0,i.jsx)(r.N_,{to:"/hiringJob",className:"text-xl text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("h6",{className:"text-center flex-1 mt-2 text_size_2 uppercase",children:"Job Details"})]}),(0,i.jsxs)("div",{className:"form-group flex flex-col gap-6",children:[(0,i.jsx)("div",{className:"grid grid-cols-2 gap-5 ",children:s.map(((e,t)=>(0,i.jsx)("div",{children:(0,i.jsx)(mt,{label:e.label,name:e.name,type:e.type,register:x,errors:N})},t)))}),(0,i.jsxs)("div",{className:"md:col-span-2 form-group",children:[(0,i.jsx)("label",{className:"mb-1 text_size_5",children:"Job description"}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},x("jobDesc")),{},{className:"resize-none w-full p-2 mt-1 border bg-lite_skyBlue border-lite_grey rounded-md outline-none",rows:"1"})),N.jobDesc&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:N.jobDesc.message})]}),(0,i.jsx)("div",{children:(0,i.jsx)(Mt,{label:"Upload Job Document",register:x,fileKey:"uploadJobDetails",handleFileUpload:async(e,t)=>{if(!E)return alert("Please enter the Job Title before uploading files."),void(window.location.href="/postJob");const a=e.target.files[0];if(a&&["application/pdf","image/jpeg","image/png","image/jpg"].includes(a.type)){if(y(t,a),a)try{((e,t)=>{D((a=>(0,g.A)((0,g.A)({},a),{},{[e]:t})))})(t,!0),S((e=>(0,g.A)((0,g.A)({},e),{},{[t]:a.name})));const e=encodeURIComponent(a.name),r="https://commonfiles.s3.ap-southeast-1.amazonaws.com/recruiment/applyJob/".concat(E,"/").concat(e);A(r);const n="https://gnth2qx5cf.execute-api.ap-southeast-1.amazonaws.com/fileupload/commonfiles/recruiment%2FapplyJob%2F".concat(E,"%2F").concat(e);await it.A.put(n,a)}catch(r){console.log(r)}}else alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},uploadedFileNames:w,deletedStringUpload:async(e,t)=>{try{const a=await(0,_a.k)(e,t,E),r=await((e,t,a,r,n,s,i)=>{try{r((a=>{const r=(0,g.A)({},a);return"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((t=>{const a=(0,g.A)({},t);return"string"===typeof a[e]&&(a[e]=""),a})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1}))),i((t=>(0,g.A)((0,g.A)({},t),{},{interview:(0,g.A)((0,g.A)({},t.interview),{},{[e]:""})})))}catch(l){console.log(l,"DeleteUploadJob in error")}})(e,t,0,S,A,D);if(!a||r)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));c("".concat(t)),I(),S((t=>{const a=(0,g.A)({},t);return delete a[e],a})),A(null)}catch(a){alert("Error processing the file deletion.")}},isUploadingString:b,error:null===N||void 0===N?void 0:N.uploadJobDetails,formattedPermissions:a,requiredPermissions:["Hiring Job"],access:"Recruitment"})}),(0,i.jsx)("div",{className:"w-full center",children:(0,i.jsx)("button",{className:"primary_btn",onClick:k,children:"Post"})})]}),p&&(0,i.jsx)(Pe,{text:u,notification:p,path:"/hiringJob"}),l&&(0,i.jsx)(Wt,{handleDeleteMsg:I,title1:d})]})},Tl=()=>{(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{hiringData:e}=(0,n.useContext)(s.Y),{formattedPermissions:t}=qt(),[a,l]=(0,n.useState)(10),[o,d]=(0,n.useState)(1),c=e.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))),p=["S.No","Job Title","Experience","Job Description","Location","Quantity","Start Date","Expiry Date","Download","Status"],m=e=>"Expired"===e?"text-[green]":"text-[#E8A317]",u=Math.ceil(c.length/a),h=(o-1)*a,x=o*a,g=c.slice(h,x);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("section",{className:"bg-[#F5F6F1CC] mx-auto p-10 min-h-screen",children:[(0,i.jsx)("div",{className:"flex items-center mb-7",children:(0,i.jsx)(r.N_,{to:"/recruitment",className:"text-xl text-grey",children:(0,i.jsx)(Tt.QVr,{})})}),(0,i.jsxs)("div",{className:"mb-5 flex justify-between",children:[(0,i.jsx)("span",{className:"bg-[#faf362] py-2 px-3 rounded-lg text-[18px] font-semibold",children:"Hiring Job"}),(0,i.jsxs)(r.N_,{to:"/postJob",className:"bg-primary py-2 px-5 text-zinc font-semibold text-lg flex items-center gap-5",children:[(0,i.jsx)("span",{className:"text-xl",children:"+"})," Create Job"]})]}),(0,i.jsx)("div",{className:"recruitmentTable w-full max-h-[calc(70vh-7rem)] overflow-y-auto rounded-xl",children:(0,i.jsxs)("table",{className:"w-full text-center",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-white sticky top-0",children:(0,i.jsx)("tr",{children:p.map(((e,t)=>(0,i.jsx)("th",{className:"px-4 py-4",children:e},t)))})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer",children:g&&g.length>0?g.map(((e,t)=>{const a=(e=>{if(!e)return"Live";const t=e.replace(/[-/]/g,"-"),[a,r,n]=t.split("-"),s=new Date(n,r-1,a),i=new Date;return s<new Date(i.getFullYear(),i.getMonth(),i.getDate())?"Expired":"Live"})(null===e||void 0===e?void 0:e.expiryDate);return(0,i.jsxs)("tr",{className:"text-center border-b-2 bg-white border-[#C7BCBC] text-[15px] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"pl-4 py-4",children:h+t+1}),(0,i.jsx)("td",{className:"pl-4 py-4",children:(null===e||void 0===e?void 0:e.jobTitle)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4",children:(null===e||void 0===e?void 0:e.exper)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4 break-words overflow-x-auto",children:(null===e||void 0===e?void 0:e.jobContent)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4",children:(null===e||void 0===e?void 0:e.location)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4",children:(null===e||void 0===e?void 0:e.quantityPerson)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4",children:(null===e||void 0===e?void 0:e.startDate)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4",children:(null===e||void 0===e?void 0:e.expiryDate)||"N/A"}),(0,i.jsx)("td",{className:"pl-4 py-4 ".concat(null!==e&&void 0!==e&&e.uploadJobDetails?"text-[#3c3cc2]":"text-dark_grey"," "),children:(0,i.jsx)("a",{href:null===e||void 0===e?void 0:e.uploadJobDetails,children:null!==e&&void 0!==e&&e.uploadJobDetails?"Download":"N/A"})}),(0,i.jsx)("td",{className:"pl-4 py-4 ".concat(m(a)),children:a})]},t)})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:p.length,className:"px-2 py-4 text-center",children:"No job postings available."})})})]})}),g.length>0&&(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:(0,i.jsx)(oa,{currentPage:o,totalPages:u,onPageChange:e=>{e>0&&e<=u&&d(e)}})})})]})})},Cl=()=>{const e=(0,Ee.D)(),[t,a]=(0,n.useState)(!1),[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(!0),[c,p]=(0,n.useState)(null),m=localStorage.getItem("userID"),{register:u,handleSubmit:h,control:x,formState:{errors:g}}=(0,tt.mN)({resolver:(0,at.t)(Kr),defaultValues:{insDetails:[{company:""}]}}),{fields:f,append:v,remove:y}=(0,tt.jz)({control:x,name:"insDetails"});return(0,n.useEffect)((()=>{(async()=>{try{let s=[],i=null;do{var t,a,r,n;const l=await e.graphql({query:Ie.Yv,variables:{nextToken:i}}),o=(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(a=t.listInsuranceTypes)||void 0===a?void 0:a.items)||[];s=[...s,...o],i=null===l||void 0===l||null===(r=l.data)||void 0===r||null===(n=r.listInsuranceTypes)||void 0===n?void 0:n.nextToken}while(i);const o=(e=>{const t={};return e.forEach((e=>{t[e.typeIns]?t[e.typeIns]=[...new Set([...t[e.typeIns],...e.insDetails])]:t[e.typeIns]=e.insDetails})),Object.entries(t).map((e=>{let[t,a]=e;return{typeIns:t,insDetails:a}}))})(s);l(o),d(!1)}catch(c){console.error("Error fetching insurance data:",c),p("Error fetching data"),d(!1)}})()}),[]),(0,i.jsxs)("section",{children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 px-10",children:[(0,i.jsx)(r.N_,{to:"/dashboard",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("p",{className:"flex-1 text-center mt-2 text_size_2 uppercase",children:"Insurance Type"}),(0,i.jsx)("div",{className:"flex-1"})]}),(0,i.jsxs)("form",{onSubmit:h((async t=>{try{const r=(new Date).toISOString().split("T")[0],n={typeIns:t.typeIns,insDetails:t.insDetails.map((e=>e.company)),createdBy:JSON.stringify([{userID:m,date:r}])};await e.graphql({query:ke.Vz,variables:{input:n}});a(!0)}catch(c){console.error("Error submitting data:",c)}})),className:"mx-auto  pt-2 px-10 mt-10 bg-[#F5F6F1CC]",children:[(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("div",{className:"grid grid-cols-2 gap-x-14",children:(0,i.jsx)(mt,{name:"typeIns",type:"text",placeholder:"Enter Insurance Type",label:"Insurance Type",register:u,errors:g})}),(0,i.jsx)("div",{className:"flex justify-end items-end",children:(0,i.jsxs)("button",{type:"button",onClick:()=>{v({company:""})},className:"mt-4 flex items-center text-medium_grey text-[25px]",children:[(0,i.jsx)(Ct.Oh0,{})," ",(0,i.jsx)("span",{className:"text-[16px]",children:" Add Company"})]})}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-x-14",children:f.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-2 relative",children:[(0,i.jsx)(mt,{name:"insDetails.".concat(t,".company"),type:"text",placeholder:"Enter Insurance Company",label:"Insurance Company",register:u,errors:g}),f.length>1&&0!==t&&(0,i.jsx)("button",{type:"button",onClick:()=>y(t),className:"absolute top-10 -right-10 text-medium_grey text-[25px]",children:(0,i.jsx)(Tt.vli,{})})]},e.id)))})]}),(0,i.jsx)("div",{className:"flex justify-center items-center mt-10",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Save"})})]}),t&&(0,i.jsx)(Pe,{text:"Insurance Type Saved Successfully",notification:t,path:"/insuranceHr"}),o&&(0,i.jsx)("p",{className:"text-center mt-10",children:"Loading insurance data..."}),c&&(0,i.jsx)("p",{className:"text-center mt-10 text-red-600",children:c}),(0,i.jsxs)("div",{className:"mt-20",children:[(0,i.jsx)("p",{className:"text-xl font-bold mb-10 p-3 rounded-lg border-2 border-[#FEF116] bg-[#FFFEF4] w-[270px] text-center",children:"View Insurance Info"}),s.length>0?(0,i.jsx)("div",{className:" h-[400px] overflow-y-auto scrollBar",children:(0,i.jsxs)("table",{className:"w-full text-center",children:[(0,i.jsx)("thead",{className:" bg-[#939393] text-white sticky top-0",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tl-lg",children:"Insurance Type"}),(0,i.jsx)("th",{className:"pl-4 py-4 rounded-tr-lg",children:"Insurance Companies"})]})}),(0,i.jsx)("tbody",{className:"bg-white cursor-pointer",children:s.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow-[0_3px_6px_1px_rgba(0,0,0,0.2)] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"pl-4 py-4",children:e.typeIns}),(0,i.jsx)("td",{className:"pl-4 py-4",children:e.insDetails.map(((e,t)=>(0,i.jsx)("div",{children:e},t)))})]},t)))})]})}):(0,i.jsx)("p",{className:"text-center mt-10",children:"No insurance information available."})]})]})},Rl=e=>{let{details:t,popupAll:a,onClose:r}=e;const[s,l]=(0,n.useState)({}),[o,d]=(0,n.useState)([]),c=[{header:"Material Requisition ",key:"MRNo"},{header:"Medical Name",key:"medicalName"},{header:"Medical Expiry",key:"medicalExpiry"},{header:"Medical Appointment Date",key:"medicalAppointDate"},{header:"Course",key:"courseCode"},{header:"Course Name",key:"courseName"},{header:"Company",key:"company"},{header:"Start Date",key:"traineeSD"},{header:"End Date",key:"traineeED"},{header:"Status",key:"traineeStatus"},{header:"Training Course Fee",key:"traineeCourseFee"},{header:"Upload Report",key:"medicalReport"}];return(0,n.useEffect)((()=>{let e=[];try{let a=(null===t||void 0===t?void 0:t.traineeTrack)||"[]",r=JSON.parse(a);if("string"===typeof r){let t=r.replace(/([{,])(\s*)(\w+)\s*:/g,'$1"$3":').replace(/:\s*'([^']+)'/g,': "$1"');e=JSON.parse(t)}else e=r;d(Array.isArray(e)?e:[e]);(async()=>{const t={};for(let r=0;r<e.length;r++){const n=e[r];try{const e=null===n||void 0===n?void 0:n.medicalReport;if(!e||"[]"===e||"null"===e||""===e)continue;let a=[];if(Array.isArray(e))a=e;else{if("string"!==typeof e)continue;a=JSON.parse(e)}if(Array.isArray(a)&&a.length>0){const e=a[0].upload,{url:n}=await(0,f.I)({path:e});t[r]=n}}catch(a){console.error("Error processing report at index",r,a)}}l(t)})()}catch(a){console.error("Error parsing traineeTrack:",a)}}),[t,a]),(0,i.jsx)("div",{className:"fixed top-0 w-full left-0 bg-black bg-opacity-50 z-[9999] py-7 min-h-screen flex items-center justify-center ",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-[45%] h-[550px] overflow-y-auto scrollBar ",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center pb-3 ",children:[(0,i.jsx)("div",{className:"w-full center",children:(0,i.jsx)("img",{src:Se.A,alt:"Logo",className:"max-w-[200px] "})}),(0,i.jsx)("button",{onClick:r,className:"rounded-md",children:(0,i.jsx)(es.oxH,{className:"text-[32px] font-xs"})})]}),(0,i.jsx)("h2",{className:"text-xl mt-2 font-bold underline text-center mb-7",children:"Training Details"}),(0,i.jsxs)("div",{className:" shadow-md rounded-md px-10 py-5",children:[(0,i.jsx)("article",{className:"flex flex-col mb-4",children:null===a||void 0===a?void 0:a.flatMap(((e,a)=>(0,i.jsx)("article",{className:"mb-2 flex flex-col",children:(0,i.jsxs)("article",{className:"flex justify-between text-[14px]",children:[(0,i.jsx)("p",{className:"flex-1 text-start font-medium",children:null===e||void 0===e?void 0:e.header}),(0,i.jsx)("p",{className:"flex-1 text-start",children:t[null===e||void 0===e?void 0:e.key]})]})},a)))}),(null===o||void 0===o?void 0:o.length)>0&&(null===o||void 0===o?void 0:o.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-4 pb-4",children:[(0,i.jsx)("h3",{className:"font-bold underline mb-2",children:"Training ".concat(t+1)}),c.map(((a,r)=>{const n=e[a.key];let l=n;return"traineeED"!==a.key&&"traineeSD"!==a.key&&"medicalAppointDate"!==a.key&&"medicalExpiry"!==a.key||(l=y(n)),(0,i.jsxs)("article",{className:"flex justify-between text-[14px] mb-1 leading-7",children:[(0,i.jsx)("p",{className:"flex-1 text-start font-medium",children:a.header}),(0,i.jsx)("p",{className:"flex-1 text-start",children:"medicalReport"===a.key?s[t]?(0,i.jsx)("a",{href:s[t],className:"text-blue underline",target:"_blank",rel:"noreferrer",children:"Download"}):"N/A":l||"N/A"})]},r)}))]},t))))]})]})})},Pl=e=>{let{mergering:t,columns:a,popupAll:r}=e;const[s,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)(null),[c,p]=(0,n.useState)(1),[m,u]=(0,n.useState)(30),[h,x]=(0,n.useState)([]),[g,f]=(0,n.useState)(t);(0,n.useEffect)((()=>{f(t)}),[t]);const v=(0,n.useCallback)((e=>{f(e),p(1)}),[]);(0,n.useEffect)((()=>{const e=(c-1)*m,t=g.slice(e,e+m);x(t)}),[g,c,m]);return(0,i.jsxs)("section",{children:[(0,i.jsx)("div",{className:"relative flex justify-end items-end mt-14",children:(0,i.jsx)(ga,{placeholder:"Search by empID, name, badge no, etc.",allEmpDetails:t,searchUserList:v,searchIcon2:(0,i.jsx)(j.zfp,{})})}),(0,i.jsxs)("div",{className:"overflow-x-auto mt-16 w-full rounded-md",children:[(0,i.jsx)("div",{className:"w-full px-4 max-h-[calc(90vh-7rem)] overflow-y-auto ",children:(0,i.jsxs)("table",{className:"w-full rounded-xl table-auto",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-center sticky top-0",children:(0,i.jsxs)("tr",{children:[a.map(((e,t)=>(0,i.jsx)("th",{className:"py-4 px-2 text-white",children:e.header},t))),(0,i.jsx)("th",{className:"py-4 px-4 text-white",children:"View"})]})}),(0,i.jsx)("tbody",{className:"bg-white text-center text-sm font-semibold text-dark_grey ",children:h.length>0?h.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow cursor-pointer",children:[a.map(((t,a)=>(0,i.jsx)("td",{className:"py-4 px-4 break-words overflow-hidden flex-1",children:e[null===t||void 0===t?void 0:t.key]||"N/A"},a))),(0,i.jsx)("td",{className:"py-4 px-4 text-dark_skyBlue underline cursor-pointer",onClick:()=>(d(e),void l(!0)),children:"View"})]},t))):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:a.length+1,className:"py-4 text-center",children:"No results found."})})})]})}),s&&o&&(0,i.jsx)(Rl,{details:o,popupAll:r,onClose:()=>{l(!1),d(null)}})]}),(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("div",{className:"flex justify-between mt-12 px-10",children:(0,i.jsx)(oa,{currentPage:c,totalPages:Math.ceil(g.length/m),onPageChange:e=>{e>=1&&e<=Math.ceil(g.length/m)&&p(e)}})})})]})},Ol=()=>{const{empPIData:e,workInfoData:t,trainingCertifi:a,AddEmpReq:l}=(0,n.useContext)(s.Y),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[f,v]=(0,n.useState)(!0),[y,N]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(e&&t&&a&&l){const a=e.map((e=>{const a=l.find((t=>t.empID===e.empID)),r=t.find((t=>t.empID===e.empID));return a&&null!==a&&void 0!==a&&a.createdAt?(0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),a),r),{},{treqCreatedAt:null===a||void 0===a?void 0:a.createdAt}):null})).filter((e=>null!==e));d(a),p(a),v(!1)}else N("Data not fully available."),v(!1)}),[e,t,a,l]);const b={addTraining:[{header:"Employee ID",key:"empID"},{header:"Employee Badge No",key:"empBadgeNo"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Material Requisition",key:"MRNo"},{header:"Medical Name",key:"medicalName"},{header:"Medical Expiry",key:"medicalExpiry"},{header:"Medical Appointment Date",key:"medicalAppointDate"},{header:"Course",key:"courseCode"},{header:"Course Name",key:"courseName"},{header:"Company",key:"company"},{header:"Start Date",key:"traineeSD"},{header:"End Date",key:"traineeED"},{header:"Status",key:"traineeStatus"},{header:"Training Course Fee",key:"traineeCourseFee"}]},D=e=>{try{if(!e)return console.warn("safeParseData: Received undefined or null data."),[];let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(y){return console.error("Error normalizing traineeTrackData:",y),[]}},j=(e,t,a)=>e.filter((e=>{let r=null,n=null;try{if(e.traineeTrack&&e.traineeTrack.length>0){const t=e.traineeTrack[e.traineeTrack.length-1],a=D(t);if(Array.isArray(a)){const e=a[a.length-1];null!==e&&void 0!==e&&e.traineeSD&&(r=new Date(e.traineeSD)),null!==e&&void 0!==e&&e.traineeED&&(n=new Date(e.traineeED))}else a.traineeSD&&(r=new Date(a.traineeSD)),a.traineeED&&(n=new Date(a.traineeED))}}catch(s){console.error("Error parsing traineeTrack:",s)}return!(!r||!n)&&(t&&a?r>=new Date(t)&&n<=new Date(a):t?r>=new Date(t)&&n>=new Date(t):!a||r<=new Date(a)&&n<=new Date(a))})),A=(e,t)=>{const a=e.target.value;"startDate"===t&&u(a),"endDate"===t&&x(a);const r=j(o,"startDate"===t?a:m,"endDate"===t?a:h);p(r)},w=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)};if(f)return(0,i.jsx)("div",{children:"Loading..."});if(y)return(0,i.jsxs)("div",{children:["Error: ",y]});const S=c.sort(((e,t)=>new Date(t.treqCreatedAt)-new Date(e.treqCreatedAt))).map((e=>{let t={MRNo:"N/A",medicalName:"N/A",medicalExpiry:"N/A",medicalAppointDate:"N/A",courseCode:"N/A",courseName:"N/A",company:"N/A",traineeSD:"N/A",traineeED:"N/A",traineeStatus:"N/A",traineeCourseFee:"N/A"};try{let r=[],n=(null===e||void 0===e?void 0:e.traineeTrack)||"[]",s=JSON.parse(n);if("string"===typeof s){let e=s.replace(/([{,])(\s*)(\w+)\s*:/g,'$1"$3":').replace(/:\s*'([^']+)'/g,': "$1"');r=JSON.parse(e)}else r=s;if(r&&r){let e=r[r.length-1];if("string"===typeof e)try{e=JSON.parse(e)}catch(a){console.error("Error parsing track data:",a)}let n=e;Array.isArray(e)&&(n=e[e.length-1]),n&&(t={MRNo:n.MRNo||"N/A",medicalName:n.medicalName||"N/A",medicalExpiry:w(n.medicalExpiry),medicalAppointDate:w(n.medicalAppointDate),courseCode:n.courseCode||"N/A",courseName:n.courseName||"N/A",company:n.company||"N/A",traineeSD:w(n.traineeSD),traineeED:w(n.traineeED),traineeStatus:n.traineeStatus||"N/A",traineeCourseFee:n.traineeCourseFee||"N/A"})}}catch(a){console.error("Error parsing traineeTrack:",a)}return(0,g.A)((0,g.A)({},e),{},{empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-"},t)}));return(0,i.jsx)("section",{className:"bg-[#F8F8F8] w-full",children:(0,i.jsxs)("div",{className:" mx-auto p-5 h-full",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 my-5",children:[(0,i.jsx)(r.N_,{to:"/trainingReq",className:"text-xl text-grey",children:(0,i.jsx)(la.QVr,{})}),(0,i.jsx)("article",{className:"flex-1 center gap-5 text-dark_grey",children:(0,i.jsx)("h1",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"Add Employee View"})})]}),(0,i.jsx)("div",{className:"px-4 relative ",children:(0,i.jsxs)("div",{className:"absolute z-20 -top-1 flex items-center gap-5",children:[(0,i.jsxs)("div",{className:" flex items-center  gap-5 w-full ",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("input",{id:"start-date",type:"date",value:m,onChange:e=>A(e,"startDate"),className:"outline-none text-grey border rounded-md p-2"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("input",{id:"end-date",type:"date",value:h,onChange:e=>A(e,"endDate"),className:"outline-none text-grey border rounded-md p-2"})]})]}),(0,i.jsx)("div",{className:" mt-5 vertical-center p-5 ",children:(0,i.jsx)("button",{className:"bg-[#FEF116] text-dark_grey w-[126px] p-2 rounded",onClick:()=>{const e="Employee Report",t=[];j(o,m,h).forEach((e=>{const a={empID:e.empID||"N/A",empBadgeNo:e.empBadgeNo||"N/A",name:e.name||"N/A",department:Array.isArray(e.department)?e.department[e.department.length-1]:e.department||"N/A"};let r=[];try{e.traineeTrack&&e.traineeTrack.length>0&&e.traineeTrack.forEach((e=>{const t=D(e);Array.isArray(t)?r.push(...t):r.push(t)}))}catch(n){console.error("Error parsing traineeTrack:",n)}0===r.length?t.push((0,g.A)((0,g.A)({},a),{},{MRNo:"N/A",medicalName:"N/A",medicalExpiry:"N/A",medicalAppointDate:"N/A",courseCode:"N/A",courseName:"N/A",company:"N/A",traineeSD:"N/A",traineeED:"N/A",traineeStatus:"N/A",traineeCourseFee:"N/A"})):r.forEach((e=>{const r=e.traineeSD?new Date(e.traineeSD):null,n=e.traineeED?new Date(e.traineeED):null;(!m||r&&r>=new Date(m))&&(!h||n&&n<=new Date(h))&&t.push((0,g.A)((0,g.A)({},a),{},{MRNo:e.MRNo||"N/A",medicalName:e.medicalName||"N/A",medicalExpiry:w(e.medicalExpiry),medicalAppointDate:w(e.medicalAppointDate),courseCode:e.courseCode||"N/A",courseName:e.courseName||"N/A",company:e.company||"N/A",traineeSD:w(e.traineeSD),traineeED:w(e.traineeED),traineeStatus:e.traineeStatus||"N/A",traineeCourseFee:e.traineeCourseFee||"N/A"}))}))})),console.log("Final data for Excel:",t);const a=new(hi().Workbook),r=a.addWorksheet("".concat(e)),n=r.addRow(b.addTraining.map((e=>e.header)));r.columns=b.addTraining.map((e=>({header:e.header,width:e.header.length<20?20:e.header.length}))),n.eachCell((e=>{e.font={bold:!0,size:12,color:{argb:"f9f9f9"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"787878"}},e.alignment={horizontal:"left"}})),t.forEach((e=>{r.addRow(b.addTraining.map((t=>e[t.key]||"N/A")))})),a.xlsx.writeBuffer().then((t=>{const a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,xi.saveAs)(a,"".concat(e,".xlsx"))}))},children:"Download"})})]})}),(0,i.jsx)(Pl,{mergering:S,columns:b.addTraining,popupAll:[{header:"Employee ID",key:"empID"},{header:"Employee Badge No",key:"empBadgeNo"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Position",key:"position"}]})]})})},_l=e=>{let{details:t,popupAll:a,onClose:r}=e;const[s,l]=(0,n.useState)({}),[o,d]=(0,n.useState)([]),c=[{header:"Course Name",key:"courseName"},{header:"Course Code",key:"courseCode"},{header:"Company",key:"company"},{header:"Training Start Date",key:"traineeSD"},{header:"Training End Date",key:"traineeED"},{header:"Certificate Expiry",key:"certifiExpiry"},{header:"e-Certificate Date",key:"eCertifiDate"},{header:"Original Certificate Date",key:"orgiCertifiDate"},{header:"PO Number",key:"poNo"},{header:"Expiry Condition",key:"addDescretion"},{header:"Training Remarks",key:"tcRemarks"},{header:"Upload Certificate",key:"trainingUpCertifi"}],p=e=>{try{let t;if(t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t)),"string"===typeof t){const e=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),a=JSON.parse(e);return Array.isArray(a)?a:[a]}return Array.isArray(t)?t:[t]}catch(t){return console.error("Error normalizing traineeTrackData:",t),[]}};(0,n.useEffect)((()=>{const e=p(null===t||void 0===t?void 0:t.traineeTrack),a=p(null===t||void 0===t?void 0:t.trainingProof).map(((t,a)=>(0,g.A)((0,g.A)({},e[a]||{}),t)));d(a);(async()=>{const e={};for(let r=0;r<a.length;r++){const n=a[r];try{const t=JSON.parse((null===n||void 0===n?void 0:n.trainingUpCertifi)||"[]");if(t.length>0){const a=t[0].upload,{url:n}=await(0,f.I)({path:a});e[r]=n}}catch(t){console.error("Invalid certificate format:",t)}}l(e)})()}),[t,a]);return(0,i.jsx)("div",{className:"fixed top-0 w-full left-0 bg-black bg-opacity-50 z-[9999] py-7 min-h-screen flex items-center justify-center ",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-[45%] h-[550px] overflow-y-auto scrollBar ",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center pb-3 ",children:[(0,i.jsx)("div",{className:"w-full center",children:(0,i.jsx)("img",{src:Se.A,alt:"Logo",className:"max-w-[200px] "})}),(0,i.jsx)("button",{onClick:r,className:"rounded-md",children:(0,i.jsx)(es.oxH,{className:"text-[32px] font-xs"})})]}),(0,i.jsx)("h2",{className:"text-xl mt-2 font-bold underline text-center mb-7",children:"Training Details"}),(0,i.jsxs)("div",{className:"shadow-md rounded-md px-10 py-5",children:[(0,i.jsx)("article",{className:"flex flex-col mb-4",children:null===a||void 0===a?void 0:a.map(((e,a)=>{const r=((e,t)=>"department"!==e&&"position"!==e||!Array.isArray(t)?t:t[t.length-1])(e.key,t[e.key]);return(0,i.jsx)("article",{className:"mb-2 flex flex-col",children:(0,i.jsxs)("article",{className:"flex justify-between text-[14px]",children:[(0,i.jsx)("p",{className:"flex-1 text-start font-medium",children:null===e||void 0===e?void 0:e.header}),(0,i.jsx)("p",{className:"flex-1 text-start",children:r||"N/A"})]})},a)}))}),(null===o||void 0===o?void 0:o.length)>0&&(null===o||void 0===o?void 0:o.map(((e,t)=>(0,i.jsxs)("div",{className:"mb-4 pb-4",children:[(0,i.jsx)("h3",{className:"font-bold underline mb-2",children:"Training ".concat(t+1)}),c.map(((a,r)=>{const n=e[a.key];let l=n;return"certifiExpiry"!==a.key&&"eCertifiDate"!==a.key&&"orgiCertifiDate"!==a.key&&"traineeSD"!==a.key&&"traineeED"!==a.key||(l=y(n)),(0,i.jsxs)("article",{className:"flex justify-between text-[14px] mb-1 leading-7",children:[(0,i.jsx)("p",{className:"flex-1 text-start font-medium",children:a.header}),(0,i.jsx)("p",{className:"flex-1 text-start",children:"trainingUpCertifi"===a.key?s[t]?(0,i.jsx)("a",{href:s[t],className:"text-blue underline",target:"_blank",rel:"noreferrer",children:"Download"}):"N/A":l||"N/A"})]},r)}))]},t))))]})]})})},Ml=e=>{let{mergering:t,columns:a,popupAll:r}=e;const[s,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)(null),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(1),[h,x]=(0,n.useState)(30),[g,f]=(0,n.useState)([]),[v,y]=(0,n.useState)(t);(0,n.useEffect)((()=>{y(t)}),[t]);const N=(0,n.useCallback)((e=>{y(e),u(1)}),[]);(0,n.useEffect)((()=>{const e=(m-1)*h,t=v.slice(e,e+h);f(t)}),[v,m,h]);return(0,i.jsxs)("section",{children:[(0,i.jsx)("div",{className:"relative flex justify-end items-end mt-14",children:(0,i.jsx)(ga,{placeholder:"Search by empID, name, badge no, etc.",allEmpDetails:t,searchUserList:N,searchIcon2:(0,i.jsx)(j.zfp,{})})}),(0,i.jsxs)("div",{className:"overflow-x-auto mt-16 w-full rounded-md",children:[(0,i.jsx)("div",{className:"w-full px-4 max-h-[calc(90vh-7rem)] overflow-y-auto",children:(0,i.jsxs)("table",{className:"w-full rounded-xl table-auto",children:[(0,i.jsx)("thead",{className:"bg-[#939393] text-center sticky top-0",children:(0,i.jsxs)("tr",{children:[a.map(((e,t)=>(0,i.jsx)("th",{className:"py-4 px-2 text-white",children:e.header},t))),(0,i.jsx)("th",{className:"py-4 px-4 text-white",children:"View"})]})}),(0,i.jsx)("tbody",{className:"bg-white text-center text-sm font-semibold text-dark_grey",children:g.length>0?g.map(((e,t)=>(0,i.jsxs)("tr",{className:"shadow cursor-pointer",children:[a.map(((t,a)=>(0,i.jsx)("td",{className:"py-4 px-4 break-words overflow-hidden flex-1",children:e[null===t||void 0===t?void 0:t.key]||"N/A"},a))),(0,i.jsx)("td",{className:"py-4 px-4 text-dark_skyBlue underline cursor-pointer",onClick:()=>(d(e),void l(!0)),children:"View"})]},t))):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:a.length+1,className:"py-4 text-center",children:"No results found."})})})]})}),s&&o&&(0,i.jsx)(_l,{details:o,popupAll:r,onClose:()=>{l(!1),d(null)}})]}),(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("div",{className:"flex justify-between mt-12 px-10",children:(0,i.jsx)(oa,{currentPage:m,totalPages:Math.ceil(v.length/h),onPageChange:e=>{e>=1&&e<=Math.ceil(v.length/h)&&u(e)}})})})]})},Fl=()=>{const{empPIData:e,trainingCertifi:t,AddEmpReq:a,workInfoData:l}=(0,n.useContext)(s.Y),[o,d]=(0,n.useState)(""),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)([]),[f,v]=(0,n.useState)(!0),[y,N]=(0,n.useState)(null),b={trainCertifi:[{header:"Employee ID",key:"empID"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Purchase Order",key:"poNo"},{header:"Start Date",key:"traineeSD"},{header:"End Date",key:"traineeED"},{header:"Certificate Expiry",key:"certifiExpiry"},{header:"E-certificate Date",key:"eCertifiDate"}]},D=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)};(0,n.useEffect)((()=>{if(e&&l&&t&&a){const r=e.map((e=>{const r=a.find((t=>t.empID===e.empID)),n=l.find((t=>t.empID===e.empID)),s=t.find((t=>t.empID===e.empID));return s&&null!==s&&void 0!==s&&s.createdAt?(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),n),s),{},{CertifyCreatedAt:null===s||void 0===s?void 0:s.createdAt}):null})).filter((e=>null!==e)).sort(((e,t)=>e.empID.localeCompare(t.empID))).filter((e=>{const t=Array.isArray(e.department)?e.department:[];return"offshore"===(t.length>0&&"string"===typeof t[t.length-1]?t[t.length-1].trim().toLowerCase():"")}));u(r),x(r),v(!1)}else N("Data not fully available."),v(!1)}),[e,l,t,a]);const j=(e,t)=>{const a=e.target.value;"startDate"===t&&d(a),"endDate"===t&&p(a);const r="startDate"===t?new Date(a):o?new Date(o):null,n="endDate"===t?new Date(a):c?new Date(c):null,s=m.filter((t=>{let a=null,s=null;try{if(t.traineeTrack&&t.traineeTrack.length>0){const e=t.traineeTrack[t.traineeTrack.length-1],r=A(e);if(Array.isArray(r)){const e=r[r.length-1];null!==e&&void 0!==e&&e.traineeSD&&(a=new Date(e.traineeSD)),null!==e&&void 0!==e&&e.traineeED&&(s=new Date(e.traineeED))}else r.traineeSD&&(a=new Date(r.traineeSD)),r.traineeED&&(s=new Date(r.traineeED))}}catch(e){console.error("Error parsing traineeTrack:",e)}return!(!a||!s)&&(r&&n?a>=r&&s<=n:r?a>=r&&s>=r:!n||a<=n&&s<=n)}));x(s)},A=e=>{try{let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(y){return console.error("Error normalizing traineeTrackData:",y),[]}},w=h.sort(((e,t)=>new Date(t.CertifyCreatedAt)-new Date(e.CertifyCreatedAt))).map((e=>{let t="N/A",a="N/A",r="N/A",n="N/A",s="N/A",i="N/A";try{if(e.trainingProof&&e.trainingProof){const s=A(e.trainingProof);let i=s;Array.isArray(s)&&(i=s[s.length-1]),i&&(t=i.certifiExpiry?D(i.certifiExpiry):"N/A",a=i.eCertifiDate?D(i.eCertifiDate):"N/A",r=i.orgiCertifiDate?D(i.orgiCertifiDate):"N/A",n=i.poNo||"N/A")}else console.log("No valid trainingProof found for this entry.");if(e.traineeTrack&&e.traineeTrack){const t=A(e.traineeTrack);let a=t;Array.isArray(t)&&(a=t[t.length-1]),a&&(s=a.traineeSD?D(a.traineeSD):"N/A",i=a.traineeED?D(a.traineeED):"N/A")}else console.log("No valid traineeTrack found for this entry.")}catch(l){console.error("Error parsing trainingProof or traineeTrack:",l)}return(0,g.A)((0,g.A)({},e),{},{empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",certifiExpiry:t,eCertifiDate:a,orgiCertifiDate:r,poNo:n,traineeSD:s,traineeED:i,department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-"})}));return(0,i.jsxs)("section",{className:"bg-[#F8F8F8] mx-auto p-5 h-full w-full",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 my-5",children:[(0,i.jsx)(r.N_,{to:"/training",className:"text-xl text-grey",children:(0,i.jsx)(la.QVr,{})}),(0,i.jsx)("article",{className:"flex-1 flex justify-center gap-5 text-dark_grey",children:(0,i.jsx)("h1",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"OME Training Certificates"})})]}),(0,i.jsx)("div",{className:"px-4 relative ",children:(0,i.jsx)("div",{className:"absolute z-20 top-3 flex items-center gap-5",children:(0,i.jsxs)("div",{className:" flex items-center  gap-5 w-full ",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("input",{id:"start-date",type:"date",value:o,onChange:e=>j(e,"startDate"),className:"outline-none text-grey border rounded-md p-2"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("input",{id:"end-date",type:"date",value:c,onChange:e=>j(e,"endDate"),className:"outline-none text-grey border rounded-md p-2"})]})]})})}),(0,i.jsx)(Ml,{mergering:w,columns:null===b||void 0===b?void 0:b.trainCertifi,popupAll:[{header:"Employee ID",key:"empID"},{header:"Employee Badge No",key:"empBadgeNo"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Position",key:"position"}]})]})},Ll=e=>{let{AfterFilter:t,name:a,gmPosition:r,userType:s}=e;const[l,o]=(0,n.useState)(!1),[d,c]=(0,n.useState)("All"),p=e=>{c(e),o(!1)};(0,n.useEffect)((()=>{t(d)}),[d]);return(0,i.jsx)("section",{className:"",children:(0,i.jsxs)("div",{className:"center gap-3 border relative rounded-md p-3 text-sm text-secondary border-[#CDCDCD]",onClick:()=>{o(!l)},children:[(0,i.jsx)(j.NDY,{}),(0,i.jsx)("p",{children:a}),l&&(0,i.jsx)("div",{className:" top-10 absolute left-0 w-32 shadow-lg bg-white z-50 ",children:(0,i.jsxs)("div",{className:"py-1 shadow-md  flex flex-col bg-white",children:[(0,i.jsx)("button",{onClick:()=>p("All"),className:" w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white ",children:"All"}),"GENERAL MANAGER"===r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>p("Pending"),className:" w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white ",children:"Pending"}),(0,i.jsx)("button",{onClick:()=>{p("Approved")},className:"   w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white",children:"Approved"}),(0,i.jsx)("button",{onClick:()=>p("Rejected"),className:" w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white",children:"Rejected"})]}),"HR"===s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>p("Pending"),className:" w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white ",children:"Pending"}),(0,i.jsx)("button",{onClick:()=>{p("Verified")},className:"   w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white",children:"Verified"}),(0,i.jsx)("button",{onClick:()=>p("Not Eligible"),className:" w-full text-left px-4 py-2 text-sm text-dark_grey hover:bg-lite_grey hover:text-white",children:"Not Eligible"})]})]})})]})})},Ul=e=>{let{userType:t}=e;const a=(0,r.zy)(),{gmPosition:n,HRMPosition:s}=(0,Fe.b)();return(0,i.jsxs)("section",{className:"flex text-center items-center py-3 text_size_5",children:[(0,i.jsx)(r.N_,{to:"/leaveManagement",className:"pr-2 relative after:absolute after:-bottom-1 after:left-0 after:w-[90%] after:h-1 cursor-pointer ".concat("/leaveManagement"===a.pathname?"after:bg-primary":""),children:"Request Leave"})," ",(0,i.jsx)(r.N_,{to:"/leaveManagement/historyLeave",className:"px-1 relative after:absolute after:-bottom-2 after:left-0 after:w-[90%] after:h-1 cursor-pointer ".concat("/leaveManagement/historyLeave"===a.pathname?"after:bg-primary":""),children:"History of leave"})," ",(0,i.jsx)(r.N_,{to:"/leaveManagement/leaveBalance",className:"px-1 relative after:absolute after:-bottom-2 after:left-0 after:w-[90%] after:h-1 cursor-pointer ".concat("/leaveManagement/leaveBalance"===a.pathname?"after:bg-primary":""),children:"Employee Leave Balance"})," ",("HR MANAGER"===s||"SuperAdmin"===t||"GENERAL MANAGER"===n)&&(0,i.jsxs)(i.Fragment,{children:[" ",(0,i.jsx)(r.N_,{to:"/leaveManagement/requestTickets",className:"px-1 relative after:absolute after:-bottom-2 after:left-0 after:w-[90%] after:h-1 cursor-pointer ".concat("/leaveManagement/requestTickets"===a.pathname?"after:bg-primary":""),children:"Request Tickets"})]})]})},Bl=()=>{const{handleClickForToggle:e,handleViewClick:t,userType:a,mergedData:l,userID:o,loading:d}=(0,r.KC)(),{empPIData:c}=(0,n.useContext)(s.Y),[p,m]=(0,n.useState)(""),[u,h]=(0,n.useState)([]),[x,g]=(0,n.useState)([]),[v,b]=(0,n.useState)([]),[D,A]=(0,n.useState)(""),[w,S]=(0,n.useState)("All"),[E,I]=(0,n.useState)(1),[k,T]=(0,n.useState)(30),[C,R]=(0,n.useState)({searchError:!1,dateError:!1,noResults:!1});console.log("SEARCH",v),(0,n.useEffect)((()=>{let e=l.filter((e=>"Supervisor"===a&&"Cancelled"!==(null===e||void 0===e?void 0:e.empStatus)?e.supervisorEmpID===o:"Manager"!==a||"Approved"!==e.supervisorStatus&&e.supervisorEmpID||"Cancelled"===(null===e||void 0===e?void 0:e.empStatus)?("SuperAdmin"===a||"HR"===a)&&"Cancelled"!==(null===e||void 0===e?void 0:e.empStatus):e.managerEmpID===o)).sort(((e,t)=>{function r(e){const t=/^(\d{2})\/(\d{2})\/(\d{4})$/;if(t.test(e)){const[,a,r,n]=t.exec(e);return"".concat(n,"-").concat(r,"-").concat(a)}if(/^\d{4}-\d{2}-\d{2}$/.test(e)){return"".concat(e,"T00:00:00.000Z")}return new Date(e).toISOString()}if("SuperAdmin"===a){const a=r(e.leaveStatusReceivedDate||e.leaveStatusCreatedAt),n=r(t.leaveStatusReceivedDate||t.leaveStatusCreatedAt);return new Date(n)-new Date(a)}const n="Pending"===e.managerStatus,s="Pending"===t.managerStatus,i="Pending"===e.supervisorStatus,l="Pending"===t.supervisorStatus;if(n&&!s)return-1;if(!n&&s)return 1;if(i&&!l)return-1;if(!i&&l)return 1;const o=r(e.leaveStatusCreatedAt||e.leaveStatusReceivedDate),d=r(t.leaveStatusCreatedAt||t.leaveStatusReceivedDate);return new Date(d)-new Date(o)}));"All"!==w&&(e=e.filter((e=>("Manager"===a?e.managerStatus:"Supervisor"===a?e.supervisorStatus:null)===w))),D&&(e=e.filter((e=>{const t=new Date(D),a=e.supervisorDate?new Date(e.supervisorDate):null,r=e.managerDate?new Date(e.managerDate):null,n=t.toISOString().split("T")[0],s=a?a.toISOString().split("T")[0]:null,i=r?r.toISOString().split("T")[0]:null;return s===n||i===n}))),g(e),h(e)}),[l,a,o,w,D]);const P=(E-1)*k,O=["S. No","Employee ID","Name","Received Date","Supervisor"!==a&&"Manager"!==a&&"Supervisor Name","Manager"!==a&&"Supervisor Approved Date","Manager"!==a&&"Supervisor"!==a&&"Manager Name","Supervisor"!==a&&"Manager Approved Date","Documents","Submitted Form","SuperAdmin"!==a&&"HR"!==a&&"Status"].filter(Boolean);(0,n.useEffect)((()=>{const e=(E-1)*k;let t=x;if(v.length>0){const e=new Set(v.map((e=>e.empID)));t=t.filter((t=>e.has(t.empID)))}const a=t.slice(e,e+k);h(a),0===v&&R({searchError:!0})}),[E,k,x,v]);const _=Math.ceil((v.length>0?v.length:x.length)/k);return d?(0,i.jsx)("div",{className:"flex items-center justify-center h-[60vh] bg-transparent",children:(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading "}),(0,i.jsx)("p",{children:(0,i.jsx)(Fr.TwU,{className:"animate-spin mt-[4px]",size:15})})]})}):(0,i.jsxs)("section",{className:"flex flex-col w-full mt-4",children:[(0,i.jsxs)("section",{className:"flex flex-wrap justify-between items-center mb-5",children:[(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Ul,{userType:a})}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,i.jsx)(ga,{allEmpDetails:x,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee ID",searchUserList:b,border:"rounded-md"}),(0,i.jsx)("div",{className:"py-2  text_size_5 bg-white border rounded-md text-grey border-lite_grey flex items-center px-3 gap-2",children:(0,i.jsx)("input",{type:"date",name:"selectedDate",className:"text-grey outline-none",value:D||"",onChange:e=>{const t=e.target.value;A(t),b([]),I(1),R({searchError:!1,dateError:!1,noResults:!1})}})}),("Supervisor"===a||"Manager"===a)&&(0,i.jsx)(Ll,{name:w,AfterFilter:e=>{S(e),I(1),R({searchError:!1,dateError:!1,noResults:!1})}})]})]}),(0,i.jsx)("div",{className:"leaveManagementTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl ",children:u&&u.length>0?(0,i.jsxs)("table",{className:"w-full font-semibold text-sm text-center",children:[(0,i.jsx)("thead",{className:"bg-[#939393] sticky top-0 rounded-t-lg",children:(0,i.jsx)("tr",{children:O.map(((e,t)=>(0,i.jsx)("th",{className:"px-4 py-5 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:u&&u.length>0?u.map(((r,n)=>{var s,l;const o=P+n+1;let d="",u="";return r.managerEmpID&&(d=c.find((e=>e.empID===r.managerEmpID))),r.supervisorEmpID&&(u=c.find((e=>e.empID===r.supervisorEmpID))),(0,i.jsxs)("tr",{className:"text-center text-sm border-b-2 bg-white border-[#C7BCBC] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:o}),(0,i.jsx)("td",{className:"py-3",children:r.empID}),(0,i.jsx)("td",{className:"py-3",children:N(r.empName)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(null===r||void 0===r?void 0:r.leaveStatusReceivedDate)||y(null===r||void 0===r?void 0:r.leaveStatusCreatedAt)}),"Supervisor"!==a&&"Manager"!==a&&(0,i.jsx)("td",{className:"py-3",children:N(null===(s=u)||void 0===s?void 0:s.name)||"N/A"}),"Manager"!==a&&(0,i.jsx)("td",{className:"py-3",children:y(r.supervisorDate)||"N/A"}),"Manager"!==a&&"Supervisor"!==a&&(0,i.jsx)("td",{className:"py-3",children:N(null===(l=d)||void 0===l?void 0:l.name)||"N/A"}),"Supervisor"!==a&&(0,i.jsx)("td",{className:"py-3",children:y(r.managerDate)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:(0,i.jsx)("a",{href:p,onClick:e=>{r.medicalCertificate?(async e=>{try{const t=await(0,f.I)({path:e});m(t.url.href)}catch(t){console.error("Error fetching the file URL:",t)}})(r.medicalCertificate):e.preventDefault()},download:!0,className:r.medicalCertificate?"border-b-2 border-[orange] text-[orange]":"",children:r.medicalCertificate?"Download":"N/A"})}),(0,i.jsx)("td",{className:"py-3 cursor-pointer",children:(0,i.jsx)("button",{className:"border-b-2 border-[blue] text-[blue]",onClick:()=>{e(),t(r,"LM")},children:r["submitted Form"]||"View"})}),(0,i.jsx)("td",{className:"font-semibold ".concat((h=r.managerStatus,"Rejected"===h?"text-[red]":"Approved"===h?"text-[#339933]":"text-[#E8A317]")),children:"Supervisor"===a&&r.supervisorStatus||"Manager"===a&&r.managerStatus})]},n);var h})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:O.length,className:"text-center py-4",children:C.searchError?(0,i.jsx)("p",{children:"No matching results found for your search"}):C.dateError?(0,i.jsx)("p",{children:"No records found for the selected date"}):(0,i.jsx)("p",{children:"No data available "})})})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{children:"No data available / No matching results found for your search"})})}),(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:u&&u.length>0&&(0,i.jsx)(oa,{currentPage:E,totalPages:_,onPageChange:e=>{e>=1&&e<=_&&I(e)}})})})]})},ql=()=>{const{userType:e,mergedData:t,userID:a,loading:s}=(0,r.KC)(),[l,o]=(0,n.useState)([]),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(""),[x,g]=(0,n.useState)(1),[f,v]=(0,n.useState)(30),[b,D]=(0,n.useState)({searchError:!1,dateError:!1,noResults:!1}),A=(x-1)*f;(0,n.useEffect)((()=>{let r=t.filter((t=>"Supervisor"===e&&"Cancelled"!==(null===t||void 0===t?void 0:t.empStatus)&&"Approved"===t.managerStatus?t.supervisorEmpID===a:"Manager"!==e||"Approved"!==t.supervisorStatus&&t.supervisorEmpID||"Cancelled"===(null===t||void 0===t?void 0:t.empStatus)||"Approved"!==t.managerStatus?("SuperAdmin"===e||"HR"===e)&&"Approved"===t.managerStatus:t.managerEmpID===a)).sort(((e,t)=>new Date(t.leaveStatusCreatedAt)-new Date(e.leaveStatusCreatedAt)));u&&(r=r.filter((e=>{const t=new Date(u),a=e.empLeaveSelectedTo||e.empLeaveEndDate?new Date(e.empLeaveSelectedTo||e.empLeaveEndDate):null,r=e.empLeaveSelectedFrom||e.empLeaveStartDate?new Date(e.empLeaveSelectedFrom||e.empLeaveStartDate):null,n=y(t),s=y(a||e.empLeaveEndDate),i=y(r||e.empLeaveStartDate);return s===n||i===n}))),c(r),o(r)}),[t,e,a,u]);const w=["S.No","Employee ID","Name","Leave Type","Start Date","End Date","Reason","SuperAdmin"!==e&&"Status"];(0,n.useEffect)((()=>{const e=(x-1)*f;let t=d;if(p.length>0){const e=new Set(p.map((e=>e.empID)));t=t.filter((t=>e.has(t.empID)))}const a=t.slice(e,e+f);o(a)}),[x,f,d,p]);const S=Math.ceil((p.length>0?p.length:d.length)/f),E=e=>/^\d{4}\/\d{1,2}\/\d{1,2}$/.test(e)||/^\d{4}-\d{2}-\d{2}$/.test(e);return s?(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading..."})})}):(0,i.jsxs)("section",{className:"py-5 w-full",children:[(0,i.jsxs)("section",{className:"flex flex-wrap justify-between items-center mb-5",children:[(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Ul,{userType:e})}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,i.jsx)(ga,{allEmpDetails:d,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee ID",searchUserList:m,border:"rounded-md"}),(0,i.jsx)("div",{className:"py-2  text_size_5 bg-white border rounded-md text-grey border-lite_grey flex items-center px-3 gap-2",children:(0,i.jsx)("input",{type:"date",name:"selectedDate",className:"text-grey outline-none",value:u||"",onChange:e=>{const t=e.target.value;h(t),m([]),g(1),D({searchError:!1,dateError:!1,noResults:!1})}})})]})]}),(0,i.jsx)("div",{className:"leaveManagementTable h-[70vh] max-h-[calc(70vh-7rem)] max-w-[100%] overflow-x-auto rounded-xl",children:l&&l.length>0?(0,i.jsxs)("table",{className:"w-full font-semibold text-sm",children:[(0,i.jsx)("thead",{className:"bg-[#939393] sticky top-0 rounded-t-lg ",children:(0,i.jsx)("tr",{className:"",children:w.map(((e,t)=>(0,i.jsx)("th",{className:"px-4 py-5 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:l&&l.map(((t,a)=>{const r=A+a+1;return(0,i.jsxs)("tr",{className:"text-center text-sm border-b-2 bg-white border-[#C7BCBC] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:r}),(0,i.jsx)("td",{className:"py-3",children:t.empID}),(0,i.jsx)("td",{className:"py-3",children:N(t.empName)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:N(t.empLeaveType)}),(0,i.jsx)("td",{className:"py-3",children:t.empLeaveSelectedFrom?E(t.empLeaveSelectedFrom)?y(t.empLeaveSelectedFrom):t.empLeaveSelectedFrom:t.empLeaveStartDate?y(t.empLeaveStartDate):"N/A"}),(0,i.jsx)("td",{className:"py-3",children:t.empLeaveSelectedTo?E(t.empLeaveSelectedTo)?y(t.empLeaveSelectedTo):t.empLeaveSelectedTo:t.empLeaveEndDate?y(t.empLeaveEndDate):"N/A"}),(0,i.jsx)("td",{className:"py-3 w-[20%] break-words overflow-hidden",children:N(t.reason)||"N/A"}),(0,i.jsx)("td",{className:"font-semibold ".concat((n="Manager"===e?t.managerStatus:"Supervisor"===e?t.supervisorStatus:t.managerStatus,"Rejected"===n?"text-[red]":"Approved"===n?"text-[green]":"Pending"===n?"text-dark_grey":"text-[#E8A317]")),children:"Manager"===e||"Supervisor"===e||"HR"===e?t.managerStatus||"not found":""})]},a);var n}))})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{children:u?"No leave history found for ".concat(new Date(u).toLocaleDateString("en-GB")):"No matching results found for your search."})})}),(0,i.jsx)("div",{className:"ml-20 flex justify-center",children:(0,i.jsx)("div",{className:"w-[60%] flex justify-start mt-10 px-10",children:l&&l.length>0&&(0,i.jsx)(oa,{currentPage:x,totalPages:S,onPageChange:e=>{e>=1&&e<=S&&g(e)}})})})]})},Hl=e=>{let{handleClosePopup:t,mergedData:a,empDetails:r}=e;const[s,l]=(0,n.useState)(""),[o,d]=(0,n.useState)(""),[c,p]=(0,n.useState)({}),m=(0,n.useRef)(),u=(e,t)=>{const a=e.target.value;"startDate"===t?l(a):"endDate"===t&&d(a)},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{total:t?null:e,taken:0,waitingLeave:0,remaining:t?null:e}},x=e=>{if(!e||"string"!==typeof e)return!1;const[t]=e.split(" "),a=t.replace(/(\d{2})\/(\d{2})\/(\d{4})/,"$3-$2-$1").replace(/(\d{2})-(\d{2})-(\d{4})/,"$3-$2-$1"),r=(new Date).getFullYear(),n=new Date(a);if(isNaN(n))return!1;return r===n.getFullYear()},g=e=>parseFloat(e.toFixed(2)),f=e=>{if(!e)return"";let t,a,r,n=e.toString().trim();if(n.includes("T")){const e=new Date(n);r=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),t=e.getDate().toString().padStart(2,"0")}else if(n.includes("/"))[t,a,r]=n.split("/");else{if(!n.includes("-"))return"";[r,a,t]=n.split("-")}return"".concat(r,"-").concat(a,"-").concat(t)};(0,n.useEffect)((()=>{(async()=>{const e=a.reduce(((e,t)=>{var a;t&&t.empID&&!e[t.empID]&&(e[t.empID]={gender:t.gender,empId:t.empID,employeeName:t.empName,empBadgeNo:t.empBadgeNo,position:t.position,department:t.department,doj:t.doj,annualLeaveBal:t.empPervAnnualLeaveBal,empsickLeaveTaken:t.empsickLeaveTaken,effectiveDate:t.empSickLeaveDate,compassionateLeave:h(0,!0),unPaidAuthorisedLeave:h(0,!0),unPaidAuthorizeSick:h(0,!0),unPaidAuthorizeAnnual:h(0,!0),annualLeave:h(g(Number(Array.isArray(t.annualLeave)&&t.annualLeave.length>0?t.annualLeave[t.annualLeave.length-1]:"string"===typeof t.annualLeave?parseFloat(t.annualLeave):0)+Number(t.empPervAnnualLeaveBal||0))),marriageLeave:h(Number(t.marriageLeave)||0),hospitalisationLeave:h(Number(t.hospitalLeave)||0),maternityLeave:h(Number(t.maternityLeave)||0),sickLeave:h(Number(t.sickLeave)||0),paternityLeave:h(Number(t.paternityLeave)||0),compensateLeave:h(0,!0)});const r={"Compassionate Leave":"compassionateLeave","Annual Leave":"annualLeave","Marriage Leave":"marriageLeave","Hospitalisation Leave":"hospitalisationLeave","Maternity Leave":"maternityLeave","Sick Leave":"sickLeave","Paternity Leave":"paternityLeave","Unpaid Authorize Leave":"unPaidAuthorisedLeave","Compensate Leave":"compensateLeave","Unpaid Authorize - Sick":"unPaidAuthorizeSick","Unpaid Authorize - Annual":"unPaidAuthorizeAnnual"}[null===(a=t.empLeaveType)||void 0===a?void 0:a.trim()],n=t.empLeaveSelectedFrom?new Date(f(t.empLeaveSelectedFrom)):new Date(f(t.empLeaveStartDate)),i=t.empLeaveSelectedTo?new Date(f(t.empLeaveSelectedTo)):new Date(f(t.empLeaveEndDate)),l=new Date(s),d=new Date(o);let c=!1;s&&o?(i>=l&&n<=d&&(console.log("checking filter"),c=!0),"sickLeave"!==r&&(c=c&&(x(f(t.empLeaveSelectedFrom))||x(f(t.empLeaveSelectedTo))))):"sickLeave"!==r&&(c=x(f(t.empLeaveSelectedFrom)));let p=!1;if("sickLeave"===r){const a=new Date(f(t.empSickLeaveDate)),n=new Date(a);n.setFullYear(n.getFullYear()+1),n.setDate(n.getDate()-1);const i=new Date(f(t.empLeaveSelectedFrom||t.empLeaveStartDate)),l=new Date(f(t.empLeaveSelectedTo||t.empLeaveEndDate));if(!e[t.empID][r]){const a=Number(t.sickLeave)||0;e[t.empID][r]={total:a,taken:0,waitingLeave:0,remaining:a}}if(s&&o){const d=new Date(s),c=new Date(o);let p=new Date(a),m=new Date(n);for(;d>m;)p.setFullYear(p.getFullYear()+1),m.setFullYear(m.getFullYear()+1);for(;d<p;)p.setFullYear(p.getFullYear()-1),m.setFullYear(m.getFullYear()-1);const u=(e,t,a,r)=>e<=r&&a<=t,h=u(i,l,d,c),x=u(i,l,p,m);if(h&&x){const a=Number(t.leaveDays)||0;"Approved"===t.managerStatus&&"Cancelled"!==t.empStatus?e[t.empID][r].taken+=a:"Pending"===t.managerStatus&&"Rejected"!==t.supervisorStatus&&"Cancelled"!==t.empStatus&&(e[t.empID][r].waitingLeave+=a);const{total:n,taken:s,waitingLeave:i}=e[t.empID][r],l=g(n-(s+i));e[t.empID][r].remaining=l}}else{let a=new Date,n=new Date(f(t.empSickLeaveDate)),s=new Date(n);for(s.setFullYear(s.getFullYear()+1),s.setDate(s.getDate()-1);s<a;)n.setFullYear(n.getFullYear()+1),s.setFullYear(s.getFullYear()+1);if(a>=n&&i>=n&&l<=s&&a<=s){"Approved"===t.managerStatus&&"Cancelled"!==t.empStatus?e[t.empID][r].taken+=Number(t.leaveDays)||0:"Pending"===t.managerStatus&&"Rejected"!==t.supervisorStatus&&"Cancelled"!==t.empStatus&&(e[t.empID][r].waitingLeave+=Number(t.leaveDays)||0);const a=e[t.empID][r].total||0,n=e[t.empID][r].taken||0,s=e[t.empID][r].waitingLeave||0,i=g(a-(n+s));e[t.empID][r].remaining=i}}}else p=c;if(r&&p){e[t.empID][r]||(e[t.empID][r]={total:0,taken:0,waitingLeave:0,remaining:0});let a=Number(t.leaveDays)||0;if("Approved"===t.managerStatus&&"Cancelled"!==t.empStatus?(e[t.empID][r].taken+=a,"6056"===t.empID&&"annualLeave"===r&&console.log(a,"val")):"Pending"===t.managerStatus&&"Rejected"!==t.supervisorStatus&&"Cancelled"!==t.empStatus&&(e[t.empID][r].waitingLeave+=a),!["compassionateLeave","unPaidAuthorisedLeave","compensateLeave","unPaidAuthorizeSick","unPaidAuthorizeAnnual"].includes(r)){const a=e[t.empID][r].total||0,n=e[t.empID][r].taken||0,s=e[t.empID][r].waitingLeave||0,i=g(a-(n+s));e[t.empID][r].remaining=i}}return e}),{})[r.empID];p(e)})()}),[a,s,o,r]);const v=(0,Ir.useReactToPrint)({content:()=>m.current,onBeforePrint:()=>console.log("Preparing print..."),onAfterPrint:()=>console.log("Print complete"),pageStyle:"print"});return(0,i.jsx)("section",{className:"fixed top-0 left-0 bg-grey z-50 w-full h-full flex flex-col items-center justify-center",children:(0,i.jsxs)("div",{className:"bg-white w-[70%] flex flex-col overflow-y-auto",children:[(0,i.jsxs)("div",{className:"py-10 px-10 flex justify-between items-center  gap-5 w-full",children:[(0,i.jsxs)("section",{className:"flex items-center gap-5 w-full ",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("div",{className:"text_size_5 bg-white border py-2 rounded-md text-grey border-lite_grey flex items-center px-3 gap-2",children:(0,i.jsx)("input",{id:"start-date",type:"date",value:s,onChange:e=>u(e,"startDate"),className:"outline-none text-grey"})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("div",{className:"text_size_5 bg-white border py-2 rounded-md text-grey border-lite_grey flex items-center px-3 gap-2",children:(0,i.jsx)("input",{id:"end-date",type:"date",value:o,onChange:e=>u(e,"endDate"),className:"outline-none text-grey"})})]})]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"text-4xl cursor-pointer text-grey",onClick:t,"aria-label":"Close Popup",children:(0,i.jsx)(es.oxH,{})})})]}),(0,i.jsxs)("div",{ref:m,id:"leaveSummary",className:"bg-white px-10 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex flex-col justify-between items-center mb-2",children:[(0,i.jsx)("article",{className:"flex items-center justify-between w-full",children:(0,i.jsx)("div",{className:"flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[240px] w-full",src:Se.A,alt:"Company logo"})})}),(0,i.jsx)("p",{className:"text-center text-dark_grey text-lg font-semibold pt-3",children:(()=>{if(s&&o){const e=new Date(s).toLocaleDateString("en-US",{month:"long",year:"numeric"}),t=new Date(o).toLocaleDateString("en-US",{month:"long",year:"numeric"});return"".concat(e," - ").concat(t)}const e=new Date,t=e.toLocaleDateString("en-US",{month:"long"}),a=e.getFullYear();return"".concat(t," ").concat(a)})()}),(0,i.jsxs)("h2",{className:"uppercase text-xl text-center w-full font-medium mt-2",children:["Leave Summary for"," ",(0,i.jsx)("span",{className:"font-semibold italic",children:(null===c||void 0===c?void 0:c.employeeName)||"N/A"})]})]}),(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsxs)("article",{className:"mb-3",children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Employee ID:"})," ",(null===c||void 0===c?void 0:c.empId)||"N/A"]}),(0,i.jsxs)("h3",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Badge No:"})," ",(null===c||void 0===c?void 0:c.empBadgeNo)||"N/A"]}),(0,i.jsxs)("h4",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Date of Join:"})," ",null!==c&&void 0!==c&&c.doj?y(c.doj):"N/A"]}),(0,i.jsxs)("h4",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Position:"})," ",null!==c&&void 0!==c&&c.position&&c.position.length>0?N(null===c||void 0===c?void 0:c.position[(null===c||void 0===c?void 0:c.position.length)-1]):"N/A"]}),(0,i.jsxs)("h4",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Department:"})," ",null!==c&&void 0!==c&&c.department&&c.department.length>0?N(c.department[c.department.length-1]):"N/A"]})]}),(0,i.jsxs)("table",{className:"min-w-full bg-white text-sm font-semibold border",children:[(0,i.jsx)("thead",{className:"bg-gray-100",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"border px-4 py-2 text-sm",children:"Leave Type"}),(0,i.jsx)("th",{className:"border px-4 py-2 text-sm",children:"Total Leave"}),(0,i.jsx)("th",{className:"border px-4 py-2 text-sm",children:"Days Taken"}),(0,i.jsx)("th",{className:"border px-4 py-2 text-sm",children:"Waiting Approval"}),(0,i.jsx)("th",{className:"border px-4 py-2 text-sm",children:"Remaining Leave"})]})}),(0,i.jsx)("tbody",{children:["annualLeave","sickLeave","hospitalisationLeave","maternityLeave","paternityLeave","compensateLeave","compassionateLeave","marriageLeave","unPaidAuthorisedLeave","unPaidAuthorizeSick","unPaidAuthorizeAnnual"].map((e=>{const t=(null===c||void 0===c?void 0:c[e])||{},a=["compassionateLeave","unPaidAuthorisedLeave","compensateLeave","unPaidAuthorizeSick","unPaidAuthorizeAnnual"].includes(e);return"maternityLeave"===e&&"Female"!==(null===c||void 0===c?void 0:c.gender)||"paternityLeave"===e&&"Male"!==(null===c||void 0===c?void 0:c.gender)?null:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"border px-4 py-2",children:(r=e,r.replace(/Leave/g,"").replace(/^./,(e=>e.toUpperCase())).trim())}),(0,i.jsx)("td",{className:"border px-4 text-center py-2",children:a?"-":t.total||0}),(0,i.jsx)("td",{className:"border px-4 text-center py-2",children:t.taken||0}),(0,i.jsx)("td",{className:"border px-4 text-center py-2",children:t.waitingLeave||0}),(0,i.jsx)("td",{className:"border px-4 text-center py-2",children:a?"-":void 0!==t.remaining&&t.remaining>=0?t.remaining:0})]},e);var r}))})]}),(0,i.jsxs)("p",{className:"font-normal py-5",children:["Previous Year Annual Leave Balance ",(new Date).getFullYear()-1," ",": ",null===c||void 0===c?void 0:c.annualLeaveBal]})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-center gap-40 py-5",children:(0,i.jsx)("button",{className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex gap-2",onClick:v,children:"Print"})})]})})},Wl=()=>{const{mergedData:e,userType:t,loading:a}=(0,r.KC)(),[s,l]=(0,n.useState)(!1),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)(1),[f,v]=(0,n.useState)(30),[b,D]=(0,n.useState)([]),[A,w]=(0,n.useState)([]),[S,E]=(0,n.useState)(!1),[I,k]=(0,n.useState)([]);let T=(0,r.Zp)();const C=["S.No","Employee ID","Employee Name","Employee BadgeNo","Date of Join","Position","Department","Summary"];(0,n.useEffect)((()=>{const t=e=>{let t=null;if(null!==e&&void 0!==e&&e.includes("/")){const[a,r,n]=e.split("/").map(Number);t=new Date(n,r-1,a)}else null!==e&&void 0!==e&&e.includes("-")&&(t=new Date(e));return t.setHours(0,0,0,0),t};const a=function(e){const a=/[\/-]/,r=[];return e.forEach((e=>{let n=null,s=null;if(String(null===e||void 0===e?void 0:e.empLeaveSelectedFrom)&&String(null===e||void 0===e?void 0:e.empLeaveSelectedTo)&&a.test(null===e||void 0===e?void 0:e.empLeaveSelectedFrom)&&a.test(null===e||void 0===e?void 0:e.empLeaveSelectedTo)?(n=t(e.empLeaveSelectedFrom),s=t(e.empLeaveSelectedTo)):String(null===e||void 0===e?void 0:e.empLeaveStartDate)&&String(null===e||void 0===e?void 0:e.empLeaveEndDate)&&a.test(null===e||void 0===e?void 0:e.empLeaveStartDate)&&a.test(null===e||void 0===e?void 0:e.empLeaveEndDate)&&(n=t(e.empLeaveStartDate),s=t(e.empLeaveEndDate)),!n||!s)return void console.log("\u26d4 Invalid item (missing valid dates):",e);let i=new Date(n);i.setHours(0,0,0,0);const l=e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(r)},o=e=>{const t=l(e);return"".concat(t,"T00:00:00.000")},d=Math.floor((s-n)/864e5)+1;d>(null===e||void 0===e?void 0:e.days)||null===e||void 0===e||e.days,parseFloat(d);for(let t=0;t<d;t++){const t=new Date(i),a=l(t),n=o(t);let s=1;1===d&&.5===parseFloat(null===e||void 0===e?void 0:e.days)&&(s=.5),r.push((0,g.A)((0,g.A)({},e),{},{empLeaveSelectedFrom:a,empLeaveSelectedTo:a,empLeaveStartDate:n,empLeaveEndDate:n,leaveTakenCount:s})),i.setDate(i.getDate()+1)}})),r}(e);k(a)}),[e]),(0,n.useEffect)((()=>{const a=localStorage.getItem("userID"),r=new Map;e.forEach((e=>{const t=e.empID,a=new Date(Math.max(new Date(e.leaveDetailsCreatedAt).getTime(),new Date(e.leaveDetailsUpdatedAt).getTime()));(!r.has(t)||a>new Date(Math.max(new Date(r.get(t).leaveDetailsCreatedAt).getTime(),new Date(r.get(t).leaveDetailsUpdatedAt).getTime())))&&r.set(t,e)}));const n=Array.from(r.values()).filter((e=>"Manager"===t?e.managerEmpID===a:"Supervisor"===t?e.supervisorEmpID===a:"SuperAdmin"===t||"HR"===t));p(n),D(n)}),[e,t]);(0,n.useEffect)((()=>{const e=(h-1)*f,t=o.length>0?o:c;if(0===t.length)return void u([]);const a=t.sort(((e,t)=>{const a=/\d+$/,r=e.empID.match(a)?e.empID.match(a)[0].padStart(5,"0"):"",n=t.empID.match(a)?t.empID.match(a)[0].padStart(5,"0"):"",s=e.empID.replace(a,"").toLowerCase(),i=t.empID.replace(a,"").toLowerCase();return s!==i?s.localeCompare(i):r.localeCompare(n)})).slice(e,e+f);u(a)}),[h,f,c,o]);const R=Math.ceil((o.length>0?o.length:c.length)/f),P=(h-1)*f;return a?(0,i.jsx)("div",{className:"flex items-center justify-center h-[60vh] bg-transparent",children:(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading "}),(0,i.jsx)("p",{children:(0,i.jsx)(Fr.TwU,{className:"animate-spin mt-[4px]",size:15})})]})}):(0,i.jsxs)("section",{className:"relative w-full",children:[(0,i.jsxs)("div",{className:"flex flex-wrap justify-between items-center mb-5",children:[(0,i.jsx)("div",{className:"",children:(0,i.jsx)(Ul,{userType:t})}),(0,i.jsx)(ga,{allEmpDetails:c,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee ID",searchUserList:async e=>{try{const t=await e;d(t||[]),E(!0),x(1)}catch(t){console.error("Error search data",t),d([]),E(!0)}},border:"rounded-md"})]}),(0,i.jsx)("div",{className:"leaveManagementTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl",children:S&&0===o.length?(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-red-500 font-medium",children:"No matching results found for your search."})}):m.length>0?(0,i.jsxs)("table",{className:"w-full font-semibold text-sm",children:[(0,i.jsx)("thead",{className:"bg-[#939393] sticky top-0 rounded-t-lg",children:(0,i.jsx)("tr",{children:C.map(((e,t)=>(0,i.jsx)("th",{className:"px-4 py-5 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:m&&m.length>0?m.map(((e,t)=>{const a=P+t+1;return(0,i.jsxs)("tr",{className:"text-center text-sm border-b-2 bg-white border-[#C7BCBC] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"py-3",children:a}),(0,i.jsx)("td",{className:"py-3",children:e.empID}),(0,i.jsx)("td",{className:"py-3",children:N(e.empName)||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:e.empBadgeNo||"N/A"}),(0,i.jsx)("td",{className:"py-3",children:y(e.doj)||"N/A"}),(0,i.jsxs)("td",{className:"py-3",children:[" ",Array.isArray(e.position)&&N(e.position[e.position.length-1])||"N/A"]}),(0,i.jsxs)("td",{className:"py-3",children:[" ",Array.isArray(e.department)&&N(e.department[e.department.length-1])||"N/A"]}),(0,i.jsx)("td",{className:"py-3",children:(0,i.jsx)("button",{onClick:()=>{T("/leaveManagement/leaveDetails",{state:{mergedLeaveData:I,item:e}})},className:"border-b-2 text-[blue]",children:"View"})})]},t)})):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:C.length,className:"text-center py-4",children:"No data available"})})})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{className:"text-gray-600",children:"No leave data available for employees."})})}),s&&(0,i.jsx)(Hl,{handleClosePopup:()=>{l(!1)},mergedData:e,formatDate:y,empDetails:A}),(0,i.jsx)("div",{className:"center my-10",children:(0,i.jsx)("div",{children:(0,i.jsx)(oa,{currentPage:h,totalPages:R,onPageChange:e=>{e>=1&&e<=R&&x(e)}})})})]})},zl=()=>{const{handleViewClick:e,handleClickForToggle:t,userType:a}=(0,r.KC)(),[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)(1),[h,x]=(0,n.useState)(5),[f,v]=(0,n.useState)([]),[b,D]=(0,n.useState)(""),[A,w]=(0,n.useState)("All"),{gmPosition:S,HRMPosition:E}=(0,Fe.b)(),{ticketMerged:I,loading:k}=Ce(),[T,C]=(0,n.useState)({date:"",search:[],status:"All"}),[R,P]=(0,n.useState)({noResults:!1,searchError:!1,dateError:!1}),O="GENERAL MANAGER";(0,n.useEffect)((()=>{console.log("\ud83d\udd01 Filters triggered with ticketMerged and filters");let e=[...I],t=!1,a=!1,r=!1,n=!1;if("All"!==T.status&&(e=e.filter((e=>"HR MANAGER"===E&&e.hrStatus===T.status||S===O&&e.gmStatus===T.status))),T.date){t=!0;const a=new Date(T.date);a.setHours(0,0,0,0),e=e.filter((e=>{const t=[(null===e||void 0===e?void 0:e.departureDate)&&new Date(e.departureDate),(null===e||void 0===e?void 0:e.arrivalDate)&&new Date(e.arrivalDate),(null===e||void 0===e?void 0:e.createdAt)&&new Date(e.createdAt)].filter(Boolean);t.forEach((e=>e.setHours(0,0,0,0)));const n=t.some((e=>e.getTime()===a.getTime()));return n&&(r=!0),n}))}T.search.length>0&&(a=!0,e=e.filter((e=>{const t=T.search.some((t=>t.empID===e.empID));return t&&(n=!0),t}))),S===O&&(e=e.filter((e=>"Verified"===e.hrStatus))),e.sort(((e,t)=>"Pending"===e.hrStatus&&"Pending"!==t.hrStatus?-1:"Pending"!==e.hrStatus&&"Pending"===t.hrStatus?1:"Pending"===e.gmStatus&&"Pending"!==t.gmStatus?-1:"Pending"!==e.gmStatus&&"Pending"===t.gmStatus?1:new Date(t.createdAt)-new Date(e.createdAt))),P({noResults:0===e.length,searchError:a&&!n,dateError:t&&!r}),p(e),d(e),u(1)}),[T,I]),(0,n.useEffect)((()=>{const e=(m-1)*h,t=(c.sort(((e,t)=>"Pending"===e.hrStatus&&"Pending"!==t.hrStatus?-1:"Pending"!==e.hrStatus&&"Pending"===t.hrStatus?1:"Pending"===e.gmStatus&&"Pending"!==t.gmStatus?-1:"Pending"!==e.gmStatus&&"Pending"===t.gmStatus?1:new Date(t.createdAt)-new Date(e.createdAt))),c.slice(e,e+h));v(t)}),[m,h,c]),(0,n.useEffect)((()=>{const e=f.sort(((e,t)=>"Pending"===e.hrStatus&&"Pending"!==t.hrStatus?-1:"Pending"!==e.hrStatus&&"Pending"===t.hrStatus?1:"Pending"===e.gmStatus&&"Pending"!==t.gmStatus?-1:"Pending"!==e.gmStatus&&"Pending"===t.gmStatus?1:new Date(t.createdAt)-new Date(e.createdAt)));if("GENERAL MANAGER"===S){const t=e.filter((e=>"Verified"===e.hrStatus&&"Pending"!==e.hrStatus));d(t),v(t)}else d(e),v(e)}),[I,S]);if(k)return(0,i.jsx)("div",{className:"flex items-center justify-center h-[60vh] bg-transparent",children:(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading "}),(0,i.jsx)("p",{children:(0,i.jsx)(Fr.TwU,{className:"animate-spin mt-[4px]",size:15})})]})});const _=Math.ceil(c.length/h),M=(m-1)*h,F=["S.No","Emp ID","Name","Department","Position","Received Date","Departure date","Arrival date","Submitted form","SuperAdmin"!==a&&"Status"];return(0,i.jsxs)("section",{className:"w-full",children:[(0,i.jsxs)("div",{className:"flex justify-between flex-wrap mb-5",children:[(0,i.jsx)("div",{children:(0,i.jsx)(Ul,{userType:a})}),(0,i.jsxs)("div",{className:"flex  flex-wrap items-center gap-2",children:[(0,i.jsx)(ga,{allEmpDetails:o,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee ID",searchUserList:async e=>{try{const t=await e;l(t),0===t.length?(v([]),p([]),P((e=>(0,g.A)((0,g.A)({},e),{},{searchError:!0,noResults:!0})))):(C((e=>(0,g.A)((0,g.A)({},e),{},{search:t}))),P((e=>(0,g.A)((0,g.A)({},e),{},{searchError:!1,noResults:!1}))))}catch(t){v([]),p([]),P((e=>(0,g.A)((0,g.A)({},e),{},{searchError:!0,noResults:!0})))}},border:"rounded-md"}),(0,i.jsx)("div",{className:"text_size_5 bg-white border py-2 rounded-md text-grey border-lite_grey flex items-center px-3 gap-2",children:(0,i.jsx)("input",{type:"date",name:"selectedDate",className:"text-grey outline-none",value:b||"",onChange:e=>{const t=e.target.value;D(t),C((e=>(0,g.A)((0,g.A)({},e),{},{date:t})))}})}),("GENERAL MANAGER"===S||"HR"===a)&&(0,i.jsx)(Ll,{name:A,AfterFilter:e=>{w(e),C((t=>(0,g.A)((0,g.A)({},t),{},{status:e})))},userType:a,gmPosition:S})]})]}),(0,i.jsx)("div",{className:"leaveManagementTable h-[70vh] max-h-[calc(70vh-7rem)] w-full overflow-y-auto rounded-xl ",children:R.noResults?(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{children:"No matching results found for your search."})}):f&&f.length>0?(0,i.jsxs)("table",{className:"w-full font-semibold text-sm",children:[(0,i.jsx)("thead",{className:"bg-[#939393] sticky top-0 rounded-t-lg",children:(0,i.jsx)("tr",{className:"px-6",children:F.map(((e,t)=>(0,i.jsx)("th",{className:"py-5 text-[15px] text-white",children:e},t)))})}),(0,i.jsx)("tbody",{children:f.map(((r,n)=>{const s=M+n+1;return(0,i.jsxs)("tr",{className:"text-center text-sm border-b-2 bg-white border-[#C7BCBC] text-[#303030] hover:bg-medium_blue",children:[(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:s}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:null===r||void 0===r?void 0:r.empID}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:N(null===r||void 0===r?void 0:r.empName)||"N/A"}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:Array.isArray(r.department)&&N(r.department[r.department.length-1])||"N/A"}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:Array.isArray(r.position)&&N(r.position[r.position.length-1])||"N/A"}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:y(r.createdAt)}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:r.empDepartureDate||y(r.departureDate)||"N/A"}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5",children:r.empArrivalDate||y(r.arrivalDate)||"N/A"}),(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] cursor-pointer py-5",children:(0,i.jsx)("span",{className:"border-b-2 text-[blue]",onClick:()=>{t(),e(r,"Tickets")},children:"View"})}),"SuperAdmin"!==a&&!S&&(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5 ".concat("Not Eligible"===r.hrStatus?"text-[red]":"Verified"===r.hrStatus?"text-[#339933]":"Pending"===r.hrStatus?"text-[#E8A317]":""),children:r.hrStatus}),"SuperAdmin"!==a&&"GENERAL MANAGER"===S&&(0,i.jsx)("td",{className:"border-b-2 border-[#CECECE] py-5 ".concat("Rejected"===r.gmStatus?"text-[red]":"Approved"===r.gmStatus?"text-[#339933]":"Pending"===r.gmStatus?"text-[#E8A317]":""),children:r.gmStatus||"Pending"})]},n)}))})]}):(0,i.jsx)("div",{className:"text-center mt-6 py-20",children:(0,i.jsx)("p",{children:"All"!==T.status?'No tickets found with status "'.concat(T.status,'".'):R.dateError?"No tickets found for the selected date.":"No tickets available."})})}),(0,i.jsx)("div",{className:"center pt-10",children:(0,i.jsx)(oa,{currentPage:m,totalPages:_,onPageChange:e=>{e>=1&&e<=_&&u(e)}})})]})},Yl=e=>{var t;let{data:a,loading:r,setTableData:s,message:l,assignObjectFun:o,toggleFunction:d,editFormTitleFunc:c,itemsPerPage:p,currentPage:m}=e;(0,n.useEffect)((()=>{if(!1===r){const e=document.querySelectorAll("tbody tr"),t=Array.from(e).map((e=>{const t=e.querySelectorAll("td");return Array.from(t).map((e=>e.innerText))}));(()=>{setTimeout((()=>{t&&s(t)}),1e3)})()}}),[r,a]);const u=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}},h=e=>{try{const t=String(e),a=new Date(t),r=a.getDate(),n=a.getMonth()+1,s=a.getFullYear(),i=(null===t||void 0===t?void 0:t.split(" ")[1])+" "+(null===t||void 0===t?void 0:t.split(" ")[2]);return"".concat(r,"/").concat(n,"/").concat(s," ").concat(i)}catch(t){}};return(0,i.jsx)("tbody",{children:!1===r&&a&&(null===a||void 0===a?void 0:a.length)>0?a.map(((e,t)=>(e=>{var a,r,n,s;const l=(m-1)*p+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[53px]  bg-white text-sm rounded-sm shadow-md text-start border-b-2 border-[#CECECE]  hover:bg-[#f1f5f9] cursor-pointer",onClick:()=>{o(e,"BLNG"),d(),c("View Form")},children:[(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:l}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:null===e||void 0===e?void 0:e.fidNo}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.empName}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:u(null===e||void 0===e?void 0:e.date)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:h((null===e||void 0===e||null===(a=e.inTime)||void 0===a?void 0:a.replace(/[\[\]]/g,""))||0).includes("undefined")?"0":h((null===e||void 0===e||null===(r=e.inTime)||void 0===r?void 0:r.replace(/[\[\]]/g,""))||0)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:h((null===e||void 0===e||null===(n=e.outTime)||void 0===n?void 0:n.replace(/[\[\]]/g,""))||0).includes("undefined")?"0":h((null===e||void 0===e||null===(s=e.outTime)||void 0===s?void 0:s.replace(/[\[\]]/g,""))||0)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.avgDailyTD)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.totalHrs)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.aweSDN)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.normalWorkHrs)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.actualWorkHrs)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:(null===e||void 0===e?void 0:e.otTime)||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:null===e||void 0===e?void 0:e.remarks})]},t)})(e))):null!==(t=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"p-5",children:l||"Please wait few seconds"})})}))&&void 0!==t?t:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"50",className:"text-center text-dark_ash text_size_5 bg-white"})})})},Vl=e=>{var t;let{data:a,loading:r,setTableData:s,message:l,assignObjectFun:o,toggleFunction:d,editFormTitleFunc:c,itemsPerPage:p,currentPage:m}=e;(0,n.useEffect)((()=>{if(!1===r){const e=document.querySelectorAll("tbody tr"),t=Array.from(e).map((e=>{const t=e.querySelectorAll("td");return Array.from(t).map((e=>e.innerText))}));(()=>{setTimeout((()=>{t&&s(t)}),1e3)})()}}),[r,a]);const u=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};return(0,i.jsx)("tbody",{children:!1===r&&a&&(null===a||void 0===a?void 0:a.length)>0?a.map(((e,t)=>(e=>{const a=(m-1)*p+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[53px] bg-white text-sm rounded-sm shadow-md text-start border-b-2 border-[#CECECE]   hover:bg-[#f1f5f9] cursor-pointer",onClick:()=>{o(e,"HO"),d(),c("View Form")},children:[(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:a}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.ctr}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empDept}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empID}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empBadgeNo}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empName}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:u(e.date)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.onAM||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.offAM||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.onPM||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.offPM||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.inTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.outTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalInOut||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.allDayHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.netMins||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.normalWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.actualWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.otTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.remarks})]},t)})(e))):null!==(t=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"p-5",children:l||"Please wait few seconds."})})}))&&void 0!==t?t:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"15",className:"text-center text-dark_ash text_size_5 bg-white"})})})},Gl=e=>{var t;let{data:a,loading:r,setTableData:s,message:l,assignObjectFun:o,toggleFunction:d,editFormTitleFunc:c,itemsPerPage:p,currentPage:m}=e;(0,n.useEffect)((()=>{if(!1===r){const e=document.querySelectorAll("tbody tr"),t=Array.from(e).map((e=>{const t=e.querySelectorAll("td");return Array.from(t).map((e=>e.innerText))}));(()=>{setTimeout((()=>{t&&s(t)}),1e3)})()}}),[r,a]);const u=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};return(0,i.jsx)("tbody",{children:!1===r&&a&&(null===a||void 0===a?void 0:a.length)>0?a.map(((e,t)=>(e=>{const a=(m-1)*p+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[53px] bg-white text-sm rounded-sm shadow-md text-start border-b-2 border-[#CECECE]  hover:bg-[#f1f5f9] cursor-pointer",onClick:()=>{o(e,"Offshore"),d(),c("View Form")},children:[(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:a}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:e.empName}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:e.trade}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.fidNo}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.location}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:u(e.date)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalNT||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalOT||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalNTOT||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.normalWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.actualWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.otTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.remarks})]},t)})(e))):null!==(t=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"p-5",children:l||"Please wait few seconds..."})})}))&&void 0!==t?t:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white"})})})},Jl=e=>{var t;let{data:a,loading:r,setTableData:s,message:l,assignObjectFun:o,toggleFunction:d,editFormTitleFunc:c,itemsPerPage:p,currentPage:m}=e;(0,n.useEffect)((()=>{if(!1===r){const e=document.querySelectorAll("tbody tr"),t=Array.from(e).map((e=>{const t=e.querySelectorAll("td");return Array.from(t).map((e=>e.innerText))}));(()=>{setTimeout((()=>{t&&s(t)}),1e3)})()}}),[r,a]);const u=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};return(0,i.jsx)("tbody",{children:!1===r&&a&&(null===a||void 0===a?void 0:a.length)>0?a.map(((e,t)=>(e=>{const a=(m-1)*p+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[53px] bg-white text-sm rounded-sm shadow-md text-start border-b-2 border-[#CECECE]  hover:bg-[#f1f5f9] cursor-pointer",onClick:()=>{o(e,"ORMC"),d(),c("View Form")},children:[(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:a}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:e.empName}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empDept}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empBadgeNo}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:u(e.date)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.inTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.outTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalInOut||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.allDayHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.netMins||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.normalWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.actualWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.otTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.remarks})]},t)})(e))):null!==(t=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"p-5",children:l||"Please wait few seconds."})})}))&&void 0!==t?t:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white"})})})},Kl=e=>{var t;let{data:a,loading:r,setTableData:s,message:l,assignObjectFun:o,toggleFunction:d,editFormTitleFunc:c,itemsPerPage:p,currentPage:m}=e;(0,n.useEffect)((()=>{if(!1===r){const e=document.querySelectorAll("tbody tr"),t=Array.from(e).map((e=>{const t=e.querySelectorAll("td");return Array.from(t).map((e=>e.innerText))}));(()=>{setTimeout((()=>{t&&s(t)}),1e3)})()}}),[r,a]);const u=e=>{try{const[t,a,r]=e.split("/");return"".concat(a,"/").concat(t,"/").concat(r)}catch(t){}};return(0,i.jsx)("tbody",{children:!1===r&&a&&(null===a||void 0===a?void 0:a.length)>0?a.map(((e,t)=>(e=>{const a=(m-1)*p+t+1;return(0,i.jsxs)("tr",{className:"text-dark_grey h-[53px] bg-white text-sm rounded-sm shadow-md text-start border-b-2 border-[#CECECE]  hover:bg-[#f1f5f9] cursor-pointer",onClick:()=>{o(e,"SBW"),d(),c("View Form")},children:[(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:a}),(0,i.jsx)("td",{className:"text-start px-4 flex-1",children:e.empName}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empDept}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.empBadgeNo}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:u(e.date)}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.inTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.outTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalInOut||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.allDayHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.netMins||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.totalHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.normalWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.actualWorkHrs||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.otTime||0}),(0,i.jsx)("td",{className:"text-center px-4 flex-1",children:e.remarks})]},t)})(e))):null!==(t=(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white",children:(0,i.jsx)("p",{className:"p-5",children:l||"Please wait few seconds."})})}))&&void 0!==t?t:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"100%",className:"text-center text-dark_ash text_size_5 bg-white"})})})},Ql=()=>{var e,t;const[a,s]=(0,n.useState)(!0),[l,o]=(0,n.useState)(""),[d,c]=(0,n.useState)(null),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),[f,v]=(0,n.useState)("Edit Form"),[y,N]=(0,n.useState)(1),[b,D]=(0,n.useState)(""),j=ds(b),{showListTimeSheet:A,timeSheetFileData:w,startDate:S,endDate:E,searchQuery:I,setCategoryFilters:k,categoryFilters:T,setTableData:C,tableData:R}=(0,Fe.b)(),P=(0,r.Zp)();(0,n.useLayoutEffect)((()=>{if(!0===A){const e=window.location.pathname;"/viewTsheetDetails"!==e&&"/viewTsheetDetails/"!==e||P("/viewTimesheet")}}),[]),(0,n.useEffect)((()=>{w&&localStorage.setItem("timeSheetData",null===w||void 0===w?void 0:w.updatedAt)}),[w]);const O=ds(T),_=d||[],M=500,F=y*M,L=F-M,U=_.slice(L,F),B=Math.ceil(_.length/M);let q=U;(0,n.useEffect)((()=>{if(p&&p.length>0){N(1),s(!1);let e=[...p];if(I&&(e=I),S&&E){const t=new Date(S),a=new Date(E);e=e.filter((e=>{const r=new Date(e.date);return null===r||void 0===r||r.setHours(0,0,0,0),null===t||void 0===t||t.setHours(0,0,0,0),null===a||void 0===a||a.setHours(0,0,0,0),r>=t&&r<=a}))}c(e),s(!1)}}),[p,S,E,I]),(0,n.useEffect)((()=>{w&&w&&(c(null===w||void 0===w?void 0:w.updatedAt),m(null===w||void 0===w?void 0:w.updatedAt),k(null===w||void 0===w?void 0:w.fileType))}),[w]),(0,n.useEffect)((()=>{setTimeout((()=>{s(!1)}),3e3)}),[d]);const H=()=>{h(!u)},W=async(e,t)=>{if(e){const a=await(async(e,t)=>{let a=[];try{var r;Array.isArray(e.empWorkInfo)&&(a=null===(r=e.empWorkInfo)||void 0===r?void 0:r.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(i){}if(e&&"HO"===t)return{REC:e.rec||0,CTR:e.ctr||"",DEPT:e.empDept||"",EMPLOYEEID:e.empID||"",BADGE:e.empBadgeNo||"",NAME:e.empName||0,DATE:e.date||"",ONAM:e.onAM||"",OFFAM:e.offAM||"",ONPM:e.onPM||0,OFFPM:e.offPM||0,IN:(null===e||void 0===e?void 0:e.inTime)||0,OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINUTES:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||"",NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:(null===e||void 0===e?void 0:e.actualWorkHrs)||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,TOTALACTUALHOURS:e.actualWorkHrs||"",jobLocaWhrs:a.flat()||[],REMARKS:e.remarks||"",STATUS:e.status||""};if(e&&"Offshore"===t)return{NAME:e.empName||"",NO:e.fidNo||"",LOCATION:e.location||"",TRADE:e.trade||"",DATE:e.date||"",TOTALHOURS:e.totalNT||0,TOTALHOURS2:e.totalOT||0,TOTALHOURS3:e.totalNTOT||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:a.flat()||[],REMARKS:e.remarks||"",STATUS:e.status||""};if(e&&"ORMC"===t)return{NAME:e.empName||0,DEPTDIV:e.empDept||"",BADGE:e.empBadgeNo||"",DATE:e.date||"",IN:e.inTime||"",OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINHRS:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,jobLocaWhrs:a.flat()||[],REMARKS:e.remarks||"",STATUS:e.status||""};if(e&&"Offshore's ORMC"===t)return{NAME:e.empName||"",NO:e.fidNo||"",LOCATION:e.location||"",TRADE:e.trade||"",DATE:e.date||"",TOTALHOURS:e.totalNT||0,TOTALHOURS2:e.totalOT||0,TOTALHOURS3:e.totalNTOT||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:a.flat()||[],REMARKS:e.remarks||"",STATUS:e.status||""};if(e&&"SBW"===t)return{NAME:e.empName||0,DEPTDIV:e.empDept||"",BADGE:e.empBadgeNo||"",DATE:e.date||"",IN:e.inTime||"",OUT:e.outTime||0,TOTALINOUT:e.totalInOut||"",ALLDAYMINHRS:e.allDayHrs||"",NETMINUTES:e.netMins||"",TOTALHOURS:e.totalHrs||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,jobLocaWhrs:a.flat()||[],REMARKS:e.remarks||"",STATUS:e.status||""};var n,s;if(e&&"BLNG"===t)return{FID:e.fidNo||0,NAMEFLAST:e.empName||"",ENTRANCEDATEUSED:e.date||"",ENTRANCEDATETIME:(null===(n=e.inTime)||void 0===n?void 0:n.replace(/[\[\]]/g,""))||"",EXITDATETIME:(null===(s=e.outTime)||void 0===s?void 0:s.replace(/[\[\]]/g,""))||"",AVGDAILYTOTALBYDAY:e.avgDailyTD||"",AHIGHLIGHTDAILYTOTALBYGROUP:e.totalHrs||"",ADININWORKSENGINEERINGSDNBHD:e.aweSDN||"",WORKINGHOURS:e.actualWorkHrs||0,OT:e.otTime||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:a.flat()||[],REMARKS:e.remarks||"",STATUS:e.status||""}})(e,t);D(t),g(a)}},z=e=>{v("View Form"===e?e:"Edit Form")};return(0,i.jsxs)("section",{className:"h-screen bg-[#fafaf6] ",children:[(0,i.jsx)(gi,{}),(0,i.jsx)("div",{className:"screen-size top-0 ",children:(0,i.jsx)("div",{className:"table-container ",children:(0,i.jsxs)("table",{className:"styled-table  w-[100%]",children:[(0,i.jsx)("thead",{className:"sticky-header",children:(0,i.jsxs)("tr",{className:"text_size_7",children:["HO"!==T&&(0,i.jsx)("td",{className:"px-5 text-center",children:"S No."}),null!==(e=null===O||void 0===O||null===(t=O.tableHeader)||void 0===t?void 0:t.map(((e,t)=>(0,i.jsx)("td",{className:"px-4 flex-1 text-center",children:e},t))))&&void 0!==e?e:(0,i.jsx)("td",{colSpan:"100%",className:"text-center",children:"No headers available"})]})}),"BLNG"===T&&(0,i.jsx)(Yl,{data:q,loading:a,setTableData:C,message:l,assignObjectFun:W,toggleFunction:H,editFormTitleFunc:z,itemsPerPage:M,currentPage:y}),"HO"===T&&(0,i.jsx)(Vl,{data:q,loading:a,setTableData:C,message:l,assignObjectFun:W,toggleFunction:H,editFormTitleFunc:z,itemsPerPage:M,currentPage:y}),"SBW"===T&&(0,i.jsx)(Kl,{data:q,loading:a,setTableData:C,message:l,assignObjectFun:W,toggleFunction:H,editFormTitleFunc:z,itemsPerPage:M,currentPage:y}),"ORMC"===T&&(0,i.jsx)(Jl,{data:q,loading:a,setTableData:C,message:l,assignObjectFun:W,toggleFunction:H,editFormTitleFunc:z,itemsPerPage:M,currentPage:y}),"Offshore's ORMC"===T&&(0,i.jsx)(Gl,{data:q,loading:a,setTableData:C,message:l,assignObjectFun:W,toggleFunction:H,editFormTitleFunc:z,itemsPerPage:M,currentPage:y}),"Offshore"===T&&(0,i.jsx)(Gl,{data:q,loading:a,setTableData:C,message:l,assignObjectFun:W,toggleFunction:H,editFormTitleFunc:z,itemsPerPage:M,currentPage:y})]})})}),(0,i.jsx)("div",{className:"flex justify-center py-7",children:q.length>0&&(0,i.jsx)(Ss,{totalPages:B,currentPage:y,paginate:e=>N(e)})}),u&&x&&(0,i.jsx)(hs,{fieldObj:(null===j||void 0===j?void 0:j.fieldObj)||{},fields:(null===j||void 0===j?void 0:j.fields)||[],tableHeader:(null===j||void 0===j?void 0:j.tableHeader)||[],toggleFunction:H,titleName:b,Position:"Manager",editObject:x,editFormTitle:f})]})},$l=e=>{var t,a,l,o,d,c,p;let{tableBody:m,tableHead:u,title:h,handleViewDetails:x,handleDate:g,startDate:f,endDate:v,testDate:N,setTestDate:b}=e;const{dropDownVal:D}=(0,n.useContext)(s.Y),[A,w]=(0,n.useState)(""),[S,E]=(0,n.useState)(""),[I,k]=(0,n.useState)(1),T=null===(t=D[0])||void 0===t||null===(a=t.departmentDD)||void 0===a?void 0:a.map((e=>({value:null===e||void 0===e?void 0:e.split(" ").map((e=>{var t;return(null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))})).join(" "),label:null===e||void 0===e?void 0:e.split(" ").map((e=>{var t;return(null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))})).join(" ")})));let C=S?null===m||void 0===m?void 0:m.filter((e=>{var t;return(null===e||void 0===e||null===(t=e.department)||void 0===t?void 0:t.toUpperCase())===(null===S||void 0===S?void 0:S.toUpperCase())})):m;C=null===(l=C)||void 0===l?void 0:l.filter((e=>{var t,a,r,n,s,i;const l=null===A||void 0===A?void 0:A.toLowerCase();return(null===(t=String(e.name||""))||void 0===t||null===(a=t.toLowerCase())||void 0===a?void 0:a.includes(l))||(null===(r=String(e.empID||""))||void 0===r||null===(n=r.toLowerCase())||void 0===n?void 0:n.includes(l))||(null===(s=String(e.empBadgeNo||""))||void 0===s||null===(i=s.toLowerCase())||void 0===i?void 0:i.includes(l))})),C=null===(o=C)||void 0===o?void 0:o.filter((e=>{var t;const a=null===e||void 0===e||null===(t=e.workStatus)||void 0===t?void 0:t.toUpperCase();return"TERMINATION"!==a&&"RESIGNATION"!==a}));const R=null===Math||void 0===Math?void 0:Math.ceil((null===(d=C)||void 0===d?void 0:d.length)/30),P=null===(c=C)||void 0===c?void 0:c.slice(30*(I-1),30*I),O=e=>{e>=1&&e<=R&&k(e)},_=["Probation Review","Probation Form Update","Recruitment & Mobilization","Contract Expiry Review","Contract Expiry Form Update"].includes(h);return(0,i.jsxs)("div",{className:"w-full px-7 bg-[#F5F6F1CC]",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 ",children:[(0,i.jsx)(r.N_,{to:"/reports",className:"text-xl flex-1 text-grey ",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)("h1",{className:"text-xl flex  font-bold center my-10 uppercase ",children:h})}),(0,i.jsxs)("div",{className:"text-center flex flex-col flex-1 gap-4 items-end relative",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search",value:A,onChange:e=>{w(e.target.value),k(1)},className:"outline-none rounded-lg px-4 py-2 shadow-md border border-[#C5C5C5] text-grey"}),(0,i.jsx)("div",{className:" absolute right-3 top-2 bg-white text-[24px]",children:(0,i.jsx)(j.zfp,{})})]})]}),(0,i.jsxs)("div",{className:"flex justify-between items-end w-full",children:["Probation Form Update"!==h&&"Contract Expiry Form Update"!==h&&(0,i.jsxs)("div",{className:"flex justify-center items-center gap-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("input",{id:"start-date",type:"date",onChange:e=>g(e,"startDate"),className:"outline-none text-grey border rounded-md p-2"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("input",{id:"end-date",type:"date",onChange:e=>g(e,"endDate"),className:"outline-none text-grey border rounded-md p-2"})]})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("label",{className:"block text-[16px] font-medium",children:"Department"}),(0,i.jsxs)("select",{value:S,onChange:e=>{E(e.target.value),k(1)},className:"outline-none rounded-lg p-2 shadow-md border border-[#8a8888] text-grey select-custom w-[200px] select-filter",children:[(0,i.jsx)("option",{value:"",children:"All Departments"}),null===T||void 0===T?void 0:T.map(((e,t)=>(0,i.jsx)("option",{value:e.value,children:e.label},t)))]})]}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("button",{onClick:()=>{const e=e=>e.replace(/([A-Z])/g," $1").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").toUpperCase(),t=["headStatus","hrmStatus","gmStatus","matchedID","oldCED","probID","probCreatedAt","probExtendStatus","prevProbExDate"],a=C.map((a=>{const r={};for(const[n,s]of Object.entries(a)){if(t.includes(n))continue;const i=e(n);r[i]="contractEndDate"===n?a.oldCED||"N/A":Array.isArray(s)?s.length>0?s.join(", "):"N/A":""!==(null!==s&&void 0!==s?s:"")?s:"N/A"}return r})),r=new(hi().Workbook),n=r.addWorksheet(h),s=n.addRow([h]);s.font={bold:!0,size:16},s.alignment={horizontal:"center",vertical:"middle"},n.mergeCells(1,1,1,Object.keys(a[0]).length);const i=[];f?i.push("Start Date: ".concat(y(f))):i.push("Start Date: Not Provided"),v?i.push("End Date: ".concat(y(v))):i.push("End Date: Not Provided"),n.addRow(i),n.addRow([]);const l=Object.keys(a[0]).map(e);n.addRow(l),a.forEach((e=>{n.addRow(Object.values(e))}));n.getRow(4).eachCell((e=>{e.font={bold:!0,color:{argb:"FFFFFFFF"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF808080"}},e.alignment={horizontal:"center",vertical:"middle",wrapText:!0}})),n.eachRow(((e,t)=>{e.eachCell((e=>{e.alignment={wrapText:!0,vertical:"top"}}))})),n.columns.forEach((e=>{let t=0;e.eachCell({includeEmpty:!0},(e=>{const a=e.value?e.value.toString():"";t=Math.max(t,a.length)})),e.width=t+2})),r.xlsx.writeBuffer().then((e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,xi.saveAs)(t,"".concat(h,".xlsx"))}))},className:"bg-[#FEF116] text-dark_grey w-[126px] p-3 rounded",children:"Download"})})]}),(null===P||void 0===P?void 0:P.length)>0?(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"w-full overflow-x-auto overflow-y-auto h-[500px] shadow-lg my-5",children:(0,i.jsxs)("table",{className:" border-collapse w-full",children:[(0,i.jsx)("thead",{className:"w-full sticky top-0",children:(0,i.jsx)("tr",{className:"bg-[#939393] rounded-sm",children:u.map(((e,t)=>(0,i.jsx)("th",{className:"px-6 py-5 text-[15px] text-white w-full",children:(0,i.jsx)("span",{className:"w-[120px] center uppercase",children:e})},t)))})}),(0,i.jsx)("tbody",{className:"bg-white",children:P.map(((e,t)=>(0,i.jsx)("tr",{className:"text-sm border-b-2 border-[#CECECE] ".concat(_?"hover:bg-gray-100 cursor-pointer":""),onClick:()=>_&&x(e),children:Object.entries(e).filter((e=>{let[t]=e;return"probExtendStatus"!==t&&"prevProbExDate"!==t&&"probCreatedAt"!==t&&"empInfoId"!==t&&"probID"!==t&&"workInfoId"!==t&&"headStatus"!==t&&"hrmStatus"!==t&&"gmStatus"!==t&&"contractEndDate"!==t&&"matchedID"!==t})).map(((e,t)=>{let[a,r]=e;const n="expAndValid"===a&&"EXPIRED"===r,s=null==r?"N/A":Array.isArray(r)?"".concat(r[r.length-1]):"".concat(r);return(0,i.jsx)("td",{className:"font-semibold border-b-2 text-center uppercase border-[#CECECE] p-2 ".concat(n?"text-[red]":""," ").concat("status"===a?"approved"===(null===r||void 0===r?void 0:r.toLowerCase())?"text-[#339933]":"reject"===(null===r||void 0===r?void 0:r.toLowerCase())?"text-[red]":"pending"===(null===r||void 0===r?void 0:r.toLowerCase())?"text-[#E8A317]":"extended"===(null===r||void 0===r?void 0:r.toLowerCase())?"text-[#339933]":"not extended"===(null===r||void 0===r?void 0:r.toLowerCase())?"text-[#E8A317]":"":""),children:s},t)}))},t)))})]})})}):0===(null===(p=C)||void 0===p?void 0:p.length)&&(f||v)?(0,i.jsx)("div",{className:"text-center mt-10",children:"No data available on this date range"}):(0,i.jsx)("div",{className:"text-center mt-10",children:"No Report List Available Here"}),(0,i.jsx)("div",{className:"flex justify-center w-full my-5",children:(0,i.jsx)("div",{className:"flex justify-center gap-6 w-3/5 items-center",children:R>1&&(0,i.jsxs)("div",{className:"flex justify-center gap-4 my-4",children:[(0,i.jsxs)("button",{onClick:()=>O(I-1),disabled:1===I,className:"flex items-center gap-2 border border-[#5A5858] text-sm text-dark_grey rounded-lg hover:bg-gray-200 px-5 py-2 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200",children:[(0,i.jsx)(Tt.QVr,{className:"text-[16px]"}),(0,i.jsx)("span",{children:"Previous"})]}),(()=>{const e=[];if(R<=4)for(let t=1;t<=R;t++)e.push(t);else{let t=Math.max(I-1,1),a=t+3;a>R&&(a=R,t=Math.max(a-3,1));for(let r=t;r<=a;r++)e.push(r)}return e})().map((e=>(0,i.jsx)("button",{onClick:()=>O(e),className:"w-8 h-8 p-4 flex items-center justify-center text-sm font-medium rounded-full ".concat(I===e?"bg-[indigo] shadow-md text-white":"bg-gray-200 text-dark_grey"),children:e},e))),(0,i.jsxs)("button",{onClick:()=>O(I+1),disabled:I===R,className:"flex items-center gap-2 border border-[#5A5858] text-sm text-dark_grey rounded-lg  px-5 py-2 ",children:[(0,i.jsx)("span",{children:"Next"}),(0,i.jsx)(Tt.Z0P,{className:"text-[16px]"})]})]})})})]})},Zl=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)(null),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[g]=(0,n.useState)(["Emp ID","Badge No","Name","Gender","Date of Birth","Date of Join","Nationality","Position","Other Position","Department","Other Department","Contact No","Type of Application: Local/LPA/SAWP","EMPLOYEE REQUISITION FORM APPROVAL DATE","CV Received From","Brunei I/C No","Brunei I/C Expiry","Malaysian IC No","Passport No","Passport Expiry","Employee Pass Expiry","INTERVIEW DATE","DATE OF LOI ISSUED","DATE OF LOI ACCEPTANCE","CVEV APPROVAL DATE","PAAF APPROVAL DATE","DATE REQUESTED FOR CLIENT'S SUPPORT LETTER","DATE RECEIVED FROM CLIENT","DATE SUBMITTED TO DOE","DATE APPROVED BY DOE","DOE VALIDITY DATE","DOE REFERENCE NUMBER","DATE SUBMITTED TO LD","LD SUBMISSION REF NO","LD APPROVED DATE","LD REFERENCE NUMBER","BG SUBMITTED DATE","BG RECEIVED DATE","DATE PURCHASED FROM TBA FOR JITPA","BG NO.","BG AMT","JITPA AMT","LABOUR DEP NO.","LABOUR DEP AMT","DATE ENDORSEMENT OF BG","DATE ENDROSEMENT OF JITPA","DATE ENDROSEMENT OF LABOUR","DATE SUBMITTED TO IMMIGRATION","DATE APPROVED BY IMMIGRATION","VISA REFERENCE NUMBER","MOBILIZATION DATE","MOBILIZATION DESTINATION FOR NON-LOCAL","MOBILIZATION AIRFARE","REMARKS FOR RECRUITMENT","View All Details"]),f=e=>{if(!e)return"-";const t=new Date(e);if(isNaN(t.getTime()))return"-";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},v=e=>{const t=e.filter((e=>e.doj)).sort(((e,t)=>new Date(t.doj)-new Date(e.doj))).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",gender:e.gender||"-",dateOfBirth:f(e.dob)||"-",dateOfJoin:f(e.doj)||"-",nationality:e.nationality||"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",contactNo:e.contactNo||"-",contractType:e.contractType||"-",requisiationApr:"-",agent:e.agent||"-",BruneiIcNo:e.bwnIcNo||"-",BruneiIcExpiry:Array.isArray(e.bwnIcExpiry)?f(e.bwnIcExpiry[e.bwnIcExpiry.length-1]):"-",MalaysianIcNo:e.myIcNo||"-",PassportNo:e.ppNo||"-",PassportExpiry:Array.isArray(e.ppExpiry)?f(e.ppExpiry[e.ppExpiry.length-1]):"-",employeePassExpiry:Array.isArray(e.empPassExp)?f(e.empPassExp[e.empPassExp.length-1]):"-",interDate:f(e.interDate)||"-",loiIssueDate:f(e.loiIssueDate)||"-",loiAcceptDate:f(e.loiAcceptDate)||"-",cvecApproveDate:f(e.cvecApproveDate)||"-",paafApproveDate:f(e.paafApproveDate)||"-",sawpDate:f(e.sawpDate)||"-",sawpRecivedDate:f(e.sawpRecivedDate)||"-",doesubmitdate:f(e.doesubmitdate)||"-",doeapprovedate:f(e.doeapprovedate)||"-",doeexpirydate:f(e.doeexpirydate)||"-",doerefno:e.doerefno||"-",nlmssubmitdate:f(e.nlmssubmitdate)||"-",submissionrefrenceno:e.submissionrefrenceno||"-",nlmsapprovedate:f(e.nlmsapprovedate)||"-",ldreferenceno:e.ldreferenceno||"-",bgsubmitdate:f(e.bgsubmitdate)||"-",bgreceivedate:f(e.bgreceivedate)||"-",tbapurchasedate:f(e.tbapurchasedate)||"-",referenceno:e.referenceno||"-",bgamount:e.bgamount||"-",jitpaamount:e.jitpaamount||"-",lbrDepoNum:e.lbrDepoNum||"-",lbrDepoAmount:e.lbrDepoAmount||"-",missingsubmitdateendorsement:f(e.missingSubmitdateendorsement)||"-",submitdateendorsement:f(e.submitdateendorsement)||"-",lbrEndroseDate:f(e.lbrEndroseDate)||"-",docsubmitdate:f(e.docsubmitdate)||"-",visaapprovedate:f(e.visaapprovedate)||"-",visareferenceno:e.visareferenceno||"-",mobSignDate:f(e.mobSignDate)||"-",cityname:e.cityname||"-",airfare:e.airfare||"-",remarkNLMob:e.remarkNLMob||"-"})));return console.log(e.interDate),t};(0,n.useEffect)((()=>{t&&d(v(t))}),[t]);return(0,i.jsxs)("div",{children:[(0,i.jsx)($l,{tableBody:c.length?c:o,tableHead:g,title:a,startDate:m,endDate:h,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&u(r),"endDate"===a&&x(r);const n="startDate"===a?new Date(r):m?new Date(m):null,s="endDate"===a?new Date(r):h?new Date(h):null,i=t.filter((e=>{const t=e.doj?new Date(e.doj):null;return!(!t||isNaN(t.getTime()))&&(n&&s?t>=n&&t<=s:n?t>=n:!s||t<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",gender:e.gender||"-",dateOfBirth:f(e.dob)||"-",dateOfJoin:f(e.doj)||"-",nationality:e.nationality||"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",contactNo:e.contactNo||"-",contractType:e.contractType||"-",requisiationApr:"-",agent:e.agent||"-",BruneiIcNo:e.bwnIcNo||"-",BruneiIcExpiry:Array.isArray(e.bwnIcExpiry)?f(e.bwnIcExpiry[e.bwnIcExpiry.length-1]):"-",MalaysianIcNo:e.myIcNo||"-",PassportNo:e.ppNo||"-",PassportExpiry:Array.isArray(e.ppExpiry)?f(e.ppExpiry[e.ppExpiry.length-1]):"-",employeePassExpiry:Array.isArray(e.empPassExp)?f(e.empPassExp[e.empPassExp.length-1]):"-",interDate:f(e.interDate)||"-",loiIssueDate:f(e.loiIssueDate)||"-",loiAcceptDate:f(e.loiAcceptDate)||"-",cvecApproveDate:f(e.cvecApproveDate)||"-",paafApproveDate:f(e.paafApproveDate)||"-",sawpDate:f(e.sawpDate)||"-",sawpRecivedDate:f(e.sawpRecivedDate)||"-",doesubmitdate:f(e.doesubmitdate)||"-",doeapprovedate:f(e.doeapprovedate)||"-",doeexpirydate:f(e.doeexpirydate)||"-",doerefno:e.doerefno||"-",nlmssubmitdate:f(e.nlmssubmitdate)||"-",submissionrefrenceno:e.submissionrefrenceno||"-",nlmsapprovedate:f(e.nlmsapprovedate)||"-",ldreferenceno:e.ldreferenceno||"-",bgsubmitdate:f(e.bgsubmitdate)||"-",bgreceivedate:f(e.bgreceivedate)||"-",tbapurchasedate:f(e.tbapurchasedate)||"-",referenceno:e.referenceno||"-",bgamount:e.bgamount||"-",jitpaamount:e.jitpaamount||"-",lbrDepoNum:e.lbrDepoNum||"-",lbrDepoAmount:e.lbrDepoAmount||"-",missingSubmitdateendorsement:f(e.missingSubmitdateendorsement)||"-",submitdateendorsement:f(e.submitdateendorsement)||"-",lbrEndroseDate:f(e.lbrEndroseDate)||"-",docsubmitdate:f(e.docsubmitdate)||"-",visaapprovedate:f(e.visaapprovedate)||"-",visareferenceno:e.visareferenceno||"-",mobSignDate:f(e.mobSignDate)||"-",cityname:e.cityname||"-",airfare:e.airfare||"-",remarkNLMob:e.remarkNLMob||"-"})));p(i)},handleViewDetails:e=>{const a=t.find((t=>t.empID===e.empID));l(a?v([a]):null)}}),s&&(0,i.jsx)("div",{className:"fixed inset-0 center z-50 bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-1/2 max-h-[80vh] overflow-y-auto scrollBar",children:[(0,i.jsxs)("section",{className:"flex justify-between gap-10 items-center mb-5",children:[(0,i.jsx)("div",{className:"w-full flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[200px]",src:Se.A,alt:"Logo"})}),(0,i.jsx)("button",{className:"text-[24px] rounded",onClick:()=>{l(null)},children:(0,i.jsx)(A.RQJ,{})})]}),(0,i.jsx)("h2",{className:"text-xl font-semibold underline text-center mb-5",children:"Recruitment & Mobilization"}),s[0]&&(0,i.jsx)("div",{className:"flex flex-col  px-10",children:(0,i.jsx)("div",{children:Object.entries(s[0]).map((e=>{let[t,a]=e;return(0,i.jsxs)("div",{className:"flex ",children:[(0,i.jsx)("p",{className:"py-2 text-[14px] font-bold flex-1",children:(r=t,r.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^\w/,(e=>e.toUpperCase())))}),(0,i.jsx)("p",{className:"py-2 px-10",children:":"}),(0,i.jsx)("p",{className:"py-2 flex-1 text-[14px] break-words overflow-hidden w-full",children:a})]},t);var r}))})})]})})]})},Xl=["rawResignDate"],eo=["rawResignDate"],to=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(["Emp ID","Badge No","Name","Date of join","Nationality","Department","Other Department","Position","Other Position","Date of Resignation","Reason of Resignation"]),g=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return g(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)};(0,n.useEffect)((()=>{const e=(e=>null===e||void 0===e?void 0:e.filter((e=>null===e||void 0===e?void 0:e.resignDate)).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:((t,a,r,n)=>{const s=new Date,i=null===(t=e.positionRevDate)||void 0===t?void 0:t[e.positionRevDate.length-1],l=null===(a=e.positionRev)||void 0===a?void 0:a[e.positionRev.length-1],o=null===(r=e.upgradePosition)||void 0===r?void 0:r[e.upgradePosition.length-1],d=null===(n=e.upgradeDate)||void 0===n?void 0:n[e.upgradeDate.length-1];let c;const p=i?new Date(i):null,m=d?new Date(d):null;var u;if(p&&m){if(p.toDateString()===m.toDateString())c=null===(u=e.position)||void 0===u?void 0:u[e.position.length-1];else if(p>m){var h;c=s>=p?l:s>=m?o:null===(h=e.position)||void 0===h?void 0:h[e.position.length-1]}else if(m>p){var x;c=s>=m?o:s>=p?l:null===(x=e.position)||void 0===x?void 0:x[e.position.length-1]}}else if(p&&!m)c=s>=p&&l;else if(m&&!p)c=s>=m&&o;else{var g;c=null===(g=e.position)||void 0===g?void 0:g[e.position.length-1]}return c||"-"})(),otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",resignDate:g(e.resignDate)||"-",rawResignDate:new Date(e.resignDate),reasonResign:e.reasonResign||"-"}))).sort(((e,t)=>e.rawResignDate-t.rawResignDate)).map((e=>{let{rawResignDate:t}=e;return(0,is.A)(e,Xl)})))(t);l(e)}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,startDate:c,endDate:m,title:a,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{const t=e.resignDate?new Date(e.resignDate):null;return!(!t||isNaN(t.getTime()))&&(n&&s?t>=n&&t<=s:n?t>=n:!s||t<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:((t,a,r,n)=>{const s=new Date,i=null===(t=e.positionRevDate)||void 0===t?void 0:t[e.positionRevDate.length-1],l=null===(a=e.positionRev)||void 0===a?void 0:a[e.positionRev.length-1],o=null===(r=e.upgradePosition)||void 0===r?void 0:r[e.upgradePosition.length-1],d=null===(n=e.upgradeDate)||void 0===n?void 0:n[e.upgradeDate.length-1];let c;const p=i?new Date(i):null,m=d?new Date(d):null;var u;if(p&&m){if(p.toDateString()===m.toDateString())c=null===(u=e.position)||void 0===u?void 0:u[e.position.length-1];else if(p>m){var h;c=s>=p?l:s>=m?o:null===(h=e.position)||void 0===h?void 0:h[e.position.length-1]}else if(m>p){var x;c=s>=m?o:s>=p?l:null===(x=e.position)||void 0===x?void 0:x[e.position.length-1]}}else if(p&&!m)c=s>=p&&l;else if(m&&!p)c=s>=m&&o;else{var g;c=null===(g=e.position)||void 0===g?void 0:g[e.position.length-1]}return c||"-"})(),otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",resignDate:g(e.resignDate)||"-",rawResignDate:new Date(e.resignDate),reasonResign:e.reasonResign||"-"}))).sort(((e,t)=>e.rawResignDate-t.rawResignDate)).map((e=>{let{rawResignDate:t}=e;return(0,is.A)(e,eo)}));d(i)}})})},ao=()=>((0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,i.jsxs)("section",{className:"min-h-screen p-10 bg-[#F5F6F1CC] flex flex-col gap-16",children:[(0,i.jsx)("div",{className:"w-full flex items-center justify-between gap-5",children:(0,i.jsx)(r.N_,{to:"/training",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(la.QVr,{})})}),(0,i.jsxs)("div",{className:" flex gap-16",children:[(0,i.jsx)(F,{img:U,text1:"Add",fontSize:"text_size_5 ",borderColor:"border-[#7DA2F2]",bgColor:"bg-white",link:"/trainingReq/add"}),(0,i.jsx)(F,{img:L,text1:"VIEW",fontSize:"text_size_5 ",borderColor:"border-[#B240FF]",bgColor:"bg-white",link:"/trainingReq/view"})]})]})),ro=()=>{const{empPIData:e,trainingCertifi:t,AddEmpReq:a,workInfoData:l}=(0,n.useContext)(s.Y),[o,d]=(0,n.useState)(""),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)([]),[f,v]=(0,n.useState)(!0),[y,N]=(0,n.useState)(null),b={trainCertifi:[{header:"Employee ID",key:"empID"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Purchase Order",key:"poNo"},{header:"Start Date",key:"traineeSD"},{header:"End Date",key:"traineeED"},{header:"Certificate Expiry",key:"certifiExpiry"},{header:"E-certificate Date",key:"eCertifiDate"}]},D=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)};(0,n.useEffect)((()=>{if(e&&l&&t&&a){const r=e.map((e=>{const r=a.find((t=>t.empID===e.empID)),n=l.find((t=>t.empID===e.empID)),s=t.find((t=>t.empID===e.empID));return s&&null!==s&&void 0!==s&&s.createdAt?(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),n),s),{},{CertifyCreatedAt:null===s||void 0===s?void 0:s.createdAt}):null})).filter((e=>null!==e)).sort(((e,t)=>e.empID.localeCompare(t.empID))).filter((e=>{const t=Array.isArray(e.department)?e.department:[];return"blng"===(t.length>0&&"string"===typeof t[t.length-1]?t[t.length-1].trim().toLowerCase():"")}));u(r),x(r),v(!1)}else N("Data not fully available."),v(!1)}),[e,l,t,a]);const j=(e,t)=>{const a=e.target.value;"startDate"===t&&d(a),"endDate"===t&&p(a);const r="startDate"===t?new Date(a):o?new Date(o):null,n="endDate"===t?new Date(a):c?new Date(c):null,s=m.filter((t=>{let a=null,s=null;try{if(t.traineeTrack&&t.traineeTrack.length>0){const e=t.traineeTrack[t.traineeTrack.length-1],r=A(e);if(Array.isArray(r)){const e=r[r.length-1];null!==e&&void 0!==e&&e.traineeSD&&(a=new Date(e.traineeSD)),null!==e&&void 0!==e&&e.traineeED&&(s=new Date(e.traineeED))}else r.traineeSD&&(a=new Date(r.traineeSD)),r.traineeED&&(s=new Date(r.traineeED))}}catch(e){console.error("Error parsing traineeTrack:",e)}return!(!a||!s)&&(r&&n?a>=r&&s<=n:r?a>=r&&s>=r:!n||a<=n&&s<=n)}));x(s)},A=e=>{try{let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(y){return console.error("Error normalizing traineeTrackData:",y),[]}},w=h.sort(((e,t)=>new Date(t.CertifyCreatedAt)-new Date(e.CertifyCreatedAt))).map((e=>{let t="N/A",a="N/A",r="N/A",n="N/A",s="N/A",i="N/A";try{if(e.trainingProof&&e.trainingProof){const s=A(e.trainingProof);let i=s;Array.isArray(s)&&(i=s[s.length-1]),i&&(t=i.certifiExpiry?D(i.certifiExpiry):"N/A",a=i.eCertifiDate?D(i.eCertifiDate):"N/A",r=i.orgiCertifiDate?D(i.orgiCertifiDate):"N/A",n=i.poNo||"N/A")}else console.log("No valid trainingProof found for this entry.");if(e.traineeTrack&&e.traineeTrack){const t=A(e.traineeTrack);let a=t;Array.isArray(t)&&(a=t[t.length-1]),a&&(s=a.traineeSD?D(a.traineeSD):"N/A",i=a.traineeED?D(a.traineeED):"N/A")}else console.log("No valid traineeTrack found for this entry.")}catch(l){console.error("Error parsing trainingProof or traineeTrack:",l)}return(0,g.A)((0,g.A)({},e),{},{empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",certifiExpiry:t,eCertifiDate:a,orgiCertifiDate:r,poNo:n,traineeSD:s,traineeED:i,department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-"})}));return(0,i.jsxs)("section",{className:"bg-[#F8F8F8] mx-auto p-5 h-full w-full",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 my-5 ",children:[(0,i.jsx)(r.N_,{to:"/training",className:"text-xl  text-grey",children:(0,i.jsx)(la.QVr,{})}),(0,i.jsx)("article",{className:"flex-1 flex gap-5 text-dark_grey justify-center",children:(0,i.jsx)("h1",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"BLNG Training Certificates"})})]}),(0,i.jsx)("div",{className:"px-4 relative ",children:(0,i.jsx)("div",{className:"absolute z-20 top-3 flex items-center gap-5",children:(0,i.jsxs)("div",{className:" flex items-center  gap-5 w-full ",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("input",{id:"start-date",type:"date",value:o,onChange:e=>j(e,"startDate"),className:"outline-none text-grey border rounded-md p-2"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("input",{id:"end-date",type:"date",value:c,onChange:e=>j(e,"endDate"),className:"outline-none text-grey border rounded-md p-2"})]})]})})}),(0,i.jsx)(Ml,{mergering:w,columns:null===b||void 0===b?void 0:b.trainCertifi,popupAll:[{header:"Employee ID",key:"empID"},{header:"Employee Badge No",key:"empBadgeNo"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Position",key:"position"}]})]})},no=()=>((0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]),(0,i.jsxs)("section",{className:"min-h-screen p-10 bg-[#F5F6F1CC] flex flex-col gap-16",children:[(0,i.jsx)("div",{className:"w-full flex items-center justify-between gap-5",children:(0,i.jsx)(r.N_,{to:"/training",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(la.QVr,{})})}),(0,i.jsxs)("div",{className:" flex gap-16",children:[(0,i.jsx)(F,{img:U,text1:"Add Course",fontSize:"text_size_5 ",borderColor:"border-[#7DA2F2]",bgColor:"bg-white",link:"/training/AcTc"}),(0,i.jsx)(F,{img:U,text1:"Training Certificate",fontSize:"text_size_5 ",borderColor:"border-[#7DA2F2]",bgColor:"bg-white",link:"/training/trainingCertify"}),(0,i.jsx)(F,{img:L,text1:"Head Office",fontSize:"text_size_5 ",borderColor:"border-[#B240FF]",bgColor:"bg-white",link:"/training/tcView"})]})]})),so=()=>{const{empPIData:e,trainingCertifi:t,AddEmpReq:a,workInfoData:l}=(0,n.useContext)(s.Y),[o,d]=(0,n.useState)(""),[c,p]=(0,n.useState)(""),m={trainCertifi:[{header:"Employee ID",key:"empID"},{header:"Employee Badge No",key:"empBadgeNo"},{header:"Name",key:"name"},{header:"Purchase Order",key:"poNo"},{header:"Start Date",key:"traineeSD"},{header:"End Date",key:"traineeED"},{header:"Certificate Expiry",key:"certifiExpiry"},{header:"E-certificate Date",key:"eCertifiDate"},{header:"Original Certificate Date",key:"orgiCertifiDate"}]},u=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"N/A";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)},[h,x]=(0,n.useState)([]),[f,v]=(0,n.useState)([]),[y,N]=(0,n.useState)(!0),[b,D]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(e&&l&&t&&a){const r=e.map((e=>{const r=a.find((t=>t.empID===e.empID)),n=l.find((t=>t.empID===e.empID)),s=t.find((t=>t.empID===e.empID));return s&&null!==s&&void 0!==s&&s.createdAt?(0,g.A)((0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),n),s),{},{CertifyCreatedAt:null===s||void 0===s?void 0:s.createdAt}):null})).filter((e=>null!==e)).sort(((e,t)=>e.empID.localeCompare(t.empID))).filter((e=>{const t=Array.isArray(e.department)?e.department:[],a=t.length>0&&"string"===typeof t[t.length-1]?t[t.length-1].trim().toLowerCase():"";return"blng"!==a&&"offshore"!==a}));x(r),v(r),N(!1)}else D("Data not fully available."),N(!1)}),[e,l,t,a]);const j=(e,t)=>{const a=e.target.value;"startDate"===t&&d(a),"endDate"===t&&p(a);const r="startDate"===t?new Date(a):o?new Date(o):null,n="endDate"===t?new Date(a):c?new Date(c):null,s=h.filter((t=>{let a=null,s=null;try{if(t.traineeTrack&&t.traineeTrack.length>0){const e=t.traineeTrack[t.traineeTrack.length-1],r=A(e);if(Array.isArray(r)){const e=r[r.length-1];null!==e&&void 0!==e&&e.traineeSD&&(a=new Date(e.traineeSD)),null!==e&&void 0!==e&&e.traineeED&&(s=new Date(e.traineeED))}else r.traineeSD&&(a=new Date(r.traineeSD)),r.traineeED&&(s=new Date(r.traineeED))}}catch(e){console.error("Error parsing traineeTrack:",e)}return!(!a||!s)&&(r&&n?a>=r&&s<=n:r?a>=r&&s>=r:!n||a<=n&&s<=n)}));console.log(s),v(s)},A=e=>{try{let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(b){return console.error("Error normalizing traineeTrackData:",b),[]}},w=f.sort(((e,t)=>new Date(t.CertifyCreatedAt)-new Date(e.CertifyCreatedAt))).map((e=>{let t="N/A",a="N/A",r="N/A",n="N/A",s="N/A",i="N/A";try{if(e.trainingProof&&e.trainingProof){const s=A(e.trainingProof);let i=s;Array.isArray(s)&&(i=s[s.length-1]),i&&(t=i.certifiExpiry?u(i.certifiExpiry):"N/A",a=i.eCertifiDate?u(i.eCertifiDate):"N/A",r=i.orgiCertifiDate?u(i.orgiCertifiDate):"N/A",n=i.poNo||"N/A")}else console.log("No valid trainingProof found for this entry.");if(e.traineeTrack&&e.traineeTrack){const t=A(e.traineeTrack);let a=t;Array.isArray(t)&&(a=t[t.length-1]),a&&(s=a.traineeSD?u(a.traineeSD):"N/A",i=a.traineeED?u(a.traineeED):"N/A")}else console.log("No valid traineeTrack found for this entry.")}catch(l){console.error("Error parsing trainingProof or traineeTrack:",l)}return(0,g.A)((0,g.A)({},e),{},{empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",certifiExpiry:t,eCertifiDate:a,orgiCertifiDate:r,poNo:n,traineeSD:s,traineeED:i,department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-"})}));return(0,i.jsxs)("section",{className:"bg-[#F8F8F8] mx-auto p-5 h-full w-full",children:[(0,i.jsxs)("div",{className:"w-full flex items-center justify-between gap-5 my-5",children:[(0,i.jsx)(r.N_,{to:"/training/hr",className:"text-xl text-grey",children:(0,i.jsx)(la.QVr,{})}),(0,i.jsx)("article",{className:"flex-1 flex gap-5 text-dark_grey justify-center",children:(0,i.jsx)("h1",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"View Training Certificates"})})]}),(0,i.jsx)("div",{className:"px-4 relative",children:(0,i.jsx)("div",{className:"absolute z-20 top-3 flex items-center gap-5",children:(0,i.jsxs)("div",{className:"flex items-center gap-5 w-full",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("input",{id:"start-date",type:"date",value:o,onChange:e=>j(e,"startDate"),className:"outline-none text-grey border rounded-md p-2"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("input",{id:"end-date",type:"date",value:c,onChange:e=>j(e,"endDate"),className:"outline-none text-grey border rounded-md p-2"})]})]})})}),(0,i.jsx)(Ml,{mergering:w,columns:null===m||void 0===m?void 0:m.trainCertifi,popupAll:[{header:"Employee ID",key:"empID"},{header:"Employee Badge No",key:"empBadgeNo"},{header:"Name",key:"name"},{header:"Department",key:"department"},{header:"Position",key:"position"}]})]})};var io=a(4791),lo=a(940);var oo=a(3701);const co=()=>{const{empPIData:e,workInfoData:t,trainingCertifi:a,AddEmpReq:l}=(0,n.useContext)(s.Y);(0,n.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[]);const{TCData:o}=(0,io.Z)(),{TCDataFunUp:d}=(0,lo.P)(),{formattedPermissions:c}=qt(),[p,m]=(0,n.useState)(!1),[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[v,y]=(0,n.useState)([]),[N,b]=(0,n.useState)([]),[A,w]=(0,n.useState)([]),[S,E]=(0,n.useState)(""),I=localStorage.getItem("userID"),[k,T]=(0,n.useState)(!1),{register:C,handleSubmit:R,setValue:P,watch:O,control:_,reset:M,getValues:F,formState:{errors:L}}=(0,tt.mN)({resolver:(0,at.t)(vi),defaultValues:{trainingProof:[{courseCode:"",courseName:"",company:"",certifiExpiry:"",eCertifiDate:"",orgiCertifiDate:"",traineeSD:"",traineeED:"",poNo:"",addDescretion:[],tcRemarks:""}]}}),[U,B]=(0,n.useState)({trainingUpCertifi:!1}),[q,H]=(0,n.useState)({trainingUpCertifi:[]}),[W,z]=(0,n.useState)({}),[Y,V]=(0,n.useState)({});(0,n.useEffect)((()=>{(async()=>{try{const r=e.map((e=>{const r=t?t.find((t=>t.empID===e.empID)):{},n=a?a.find((t=>t.empID===e.empID)):{},s=l?l.find((t=>t.empID===e.empID)):{};return(0,g.A)((0,g.A)((0,g.A)((0,g.A)({},e),r),n),s)})).filter(Boolean);y(r),b(r)}catch(r){console.log(r)}})()}),[e,t,a,l]);const{fields:G,append:J,remove:K}=(0,tt.jz)({control:_,name:"trainingProof"}),Q=O("empID"),$=async(e,t,a)=>{if(!Q)return alert("Please enter the Employee ID before uploading files."),void(window.location.href="/training/trainingCertify");const r=e.target.files[0];if(!r)return;if(["application/pdf","image/jpeg","image/png","image/jpg"].includes(r.type)){P("trainingProof[".concat(a,"].trainingUpCertifi"),r);try{n=t,s=!0,i=a,B((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(i,"_").concat(n)]:s}))),await ct(r,t,H,Q,a),z((e=>(0,g.A)((0,g.A)({},e),{},{["".concat(a,"_").concat(t)]:[r.name]})))}catch(l){console.log(l)}var n,s,i}else alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")},Z=()=>{m(!p)},X=e=>{try{let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(t){return console.error("Error normalizing traineeTrackData:",t),[]}},ee=()=>{J({department:"",courseCode:"",courseName:"",company:"",certifiExpiry:"",eCertifiDate:"",orgiCertifiDate:"",traineeSD:"",traineeED:"",poNo:"",addDescretion:[],tcRemarks:""})},te=async(e,t,a,r)=>{try{if(!Q)return void alert("Please provide the Employee ID before deleting files.");const a=await(0,_a.k)(e,t,Q),r=await((e,t,a,r,n,s)=>{try{r((a=>{const r=(0,g.A)({},a);return Array.isArray(r[e])?r[e]=r[e].filter((e=>e!==t)):"string"===typeof r[e]&&r[e]===t&&(r[e]=[]),r[e]&&0!==r[e].length||(r[e]=[]),r})),n((r=>{const n=(0,g.A)({},r);return Array.isArray(n[e])&&(n[e]=n[e].filter((r=>r.upload!=="public/".concat(e,"/").concat(a,"/").concat(t))),n[e]&&0!==n[e].length||(n[e]=[])),n})),s((t=>(0,g.A)((0,g.A)({},t),{},{[e]:!1})))}catch(i){console.log(i,"deletedarrayUpload in employe info")}})(e,t,Q,z,V,H);if(!a)return void console.error("Failed to delete file: ".concat(t,", dynamodb."));if(r)return void console.error("Failed to delete file: ".concat(t,", skipping UI update."));h("".concat(t)),Z()}catch(n){console.error("Error deleting file:",n),alert("Error processing the file deletion.")}},ae=["HR"];return(0,i.jsxs)("section",{className:"bg-[#F8F8F8] p-10 center flex-col w-full",children:[(0,i.jsxs)("div",{className:" w-full flex items-center justify-center gap-5 my-10",children:[(0,i.jsx)(r.N_,{to:"/training/hr",className:"text-xl flex-1 text-grey",children:(0,i.jsx)(la.QVr,{})}),(0,i.jsx)("article",{className:"w-full  center gap-5 text-dark_grey ",children:(0,i.jsx)("p",{className:"text-center mt-2 text_size_2 relative after:absolute after:w-full after:h-1 after:bg-primary after:-bottom-2 after:left-0",children:"Training Certificates"})})]}),(0,i.jsxs)("div",{className:"mt-16 mb-16 w-full rounded-md bg-white px-20 py-10",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("div",{className:"mt-6",children:(0,i.jsx)(ea,{searchResult:e=>{if(e&&T(!0),!e)return void console.warn("Search result is undefined or null");["empID","empBadgeNo","name"].forEach((t=>{const a=e[t]||null;P(t,a)}));const t=e=>{if(!e)return null;let t;t="string"===typeof e&&/^\d{2}-\d{2}-\d{4}$/.test(e)?(0,oo.qg)(e,"MM-dd-yyyy",new Date):new Date(e);return isNaN(t)?null:(0,D.GP)(t,"yyyy-MM-dd")};["department","position"].forEach((t=>{let a=(r=e[t],(Array.isArray(r)&&r.length?r[r.length-1]:r)||null);var r;P(t,a)}));const a=null===e||void 0===e?void 0:e.trainingProof,r=null===e||void 0===e?void 0:e.traineeTrack;if(a&&r)try{const e=X(a),n=X(r);Array.isArray(n)&&n.forEach(((e,t)=>{e.courseName&&P("courseName",e.courseName),e.courseCode&&P("courseCode",e.courseCode),e.company&&P("company",e.company)})),e.forEach(((e,a)=>{if(e.certifiExpiry&&P("certifiExpiry",t(e.certifiExpiry)),e.eCertifiDate&&P("eCertifiDate",t(e.eCertifiDate)),e.orgiCertifiDate&&P("orgiCertifiDate",t(e.orgiCertifiDate)),e.poNo&&P("poNo",e.epoNo),e.addDescretion&&P("addDescretion",e.addDescretion),e.trainingUpCertifi)try{const t="string"===typeof e.trainingUpCertifi?JSON.parse(e.trainingUpCertifi):e.trainingUpCertifi;if(Array.isArray(t)){H((e=>(0,g.A)((0,g.A)({},e),{},{trainingUpCertifi:(0,g.A)((0,g.A)({},e.trainingUpCertifi),{},{[a]:t})})));const e=t.map((e=>null!==e&&void 0!==e&&e.upload?e.upload.split("/").pop():""));V((t=>(0,g.A)((0,g.A)({},t),{},{["".concat(a,"_trainingUpCertifi")]:e})))}}catch(r){console.error("Error parsing trainingUpCertifi:",r)}}));const s=e.map(((e,t)=>{const a=(null===n||void 0===n?void 0:n[t])||{};return(0,g.A)((0,g.A)({},a),{},{MRNo:a.MRNo,company:a.company,courseCode:a.courseCode,courseName:a.courseName,traineeCourseFee:a.traineeCourseFee,traineeED:a.traineeED,traineeSD:a.traineeSD,traineeStatus:a.traineeStatus,certifiExpiry:e.certifiExpiry||a.certifiExpiry,eCertifiDate:e.eCertifiDate||a.eCertifiDate,orgiCertifiDate:e.orgiCertifiDate||a.orgiCertifiDate,poNo:e.poNo||a.poNo,addDescretion:e.addDescretion||a.addDescretion||[],tcRemarks:e.tcRemarks||a.tcRemarks,trainingUpCertifi:e.trainingUpCertifi||a.trainingUpCertifi||[]})}));console.log(s,"mergedData"),P("trainingProof",s)}catch(n){console.error("Error parsing training data:",n)}else if(r){console.log("TRack",r),H({trainingUpCertifi:{0:[]}}),z({"0_trainingUpCertifi":[]}),V({"0_trainingUpCertifi":[]});try{const e=JSON.parse(r[0]),t=e.map((e=>({courseName:null===e||void 0===e?void 0:e.courseName,courseCode:null===e||void 0===e?void 0:e.courseCode,company:null===e||void 0===e?void 0:e.company,certifiExpiry:"",eCertifiDate:"",orgiCertifiDate:"",traineeSD:null===e||void 0===e?void 0:e.traineeSD,traineeED:null===e||void 0===e?void 0:e.traineeED,poNo:"",addDescretion:[],tcRemarks:""})));e.forEach(((e,t)=>{e.courseName&&P("courseName",e.courseName),e.courseCode&&P("courseCode",e.courseCode),e.company&&P("company",e.company),e.traineeSD&&P("traineeSD",null===e||void 0===e?void 0:e.traineeSD),e.traineeED&&P("traineeED",null===e||void 0===e?void 0:e.traineeED)})),P("trainingProof",t)}catch(n){console.error("Error parsing trainingTrack:",n)}}else M({empID:F("empID"),empBadgeNo:F("empBadgeNo"),name:F("name"),department:F("department"),trainingProof:[{courseCode:"",courseName:"",company:"",certifiExpiry:"",eCertifiDate:"",traineeSD:"",traineeED:"",orgiCertifiDate:"",poNo:"",addDescretion:[],tcRemarks:""}]}),H({trainingUpCertifi:{0:[]}}),z({"0_trainingUpCertifi":[]}),V({"0_trainingUpCertifi":[]})},newFormData:N,searchIcon2:(0,i.jsx)(j.zfp,{}),placeholder:"Employee Id",rounded:"rounded-lg",filteredEmployees:A,setFilteredEmployees:w})}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("label",{className:"text_size_5 text-dark_grey",children:"Employee ID"}),(0,i.jsx)("div",{className:"py-2 w-full text_size_5 border text-grey bg-white border-lite_grey ".concat("rounded-lg"," flex items-center px-2 gap-2"),children:(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text",placeholder:"Employee ID",className:"outline-none w-full"},C("empID")),{},{disabled:k}))}),L.empID&&(0,i.jsx)("p",{className:"text-[red] text-[12px]",children:L.empID.message})]})]}),(0,i.jsxs)("form",{onSubmit:R((async e=>{try{const n=(new Date).toISOString().split("T")[0],s=a?a.find((t=>t.empID===e.empID)):{},i=e=>e.map((e=>{let{certifiExpiry:t,eCertifiDate:a,orgiCertifiDate:r,poNo:n,tcRemarks:s,addDescretion:i,trainingUpCertifi:l,traineeSD:o,traineeED:d}=e;return{certifiExpiry:t,eCertifiDate:a,orgiCertifiDate:r,poNo:n,tcRemarks:s,addDescretion:i,trainingUpCertifi:l,traineeSD:o,traineeED:d}}));if(s){var t;const a=s.updatedBy?JSON.parse(s.updatedBy):[],r=JSON.stringify([...a,{userID:I,date:n}]),l=(0,g.A)((0,g.A)({},e),{},{trainingProof:null===(t=i(null===e||void 0===e?void 0:e.trainingProof))||void 0===t?void 0:t.map(((e,t)=>{var a;return(0,g.A)((0,g.A)({},e),{},{trainingUpCertifi:JSON.stringify(null===q||void 0===q||null===(a=q.trainingUpCertifi)||void 0===a?void 0:a[t])||[]})})),id:s.id,updatedBy:r});await d({TCDataUp:l}),E("Training Certificate Details Updated successfully"),f(!0),console.log("Update:",l)}else{var r;const t=(0,g.A)((0,g.A)({},e),{},{trainingProof:null===(r=i(null===e||void 0===e?void 0:e.trainingProof))||void 0===r?void 0:r.map(((e,t)=>{var a;return(0,g.A)((0,g.A)({},e),{},{trainingUpCertifi:JSON.stringify(null===q||void 0===q||null===(a=q.trainingUpCertifi)||void 0===a?void 0:a[t])||[]})})),createdBy:JSON.stringify([{userID:I,date:n}])});await o({TCValue:t}),E("Training Certificate Details Saved successfully"),f(!0),console.log("Create:",t)}}catch(n){console.log(n)}})),children:[(0,i.jsx)("div",{className:"flex justify-end  items-center py-5 mt-2"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-6 ",children:[(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee Name"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},C("name")),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Employee Badge Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},C("empBadgeNo")),{},{className:"input-field"}))]}),(0,i.jsx)(mt,{label:"Department",register:C,name:"department",type:"text",errors:L}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Position"}),(0,i.jsx)("input",(0,g.A)({type:"text",className:"input-field "},C("position")))]})]}),G.map(((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-6 mt-6 border-t pt-6 border border-[#E9E7E7] px-8 py-6 rounded",children:[(0,i.jsxs)("h3",{className:"col-span-2 text-lg font-semibold",children:["Training Certificate ",t+1]}),(0,i.jsxs)("div",{className:"mb-4 ",children:[(0,i.jsx)("label",{htmlFor:"courseSelect",className:"font-semibold",children:"Selected Course:"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},C("trainingProof.".concat(t,".courseCode"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{className:"mb-4 relative",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Training Course Name"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},C("trainingProof.".concat(t,".courseName"))),{},{className:"input-field"})),(0,i.jsxs)("div",{className:"absolute -right-0 -top-10",children:[0===t&&(0,i.jsx)("button",{type:"button",onClick:ee,className:"text-grey text-xl ",children:(0,i.jsx)(Tt.fFF,{})}),0!==t&&(0,i.jsx)("button",{type:"button",onClick:()=>(e=>{var t;const a=(0,g.A)({},q),r=(0,g.A)({},W),n=(0,g.A)({},Y);null===(t=a.trainingUpCertifi)||void 0===t||delete t[e],Object.keys(r).forEach((t=>{t.startsWith("".concat(e,"_"))&&delete r[t]}));const s={},i={},l={},o=Object.keys(a.trainingUpCertifi||{}).map(Number).sort(((e,t)=>e-t));o.forEach(((e,t)=>{s[t]=a.trainingUpCertifi[e]})),o.forEach(((e,t)=>{Object.keys(r).forEach((a=>{if(a.startsWith("".concat(e,"_"))){const n=a.replace("".concat(e,"_"),"".concat(t,"_"));i[n]=r[a]}}))})),o.forEach(((e,t)=>{Object.keys(n).forEach((a=>{if(a.startsWith("".concat(e,"_"))){const r=a.replace("".concat(e,"_"),"".concat(t,"_"));l[r]=n[a]}}))})),H((0,g.A)((0,g.A)({},a),{},{trainingUpCertifi:s})),z(i),V(l),K(e)})(t),className:"text-xl text-grey",children:(0,i.jsx)(Tt.vli,{})})]})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Training Company"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"text"},C("trainingProof.".concat(t,".company"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{className:"mb-2",children:[" ",(0,i.jsx)("label",{className:"text_size_5",children:"Purchase Order (PO) Number"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},C("trainingProof.".concat(t,".poNo"))),{},{className:"input-field",type:"text"})),L.poNo&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:L.poNo.message})]}),(0,i.jsxs)("div",{className:"mb-2",children:[" ",(0,i.jsx)("label",{className:"text_size_5",children:"Expiry Condition"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},C("trainingProof.".concat(t,".addDescretion"))),{},{className:"input-field",type:"text"})),L.addDescretion&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:L.addDescretion.message})]}),(0,i.jsxs)("div",{className:"mb-2",children:[" ",(0,i.jsx)("label",{className:"text_size_5",children:"Date received E-certificate"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},C("trainingProof.".concat(t,".eCertifiDate"))),{},{className:"input-field",type:"date"})),L.eCertifiDate&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:L.eCertifiDate.message})]}),(0,i.jsxs)("div",{className:"mb-2",children:[" ",(0,i.jsx)("label",{className:"text_size_5",children:"Date received Original Certificate"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},C("trainingProof.".concat(t,".orgiCertifiDate"))),{},{className:"input-field",type:"date"})),L.orgiCertifiDate&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:L.orgiCertifiDate.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"Start Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},C("trainingProof.".concat(t,".traineeSD"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"text_size_5",children:"End Date"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"date"},C("trainingProof.".concat(t,".traineeED"))),{},{className:"input-field"}))]}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Training Certificate Expiry"}),(0,i.jsx)("input",(0,g.A)((0,g.A)({},C("trainingProof.".concat(t,".certifiExpiry"))),{},{className:"input-field",type:"date"})),L.certifiExpiry&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:L.certifiExpiry.message})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("label",{className:"text_size_5",children:"Upload Document"}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-10 py-2",children:(0,i.jsxs)("div",{className:"",children:[(0,i.jsxs)("label",{onClick:()=>{null!==U&&void 0!==U&&U["".concat(t,"_trainingUpCertifi")]&&alert("Please delete the previously uploaded file before uploading a new one.")},className:"flex items-center px-3 py-3 text_size_7 p-2.5 bg-lite_skyBlue border border-[#dedddd] rounded-md cursor-pointer w-[470px]",children:[(0,i.jsx)("input",(0,g.A)((0,g.A)({type:"file"},C("trainingProof[".concat(t,"].trainingUpCertifi"))),{},{onChange:e=>$(e,"trainingUpCertifi",t),accept:"application/pdf",className:"hidden",disabled:null===U||void 0===U?void 0:U["".concat(t,"_trainingUpCertifi")]})),(0,i.jsxs)("span",{className:"ml-2 w-full font-normal flex justify-between items-center gap-10",children:["Upload",(0,i.jsx)(ut.gwN,{})]})]}),(0,i.jsx)("div",{className:"flex items-center justify-between ",children:null!==W&&void 0!==W&&W["".concat(t,"_trainingUpCertifi")]?(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(W["".concat(t,"_trainingUpCertifi")])&&W["".concat(t,"_trainingUpCertifi")].slice().reverse().map(((e,t)=>(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{te("trainingUpCertifi",e)},children:(0,i.jsx)(_t.uDv,{})})]},t)))}):(null===Y||void 0===Y?void 0:Y["".concat(t,"_trainingUpCertifi")])&&(0,i.jsx)("p",{className:"text-grey text-sm my-1",children:Array.isArray(Y["".concat(t,"_trainingUpCertifi")])&&Y["".concat(t,"_trainingUpCertifi")].slice().reverse().map(((e,t)=>{var a,r;return(0,i.jsxs)("span",{className:"mt-2 flex justify-between items-center",children:[e,(null===c||void 0===c||null===(a=c.deleteAccess)||void 0===a||null===(r=a.Training)||void 0===r?void 0:r.some((e=>ae.includes(e))))&&(0,i.jsx)("button",{type:"button",className:"ml-2 text-[16px] font-bold text-[#F24646] hover:text-[#F24646] focus:outline-none",onClick:()=>{te("trainingUpCertifi",e)},children:(0,i.jsx)(_t.uDv,{})})]},t)}))})}),(null===L||void 0===L?void 0:L.claimUpload)&&(0,i.jsx)("p",{className:"text-red text-sm",children:L.claimUpload.message})]})})]}),(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("label",{className:"text_size_5 my-3",children:"Remarks"}),(0,i.jsx)("textarea",(0,g.A)((0,g.A)({},C("trainingProof.".concat(t,".tcRemarks"))),{},{className:"input-field",type:"text",rows:"3"})),(null===L||void 0===L?void 0:L.tcRemarks)&&(0,i.jsx)("p",{className:"text-[red] text-[13px] mt-1",children:L.tcRemarks.message})]})]},e.id))),(0,i.jsx)("div",{className:"center py-5",children:(0,i.jsx)("button",{type:"submit",className:"primary_btn",children:"Submit"})})]})]}),x&&(0,i.jsx)(Pe,{text:S,notification:x,path:"/training/trainingCertify"}),p&&(0,i.jsx)(Wt,{handleDeleteMsg:Z,title1:u})]})},po=()=>{const{IDData:e}=(0,n.useContext)(s.Y),{SubmitEIData:t}=bn(),{UpdateEIValue:a}=Dn();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["IDDetailsMD",(0,i.jsx)("button",{onClick:async()=>{},children:"Click Here"})]})},mo=()=>{const[e,t]=(0,n.useState)(null),{empPIData:a}=(0,n.useContext)(s.Y),{SubmitEIData:r}=bn(),{UpdateEIValue:l}=Dn();console.log(a);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["EmpPersonalinfoMD",(0,i.jsx)("button",{onClick:async()=>{try{const e=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/PersonalInfo+Prod/EmpPersonnelInfo+10.csv",{responseType:"arraybuffer"}),t=new Uint8Array(e.data);console.log(t);const n=ei.LF(t,{type:"array"}),s=n.SheetNames[0],i=n.Sheets[s],o=ei.Wp.sheet_to_json(i,{header:1}),d=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];"dob"!==a||isNaN(n)||(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),"familyDetails"===a&&(n=JSON.stringify(n)),t[a]=void 0!==n?String(n):n})),t}));for(const c of d){if(!c.empID)continue;c.empID&&(c.empID=String(c.empID)),console.log(c);const e=a.find((e=>{var t,a;return(null===e||void 0===e||null===(t=e.empID)||void 0===t?void 0:t.toString().toLowerCase())===(null===c||void 0===c||null===(a=c.empID)||void 0===a?void 0:a.toString().toLowerCase())}));if(e){console.log(c,"update");const t=(0,g.A)((0,g.A)({},c),{},{PITableID:e.id});await l({collectValue:t})}else console.log(c,"create"),await r({empValue:c})}}catch(e){console.error("Error fetching Excel file:",e)}},children:"Click Here"})]})},uo=()=>{const{workInfoData:e}=(0,n.useContext)(s.Y),{SubmitWIData:t}=wn(),{WIUpdateData:a}=En();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["WorkInfoMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/EmpWorkInfo/EmpWorkInfo+5.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["doj","contractStart","contractEnd","probationEnd","probationStart","upgradeDate"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{workInfoDataRecord:r});await a({workInfoUpValue:e})}else console.log(p,"create"),await t({workInfoValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},ho=()=>{const{EmpInsuranceData:e}=(0,n.useContext)(s.Y),{SubmitMPData:t}=Un(),{UpdateEIDataSubmit:a}=Bn();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["EmpInsuranceMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/EmpInsurance+Prod/EmpInsurance.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["doj","contractStart","contractEnd","probationEnd","probationStart","upgradeDate"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{id:r.id});await a({empInsValue:e})}else console.log(p,"create"),await t({empInsValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},xo=()=>{const{leaveDetailsData:e}=(0,n.useContext)(s.Y),{SubmitWIData:t}=wn(),{WIUpdateData:a}=En();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["LeaveDetailsMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/EmpLeaveDetails+Prod/EmpLeaveDetails+4.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["dateLeavePass","annualLeaveDate","sickLeaveDate"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{leaveDetailsDataRecord:r});await a({workInfoUpValue:e})}else console.log(p,"create"),await t({workInfoValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},go=()=>{const{NLAData:e}=(0,n.useContext)(s.Y),{NLADatas:t}=Vn(),{NLAUpdateFun:a}=Gn();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["NonLocalAccMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/Non-Local+Accommodation/EmployeeNonLocalAccom.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];t[a]=void 0!==n?String(n):n})),t}));for(const c of d){if(!c.empID)continue;c.empID&&(c.empID=String(c.empID));const r=e.find((e=>e.empID===c.empID));if(r){console.log(c,"update");const e=(0,g.A)((0,g.A)({},c),{},{IDTable:r.id});await a({NLAValue:e})}else console.log(c,"create"),await t({NLACreValue:c})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},fo=()=>{const{DNData:e}=(0,n.useContext)(s.Y),{CrerDoeFunData:t}=Ci(),{UpdateMPData:a}=Ti();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["DNDetailsMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/DNDetails+Prod/DNDetails+3.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["doeEmpValid","nlmsEmpValid","doeEmpSubmit","doeEmpApproval","nlmsEmpApproval","nlmsEmpSubmit"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{id:r.id});await a({DoeUpValue:e})}else console.log(p,"create"),await t({DoeValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},vo=()=>{const{terminateData:e}=(0,n.useContext)(s.Y),{SubmitWIData:t}=wn(),{WIUpdateData:a}=En();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["TerminatedMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/TerminationInfo+Prod/TerminationInfo.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["termiDate","resignDate"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&(n=void 0),t[a]=n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p.empID);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{workInfoDataRecord:r});await a({workInfoUpValue:e})}else console.log(p,"create"),await t({workInfoValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},yo=()=>{const{BJLData:e}=(0,n.useContext)(s.Y),{BGData:t}=_i(),{UpdateBJLFun:a}=Mi();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["BJLDetailsMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/BJLDetails+Prod/BJLDetails+1.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["jpValid","bankValid","bankSubmit","bankRece","bankEndorse","jpEndorse","tbaPurchase","lbrDepoSubmit"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{id:r.id});await a({BJLUpValue:e})}else console.log(p,"create"),await t({BJLValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},No=["termiDate"],bo=["rawTermiDate"],Do=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(["Emp ID","Badge No","Name","Date of join","Nationality","Department","Other Department","Position","OTHER Position","Date of Termination","Reason of Termination"]),g=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return g(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)};(0,n.useEffect)((()=>{var e;l(null===(e=t)||void 0===e?void 0:e.filter((e=>e.termiDate)).map((e=>({termiDate:new Date(e.termiDate),empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:((t,a,r,n)=>{const s=new Date,i=null===(t=e.positionRevDate)||void 0===t?void 0:t[e.positionRevDate.length-1],l=null===(a=e.positionRev)||void 0===a?void 0:a[e.positionRev.length-1],o=null===(r=e.upgradePosition)||void 0===r?void 0:r[e.upgradePosition.length-1],d=null===(n=e.upgradeDate)||void 0===n?void 0:n[e.upgradeDate.length-1];let c;const p=i?new Date(i):null,m=d?new Date(d):null;var u;if(p&&m){if(p.toDateString()===m.toDateString())c=null===(u=e.position)||void 0===u?void 0:u[e.position.length-1];else if(p>m){var h;c=s>=p?l:s>=m?o:null===(h=e.position)||void 0===h?void 0:h[e.position.length-1]}else if(m>p){var x;c=s>=m?o:s>=p?l:null===(x=e.position)||void 0===x?void 0:x[e.position.length-1]}}else if(p&&!m)c=s>=p&&l;else if(m&&!p)c=s>=m&&o;else{var g;c=null===(g=e.position)||void 0===g?void 0:g[e.position.length-1]}return c||"-"})(),otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",terminateDate:g(e.termiDate)||"-",reasonTerminate:e.reasonTerminate||"-"}))).sort(((e,t)=>e.termiDate-t.termiDate)).map((e=>{let{termiDate:t}=e;return(0,is.A)(e,No)})))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,startDate:c,endDate:m,title:a,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{const t=e.termiDate?new Date(e.termiDate):null;return!(!t||isNaN(t.getTime()))&&(n&&s?t>=n&&t<=s:n?t>=n:!s||t<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:((t,a,r,n)=>{const s=new Date,i=null===(t=e.positionRevDate)||void 0===t?void 0:t[e.positionRevDate.length-1],l=null===(a=e.positionRev)||void 0===a?void 0:a[e.positionRev.length-1],o=null===(r=e.upgradePosition)||void 0===r?void 0:r[e.upgradePosition.length-1],d=null===(n=e.upgradeDate)||void 0===n?void 0:n[e.upgradeDate.length-1];let c;const p=i?new Date(i):null,m=d?new Date(d):null;var u;if(p&&m){if(p.toDateString()===m.toDateString())c=null===(u=e.position)||void 0===u?void 0:u[e.position.length-1];else if(p>m){var h;c=s>=p?l:s>=m?o:null===(h=e.position)||void 0===h?void 0:h[e.position.length-1]}else if(m>p){var x;c=s>=m?o:s>=p?l:null===(x=e.position)||void 0===x?void 0:x[e.position.length-1]}}else if(p&&!m)c=s>=p&&l;else if(m&&!p)c=s>=m&&o;else{var g;c=null===(g=e.position)||void 0===g?void 0:g[e.position.length-1]}return c||"-"})(),otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",terminateDate:g(e.termiDate)||"-",reasonTerminate:e.reasonTerminate||"-",rawTermiDate:new Date(e.termiDate)}))).sort(((e,t)=>e.rawTermiDate-t.rawTermiDate)).map((e=>{let{rawTermiDate:t}=e;return(0,is.A)(e,bo)}));d(i)}})})},jo=["lastDate"],Ao=()=>{const e=localStorage.getItem("userID"),t=localStorage.getItem("userType"),a=(0,r.zy)(),{allData:s,title:l}=a.state||{},{gmPosition:o,HRMPosition:d}=(0,Fe.b)(),[c,p]=(0,n.useState)([]),[m,u]=(0,n.useState)([]),[h,x]=(0,n.useState)(""),[f,v]=(0,n.useState)(""),[y,N]=(0,n.useState)([]),[b,D]=(0,n.useState)(null),[j]=(0,n.useState)(["Emp ID","Badge no","Name","Date of Join","Department","Other Department","Position","Other Position","Probation Expiry Date","Deadline to Return to HRD","SuperAdmin"!==t&&"Status"].filter(Boolean)),w=(0,r.Zp)(),S=e=>{if(Array.isArray(e)){if(0===e.length)return"-";const t=e[e.length-1];return S(t)}if(!e)return"-";let t;if("string"===typeof e&&e.includes("/")){const[a,r,n]=e.split("/");t=new Date("".concat(n,"-").concat(r,"-").concat(a))}else t=new Date(e);if(isNaN(t.getTime()))return"-";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},E=e=>{let t;if(e.includes("/")){const[a,r,n]=e.split("/");t=new Date("".concat(n,"-").concat(r,"-").concat(a))}else t=new Date(e);return isNaN(t)?"Invalid Date":(t.setDate(t.getDate()-7),t.toISOString().split("T")[0])};(0,n.useEffect)((()=>{const e=(e=>{const a=new Date,r=new Date(a.getFullYear(),a.getMonth()+1,1),n=new Date(a.getFullYear(),a.getMonth()+2,1);n.setMilliseconds(-1);const s=null===e||void 0===e?void 0:e.filter((e=>{if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase()||"ACTIVE"===t.toUpperCase())return!1;const a=e.probationEnd||[],s=a[a.length-1];if(!s)return!1;const i=new Date(s);let l=null;if(e.prevProbExDate){const[t,a,r]=e.prevProbExDate.split("/");l=new Date("".concat(r,"-").concat(a,"-").concat(t))}return(!l||i.toDateString()!==l.toDateString())&&"probup"!==e.probExtendStatus&&"completed"!==e.probExtendStatus&&i>=r&&i<=n}return!1})).map((e=>{var a,r,n,s;const i=e.probationEnd||[],l=i[i.length-1];if("Manager"===t&&"HR MANAGER"!==d)return null;if("HR"===t||"HR MANAGER"===d);else if("GENERAL MANAGER"===o)return null;const c=new Date,p=null===(a=e.positionRevDate)||void 0===a?void 0:a[e.positionRevDate.length-1],m=null===(r=e.positionRev)||void 0===r?void 0:r[e.positionRev.length-1],u=null===(n=e.upgradePosition)||void 0===n?void 0:n[e.upgradePosition.length-1],h=null===(s=e.upgradeDate)||void 0===s?void 0:s[e.upgradeDate.length-1];let x;const f=p?new Date(p):null,v=h?new Date(h):null;var y;if(f&&v){if(f.toDateString()===v.toDateString())x=null===(y=e.position)||void 0===y?void 0:y[e.position.length-1];else if(f>v){var N;x=c>=f?m:c>=v?u:null===(N=e.position)||void 0===N?void 0:N[e.position.length-1]}else if(v>f){var b;x=c>=v?u:c>=f?m:null===(b=e.position)||void 0===b?void 0:b[e.position.length-1]}}else if(f&&!v)x=c>=f&&m;else if(v&&!f)x=c>=v&&u;else{var D;x=null===(D=e.position)||void 0===D?void 0:D[e.position.length-1]}return(0,g.A)((0,g.A)({lastDate:new Date(l),empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:S(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:x,otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",probationEndDate:S(l)||"-",deadline:l?S(E(l)):"-",probExtendStatus:e.probExtendStatus,prevProbExDate:e.prevProbExDate},"Supervisor"===t&&{status:"Extended"===e.probExtendStatus?"Pending":e.supervisorApproved?"Approved":"Pending"}),"HR MANAGER"===d||"HR"===t?{status:"Extended"===e.probExtendStatus?"Pending":e.hrName?"Approved":"Pending"}:{})})).filter(Boolean).sort(((e,t)=>e.lastDate-t.lastDate)).sort(((e,t)=>"Pending"===e.status&&"Pending"!==t.status?-1:"Pending"!==e.status&&"Pending"===t.status?1:0));return null===s||void 0===s?void 0:s.map((e=>{let{lastDate:t}=e;return(0,is.A)(e,jo)}))})(s);p(e),u(e)}),[s,t,o,e,d]);const I=()=>{D(null)};(0,n.useEffect)((()=>{if(b){const e=s.filter((e=>e.empID===b.empID)).filter((e=>"probup"!==e.probExtendStatus)),t=e.some((e=>{var t,a;return"extended"===(null===(t=e.probExtendStatus)||void 0===t?void 0:t.trim().toLowerCase())||"completed"===(null===(a=e.probExtendStatus)||void 0===a?void 0:a.trim().toLowerCase())}));N(t?e:[])}}),[s,b]);return(0,i.jsxs)("div",{children:[(0,i.jsx)($l,{tableBody:c,tableHead:j,title:l,startDate:h,endDate:f,handleDate:(e,t)=>{const a=e.target.value;"startDate"===t&&x(a),"endDate"===t&&v(a);const r="startDate"===t?a:h,n="endDate"===t?a:f,s=m.filter((e=>{if(!e.probationEndDate||"-"===e.probationEndDate)return!1;const[t,a,s]=e.probationEndDate.split("-"),i=new Date("".concat(s,"-").concat(a,"-").concat(t)),l=r?new Date(r):null,o=n?new Date(n):null;if(!l&&!o)return!0;let d=!0;return l&&(d=d&&i>=l),o&&(d=d&&i<=o),d}));p(s)},handleViewDetails:e=>{D(e)}}),b&&(0,i.jsx)("div",{className:"fixed inset-0 center z-50 bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg overflow-y-auto max-h-[80vh] shadow-lg w-1/3",children:[(0,i.jsxs)("section",{className:"flex justify-between gap-10 items-center mb-5",children:[(0,i.jsx)("div",{className:"w-full flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[200px]",src:Se.A,alt:"Logo"})}),(0,i.jsx)("button",{className:"text-[24px] rounded",onClick:I,children:(0,i.jsx)(A.RQJ,{})})]}),(0,i.jsx)("h2",{className:"text-xl font-semibold underline text-center mb-5",children:"Person Details"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm font-semibold px-12",children:[(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Badge No"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:b.name})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Emp Badge No"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:b.empBadgeNo})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Date of Join"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:b.dateOfJoin})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Position"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:"OTHER"===b.position?b.otherPosition:b.position})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Department"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:"OTHER"===b.department?b.otherDepartment:b.department})]})]}),y.length>0&&(0,i.jsx)("div",{className:"mt-6 center",children:(0,i.jsxs)("div",{className:"mt-6 border border-lite_grey h-auto w-[400px] p-4 rounded",children:[(0,i.jsx)("div",{className:"text-center mb-4",children:(0,i.jsx)("span",{className:"text-base font-semibold",children:"Probation Extension History"})}),(0,i.jsx)("div",{className:"center",children:(0,i.jsxs)("table",{className:"border border-[#D3D3D3] rounded-md shadow-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"bg-[#E5E5E5] text-xs",children:[(0,i.jsx)("th",{className:"text-center px-6 py-2 border-r border-[#D3D3D3]",children:"No of time"}),(0,i.jsx)("th",{className:"text-center px-6 py-2",children:"Date"})]})}),(0,i.jsx)("tbody",{children:[...y].sort(((e,t)=>new Date(t.prevProbExDate)-new Date(e.prevProbExDate))).map(((e,t)=>(0,i.jsxs)("tr",{className:"text-xs border-t border-[#F0F0F0] text-center",children:[(0,i.jsx)("td",{className:"px-6 py-2 border-r border-[#F0F0F0]",children:t+1}),(0,i.jsx)("td",{className:"px-6 py-2",children:S(e.prevProbExDate)})]},t)))})]})})]})}),(0,i.jsx)("div",{className:"flex justify-center items-center py-6 px-4",children:(0,i.jsxs)("button",{className:"bg-primary text-sm font-bold py-2 px-6 text-dark_grey rounded-md",onClick:()=>{I(),b&&w("/probReviewForm",{state:{employeeData:b}})},children:["Go to ",(0,i.jsx)("strong",{children:"Probation"})," Form"]})})]})})]})},wo=["lastDate"],So=["lastDate"],Eo=()=>{const e=(0,r.Zp)(),t=(0,r.zy)(),{allData:a,title:l}=t.state||{},{contractForms:o}=(0,n.useContext)(s.Y),[d,c]=(0,n.useState)([]),[p,m]=(0,n.useState)(null),[u,h]=(0,n.useState)([]),[x,f]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),{gmPosition:N,HRMPosition:b}=(0,Fe.b)(),D=localStorage.getItem("userID"),j=localStorage.getItem("userType"),[w,S]=(0,n.useState)([]),E=["Emp ID","Badge No","Name","Nationality","Date of Join","Department","Other Department","Position","Other Position","Contract Start Date","Contract End Date","LD Expiry","SuperAdmin"!==j&&"Status"].filter(Boolean),I=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return I(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)};(0,n.useEffect)((()=>{if(a){const e=(e=>{const t=new Date,a=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(t.getFullYear(),t.getMonth()+3,1);r.setMilliseconds(-1);const n=new Set(o.filter((e=>"noExtended"===e.extendedStatus)).map((e=>e.empID))),s=new Map;o.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).forEach((e=>{s.has(e.empID)||s.set(e.empID,e)})),Array.from(s.values());const i=e.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).map((e=>{var t,s,i,l,d,c,p,m,u;if(n.has(e.empID))return null;const h=e.workStatus||[],x=h[h.length-1];if(x&&["TERMINATION","RESIGNATION"].includes(x.toUpperCase()))return null;const f=e.contractEnd||[];if(0===f.length)return null;const v=f[f.length-1],y=o.filter((t=>t.empID===e.empID)).sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)))[0];if(!v||null!==y&&void 0!==y&&y.depHead&&""===y.hrManager||e.contStatus&&"noExtended"===e.extendedStatus||"hrmView"===e.extendedStatus||"gmView"===e.extendedStatus)return null;const A=new Date(v);if(!(A>=a&&A<=r))return null;const w=e.contractStart||[],S=w[w.length-1],E=(null===(t=e.manager)||void 0===t?void 0:t[e.manager.length-1])||null;if("HR MANAGER"===b||"HR"===j);else{if("GENERAL MANAGER"===N)return null;if("Manager"===j&&E!==D)return null;if("HR"===j&&"HR MANAGER"!==b)return null;if("Supervisor"===j)return null}const k=new Date,T=null===(s=e.positionRevDate)||void 0===s?void 0:s[e.positionRevDate.length-1],C=null===(i=e.positionRev)||void 0===i?void 0:i[e.positionRev.length-1],R=null===(l=e.upgradePosition)||void 0===l?void 0:l[e.upgradePosition.length-1],P=null===(d=e.upgradeDate)||void 0===d?void 0:d[e.upgradeDate.length-1];let O;const _=T?new Date(T):null,M=P?new Date(P):null;var F;if(_&&M){if(_.toDateString()===M.toDateString())O=null===(F=e.position)||void 0===F?void 0:F[e.position.length-1];else if(_>M){var L;O=k>=_?C:k>=M?R:null===(L=e.position)||void 0===L?void 0:L[e.position.length-1]}else if(M>_){var U;O=k>=M?R:k>=_?C:null===(U=e.position)||void 0===U?void 0:U[e.position.length-1]}}else if(_&&!M)O=k>=_&&C;else if(M&&!_)O=k>=M&&R;else{var B;O=null===(B=e.position)||void 0===B?void 0:B[e.position.length-1]}return(0,g.A)((0,g.A)((0,g.A)((0,g.A)({lastDate:new Date(v),empID:e.empID,empBadgeNo:e.empBadgeNo,name:e.name,nationality:e.nationality,dateOfJoin:I(e.doj),department:null===(c=e.department)||void 0===c?void 0:c[e.department.length-1],otherDepartment:null===(p=e.otherDepartment)||void 0===p?void 0:p[e.otherDepartment.length-1],position:O,otherPosition:null===(m=e.otherPosition)||void 0===m?void 0:m[e.otherPosition.length-1],contractStartDate:I(S),contractEndDate:I(v),oldCED:e.oldCED===I(v)?e.oldCED:I(v),nlmsEmpApproval:null!==(u=e.nlmsEmpValid)&&void 0!==u&&u[e.nlmsEmpValid.length-1]?I(e.nlmsEmpValid[e.nlmsEmpValid.length-1]):null},"HR MANAGER"===b?{status:null!==y&&void 0!==y&&y.hrManager&&y.oldCED===I(v)?"Approved":"Pending"}:{}),"Manager"===j&&{status:null!==y&&void 0!==y&&y.depHead&&(null===y||void 0===y?void 0:y.oldCED)===I(v)?"Approved":"Pending"}),"GENERAL MANAGER"===N&&{status:null!==y&&void 0!==y&&y.genManager&&y.oldCED===I(v)?"Approved":"Pending"}),"HR"===j&&{status:null!==y&&void 0!==y&&y.hrSign&&y.oldCED===I(v)?"Approved":"Pending"})})).filter(Boolean).filter((e=>"Pending"===e.status)).sort(((e,t)=>e.lastDate-t.lastDate)).map((e=>{let{lastDate:t}=e;return(0,is.A)(e,wo)}));return i})(a);c(e)}}),[a,j,N,D,b]);const k=()=>{m(null)},T=t=>{k(),p&&e("/contractForms",{state:{employeeData:p,matchedID:null!==t&&void 0!==t?t:null}})};return(0,i.jsxs)("div",{children:[(0,i.jsx)($l,{tableBody:u.length?u:d,tableHead:E,title:l,startDate:x,endDate:v,handleDate:(e,t)=>{const r=e.target.value;"startDate"===t&&f(r),"endDate"===t&&y(r);const n="startDate"===t?new Date(r):x?new Date(x):null,s="endDate"===t?new Date(r):v?new Date(v):null,i=a.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;if(!e.contStatus){const t=e.contractEnd||[],a=t.length?new Date(t[t.length-1]):null;return!(!a||isNaN(a.getTime()))&&(n&&s?a>=n&&a<=s:n?a>=n:!s||a<=s)}return!1})).map((e=>{var t,a,r,n;const s=e.contractEnd||[],i=s[s.length-1],l=e.contractStart||[],o=l[l.length-1],d=new Date,c=null===(t=e.positionRevDate)||void 0===t?void 0:t[e.positionRevDate.length-1],p=null===(a=e.positionRev)||void 0===a?void 0:a[e.positionRev.length-1],m=null===(r=e.upgradePosition)||void 0===r?void 0:r[e.upgradePosition.length-1],u=null===(n=e.upgradeDate)||void 0===n?void 0:n[e.upgradeDate.length-1];let h;const x=c?new Date(c):null,f=u?new Date(u):null;var v;if(x&&f){if(x.toDateString()===f.toDateString())h=null===(v=e.position)||void 0===v?void 0:v[e.position.length-1];else if(x>f){var y;h=d>=x?p:d>=f?m:null===(y=e.position)||void 0===y?void 0:y[e.position.length-1]}else if(f>x){var D;h=d>=f?m:d>=x?p:null===(D=e.position)||void 0===D?void 0:D[e.position.length-1]}}else if(x&&!f)h=d>=x&&p;else if(f&&!x)h=d>=f&&m;else{var A;h=null===(A=e.position)||void 0===A?void 0:A[e.position.length-1]}return(0,g.A)((0,g.A)((0,g.A)({lastDate:new Date(i),empID:e.empID,empBadgeNo:e.empBadgeNo,name:e.name,nationality:e.nationality,dateOfJoin:I(e.doj),department:Array.isArray(e.department)&&e.department[e.department.length-1],otherDepartment:Array.isArray(e.otherDepartment)&&e.otherDepartment[e.otherDepartment.length-1],position:h,otherPosition:Array.isArray(e.otherPosition)&&e.otherPosition[e.otherPosition.length-1],contractStartDate:I(o),contractEndDate:I(i),oldCED:e.oldCED===I(i)?e.oldCED:I(i),nlmsEmpApproval:Array.isArray(e.nlmsEmpValid)?I(e.nlmsEmpValid[e.nlmsEmpValid.length-1]):"-"},"HR MANAGER"===b||"HR"===j?{status:e.hrManager?"Approved":"Pending"}:{}),"Manager"===j&&{status:e.depHead?"Approved":"Pending"}),"GENERAL MANAGER"===N&&{status:e.genManager?"Approved":"Pending"})})).sort(((e,t)=>e.lastDate-t.lastDate)).map((e=>{let{lastDate:t}=e;return(0,is.A)(e,So)}));h(i)},handleViewDetails:e=>{const t=o.filter((t=>t.empID===e.empID));S(t),m(e)}}),p&&(0,i.jsx)("div",{className:"fixed inset-0 center z-50 bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-1/3 h-[600px] overflow-y-auto",children:[(0,i.jsxs)("section",{className:"flex justify-between gap-10 items-center mb-5",children:[(0,i.jsx)("div",{className:"w-full flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[200px]",src:Se.A,alt:"Logo"})}),(0,i.jsx)("button",{className:"text-[24px] rounded",onClick:k,children:(0,i.jsx)(A.RQJ,{})})]}),(0,i.jsx)("h2",{className:"text-xl font-semibold underline text-center mb-5",children:"Person Details"}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Name"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",p.name]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Emp ID"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",p.empID]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Emp Badge No"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",p.empBadgeNo]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Nationality"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",p.nationality]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Date of Join"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",p.dateOfJoin]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Position:"}),(0,i.jsxs)("span",{className:" flex-1",children:["  : \xa0","OTHER"===p.position?p.otherPosition:p.position]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Department:"})," ",(0,i.jsxs)("span",{className:" flex-1",children:["  : \xa0","OTHER"===p.department?p.otherDepartment:p.department]})]}),w.length>0&&(0,i.jsxs)("div",{className:"mt-10",children:[(0,i.jsx)("h5",{className:"text-xl font-semibold text-center mb-5",children:"Contract Extension History"}),(0,i.jsx)("div",{className:" center",children:(0,i.jsx)("div",{className:"py-7 max-w-[350px] w-full center shadow-[2px_2px_8px_rgba(0,0,0,0.3)] rounded-md",children:(0,i.jsxs)("table",{className:"border ",children:[(0,i.jsx)("thead",{className:"border ",children:(0,i.jsxs)("tr",{className:"bg-medium_grey  text-white  border",children:[(0,i.jsx)("th",{className:"border px-3 py-2",children:"No of Time"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Date"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Action"})]})}),(0,i.jsx)("tbody",{className:"text-sm",children:w.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).map(((e,t)=>(0,i.jsxs)("tr",{children:[(e.genManager||""!==e.genManager.trim())&&(0,i.jsx)("th",{className:"border px-3 py-2 text-dark_grey",children:t+1}),(e.genManager||""!==e.genManager.trim())&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("th",{className:"border px-3 py-2 text-dark_grey",children:e.oldCED}),(0,i.jsx)("th",{className:"border px-3 py-2 text-blue underline cursor-pointer",onClick:()=>T(e.id),children:"View"})]})]},t)))})]})})})]}),(0,i.jsx)("div",{className:"flex justify-evenly items-center p-3 mt-10",children:(0,i.jsx)("button",{className:"primary_btn",onClick:()=>T(),children:"Go to Contract Form"})})]})})]})},Io=["lastPassExp"],ko=["lastPassExp"],To=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(["Emp ID","Badge No","Name","Nationality","Date of Join","Department","Other Department","Position","Other Position","Pass Expiry"]),g=e=>e.filter((e=>Array.isArray(e.empPassExp)&&e.empPassExp.length>0&&e.empPassExp.every((e=>e&&!isNaN(new Date(e).getTime()))))).filter((e=>{if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase())return!1}return(e=>{if(!e)return!1;const t=new Date(e),a=new Date,r=new Date(a.getFullYear(),a.getMonth()+1,1),n=new Date(a.getFullYear(),a.getMonth()+2,1);return t>=r&&t<=n})(e.empPassExp[e.empPassExp.length-1])})).map((e=>{const t=e.empPassExp[e.empPassExp.length-1];return{lastPassExp:new Date(t),empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",nationality:e.nationality||"-",dateOfJoin:y(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",passExpiry:y(t)||"-"}})).sort(((e,t)=>e.lastPassExp-t.lastPassExp)).map((e=>{let{lastPassExp:t}=e;return(0,is.A)(e,Io)}));(0,n.useEffect)((()=>{l(g(t))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.empPassExp||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>{const t=e.empPassExp[e.empPassExp.length-1];return{lastPassExp:new Date(t),empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",nationality:e.nationality||"-",dateOfJoin:y(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",passExpiry:y(t)||"-"}})).sort(((e,t)=>e.lastPassExp-t.lastPassExp)).map((e=>{let{lastPassExp:t}=e;return(0,is.A)(e,ko)}));d(i)}})})},Co=["rawExpiryDate"],Ro=["rawExpiryDate"],Po=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(["Emp ID","Badge No","Name","Date of Join","Nationality","Department","Other Department","Position","Ohter Position","Passport Expiry"]),g=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return g(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)};(0,n.useEffect)((()=>{const e=(e=>{const t=new Date,a=t.getMonth(),r=t.getFullYear()+1;return e.filter((e=>{if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase())return!1}if(!Array.isArray(e.ppExpiry)||0===e.ppExpiry.length)return!1;const t=new Date(e.ppExpiry[e.ppExpiry.length-1]);if(isNaN(t.getTime()))return!1;const n=t.getMonth(),s=t.getFullYear();return n===a&&s===r}))})(t).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",ppExpiry:g(e.ppExpiry[e.ppExpiry.length-1]),rawExpiryDate:new Date(e.ppExpiry[e.ppExpiry.length-1])}))).sort(((e,t)=>e.rawExpiryDate-t.rawExpiryDate)).map((e=>{let{rawExpiryDate:t}=e;return(0,is.A)(e,Co)}));l(e)}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.ppExpiry||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",ppExpiry:g(e.ppExpiry[e.ppExpiry.length-1]),rawExpiryDate:new Date(e.ppExpiry[e.ppExpiry.length-1])}))).sort(((e,t)=>e.rawExpiryDate-t.rawExpiryDate)).map((e=>{let{rawExpiryDate:t}=e;return(0,is.A)(e,Ro)}));d(i)}})})},Oo=["lastValidDate"],_o=["lastValidDate"],Mo=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h]=(0,n.useState)(["Emp ID","Badge No","Name","Nationality","Department","Other Department","Position","Other Position","LD Approved","LD Expiry","ENERGY DEPARTMENT APPROVAL VALIDITY DATE","ENERGY DEPARTMENT APPROVAL REFERENCE NUMBER"]),x=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return x(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)},g=e=>e.filter((e=>{var t;if(Array.isArray(e.workStatus)&&(null===(t=e.workStatus)||void 0===t?void 0:t.length)>0){var a;const t=e.workStatus[(null===(a=e.workStatus)||void 0===a?void 0:a.length)-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase())return!1}return Array.isArray(e.nlmsEmpValid)&&e.nlmsEmpValid.length>0&&e.nlmsEmpValid.every((e=>e&&!isNaN(new Date(e).getTime())))})).filter((e=>(e=>{if(!e)return!1;const t=new Date(e),a=new Date,r=new Date(a.getFullYear(),a.getMonth()+1+1+1),n=new Date(a.getFullYear(),a.getMonth()+4,1);return t>=r&&t<=n})(e.nlmsEmpValid[e.nlmsEmpValid.length-1]))).map((e=>{const t=e.nlmsEmpValid[e.nlmsEmpValid.length-1];return{lastValidDate:new Date(t),empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",nlmsEmpApproval:Array.isArray(e.nlmsEmpApproval)?x(e.nlmsEmpApproval[e.nlmsEmpApproval.length-1]):"-",nlmsEmpValid:x(t)||"-",nlmsEmpSubmit:Array.isArray(e.nlmsEmpSubmit)?x(e.nlmsEmpSubmit[e.nlmsEmpSubmit.length-1]):"-",nlmsEmpSubmitRefNo:e.nlmsEmpSubmitRefNo}})).sort(((e,t)=>e.lastValidDate-t.lastValidDate)).map((e=>{let{lastValidDate:t}=e;return(0,is.A)(e,Oo)}));(0,n.useEffect)((()=>{const e=g(t);l(e)}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.nlmsEmpValid||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>{const t=e.nlmsEmpValid[e.nlmsEmpValid.length-1];return{lastValidDate:new Date(t),empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",nlmsEmpApproval:Array.isArray(e.nlmsEmpApproval)?x(e.nlmsEmpApproval[e.nlmsEmpApproval.length-1]):"-",nlmsEmpValid:x(t)}})).sort(((e,t)=>e.lastValidDate-t.lastValidDate)).map((e=>{let{lastValidDate:t}=e;return(0,is.A)(e,_o)}));d(i)}})})},Fo=()=>{const e=(0,r.zy)(),[t,a]=(0,n.useState)([]),[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)(null),[c,p]=(0,n.useState)(null),{allData:m,title:u}=e.state||{},[h]=(0,n.useState)(["Emp ID","Badge No","Name","Date of Join","Nationality","Department","Other Department","Position","Other Position","Medical Expiry"]),x=e=>{if(!e)return null;const t=e.replace(/-/g,"/").split("/");if(3!==t.length)return null;let a,r,n;if(4===t[0].length)[n,r,a]=t.map(Number);else{if(4!==t[2].length)return null;{const[e,s,i]=t.map(Number);e>12?[a,r,n]=[e,s,i]:[r,a,n]=[e,s,i]}}return new Date(n,r-1,a)},g=e=>{if("string"!==typeof e)return null;const t=e.replace(/-/g,"/").split("/");if(3!==t.length)return null;let a,r,n;if(4===t[0].length)[n,r,a]=t.map(Number);else{if(4!==t[2].length)return null;{const[e,s,i]=t.map(Number);e>12?[a,r,n]=[e,s,i]:[r,a,n]=[e,s,i]}}return"".concat(a,"-").concat(r,"-").concat(n)},f=e=>null===e||void 0===e?void 0:e.map((e=>{var t;if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase())return!1}if(!e.bruneiME||0===(null===e||void 0===e||null===(t=e.bruneiME)||void 0===t?void 0:t.length))return!1;const a=null===e||void 0===e?void 0:e.bruneiME[(null===e||void 0===e?void 0:e.bruneiME.length)-1];if(!(e=>{if(!e)return!1;const t=x(e),a=new Date,r=new Date(a.getFullYear(),a.getMonth()+3,1),n=new Date(a.getFullYear(),a.getMonth()+4,1);return t>=r&&t<=n})(a))return!1;return{empID:null===e||void 0===e?void 0:e.empID,empBadgeNo:null===e||void 0===e?void 0:e.empBadgeNo,name:null===e||void 0===e?void 0:e.name,dateOfJoin:g(null===e||void 0===e?void 0:e.doj)||"-",nationality:null===e||void 0===e?void 0:e.nationality,department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",medicalExpiryDate:g(a)||"-"}})).filter((e=>!1!==e));(0,n.useEffect)((()=>{const e=f(m);a(e)}),[m]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:null!==s&&void 0!==s&&s.length?s:t,tableHead:h,title:u,startDate:o?g(o):"",endDate:c?g(c):"",handleDate:(e,t)=>{const a=e.target.value,r=a?x(a):null;"startDate"===t&&d(r),"endDate"===t&&p(r);const n=m.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const a=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===a||void 0===a?void 0:a.toUpperCase())||"RESIGNATION"===(null===a||void 0===a?void 0:a.toUpperCase()))return!1;const n=e.bruneiME||[],s=n.length?x(n[n.length-1]):null;return!(!s||isNaN(s.getTime()))&&(!r||("startDate"===t&&c?s>=r&&s<=c:"endDate"!==t||!o||s>=o&&s<=r))})).map((e=>{const t=e.bruneiME[e.bruneiME.length-1];return{empID:null===e||void 0===e?void 0:e.empID,empBadgeNo:null===e||void 0===e?void 0:e.empBadgeNo,name:null===e||void 0===e?void 0:e.name,dateOfJoin:g(null===e||void 0===e?void 0:e.doj)||"-",nationality:null===e||void 0===e?void 0:e.nationality,department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",medicalExpiryDate:g(t)}}));l(n)}})})},Lo=["rawDateOfJoin"],Uo=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h]=(0,n.useState)(["Emp ID","Badge No","Name","Date of Birth","Gender","Date of Join","Nationality","Department","Other Department","Position","Other Position","contactNo","Brunei I/C No","Passport No","Pass Expiry","Contract Start Date","Contract End Date","IMMIGRATION REFERENCE NUMBER","EDUCATION LEVEL","Previous Company Name"]),x=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return x(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)},g=e=>e.filter((e=>(e=>{const t=new Date(e);if(isNaN(t.getTime()))return!1;const a=new Date;return t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth()})(e.doj))).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfBirth:x(e.dob)||"-",gender:e.gender||"-",dateOfJoin:x(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",contactNo:e.contactNo||"-",bruneiIcNo:e.bwnIcNo||"-",passportNo:e.ppNo||"-",passporExpiry:Array.isArray(e.ppExpiry)?x(e.ppExpiry[e.ppExpiry.length-1]):"-",contractStart:Array.isArray(e.contractStart)?x(e.contractStart[e.contractStart.length-1]):"-",contractEnd:Array.isArray(e.contractEnd)?x(e.contractEnd[e.contractEnd.length-1]):"-",immigRefNo:e.immigRefNo||"-",educLevel:e.educLevel||"-",previousEmployee:e.preEmp||"-",rawDateOfJoin:new Date(e.doj)}))).sort(((e,t)=>e.rawDateOfJoin-t.rawDateOfJoin)).map((e=>{let{rawDateOfJoin:t}=e;return(0,is.A)(e,Lo)}));(0,n.useEffect)((()=>{l(g(t))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.doj?new Date(e.doj):null;return!(!a||isNaN(a.getTime()))&&(n&&s?a>=n&&a<=s:n?a>=n:!s||a<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfBirth:x(e.dob)||"-",gender:e.gender||"-",dateOfJoin:x(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",contactNo:e.contactNo||"-",bruneiIcNo:e.bwnIcNo||"-",passportNo:e.ppNo||"-",passporExpiry:Array.isArray(e.ppExpiry)?x(e.ppExpiry[e.ppExpiry.length-1]):"-",contractStart:Array.isArray(e.contractStart)?x(e.contractStart[e.contractStart.length-1]):"-",contractEnd:Array.isArray(e.contractEnd)?x(e.contractEnd[e.contractEnd.length-1]):"-",immigRefNo:e.immigRefNo||"-",educLevel:e.educLevel||"-",previousEmployee:e.preEmp||"-"})));d(i)}})})},Bo=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(["Emp ID","Badge No","Name","MR No","PO No","CODE","COURSE / PROGRAMME","CONDUCTED BY","Course Fee","Department","Other Department","Position","Other Position","START DATE","END DATE","CERT. EXP","EXPIRED/VALID","Mandatory/ Supplementary","E-CERT RECEIVED","ORIGINAL CERT RECEIVED","REMARKS"]),g=e=>{if(!e)return"-";const t=new Date(e);if(isNaN(t.getTime()))return"-";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},f=e=>{if(!e)return"EXPIRED";return new Date(e)<new Date?"EXPIRED":"VALID"},v=e=>{if(!e)return!1;try{let t;t=Array.isArray(e)?e[0]:e,"string"===typeof t&&t.startsWith('"')&&t.endsWith('"')&&(t=JSON.parse(t));const a=t.replace(/([{,])\s*(\w+)\s*:/g,'$1"$2":'),r=JSON.parse(a);return Array.isArray(r)?r:[r]}catch(t){return console.error("Error normalizing traineeTrackData:",e),[]}};(0,n.useEffect)((()=>{l(t.filter((e=>{if(Array.isArray(null===e||void 0===e?void 0:e.workStatus)&&(null===e||void 0===e?void 0:e.workStatus.length)>0){const t=null===e||void 0===e?void 0:e.workStatus[(null===e||void 0===e?void 0:e.workStatus.length)-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase())return!1}return!0})).flatMap((e=>{const t=v(e.traineeTrack||"[]");if(!e.trainingProof)return!1;const a=v(e.trainingProof||"[]");return t.map((t=>{const r=a.find((e=>e.empID===t.empID&&e.traineeSD===t.traineeSD&&e.traineeED===t.traineeED))||{};return{empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",mrNo:t.MRNo||"-",poNo:r.poNo||"-",code:t.courseCode||"-",courseProgramme:t.courseName||"-",conductedBy:t.company||"-",courseFee:t.traineeCourseFee||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",startDate:g(t.traineeSD)||"-",endDate:g(t.traineeED)||"-",certExp:g(r.certifiExpiry)||"-",expiredValid:f(r.certifiExpiry),mandatorySupplementary:t.traineeStatus||"-",eCertReceived:g(r.eCertifiDate)||"-",originalCertReceived:g(r.orgiCertifiDate)||"-",remarks:r.tcRemarks||"-"}}))})))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,startDate:c,endDate:m,tableHead:h,title:a,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];return!["TERMINATION","RESIGNATION"].includes(null===t||void 0===t?void 0:t.toUpperCase())})).flatMap((e=>v(e.traineeTrack||"[]").filter((e=>{const t=new Date(e.traineeSD),a=new Date(e.traineeED);return!(!t||!a||isNaN(t)||isNaN(a))&&(n&&s?t>=n&&a<=s:n?t>=n:!s||a<=s)})).map((t=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",MRNo:e.MRNo||"-",poNo:e.poNo||"-",courseCode:e.courseCode||"-",courseName:e.courseName||"-",company:e.company||"-",traineeCourseFee:e.traineeCourseFee||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",traineeSD:g(t.traineeSD),traineeED:g(t.traineeED),certifiExpiry:Array.isArray(e.certifiExpiry)?g(e.certifiExpiry[e.certifiExpiry.length-1]):"-",expAndValid:f(e.certifiExpiry),traineeStatus:e.traineeStatus||"-",eCertifiDate:Array.isArray(e.eCertifiDate)?g(e.eCertifiDate[e.eCertifiDate.length-1]):"-",orgiCertifiDate:Array.isArray(e.orgiCertifiDate)?g(e.orgiCertifiDate[e.orgiCertifiDate.length-1]):"-",remark:e.remark||"-",rawCertifiExpiry:new Date(e.certifiExpiry)})))));d(i)}})})},qo=["rawDateOfJoin"],Ho=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h]=(0,n.useState)(["Emp ID","Badge No","Name","Gender","Date of Birth","Date of Join","Nationality","SKILL POOL","department","Other Department","Position","Other Position","Upgrade Position","contact No","Brunei I/C No","Malaysian IC No","Passport No","IMMIGRATION REFERENCE NUMBER","Pass Expiry","Company Name of Previous Employment","Previous Employment Period","EDUCATION LEVEL","CV RECEIVED FROM"]),x=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return x(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)};(0,n.useEffect)((()=>{l(t.filter((e=>{if(!e.doj)return!1;if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1].toUpperCase();if("TERMINATION"===t||"RESIGNATION"===t)return!1}return!0})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",gender:e.gender||"-",dateOfBirth:x(e.dob)||"-",dateOfJoin:x(e.doj)||"-",nationality:e.nationality||"-",skillPool:e.skillPool||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",upgradePosition:Array.isArray(e.upgradePosition)?x(e.upgradePosition[e.upgradePosition.length-1]):"-",contactNo:e.contactNo||"-",bruneiIcNo:e.bwnIcNo||"-",malaysianIcNo:e.myIcNo||"-",passportNo:Array.isArray(e.ppNo)?x(e.ppNo[e.ppNo.length-1]):"-",immigRefNo:e.immigRefNo||"-",passExpiry:Array.isArray(e.empPassExp)?x(e.empPassExp[e.empPassExp.length-1]):"-",preEmp:e.preEmp||"-",preEmpPeriod:e.preEmpPeriod||"-",educLevel:e.educLevel||"-",agent:e.agent||"-",rawDateOfJoin:new Date(e.doj)}))).sort(((e,t)=>e.rawDateOfJoin-t.rawDateOfJoin)).map((e=>{let{rawDateOfJoin:t}=e;return(0,is.A)(e,qo)})))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.doj?new Date(e.doj):null;return!(!a||isNaN(a.getTime()))&&(n&&s?a>=n&&a<=s:n?a>=n:!s||a<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",gender:e.gender||"-",dateOfBirth:x(e.dob)||"-",dateOfJoin:x(e.doj)||"-",nationality:e.nationality||"-",skillPool:e.skillPool||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",upgradePosition:Array.isArray(e.upgradePosition)?x(e.upgradePosition[e.upgradePosition.length-1]):"-",contactNo:e.contactNo||"-",bruneiIcNo:e.bwnIcNo||"-",malaysianIcNo:e.myIcNo||"-",passportNo:Array.isArray(e.ppNo)?x(e.ppNo[e.ppNo.length-1]):"-",immigRefNo:e.immigRefNo||"-",passExpiry:Array.isArray(e.empPassExp)?x(e.empPassExp[e.empPassExp.length-1]):"-",preEmp:e.preEmp||"-",preEmpPeriod:e.preEmpPeriod||"-",educLevel:e.educLevel||"-",agent:e.agent||"-"})));d(i)}})})},Wo=["rawGhsd"],zo=["rawGhsd"],Yo=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h]=(0,n.useState)(["Emp ID","Badge No","Name","Date of Join","Nationality","Department","Other Department","Position","Other Position","Group H&S Insurance","Group H&S Insurance Enrollment Effective Date","Group H&S Insurance Enrollment End Date"]);(0,n.useEffect)((()=>{l(t.filter((e=>{if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===t.toUpperCase()||"RESIGNATION"===t.toUpperCase())return!1}return Array.isArray(e.groupInsEffectDate)&&e.groupInsEffectDate.length>0&&e.groupInsEffectDate.every((e=>e&&!isNaN(new Date(e).getTime())))})).filter((e=>e.groupInsEffectDate[e.groupInsEffectDate.length-1])).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:y(e.doj),nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",groupIns:e.groupIns||"-",groupInsEffectDate:Array.isArray(e.groupInsEffectDate)?y(e.groupInsEffectDate[e.groupInsEffectDate.length-1]):"-",groupInsEndDate:Array.isArray(e.groupInsEndDate)?y(e.groupInsEndDate[e.groupInsEndDate.length-1]):"-",rawGhsd:new Date(e.groupInsEffectDate)}))).sort(((e,t)=>e.rawGhsd-t.rawGhsd)).map((e=>{let{rawGhsd:t}=e;return(0,is.A)(e,Wo)})))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.groupInsEffectDate||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:y(e.doj),nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",groupIns:e.groupIns||"-",groupInsEffectDate:Array.isArray(e.groupInsEffectDate)?y(e.groupInsEffectDate[e.groupInsEffectDate.length-1]):"-",groupInsEndDate:Array.isArray(e.groupInsEndDate)?y(e.groupInsEndDate[e.groupInsEndDate.length-1]):"-",rawGhsd:new Date(e.groupInsEffectDate)}))).sort(((e,t)=>e.rawGhsd-t.rawGhsd)).map((e=>{let{rawGhsd:t}=e;return(0,is.A)(e,zo)}));d(i)}})})},Vo=["rawAld"],Go=["rawAld"],Jo=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(["Emp ID","Badge No","Name","Date of Join","Nationality","Department","Other Department","Position","Contract Start Date","Contract End Date","LEAVE PASSAGE ENTITLEMENT","LEAVE PASSAGE DESTINATION"]),g=e=>{if(Array.isArray(e)){const t=e.filter((e=>!isNaN(new Date(e).getTime())));return 0===t.length?"-":g(t[t.length-1])}if(!e)return"-";const t=new Date(e);if(isNaN(t.getTime()))return"-";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)};(0,n.useEffect)((()=>{l(t.filter((e=>Array.isArray(e.dateLeavePass)&&e.dateLeavePass.length>0&&e.dateLeavePass.every((e=>e&&!isNaN(new Date(e).getTime()))))).filter((e=>e.dateLeavePass[e.dateLeavePass.length-1])).filter((e=>{if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1].toUpperCase();if("TERMINATION"===t||"RESIGNATION"===t)return!1}return!0})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",contractStart:g(e.contractStart)||"-",contractEnd:g(e.contractEnd)||"-",leavePassageEntitlement:g(e.dateLeavePass)||"-",leavePassageDestination:e.destinateLeavePass||"-",rawAld:new Date(e.dateLeavePass)||"-"}))).sort(((e,t)=>e.rawAld-t.rawAld)).map((e=>{let{rawAld:t}=e;return(0,is.A)(e,Vo)})))}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,title:a,startDate:c,endDate:m,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.dateLeavePass||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:g(e.doj)||"-",nationality:e.nationality||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",contractStart:g(e.contractStart)||"-",contractEnd:g(e.contractEnd)||"-",leavePassageEntitlement:g(e.dateLeavePass)||"-",leavePassageDestination:e.destinateLeavePass||"-",rawAld:new Date(e.dateLeavePass)||"-"}))).sort(((e,t)=>e.rawAld-t.rawAld)).map((e=>{let{rawAld:t}=e;return(0,is.A)(e,Go)}));d(i)}})})},Ko=e=>{let{userID:t,userType:a}=e;const{contractForms:l}=(0,n.useContext)(s.Y),o=(0,r.Zp)(),d=(0,r.zy)(),{gmPosition:c,HRMPosition:p}=(0,Fe.b)(),{allData:m,title:u}=d.state||{},[h,x]=(0,n.useState)([]),[f,v]=(0,n.useState)([]),[y,N]=(0,n.useState)([]),[b,D]=(0,n.useState)(""),[j,w]=(0,n.useState)(""),[S,E]=(0,n.useState)(null),[I,k]=(0,n.useState)([]),[T]=(0,n.useState)(["Emp ID","Badge No","Name","Nationality","Date of Join","Department","other Department","Position","Other Position","Contract Start Date","Contract End Date","LD Expiry","SuperAdmin"!==a&&"Status"].filter(Boolean)),C=e=>{if("string"===typeof e&&/^\d{2}-\d{2}-\d{4}$/.test(e))return e;if(Array.isArray(e)){if(0===e.length)return"-";const t=e[e.length-1];return C(t)}if(!e)return"-";const t=new Date(e);if(isNaN(t.getTime()))return"-";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)};(0,n.useEffect)((()=>{if(m.length>0&&l.length>0){const e=(e=>{const t=new Set,r=l.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).map((r=>{var n,s,i,l;if(t.has(r.empID))return null;t.add(r.empID);const o=e.find((e=>e.empID===r.empID));if(!o)return null;const d=Array.isArray(o.workStatus)&&o.workStatus.length>0?o.workStatus[o.workStatus.length-1]:"";if("TERMINATION"===d.toUpperCase()||"RESIGNATION"===d.toUpperCase())return null;const m=o.contractEnd||[],u=m[m.length-1];if(!u||!0!==o.contStatus)return null;const h=o.contractStart||[],x=h[h.length-1],f=new Date,v=null===(n=o.positionRevDate)||void 0===n?void 0:n[o.positionRevDate.length-1],y=null===(s=o.positionRev)||void 0===s?void 0:s[o.positionRev.length-1],N=null===(i=o.upgradePosition)||void 0===i?void 0:i[o.upgradePosition.length-1],b=null===(l=o.upgradeDate)||void 0===l?void 0:l[o.upgradeDate.length-1];let D;const j=v?new Date(v):null,A=b?new Date(b):null;var w;if(j&&A){if(j.toDateString()===A.toDateString())D=null===(w=o.position)||void 0===w?void 0:w[o.position.length-1];else if(j>A){var S;D=f>=j?y:f>=A?N:null===(S=o.position)||void 0===S?void 0:S[o.position.length-1]}else if(A>j){var E;D=f>=A?N:f>=j?y:null===(E=o.position)||void 0===E?void 0:E[o.position.length-1]}}else if(j&&!A)D=f>=j&&y;else if(A&&!j)D=f>=A&&N;else{var I;D=null===(I=o.position)||void 0===I?void 0:I[o.position.length-1]}return(0,g.A)((0,g.A)((0,g.A)((0,g.A)({empID:o.empID,empBadgeNo:o.empBadgeNo,name:o.name,nationality:o.nationality,dateOfJoin:C(o.doj),department:Array.isArray(o.department)&&o.department[o.department.length-1],otherDepartment:Array.isArray(o.otherDepartment)&&o.otherDepartment[o.otherDepartment.length-1],position:D,otherPosition:Array.isArray(o.otherPosition)&&o.otherPosition[o.otherPosition.length-1],contractStartDate:C(x),contractEndDate:C(u),oldCED:C(r.oldCED),nlmsEmpApproval:Array.isArray(o.nlmsEmpValid)?C(o.nlmsEmpValid[o.nlmsEmpValid.length-1]):"N/A",headStatus:r.depHead,hrmStatus:r.hrManager,gmStatus:r.genManager,matchedID:r.id},"Manager"===a&&"GENERAL MANAGER"!==c&&"HR MANAGER"!==p&&{status:r.depHead?"Approved":"Pending"}),"HR MANAGER"===p?{status:r.hrManager?"Approved":"Pending"}:{}),"GENERAL MANAGER"===c&&{status:r.genManager?"Approved":"Pending"}),"HR"===a&&{status:r.hrSign&&"extended"===r.extendedStatus?"Extended":"Not Extended"})})).filter((e=>null!==e)).sort(((e,t)=>{const a=e=>"Pending"===e.status?1:"Not Extended"===e.status?2:3;return a(e)-a(t)}));return N(r),r})(m);x(e)}}),[m,l,a,c,t,p]);const R=()=>{E(null)},P=e=>{R(),S&&o("/contractForms",{state:{employeeData:S,matchedID:e}})};return(0,i.jsxs)("div",{children:[(0,i.jsx)($l,{tableBody:f.length?f:h,startDate:b,endDate:j,tableHead:T,title:u,allData:m,handleDate:(e,t)=>{const r=e.target.value;"startDate"===t&&D(r),"endDate"===t&&w(r);const n="startDate"===t?new Date(r):b?new Date(b):null,s="endDate"===t?new Date(r):j?new Date(j):null,i=h.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=(null===e||void 0===e?void 0:e.contractEnd)||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>{var t,r,n,s;const i=e.contractEnd||[],l=i[i.length-1],o=e.contractStart||[],d=o[o.length-1],m=new Date,u=null===(t=e.positionRevDate)||void 0===t?void 0:t[e.positionRevDate.length-1],h=null===(r=e.positionRev)||void 0===r?void 0:r[e.positionRev.length-1],x=null===(n=e.upgradePosition)||void 0===n?void 0:n[e.upgradePosition.length-1],f=null===(s=e.upgradeDate)||void 0===s?void 0:s[e.upgradeDate.length-1];let v;const y=u?new Date(u):null,N=f?new Date(f):null;var b;if(y&&N){if(y.toDateString()===N.toDateString())v=null===(b=e.position)||void 0===b?void 0:b[e.position.length-1];else if(y>N){var D;v=m>=y?h:m>=N?x:null===(D=e.position)||void 0===D?void 0:D[e.position.length-1]}else if(N>y){var j;v=m>=N?x:m>=y?h:null===(j=e.position)||void 0===j?void 0:j[e.position.length-1]}}else if(y&&!N)v=m>=y&&h;else if(N&&!y)v=m>=N&&x;else{var A;v=null===(A=e.position)||void 0===A?void 0:A[e.position.length-1]}return(0,g.A)((0,g.A)((0,g.A)({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",nationality:e.nationality||"-",dateOfJoin:C(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:v,otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",contractStartDate:C(d)||"-",contractEndDate:C(l)||"-",nlmsEmpApproval:Array.isArray(e.nlmsEmpValid)?C(e.nlmsEmpValid[e.nlmsEmpValid.length-1]):"-"},"Manager"===a&&"GENERAL MANAGER"!==c&&"HR MANAGER"!==p&&{status:e.depHead?"Approved":"Pending"}),"HR MANAGER"===p||"HR"===a?{status:e.hrManager?"Approved":"Pending"}:{}),"GENERAL MANAGER"===c&&{status:e.genManager?"Approved":"Pending"})}));v(i)},handleViewDetails:e=>{const t=l.filter((t=>t.empID===e.empID&&""!==t.genManager.trim()));k(t),E(e)}}),S&&(0,i.jsx)("div",{className:"fixed inset-0 center z-50 bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg lg:w-1/3 w-1/2 h-[600px] overflow-y-auto",children:[(0,i.jsxs)("section",{className:"flex justify-between gap-10 items-center mb-5",children:[(0,i.jsx)("div",{className:"w-full flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[200px]",src:Se.A,alt:"Logo"})}),(0,i.jsx)("button",{className:"text-[24px] rounded",onClick:R,children:(0,i.jsx)(A.RQJ,{})})]}),(0,i.jsx)("h2",{className:"text-xl font-semibold underline text-center mb-5",children:"Person Details"}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Name"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",S.name]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Emp ID"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",S.empID]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Emp Badge No"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",S.empBadgeNo]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Nationality"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",S.nationality]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Date of Join"})," ",(0,i.jsxs)("span",{className:" flex-1",children:[": \xa0",S.dateOfJoin]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Position:"}),(0,i.jsxs)("span",{className:" flex-1",children:["  : \xa0","OTHER"===S.position?S.otherPosition:S.position]})]}),(0,i.jsxs)("p",{className:"flex mb-2",children:[(0,i.jsx)("strong",{className:"w-[30%]",children:"Department:"}),(0,i.jsxs)("span",{className:" flex-1",children:["  : \xa0","OTHER"===S.department?S.otherDepartment:S.department]})]}),I.length>0&&(0,i.jsxs)("div",{className:"mt-10",children:[(0,i.jsx)("h5",{className:"text-xl font-semibold text-center mb-5",children:"Contract Extension History"}),(0,i.jsx)("div",{className:" center",children:(0,i.jsx)("div",{className:"py-7 max-w-[350px] w-full center shadow-[2px_2px_8px_rgba(0,0,0,0.3)] rounded-md",children:(0,i.jsxs)("table",{className:"border ",children:[(0,i.jsx)("thead",{className:"border ",children:(0,i.jsxs)("tr",{className:"bg-medium_grey  text-white  border",children:[(0,i.jsx)("th",{className:"border px-3 py-2",children:"No of Time"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Date"}),(0,i.jsx)("th",{className:"border px-3 py-2",children:"Action"})]})}),(0,i.jsx)("tbody",{className:"text-sm",children:I.map(((e,t)=>(0,i.jsxs)("tr",{children:[(e.genManager||""!==e.genManager.trim())&&(0,i.jsx)("th",{className:"border px-3 py-2 text-dark_grey",children:t+1}),(e.genManager||""!==e.genManager.trim())&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("th",{className:"border px-3 py-2 text-dark_grey",children:C(e.oldCED)}),(0,i.jsx)("th",{className:"border px-3 py-2 text-blue underline cursor-pointer",onClick:()=>P(e.id),children:"View"})]})]},t)))})]})})})]}),!S.gmStatus&&(0,i.jsx)("div",{className:"flex justify-evenly items-center p-3 mt-10",children:(0,i.jsx)("button",{className:"primary_btn",onClick:()=>S.gmStatus?P():P(S.matchedID),children:"Go to Contract Form"})})]})})]})},Qo=["rawUD"],$o=["rawUD"],Zo=()=>{const e=(0,r.zy)(),{allData:t,title:a}=e.state||{},[s,l]=(0,n.useState)([]),[o,d]=(0,n.useState)([]),[c,p]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[h]=(0,n.useState)(["Emp ID","Badge No","Name","Date of Join","Department","Other Department","Position","other Position","UPGRADE POSITION","UPGRADE POSITION EFFECTIVE DATE"]),x=(e,t)=>{if(Array.isArray(e)){if(0===e.length)return"-";const a=e[e.length-1];return x(a,t)}if(!e)return"-";const a=new Date(e);if(isNaN(a.getTime()))return"-";const r=String(a.getDate()).padStart(2,"0"),n=String(a.getMonth()+1).padStart(2,"0"),s=a.getFullYear();return"".concat(r,"-").concat(n,"-").concat(s)};(0,n.useEffect)((()=>{const e=(e=>e.filter((e=>Array.isArray(e.upgradeDate)&&e.upgradeDate.length>0&&e.upgradeDate.every((e=>e&&!isNaN(new Date(e).getTime()))))).filter((e=>{if(Array.isArray(e.workStatus)&&e.workStatus.length>0){const t=e.workStatus[e.workStatus.length-1].toUpperCase();if("TERMINATION"===t||"RESIGNATION"===t)return!1}return!0})).map((e=>{const t=e.upgradeDate[e.upgradeDate.length-1];return{empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:x(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",upgradePosition:Array.isArray(e.upgradePosition)?e.upgradePosition[e.upgradePosition.length-1]:"-",upgradeDate:x(t)||"-",rawUD:new Date(t)}})).sort(((e,t)=>e.rawUD-t.rawUD)).map((e=>{let{rawUD:t}=e;return(0,is.A)(e,Qo)})))(t);l(e)}),[t]);return(0,i.jsx)("div",{children:(0,i.jsx)($l,{tableBody:o.length?o:s,tableHead:h,startDate:c,endDate:m,title:a,handleDate:(e,a)=>{const r=e.target.value;"startDate"===a&&p(r),"endDate"===a&&u(r);const n="startDate"===a?new Date(r):c?new Date(c):null,s="endDate"===a?new Date(r):m?new Date(m):null,i=t.filter((e=>{if(!Array.isArray(e.workStatus)||0===e.workStatus.length)return!1;const t=e.workStatus[e.workStatus.length-1];if("TERMINATION"===(null===t||void 0===t?void 0:t.toUpperCase())||"RESIGNATION"===(null===t||void 0===t?void 0:t.toUpperCase()))return!1;const a=e.upgradeDate||[],r=a.length?new Date(a[a.length-1]):null;return!(!r||isNaN(r.getTime()))&&(n&&s?r>=n&&r<=s:n?r>=n:!s||r<=s)})).map((e=>({empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:x(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:Array.isArray(e.position)?e.position[e.position.length-1]:"-",otherPosition:Array.isArray(e.otherPosition)?e.otherPosition[e.otherPosition.length-1]:"-",upgradePosition:Array.isArray(e.upgradePosition)?e.upgradePosition[e.upgradePosition.length-1]:"-",upgradeDate:x(e.upgradeDate[e.upgradeDate.length-1]),rawUD:new Date(e.upgradeDate[e.upgradeDate.length-1])}))).sort(((e,t)=>e.rawUD-t.rawUD)).map((e=>{let{rawUD:t}=e;return(0,is.A)(e,$o)}));d(i)}})})},Xo=()=>{const{SRData:e}=(0,n.useContext)(s.Y),{SubmitWIData:t}=wn(),{WIUpdateData:a}=En();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["ServiceRecordedMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/ServiceRecord/ServiceRecord.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["doj","contractStart","contractEnd","probationEnd","probationStart","upgradeDate"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{workInfoDataRecord:r});await a({workInfoUpValue:e})}else console.log(p,"create"),await t({workInfoValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},ed=()=>{const{PPValidsData:e}=(0,n.useContext)(s.Y),{ImmigrationData:t}=Bi(),{UpdateImmigraData:a}=qi();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["PassportValidMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/PassportValid+Prod/PassportValid+2.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["empPassExp","immigApproval","ppSubmit"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{id:r.id});await a({UpImmiValue:e})}else console.log(p,"create"),await t({ImmiValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},td=()=>{const{DNData:e}=(0,n.useContext)(s.Y),{uploadNlmsFun:t}=Pi();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["NlmsMD",(0,i.jsx)("button",{onClick:async()=>{try{const a=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/DNDetails+Prod/DNDetails+3.csv",{responseType:"arraybuffer"}),r=new Uint8Array(a.data);console.log(r);const n=ei.LF(r,{type:"array"}),s=n.SheetNames[0],i=n.Sheets[s],l=ei.Wp.sheet_to_json(i,{header:1}),o=["nlmsEmpValid"],d=l.slice(1).map((e=>{let t={};return l[0].forEach(((a,r)=>{let n=e[r];o.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const c of d){c.empID&&(c.empID=String(c.empID)),console.log(c);const a=e.find((e=>e.empID===c.empID));if(a){console.log("update");const e=(0,g.A)((0,g.A)({},c),{},{id:a.id});await t({DoeValue:e})}}}catch(a){console.error("Error fetching Excel file:",a)}},children:"Click Here"})]})},ad=()=>{const{LMIData:e}=(0,n.useContext)(s.Y),{SubmitMPData:t}=On(),{updateMedicalSubmit:a}=_n();console.log(e);return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["LabourMedicalInfoMD",(0,i.jsx)("button",{onClick:async()=>{try{const r=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/LabourMedicalInfo+Prod/LabourMedicalInfo+2.csv",{responseType:"arraybuffer"}),n=new Uint8Array(r.data);console.log(n);const s=ei.LF(n,{type:"array"}),i=s.SheetNames[0],l=s.Sheets[i],o=ei.Wp.sheet_to_json(l,{header:1}),d=["bruneiME"],c=o.slice(1).map((e=>{let t={};return o[0].forEach(((a,r)=>{let n=e[r];d.includes(a)&&!isNaN(n)&&(n=(e=>{const t=new Date(Date.UTC(1900,0,1)),a=e-2;return new Date(t.getTime()+24*a*60*60*1e3)})(n).toISOString().split("T")[0]),t[a]=void 0!==n?String(n):n})),t}));for(const p of c){if(!p.empID)continue;p.empID&&(p.empID=String(p.empID)),console.log(p);const r=e.find((e=>e.empID===p.empID));if(r){console.log(p,"update");const e=(0,g.A)((0,g.A)({},p),{},{LabTable:r.id});await a({LabUpValue:e})}else console.log(p,"create"),await t({labValue:p})}}catch(r){console.error("Error fetching Excel file:",r)}},children:"Click Here"})]})},rd=(0,Ee.D)(),nd=e=>{let{contentRef:t}=e;const{contractForm:a}=(()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1),[s,i]=(0,n.useState)(null);return{contractForm:async e=>{t(!0),r(!1),i(null);try{const t=await rd.graphql({query:ke.vj,variables:{input:e}});console.log("API Response:",t),r(!0)}catch(a){console.error("Error during API call:",a),i(a)}finally{t(!1)}},isLoading:e,notification:a,error:s}})(),{gmPosition:l,PDInfo:o,HRMPosition:d}=(0,Fe.b)(),{contractDetails:c}=(()=>{const e=(0,Ee.D)();return{contractDetails:(0,n.useCallback)((async t=>{let{ContractValue:a}=t;if(!a)throw new Error("Missing required parameters or empID");try{const{conAttn:t,depHead:r,contStatus:n,hrManager:s,genManager:i,remarks:l,oldCED:o,gmDate:d,extendedStatus:c,hrmDate:p,managerDate:m,remarkHr:u,remarkGm:h,renewalContract:x,id:g,hrSign:f,hrDate:v}=a,y={conAttn:t,depHead:r,hrManager:s,genManager:i,remarks:l,remarkHr:u,remarkGm:h,contStatus:n,oldCED:o,gmDate:d,extendedStatus:c,hrmDate:p,managerDate:m,renewalContract:x,hrSign:f,hrDate:v,id:g};await e.graphql({query:ke.Qb,variables:{input:y}})}catch(r){throw console.error("Error updating data:",r),r}}),[])}})(),{contractForms:p,workInfoData:m,empPIData:u}=(0,n.useContext)(s.Y),h=(0,r.zy)(),{employeeData:x,matchedID:f}=h.state||{},{createNotification:v}=_e(),[y,N]=(0,n.useState)(""),[b,D]=(0,n.useState)(""),[j,A]=(0,n.useState)(!1),[w,S]=(0,n.useState)(!1),[E,I]=(0,n.useState)(!1),[k,T]=(0,n.useState)(!1),C=null===x||void 0===x?void 0:x.contractEndDate,[R,P]=(0,n.useState)({managerEmpID:"",managerOfficialMail:"",managerName:"",hrEmail:"Hr-notification@adininworks.com",genManagerEmail:[]}),[O,_]=(0,n.useState)({contract:{empID:"",conAttn:"",depHead:"",hrManager:"",genManager:"",remarks:"",remarkHr:"",hrmDate:"",managerDate:"",remarkGm:"",extendedStatus:"noExtended",gmDate:"",renewalContract:"",status:"",createdAt:"",hrSign:"",hrDate:""}}),M=e=>{const{name:t,value:a}=e.target;_((e=>(0,g.A)((0,g.A)({},e),{},{contract:(0,g.A)((0,g.A)({},e.contract),{},{[t]:a})})))};(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");N(e)}),[]),(0,n.useEffect)((()=>{if(m.length>0&&null!==x&&void 0!==x&&x.empID){const e=m.find((e=>e.empID===x.empID));if(e){const t=e.manager;if(P((e=>(0,g.A)((0,g.A)({},e),{},{managerEmpID:t}))),t&&t.length>0){const e=u.find((e=>e.empID===String(t[0])));e&&P((t=>(0,g.A)((0,g.A)({},t),{},{managerOfficialMail:e.officialEmail,managerName:e.name})))}const a=null===m||void 0===m?void 0:m.filter((e=>{var t,a,r;return null===e||void 0===e||null===(t=e.position)||void 0===t||null===(a=t[(null===e||void 0===e||null===(r=e.position)||void 0===r?void 0:r.length)-1])||void 0===a?void 0:a.includes("GENERAL MANAGER")}));if((null===a||void 0===a?void 0:a.length)>0){const e=[];null===a||void 0===a||a.forEach((t=>{const a=u.find((e=>e.empID===String(t.empID)));a?(e.push(a.officialEmail),P((t=>(0,g.A)((0,g.A)({},t),{},{genManagerEmail:e})))):console.log("GM Info not found.")}))}else console.log("No GENERAL MANAGER positions found.")}}}),[m,null===x||void 0===x?void 0:x.empID,u]),(0,n.useEffect)((()=>{if(p.length>0){const e=p.filter((e=>e.id===f)).find((e=>e.empID===(null===x||void 0===x?void 0:x.empID)));e&&(_({contract:{conAttn:e.conAttn,depHead:e.depHead,hrManager:e.hrManager,genManager:e.genManager,remarks:e.remarks,managerDate:e.managerDate,remarkHr:e.remarkHr,hrmDate:e.hrmDate,remarkGm:e.remarkGm,gmDate:e.gmDate,hrDate:e.hrDate,hrSign:e.hrSign,extendedStatus:e.extendedStatus||"noExtended",createdAt:e.createdAt,renewalContract:e.renewalContract}}),T("extended"===e.extendedStatus))}}),[p,null===x||void 0===x?void 0:x.empID]);const F=async()=>{let e=null,t=null,r=null;try{var n;if("HR MANAGER"===d&&(!O.contract.hrManager||!O.contract.hrmDate)&&(""===O.contract.hrManager.trim()||""===O.contract.hrmDate.trim()))return void alert("HRM Name and Date is required!");if("GENERAL MANAGER"===l&&(!O.contract.genManager||!O.contract.gmDate)&&(""===O.contract.genManager.trim()||""===O.contract.gmDate.trim()))return void alert("GM Name and Date is required!");if("HR"===y&&(!O.contract.hrSign||!O.contract.hrDate)&&(""===O.contract.hrSign.trim()||""===O.contract.hrDate.trim()))return void alert("HR Name and Date is required!");if("Manager"===y&&"GENERAL MANAGER"!==l&&"HR MANAGER"!==d&&(!O.contract.depHead||!O.contract.managerDate)&&(""===O.contract.depHead.trim()||""===O.contract.managerDate.trim()))return void alert(" Department Head Name and Date is required!");S(!0);const s=p.find((e=>e.empID===(null===x||void 0===x?void 0:x.empID))),i=u.find((e=>(null===e||void 0===e?void 0:e.empID)===(null===x||void 0===x?void 0:x.empID))),h=m.find((e=>(null===e||void 0===e?void 0:e.empID)===(null===x||void 0===x?void 0:x.empID))),N=null===i||void 0===i?void 0:i.name,b=Array.isArray(null===h||void 0===h?void 0:h.contractEnd)&&(null===h||void 0===h||null===(n=h.contractEnd)||void 0===n?void 0:n.length)>0?h.contractEnd[h.contractEnd.length-1].split("-").reverse().join("/"):"Not mentioned";let j="";"HR MANAGER"===d&&(j=!k&&"gmView"),"GENERAL MANAGER"===l&&(j=!k&&"noExtended"),"HR"===y&&(j=k&&"extended"),"Manager"===y&&"GENERAL MANAGER"!==l&&"HR MANAGER"!==d&&(j=!k&&"hrmView");const w=(0,g.A)({empID:x.empID,conAttn:O.contract.conAttn,depHead:O.contract.depHead,hrManager:O.contract.hrManager,genManager:O.contract.genManager,remarks:O.contract.remarks,managerDate:O.contract.managerDate,remarkHr:O.contract.remarkHr,hrmDate:O.contract.hrmDate,remarkGm:O.contract.remarkGm,gmDate:O.contract.gmDate,hrDate:O.contract.hrDate,hrSign:O.contract.hrSign,extendedStatus:j,renewalContract:O.contract.renewalContract,contStatus:!0},"hrmView"===j&&{oldCED:C});if(f){const e=(0,g.A)((0,g.A)({},w),{},{id:f});await c({ContractValue:e})}else await a(w);"HR MANAGER"===d?e=await(async(e,t,a)=>{const r="Contract Verification by HR",n="Your Employee Mr./Ms. ".concat(e||"Not mentioned","'s contract period ending on ").concat(t||"Not Mentioned",", has been verified by HR.");if(Array.isArray(null===a||void 0===a?void 0:a.genManagerEmail))for(let s of a.genManagerEmail){const a=await Me(r,"<html>\n          <body>\n            <p>Your Employee Mr./Ms. ".concat(e||"Not mentioned","'s contract period ending on ").concat(t||"Not Mentioned",',\n              <br/>\n              has been verified by HR.\n            </p>\n            <p>Click here <a href="https://hr.adininworks.co">to view the updates.</a></p>\n          </body>\n        </html>'),"hr_no-reply@adininworks.com",s);return await v({empID:null===x||void 0===x?void 0:x.empID,leaveType:r,message:n,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:s}),a}})(N,b,R):"Manager"===y&&"GENERAL MANAGER"!==l&&"HR MANAGER"!==d?t=await(async(e,t,a,r)=>{const n="Contract Review by Manager",s="Your Employee Mr./Ms. ".concat(e||"Not mentioned","'s contract period ending on ").concat(t||"Not Mentioned",", has been reviewed by Manager, ").concat(a||"Not Mentioned","."),i=await Me(n,"<html>\n      <body>\n        <p>Your Employee Mr./Ms. ".concat(e||"Not mentioned","'s contract period ending on ").concat(t||"Not Mentioned",",\n          <br/>\n          has been reviewed by Manager, ").concat(a||"Not Mentioned",'.\n        </p>\n        <p>Click here <a href="https://hr.adininworks.co">to view the updates.</a></p>\n      </body>\n    </html>'),"hr_no-reply@adininworks.com",null===r||void 0===r?void 0:r.hrEmail);return await v({empID:null===x||void 0===x?void 0:x.empID,leaveType:n,message:s,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:null===r||void 0===r?void 0:r.hrEmail}),i})(N,b,o,R):"GENERAL MANAGER"===l&&(r=await(async(e,t,a)=>{const r="Contract Confirmation by General Manager",n="Your Employee Mr./Ms. ".concat(e||"Not mentioned","'s contract period ending on ").concat(t||"Not Mentioned",", has been confirmed by the GENERAL MANAGER."),s=await Me(r,"<html>\n      <body>\n        <p>Your Employee Mr./Ms. ".concat(e||"Not mentioned","'s contract period ending on ").concat(t||"Not Mentioned",',\n          <br/>\n          has been confirmed by the GENERAL MANAGER,\n        </p>\n        <p>Please proceed with the necessary actions.</p>\n        <p>Click here <a href="https://hr.adininworks.co">to view the updates.</a></p>\n      </body>\n    </html>'),"hr_no-reply@adininworks.com",a.hrEmail);return await v({empID:null===x||void 0===x?void 0:x.empID,leaveType:r,message:n,senderEmail:"hr_no-reply@adininworks.com",receipentEmail:null===a||void 0===a?void 0:a.hrEmail}),s})(N,b,R));("success"===t||"success"===e||"success"===r)&&(D(s?"Contract Form Updated Successfully":"Contract Form Created Successfully"),A(!0))}catch(s){console.error("Submission error:",s),D("Error occurred during submission"),A(!0)}finally{S(!1)}};let L="Invalid Date";if(C){const[e,t,a]=C.split("-"),r=new Date("".concat(a,"-").concat(t,"-").concat(e));isNaN(r)||(L=r.toLocaleDateString("en-US",{month:"long",year:"numeric"}))}const U=(0,n.useRef)(),B=(0,Ir.useReactToPrint)({content:()=>U.current,onBeforePrint:()=>console.log("Preparing to print PDF..."),onAfterPrint:()=>console.log("Print complete")});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{id:"capture-section",className:"container mx-auto px-8 print-contract-form",ref:U,children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("style",{children:"\n              @media print {\n                   .no-print, .no-print-parent {\n                      display: none !important;\n                     \n                   }\n                }\n           "}),(0,i.jsxs)("section",{className:"flex items-center pt-4 ",children:[(0,i.jsx)(r.N_,{to:"/reports",id:"left-button",className:"no-print left-button text-xl text-start w-[50px] text-grey",children:(0,i.jsx)(Tt.QVr,{})}),(0,i.jsx)("div",{className:" w-full center pr-10",children:(0,i.jsx)("img",{className:" max-w-[300px]",src:Se.A,alt:"Logo not found"})})]}),(0,i.jsx)("div",{className:"text-center text-sm font-bold uppercase w-full py-6",children:"Contract Completion Form for the Month of ".concat(L)}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("label",{className:"text-sm",children:"Attention:"}),(0,i.jsx)("input",{type:"text",name:"conAttn",value:O.contract.conAttn,onChange:M,className:"ml-2 border-b border-black focus:outline-none"})]}),(0,i.jsx)("div",{className:"w-full print-box",children:(0,i.jsxs)("table",{className:"min-w-full table-fixed print:table-auto print:w-[95%] text-xs text-center border-collapse border",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"border p-1 py-4",children:"No."}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Employee Name"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Emp ID"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Badge No."}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Position"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Department"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Nationality"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Date Of Join"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Contract Start Date"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Contract End Date"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"LD Expiry"}),(0,i.jsx)("th",{className:"border p-1 py-4",children:"Renewal Duration"})]})}),(0,i.jsx)("tbody",{children:[...Array(1)].map(((e,t)=>{var a;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"border p-1 py-4",children:t+1}),(0,i.jsx)("td",{className:"border p-1 py-4",children:null===x||void 0===x?void 0:x.name}),(0,i.jsx)("td",{className:"border p-1 py-4",children:null===x||void 0===x?void 0:x.empID}),(0,i.jsx)("td",{className:"border p-1 py-4",children:null===x||void 0===x?void 0:x.empBadgeNo}),(0,i.jsx)("td",{className:"border p-1 py-4",children:"OTHER"===(null===x||void 0===x?void 0:x.position)?x.otherPosition:x.position||"N/A"}),(0,i.jsx)("td",{className:"border p-1 py-4",children:"OTHER"===(null===x||void 0===x?void 0:x.department)?x.otherDepartment:x.department||"N/A"}),(0,i.jsx)("td",{className:"border p-1 py-4",children:(null===x||void 0===x?void 0:x.nationality)||"N/A"}),(0,i.jsx)("td",{className:"border p-1 py-4",children:null===x||void 0===x?void 0:x.dateOfJoin}),(0,i.jsx)("td",{className:"border p-1 py-4",children:(null===x||void 0===x?void 0:x.contractStartDate)||"N/A"}),(0,i.jsx)("td",{className:"border p-1 py-4",children:null!==x&&void 0!==x&&null!==(a=x.oldCED)&&void 0!==a&&a.trim()?x.oldCED:null!==x&&void 0!==x&&x.contractEndDate?x.contractEndDate:"N/A"}),(0,i.jsx)("td",{className:"border p-1 py-4",children:(null===x||void 0===x?void 0:x.nlmsEmpApproval)||"N/A"}),(0,i.jsx)("td",{className:"border p-1 py-4",children:(0,i.jsx)("textarea",{name:"renewalContract",value:O.contract.renewalContract,onChange:M,disabled:"Manager"!==y,className:"outline-none p-1 w-full print-renewalContract text-xs resize-none break-words whitespace-normal",rows:3})})]},t)}))})]})}),(0,i.jsx)("div",{className:"mt-7 text-sm",children:(0,i.jsx)("p",{children:"Notes: Deadline return to HRD after one week from the date received of Contract Completion Report"})}),(0,i.jsxs)("div",{className:"mt-10",children:[(0,i.jsx)("label",{className:"text-sm block py-4",children:"Manager Remarks:"}),(0,i.jsx)("textarea",{type:"text",name:"remarks",value:O.contract.remarks,onChange:M,disabled:"Manager"!==y&&"GENERAL MANAGER"===l||"HR MANAGER"===d,className:"border w-full text-sm  rounded resize-none outline-none p-2"})]}),(0,i.jsxs)("div",{className:"mt-10",children:[(0,i.jsx)("label",{className:"text-sm block py-4",children:"HRM Remarks:"}),(0,i.jsx)("textarea",{type:"text",name:"remarkHr",value:O.contract.remarkHr,onChange:M,disabled:"HR MANAGER"!==d&&"HR"!==y,className:"border w-full text-sm  rounded resize-none outline-none p-2"})]}),(0,i.jsxs)("div",{className:"mt-10 ",children:[(0,i.jsx)("label",{className:"text-sm block py-4",children:"GM Remarks:"}),(0,i.jsx)("textarea",{type:"text",name:"remarkGm",value:O.contract.remarkGm,onChange:M,disabled:"GENERAL MANAGER"!==l,className:"border w-full text-sm  rounded resize-none outline-none p-2"})]}),"HR"===y&&(0,i.jsxs)("div",{className:"mt-10 flex items-center",children:[(0,i.jsx)("input",{type:"checkbox",id:"extendedStatus",checked:k,onChange:e=>{const{checked:t}=e.target;T(t),_((e=>(0,g.A)((0,g.A)({},e),{},{contract:(0,g.A)((0,g.A)({},e.contract),{},{extendedStatus:t?"extended":"noExtended"})})))},className:"mr-2"}),(0,i.jsx)("label",{htmlFor:"extendedStatus",className:"text-sm",children:"Extended Contract"})]}),(0,i.jsxs)("div",{className:"mt-14 mb-10 flex justify-between items-center gap-x-5",children:[(0,i.jsxs)("div",{className:"text-center ",children:[(0,i.jsx)("p",{className:" mb-5 text-sm",children:"Recommended By:"}),(0,i.jsx)("input",{type:"text",name:"depHead",value:O.contract.depHead,onChange:M,disabled:"Manager"!==y&&"GENERAL MANAGER"===l||"HR MANAGER"===d,className:"border-b border-black w-56 print-width mx-auto outline-none text-center leading-loose"}),(0,i.jsx)("p",{className:"mt-3 text-sm",children:"Department Head"}),(0,i.jsx)("div",{className:" mt-5",children:(0,i.jsx)("input",{type:"date",name:"managerDate",value:O.contract.managerDate,onChange:M,disabled:"Manager"!==y&&"GENERAL MANAGER"===l||"HR MANAGER"===d,className:"outline-none text-dark_grey border rounded-md p-2"})})]}),(0,i.jsxs)("div",{className:"text-center ",children:[(0,i.jsx)("p",{className:" mb-5 text-sm",children:"Acknowledged & Checked By:"}),(0,i.jsx)("input",{type:"text",name:"hrManager",value:O.contract.hrManager,onChange:M,disabled:"HR MANAGER"!==d&&"HR"!==y,className:"border-b border-black w-56 print-width mx-auto outline-none text-center leading-loose"}),(0,i.jsx)("p",{className:"mt-3 text-sm",children:"HRM"}),(0,i.jsx)("div",{className:" mt-5",children:(0,i.jsx)("input",{type:"date",name:"hrmDate",value:O.contract.hrmDate,onChange:M,disabled:"HR MANAGER"!==d&&"HR"!==y,className:"outline-none text-dark_grey border rounded-md p-2"})})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:" mb-5 text-sm",children:"Approved By:"}),(0,i.jsx)("input",{type:"text",name:"genManager",value:O.contract.genManager,onChange:M,disabled:"GENERAL MANAGER"!==l,className:"border-b border-black w-56 print-width mx-auto outline-none text-center leading-loose"}),(0,i.jsx)("p",{className:"mt-3 text-sm",children:"GM"}),(0,i.jsx)("div",{className:" mt-5",children:(0,i.jsx)("input",{type:"date",name:"gmDate",value:O.contract.gmDate,onChange:M,disabled:"GENERAL MANAGER"!==l,className:"outline-none text-dark_grey border rounded-md p-2"})})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:" mb-5 text-sm",children:"Verified By:"}),(0,i.jsx)("input",{type:"text",name:"hrSign",value:O.contract.hrSign,onChange:M,disabled:"HR"!==y,className:"border-b border-black w-56 print-width mx-auto outline-none text-center leading-loose"}),(0,i.jsx)("p",{className:"mt-3 text-sm",children:"HR"}),(0,i.jsx)("div",{className:" mt-5",children:(0,i.jsx)("input",{type:"date",name:"hrDate",value:O.contract.hrDate,onChange:M,disabled:"HR"!==y,className:"outline-none text-dark_grey border rounded-md p-2"})})]})]}),"SuperAdmin"!==y&&(0,i.jsx)("div",{className:"flex justify-center gap-4 py-8 no-print-parent text-center",children:E?(0,i.jsx)("p",{className:"text-lg font-semibold",children:"Downloading..."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("button",{id:"save-button",onClick:()=>F(),disabled:w,className:"bg-primary text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:w?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Submiting"}),(0,i.jsx)("span",{className:"ml-1 animate-spin border-2 border-t-2 border-t-white border-gray-300 rounded-full w-4 h-4"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"Submit"}),(0,i.jsx)(Tt.dIn,{className:"ml-2 mt-1"})]})})}),(0,i.jsxs)("button",{id:"download-button",onClick:()=>{I(!0);const e=document.getElementById("left-button"),t=document.getElementById("download-button"),a=document.getElementById("print-button"),r=document.getElementById("save-button");e&&(e.style.visibility="hidden"),t&&(t.style.visibility="hidden"),a&&(a.style.visibility="hidden"),r&&(r.style.visibility="hidden"),(e=>{const t=document.getElementById(e);if(!t)return void console.error("Element with ID ".concat(e," not found"));const a=t.parentElement,r=a.style.height;a.style.height="auto",el()(t,{useCORS:!0,scale:1.5}).then((e=>{a.style.height=r;const t=e.toDataURL("image/jpeg",.8),n=new tl.default({orientation:"landscape",unit:"mm",format:[279.4,431.8]}),s=n.internal.pageSize.getWidth()-10-10,i=n.internal.pageSize.getHeight()-10-10,l=e.width,o=e.height,d=Math.min(s/l,i/o),c=10+(s-l*d)/2;n.addImage(t,"JPEG",c,10,l*d,o*d),n.save("ContractForm.pdf")})).catch((e=>{console.error("Error generating PDF:",e)}))})("capture-section"),setTimeout((()=>{e&&(e.style.visibility="visible"),t&&(t.style.visibility="visible"),a&&(a.style.visibility="visible"),r&&(r.style.visibility="visible"),I(!1)}),500)},className:"border-yellow border-2 text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:[(0,i.jsx)("span",{children:"Download"}),(0,i.jsx)(Tt.WCW,{className:"ml-2 mt-1"})]}),(0,i.jsxs)("button",{id:"print-button",onClick:B,className:"border-yellow border-2 text-dark_grey text_size_3 rounded-md px-4 py-2 flex items-center justify-center gap-2 min-w-[160px] h-[40px] no-print",children:[(0,i.jsx)("span",{children:"Print"}),(0,i.jsx)(Tt.n4o,{className:"ml-2 mt-1"})]})]})})]}),j&&(0,i.jsx)(Pe,{text:b,notification:j,path:"/reports"})]})})},sd=e=>{let{userID:t,userType:a}=e;const s=(0,r.zy)(),{allData:l,title:o}=s.state||{},{gmPosition:d,HRMPosition:c}=(0,Fe.b)(),[p,m]=(0,n.useState)([]),[u,h]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[f,v]=(0,n.useState)(!0),[y,N]=(0,n.useState)([]),[b]=(0,n.useState)(["Emp ID","Badge no","Name","Date of Join","Department","Other Department","Position","Other Position","Probation End Date","Deadline to Return to HRD","SuperAdmin"!==a&&"Status"].filter(Boolean)),[D,j]=(0,n.useState)(null),w=(0,r.Zp)(),S=e=>{if(Array.isArray(e)){if(0===e.length)return"-";const t=e[e.length-1];return S(t)}if(!e)return"-";let t;if("string"===typeof e&&e.includes("/")){const[a,r,n]=e.split("/");t=new Date("".concat(n,"-").concat(r,"-").concat(a))}else t=new Date(e);if(isNaN(t.getTime()))return"-";const a=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(a,"-").concat(r,"-").concat(n)},E=e=>{let t;if(e.includes("/")){const[a,r,n]=e.split("/");t=new Date("".concat(n,"-").concat(r,"-").concat(a))}else t=new Date(e);return isNaN(t)?"Invalid Date":(t.setDate(t.getDate()-7),t.toISOString().split("T")[0])};(0,n.useEffect)((()=>{v(!0);const e=((e,t,a,r)=>{const n=e.filter((e=>{var n,s,i,l;if(Array.isArray(e.workStatus)&&e.workStatus.length>0){var o;const t=null===(o=e.workStatus[e.workStatus.length-1])||void 0===o?void 0:o.toUpperCase();if(["TERMINATION","RESIGNATION","ACTIVE"].includes(t))return!1}const d=!0===e.probStatus&&(null===(n=e.probationEnd)||void 0===n?void 0:n.length)>0,p=(Array.isArray(e.supervisor)&&e.supervisor.length>0&&e.supervisor[e.supervisor.length-1],Array.isArray(e.manager)&&e.manager.length>0?e.manager[e.manager.length-1]:null),m=e.skillPool?e.skillPool.toUpperCase():"",u="APPROVED"===(null===(s=e.supervisorApproved)||void 0===s?void 0:s.toUpperCase()),h="APPROVED"===(null===(i=e.managerApproved)||void 0===i?void 0:i.toUpperCase()),x="APPROVED"===(null===(l=e.gmApproved)||void 0===l?void 0:l.toUpperCase());return"Supervisor"===t?d:"Manager"===t&&"GENERAL MANAGER"!==a&&"HR MANAGER"!==c?d&&p===r&&u:"GENERAL MANAGER"===a?"SKILLED"!==m&&"UNSKILLED"!==m&&d&&h:"HR"===t||"HR MANAGER"===c?"SKILLED"===m||"UNSKILLED"===m?d:d&&x:d})),s=new Map;for(const i of n){const e=new Date(i.probCreatedAt||0),t=s.get(i.empID);(!t||e>new Date(t.probCreatedAt||0))&&s.set(i.empID,i)}return Array.from(s.values()).map((e=>{var r,n,s,i,l;const o=e.probationEnd||[],d=o[o.length-1],p=new Date,m=null===(r=e.positionRevDate)||void 0===r?void 0:r[e.positionRevDate.length-1],u=null===(n=e.positionRev)||void 0===n?void 0:n[e.positionRev.length-1],h=null===(s=e.upgradePosition)||void 0===s?void 0:s[e.upgradePosition.length-1],x=null===(i=e.upgradeDate)||void 0===i?void 0:i[e.upgradeDate.length-1];let g;const f=m?new Date(m):null,v=x?new Date(x):null;var y;if(f&&v)if(f.toDateString()===v.toDateString())g=null===(y=e.position)||void 0===y?void 0:y[e.position.length-1];else if(f>v){var N;g=p>=f?u:p>=v?h:null===(N=e.position)||void 0===N?void 0:N[e.position.length-1]}else{var b;g=p>=v?h:p>=f?u:null===(b=e.position)||void 0===b?void 0:b[e.position.length-1]}else if(f)g=p>=f&&u;else if(v)g=p>=v&&h;else{var D;g=null===(D=e.position)||void 0===D?void 0:D[e.position.length-1]}let j="";var A;return"SuperAdmin"!==t&&("extended"===(null===(A=e.probExtendStatus)||void 0===A?void 0:A.trim().toLowerCase())?j="Extended":"Supervisor"===t?j=e.supervisorApproved?"Approved":"Pending":"HR MANAGER"===c||"HR"===t?j=e.hrName?"Approved":"Pending":"Manager"===t&&"GENERAL MANAGER"!==a&&"HR MANAGER"!==c?j=e.managerApproved?"Approved":"Pending":"GENERAL MANAGER"===a&&(j="Extended"===e.probExtendStatus?"Extended":e.gmApproved||"Pending")),{probID:e.probID,probCreatedAt:e.probCreatedAt,empID:e.empID||"-",empBadgeNo:e.empBadgeNo||"-",name:e.name||"-",dateOfJoin:S(e.doj)||"-",department:Array.isArray(e.department)?e.department[e.department.length-1]:"-",otherDepartment:Array.isArray(e.otherDepartment)?e.otherDepartment[e.otherDepartment.length-1]:"-",position:g,otherPosition:null===(l=e.otherPosition)||void 0===l?void 0:l[e.otherPosition.length-1],probationEndDate:e.prevProbExDate?S(e.prevProbExDate):S(d),deadline:e.prevProbExDate?S(E(e.prevProbExDate)):S(E(d)),probExtendStatus:e.probExtendStatus,prevProbExDate:e.prevProbExDate,status:j}})).sort(((e,t)=>"Pending"===e.status&&"Pending"!==t.status?-1:"Pending"!==e.status&&"Pending"===t.status?1:0))})(l,a,d,t);m(e),v(!1)}),[l,a,d,t,c]);const I=()=>{j(null)};(0,n.useEffect)((()=>{if(D){const e=l.filter((e=>e.empID===D.empID)).filter((e=>"probup"!==e.probExtendStatus)),t=e.some((e=>{var t,a;return"extended"===(null===(t=e.probExtendStatus)||void 0===t?void 0:t.trim().toLowerCase())||"completed"===(null===(a=e.probExtendStatus)||void 0===a?void 0:a.trim().toLowerCase())}));N(t?e:[])}}),[l,D]);return f?(0,i.jsx)("div",{className:"flex items-center justify-center h-[82vh]",children:(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading..."})}):(0,i.jsxs)("div",{children:[(0,i.jsx)($l,{tableBody:p,tableHead:b,title:o,startDate:u,endDate:x,handleDate:(e,t)=>{const a=e.target.value;"startDate"===t&&h(a),"endDate"===t&&g(a);const r="startDate"===t?a:u,n="endDate"===t?a:x;if(!r&&!n)return;const s=p.filter((e=>{const[t,a,s]=e.probationEndDate.split("-"),i=new Date("".concat(s,"-").concat(a,"-").concat(t)),l=r?new Date(r):null,o=n?new Date(n):null;return l&&o?i>=l&&i<=o:l?i>=l:!o||i<=o}));m(s)},handleViewDetails:e=>{j(e)}}),D&&(0,i.jsx)("div",{className:"fixed inset-0 center z-50 bg-black bg-opacity-50",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded-lg overflow-y-auto max-h-[80vh] shadow-lg w-1/3",children:[(0,i.jsxs)("section",{className:"flex justify-between gap-10 items-center mb-5",children:[(0,i.jsx)("div",{className:"w-full flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[200px]",src:Se.A,alt:"Logo"})}),(0,i.jsx)("button",{className:"text-[24px] rounded",onClick:I,children:(0,i.jsx)(A.RQJ,{})})]}),(0,i.jsx)("h2",{className:"text-xl font-semibold underline text-center mb-5",children:"Personal Details"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm font-semibold px-12",children:[(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Badge No"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:D.name})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Emp Badge No"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:D.empBadgeNo})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Date of Join"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:D.dateOfJoin})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Position"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:"OTHER"===D.position?D.otherPosition:D.position})]}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("span",{className:"w-40",children:"Department"}),(0,i.jsx)("span",{className:"w-4 text-center",children:":"}),(0,i.jsx)("span",{className:"flex-1 text-[#666666]",children:"OTHER"===D.department?D.otherDepartment:D.department})]})]}),y.length>0&&(0,i.jsx)("div",{className:"mt-6 center",children:(0,i.jsxs)("div",{className:"mt-6 border border-lite_grey h-auto w-[400px] p-4 rounded",children:[(0,i.jsx)("div",{className:"text-center mb-4",children:(0,i.jsx)("span",{className:"text-base font-semibold",children:"Probation Extension History"})}),(0,i.jsx)("div",{className:"center",children:(0,i.jsxs)("table",{className:"border border-[#D3D3D3] rounded-md shadow-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"bg-[#E5E5E5] text-xs",children:[(0,i.jsx)("th",{className:"text-center px-6 py-2 border-r border-[#D3D3D3]",children:"No of time"}),(0,i.jsx)("th",{className:"text-center px-6 py-2",children:"Date"}),(0,i.jsx)("th",{className:"text-center px-6 py-2",children:"Action"})]})}),(0,i.jsx)("tbody",{children:[...y].sort(((e,t)=>new Date(t.prevProbExDate)-new Date(e.prevProbExDate))).map(((e,t)=>(0,i.jsxs)("tr",{className:"text-xs border-t border-[#F0F0F0] text-center",children:[(0,i.jsx)("td",{className:"px-6 py-2 border-r border-[#F0F0F0]",children:t+1}),(0,i.jsx)("td",{className:"px-6 py-2",children:S(e.prevProbExDate)}),(0,i.jsx)("td",{onClick:()=>{I(),w("/probForm",{state:{employeeData:e}})},className:"px-3 py-2 text-blue underline cursor-pointer",children:"View"})]},t)))})]})})]})}),"Extended"!==(null===D||void 0===D?void 0:D.probExtendStatus)&&(0,i.jsx)("div",{className:"flex justify-center items-center py-6 px-4",children:(0,i.jsxs)("button",{className:"bg-primary text-sm font-bold py-2 px-6 text-dark_grey rounded-md",onClick:()=>{I(),D&&w("/probForm",{state:{employeeData:D}})},children:["Go to ",(0,i.jsx)("strong",{children:"Probation"})," Form"]})})]})})]})},id=()=>{const{CRLeaveDetails:e}=(()=>{(0,Ee.D)();const e=(0,n.useCallback)((async e=>{var t;let{LeaveValue:a}=e;if(!a)throw new Error("Missing required parameters");const r=e=>{var t,a;if(!e)return null;const r=null===(a=e=null===(t=e)||void 0===t?void 0:t.replace(/-/g,"/"))||void 0===a?void 0:a.split("/");if(3===r.length){let[e,t,a]=r;if(4===e.length){const[r,n,s]=[e,t,a];return console.log(r,n,s,"first yyyy"),"".concat(r,"-").concat(n,"-").concat(s)}if(4===a.length){const[r,n,s]=[e,t,a];return"".concat(s,"-").concat(n,"-").concat(r)}return console.error("Invalid date format"),""}return console.error("Invalid date format"),""},{empID:n,leaveType:s,fromDate:i,toDate:l,days:o,applyTo:d,reason:c,medicalCertificate:p,supervisorName:m,supervisorEmpID:u,supervisorStatus:h,supervisorDate:x,supervisorRemarks:g,managerName:f,managerEmpID:v,managerStatus:y,managerDate:N,managerRemarks:b,receivedDate:D,empStatus:j,empDate:A,empRemarks:w,selectedFrom:S,selectedTo:E,startDate:I,endDate:k}=a,T=r(i),C=T?new Date(T).toISOString():null,R=r(l),P=R?null===(t=new Date(R))||void 0===t?void 0:t.toISOString():null,O=r(x),_=O?new Date(O).toISOString():null,M=r(N),F=M?new Date(M).toISOString():null,L=d.split(",").map((e=>e.trim())),U=r(S),B=r(E),q={empID:n,leaveType:s,fromDate:C,toDate:P,days:o,applyTo:L,reason:c,medicalCertificate:p,supervisorName:m,supervisorEmpID:u,supervisorStatus:h,supervisorDate:_,supervisorRemarks:g,managerName:f,managerEmpID:v,managerStatus:y,managerDate:F,managerRemarks:b,empStatus:j,receivedDate:r(D),empDate:A,empRemarks:w,selectedFrom:U,selectedTo:B,startDate:r(I),endDate:r(k)};console.log(q)}),[]);return{CRLeaveDetails:e}})();return(0,i.jsxs)("div",{className:"flex flex-col gap-40",children:["Leave Details",(0,i.jsx)("button",{onClick:async()=>{try{const t=await it.A.get("https://commonfiles.s3.ap-southeast-1.amazonaws.com/BulkDataFiles/LeaveStatus/LeaveStatus+Feb+Manager.csv",{responseType:"arraybuffer"}),a=new Uint8Array(t.data),r=ei.LF(a,{type:"array"}),n=r.SheetNames[0],s=r.Sheets[n],i=ei.Wp.sheet_to_json(s,{header:1,raw:!1}),l=["fromDate","toDate","supervisorDate","managerDate","empDate","startDate","endDate","receivedDate","selectedFrom","selectedTo"],o=i.slice(1).map((e=>{let t={};return i[0].forEach(((a,r)=>{let n=e[r];if("empID"===a&&(n="number"===typeof n?n.toString():n),l.includes(a)&&n){let e=n.includes("/")?"/":n.includes("-")?"-":null;if(!e)return console.warn("Skipping invalid date format: ".concat(n)),void(t[a]=n);let r=n.split(e);if(3!==r.length)return console.warn("Skipping invalid date: ".concat(n)),void(t[a]=n);let[s,i,l]=r;if(!/^\d+$/.test(l))return console.warn("Skipping invalid year: ".concat(l," in ").concat(n)),void(t[a]=n);let o=2===l.length?"20"+l.padStart(2,"0"):l;const d="".concat(s.padStart(2,"0"),"/").concat(i.padStart(2,"0"),"/").concat(o);t[a]=d}else t[a]=n})),t}));for(const d of o)d.empID&&(d.empID&&(d.empID=String(d.empID)),await e({LeaveValue:d}))}catch(t){console.error("Error fetching Excel file:",t)}},children:"Click Here"})]})},ld=(0,Ee.D)(),od=()=>{const e=["Foreign Worker License (LPA)","Foreign Worker License (SAWP)","Foreign Worker License Additional (LPA)","Foreign Worker License Additional (SAWP)","Foreign Worker License Renewal (LPA)","Foreign Worker License Renewal (SAWP)","Foreign Worker License Change Salary/Job Title (LPA)","Foreign Worker License Cancellation (LPA)","Foreign Worker License Cancellation (SAWP)","Foreign Worker License Cancellation SAWP To LPA","Foreign Worker License Transfer Of Contract (LPA)"];return(0,i.jsx)("div",{onClick:async()=>{await ld.graphql({query:ke.P$,variables:{input:{id:"df1a97dd-732a-4afc-9578-8c7c99676f1e",permitWorkDD:e}}}).then((()=>{})).catch((e=>{}))},children:"click Here"})},dd=()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)([]),[s,l]=(0,n.useState)(0),[o,d]=(0,n.useState)(!0),c=localStorage.getItem("userType"),p="Offshore's ORMC",m="Manager"===c?"Manager":"Manager"!==c?"Unsubmitted":"",u=(0,n.useMemo)((()=>p),[p]),h=(0,n.useMemo)((()=>m),[m]),{convertedStringToArrayObj:x}=ri(u,h);return(0,n.useEffect)((()=>{if("Manager"!==c){(async()=>{d(!0);try{if(await new Promise((e=>{x&&x.length>0?e(!0):x?0===x.length&&l(2):l(0)}))){const a=await As(x);a&&a.length>0?(t((e=a)&&e.length>0?e.map((e=>{let t=[];try{Array.isArray(e.empWorkInfo)&&(t=e.empWorkInfo.map((e=>"string"===typeof e?JSON.parse(e):e)))}catch(a){}return{id:e.id,fileName:e.fileName,NAME:e.empName||"",NO:e.fidNo||"",LOCATION:e.location||"",TRADE:e.trade||"",DATE:e.date||"",TOTALHOURS:e.totalNT||0,TOTALHOURS2:e.totalOT||0,TOTALHOURS3:e.totalNTOT||0,WORKINGHOURS:e.actualWorkHrs||0,OT:(null===e||void 0===e?void 0:e.otTime)||0,NORMALWORKINGHRSPERDAY:(null===e||void 0===e?void 0:e.normalWorkHrs)||0,jobLocaWhrs:t.flat()||[],fileType:e.fileType||"",timeKeeper:e.assignBy||"",manager:e.assignTo||"",REMARKS:e.remarks||"",status:e.status||""}})):[]),l(1)):l(2)}else l(2)}catch(a){l(2)}finally{d(!1)}var e})()}else"Manager"===c&&(l(null),r(x))}),[x,c]),(0,i.jsx)("div",{children:(0,i.jsx)(oi,{title:"Offshore's ORMC",submittedData:e||[],showing:s,ManagerData:a})})},cd=()=>{const e=E("userID","TimeSheet");return(0,i.jsxs)("section",{className:"p-16 bg-[#F5F6F1] h-screen ",children:[(0,i.jsx)("div",{className:"text-start screen-size mb-3",children:(0,i.jsx)(r.N_,{to:"/timeSheet",className:"text-xl flex-1 text-grey  ",children:(0,i.jsx)(Tt.QVr,{})})}),(0,i.jsxs)("div",{className:" screen-size ",children:[(0,i.jsx)("h4",{className:"text_size_4  w-fit py-2    text-dark_grey ",children:"Upload Time Sheet"}),(0,i.jsxs)("div",{className:"flex justify-start gap-20",children:[e.includes("Offshore")&&(0,i.jsx)(F,{img:Q,text1:"Offshore",borderColor:"border-[#B7610B]",bgColor:"bg-white",link:"/timesheetOffshore"}),e.includes("Offshore's ORMC")&&(0,i.jsx)(F,{img:$,text1:"ORMC",borderColor:"border-[#0B47B7]",bgColor:"bg-white",link:"/OffshoreSheets/OffshoreORMC"})]})]})]})};var pd=a(817),md=a(8585);const ud=(0,Ee.D)(),hd=()=>({filterOnshoreOffshorePHbasis:e=>{var t;let{formattedPHList:a,primaryData:r,getMatchedEmpLeaves:n}=e;const s=Object.values(r.reduce(((e,t)=>{const a="".concat(t.empBadgeNo);if(!e[a]){let r=Array.isArray(t.workHrs)?t.workHrs[t.workHrs.length-1]:"0",n=Array.isArray(t.workMonth)?t.workMonth[t.workMonth.length-1]:"0",s=Array.isArray(t.workWeek)?t.workWeek[t.workWeek.length-1]:"0";e[a]={empID:t.empID,empBadgeNo:t.empBadgeNo,workHrs:r,workMonth:n,workWeek:s,groupedData:[]}}return e[a].groupedData.push(t),e}),{})),i=null===s||void 0===s?void 0:s.filter((e=>e.empID===n.empId&&e.empBadgeNo===n.empBadgeNo)),l=null===i||void 0===i?void 0:i.map((e=>e.empBadgeNo.startsWith("AW")&&7===parseFloat(null===e||void 0===e?void 0:e.workWeek)?"Offshore Employee":!e.empBadgeNo.startsWith("AW")&&parseFloat(null===e||void 0===e?void 0:e.workWeek)<7?"Onshore Employee":"Unknown"))[0];let o=[];if("Offshore Employee"===l)o=i;else if("Onshore Employee"===l){const{updatedLeaveData:e}=function(e){let{getSpecificEmpLeaves:t,formattedPHList:a}=e;const r=[];return null===a||void 0===a||a.forEach((e=>{e.dates.forEach((e=>{r.push(e.date)}))})),{updatedLeaveData:null===t||void 0===t?void 0:t.map((e=>{var t;const a=null===(t=e.groupedData)||void 0===t?void 0:t.filter((e=>{if("Maternity Leave"!==(null===e||void 0===e?void 0:e.empLeaveType)){const t=new Date(e.empLeaveSelectedFrom||e.empLeaveStartDate),a=new Date(e.empLeaveSelectedTo||e.empLeaveEndDate),n=t.toISOString().split("T")[0],s=a.toISOString().split("T")[0],i=r.includes(n),l=r.includes(s);return!(i&&l)}}));return(0,g.A)((0,g.A)({},e),{},{groupedData:a})}))}}({getSpecificEmpLeaves:i,formattedPHList:a});o=null===(d=e)||void 0===d?void 0:d.map((e=>{var t,a;const r=null===(t=e.groupedData)||void 0===t||null===(a=t.filter((e=>{const t=e.empLeaveSelectedFrom||e.empLeaveStartDate;return"Sunday"!==new Date(t).toLocaleDateString("en-US",{weekday:"long"})})))||void 0===a?void 0:a.map((t=>{if("Maternity Leave"!==(null===t||void 0===t?void 0:t.empLeaveType)){const a=t.empLeaveSelectedFrom||t.empLeaveStartDate,r=new Date(a).toLocaleDateString("en-US",{weekday:"long"});let n=t.leaveTakenCount;if("Saturday"===r){const t=parseFloat(e.workWeek);5===t?n=0:5.5===t?n=.5:6===t&&(n=1)}return(0,g.A)((0,g.A)({},t),{},{leaveTakenCount:n})}}));return(0,g.A)((0,g.A)({},e),{},{groupedData:r})}))}var d;return{getUpdatedLeaveData:null===(t=o)||void 0===t?void 0:t.flatMap((e=>null===e||void 0===e?void 0:e.groupedData))}}}),xd=e=>{var t,a,r,s,l,o;let{selectedDate:d,leaveTypes:c,leaveSummary:p}=e;const[m,u]=(0,n.useState)({}),{DownloadExcelPDF:h}={DownloadExcelPDF:(e,t,a)=>{const r=document.getElementById(e);if(!r)return void console.warn("Invalid element ID passed for PDF generation.");const n=r.closest(".overflow-x-auto"),s=n.style.width;n.style.width="auto",el()(r,{useCORS:!0,scale:2,backgroundColor:"#ffffff"}).then((e=>{n.style.width=s;const r=e.toDataURL("image/png"),i=new tl.default({orientation:"portrait",unit:"mm",format:"a4"}),l=i.internal.pageSize.getWidth(),o=(i.internal.pageSize.getHeight(),10),d=l-20,c=e.width,p=e.height*(d/c),m=vl;i.addImage(m,"SVG",o,o,30,0),i.setFontSize(8),i.text("Leave Summary for ".concat(null===a||void 0===a?void 0:a.employeeName," (").concat(t,")"),o,20),i.addImage(r,"SVG",o,25,d,p),i.save("Leave Summary for (".concat(t,").pdf"))})).catch((e=>{console.error("Failed to generate PDF:",e)}))}},x=e=>{let t=new Date(e);t.setHours(0,0,0,0);let a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(a)},f=new Date,v=f.getFullYear(),y=f.getFullYear()-1,N=["Badge NO","Status","Leave Calculated \nFrom (DOJ or 01-01-".concat(v,")"),"Leave Entitled \nas of today","No of Days \nWorked in ".concat(v),"No of Days Worked \nin ".concat(v," (- UAL)"),"Previous Year Annual \nLeave Balance ".concat(y),"Leave Entitled \nfor ".concat(v),"Monthly Leave Usage","Eligible for \nannual leave"],b=(e,t)=>{const a=new Date(e),r=new Date(t);return parseFloat((r-a)/864e5).toFixed(0)};return(0,n.useEffect)((()=>{var e,t,a,r,n;const s=(e=>{var t,a;if(!e)return;let r={};const n={AL:null!==(t=null===e||void 0===e?void 0:e.annualLeaveEntitlement)&&void 0!==t?t:"0",SL:null!==(a=null===e||void 0===e?void 0:e.sickLeaveEntitlement)&&void 0!==a?a:"0"};if("5.5"===(null===e||void 0===e?void 0:e.workWeek))r=(0,g.A)((0,g.A)({},e),{},{status:(0,g.A)({SAT:null!=="0.5"?"0.5":"0"},n)});else if("6"===(null===e||void 0===e?void 0:e.workWeek)){r=(0,g.A)((0,g.A)({},e),{},{status:(0,g.A)({SAT:null!=="1"?"1":"0"},n)})}else r=(0,g.A)((0,g.A)({},e),{},{status:(0,g.A)({},n)});return r})(p),i=new Date;i.setHours(0,0,0,0);let l=i.getFullYear(),o="".concat(l,"-01-01")||(null===s||void 0===s?void 0:s.doj),d=b(o||(null===s||void 0===s?void 0:s.doj),i.toLocaleDateString("en-CA")),c=parseFloat(d)-parseFloat(null===s||void 0===s||null===(e=s.unPaidAuthorizeAnnual)||void 0===e?void 0:e.daysTaken);const m=null!==(t=parseFloat(null===s||void 0===s?void 0:s.annualLeaveEntitlement))&&void 0!==t?t:0,h=parseFloat(m/365*c).toFixed(1),x=h>0?h:"0";let f=parseFloat(null===s||void 0===s?void 0:s.annualLeaveBal)+parseFloat(x),v=parseFloat(f)-(parseFloat(null===s||void 0===s||null===(a=s.annualLeave)||void 0===a?void 0:a.daysTaken)+parseFloat(null===s||void 0===s||null===(r=s.annualLeave)||void 0===r?void 0:r.waitingApproval));const y=(0,g.A)((0,g.A)({},s),{},{annualLeave:(0,g.A)((0,g.A)({},s.annualLeave),{},{totalLeave:f.toFixed(1),remainingLeave:v.toFixed(1)}),dojOrSpecifiedDate:o,leaveEntitleToday:i.toLocaleDateString("en-CA"),noOfDaysWorked:parseFloat(d).toFixed(1),totalWorkedDays:b(null===s||void 0===s?void 0:s.doj,i.toLocaleDateString("en-CA")),annualLeaveEntitleBal:x,noOfDaysWorkedUAL:c.toFixed(1),leaveEligibleForThisYear:parseFloat(null===s||void 0===s||null===(n=s.annualLeave)||void 0===n?void 0:n.totalLeave)-parseFloat(null===s||void 0===s?void 0:s.annualLeaveBal),isEligibleForAnnualLeave:v.toFixed(1)>0?"Yes":"No"});u(y)}),[p]),(0,i.jsxs)("main",{className:"w-full",children:[(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"table-auto border border-collapse w-[2000px] text-sm text-center",id:"downloadTable",children:[(0,i.jsxs)("thead",{className:"bg-[#fde28bb6]",children:[(0,i.jsx)("tr",{className:"",children:N.map(((e,t)=>"Monthly Leave Usage"===e?(0,i.jsx)("th",{colSpan:"5",className:"border p-2",children:"Monthly Leave Usage (".concat(d,")")},"col-".concat(t)):(0,i.jsx)("th",{rowSpan:2,className:"border p-2 whitespace-pre-wrap",children:e},t)))}),(0,i.jsx)("tr",{children:["Leave Type","Total Leave","Days Taken","Waiting Approval","Remaining Leave"].map(((e,t)=>(0,i.jsx)("th",{className:"border p-2",children:e},t)))})]}),(0,i.jsxs)("tbody",{className:"text_size_8",children:[(0,i.jsxs)("tr",{className:"bg-[#c7c4c413] ",children:[(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:(null===m||void 0===m?void 0:m.empBadgeNo)||"N/A"}),(0,i.jsx)("td",{className:"border align-top text-center py-2",rowSpan:"14",children:(0,i.jsxs)("div",{className:"flex flex-col gap-5 pl-3 items-start text-[#5033f8]",children:[(0,i.jsx)("span",{children:"MON - SAT"}),(null===m||void 0===m||null===(t=m.status)||void 0===t?void 0:t.SAT)&&(0,i.jsxs)("span",{className:"text-start",children:["SAT :","".concat(null===m||void 0===m||null===(a=m.status)||void 0===a?void 0:a.SAT," DAYS")]}),(0,i.jsxs)("span",{children:["AL :"," ","".concat("N/A"===(null===m||void 0===m||null===(r=m.status)||void 0===r?void 0:r.AL)?"0":null===m||void 0===m||null===(s=m.status)||void 0===s?void 0:s.AL," DAYS")]}),(0,i.jsxs)("span",{children:["SL :"," ","".concat("N/A"===(null===m||void 0===m||null===(l=m.status)||void 0===l?void 0:l.SL)?"0":null===m||void 0===m||null===(o=m.status)||void 0===o?void 0:o.SL," DAYS")]})]})}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:x(null===m||void 0===m?void 0:m.dojOrSpecifiedDate)||"N/A"}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:x(null===m||void 0===m?void 0:m.leaveEntitleToday)||"N/A"}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:isNaN(m.noOfDaysWorked)?"N/A":null===m||void 0===m?void 0:m.noOfDaysWorked}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:(null===m||void 0===m?void 0:m.noOfDaysWorkedUAL)||"N/A"}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:0===(null===m||void 0===m?void 0:m.annualLeaveBal)?"0":(null===m||void 0===m?void 0:m.annualLeaveBal)||"N/A"}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:(null===m||void 0===m?void 0:m.annualLeaveEntitleBal)||"N/A"}),(0,i.jsx)("td",{className:"p-0",id:"leaveDetailSec",colSpan:"5"}),(0,i.jsx)("td",{className:"border  align-top text-center py-2",rowSpan:"14",children:(null===m||void 0===m?void 0:m.isEligibleForAnnualLeave)||"N/A"})]}),Object.keys(c).map((e=>{if("MALE"===m.gender&&"maternityLeave"===e)return null;if("FEMALE"===m.gender&&"paternityLeave"===e)return null;const t=null===c||void 0===c?void 0:c[e],a=(null===m||void 0===m?void 0:m[e])||{totalLeave:"0",daysTaken:"0",waitingApproval:"0",remainingLeave:"0"};let r="Annual Leave"===t?"border-r":"border";return(0,i.jsxs)("tr",{className:"bg-[#c7c4c413]",children:[(0,i.jsx)("td",{className:"".concat(r," px-4 text-start"),id:"LeaveNames",children:t}),(0,i.jsx)("td",{className:"".concat(r," p-2"),children:(null===a||void 0===a?void 0:a.totalLeave)||"0"}),(0,i.jsx)("td",{className:"".concat(r," p-2"),children:(null===a||void 0===a?void 0:a.daysTaken)||"0"}),(0,i.jsx)("td",{className:"".concat(r," p-2"),children:(null===a||void 0===a?void 0:a.waitingApproval)||"0"}),(0,i.jsx)("td",{className:"".concat(r," p-2"),children:(null===a||void 0===a?void 0:a.remainingLeave)||"0"})]},e)}))]})]})}),(0,i.jsx)("div",{className:"py-8 center",children:(0,i.jsxs)("button",{className:"px-3 py-2 flex center gap-3 bg-primary text_size_5 text-dark_grey rounded",onClick:()=>{h("downloadTable",d,p)},children:[(0,i.jsx)("i",{children:(0,i.jsx)(es.qqM,{})}),(0,i.jsx)("span",{children:"Download"})]})})]})},gd=()=>{var e;const t=(0,r.Zp)(),a=(0,r.zy)(),{mergedLeaveData:s,item:l}=a.state||{},{publicHoliday:o}=(()=>{const[e,t]=(0,n.useState)([]),[a,r]=(0,n.useState)(!0),[s,i]=(0,n.useState)(null);return(0,n.useEffect)((()=>{fetch("https://commonfiles.s3.ap-southeast-1.amazonaws.com/Leave+Details/CompanyHolidays2025.json").then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((e=>{t(e),r(!1)})).catch((e=>{i(e),r(!1)}))}),[]),{publicHoliday:e}})(),{filterOnshoreOffshorePHbasis:d}=hd(),{convertToFormattedHolidays:c,getSelectedMonthName:p}={convertToFormattedHolidays:function(e){var t;let{publicHoliday:a}=e;const r={January:"01",February:"02",March:"03",April:"04",May:"05",June:"06",July:"07",August:"08",September:"09",October:"10",November:"11",December:"12"},n=e=>{const[t,a]=e.split(", "),[n,s,i]=a.replace(/(\d+)(st|nd|rd|th)/,"$1").split(" "),l=r[s],o=n.padStart(2,"0");return{day:t,date:"".concat(i,"-").concat(l,"-").concat(o)}};return{formattedPHList:null===a||void 0===a||null===(t=a.CompanyHolidays2025)||void 0===t?void 0:t.map((e=>{let t=[];return e.date?t.push(n(e.date)):e.dates&&Array.isArray(e.dates)&&(t=e.dates.map(n)),{PHName:e.name,dates:t}}))}},getSelectedMonthName:function(e,t){const a=new Date(e),r=new Date(t),n=a.toLocaleString("default",{month:"short"}),s=r.toLocaleString("default",{month:"short"}),i=a.getFullYear(),l=r.getFullYear(),o=a.getMonth(),d=r.getMonth();return i===l&&o===d?"".concat(n," ").concat(i):i===l?"".concat(n," - ").concat(s," ").concat(i):"".concat(n," ").concat(i," - ").concat(s," ").concat(l)}},{PrintExcelSheet:m}={PrintExcelSheet:(e,t,a)=>{const r=document.getElementById(e);if(!r)return;const n=document.createElement("iframe");n.style.position="absolute",n.style.width="0",n.style.height="0",n.style.border="none",document.body.appendChild(n);const s=n.contentDocument||n.contentWindow.document;s.open(),s.write("<html><head><title>Print Table</title>"),s.write("<style>"),s.write("\n    body { font-family: Arial, sans-serif; margin: 20px; }\n\n    .print-header {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 20px;\n      margin-bottom: 20px;\n    }\n\n    .logo {\n      width: 200px;\n      height: auto;\n    }\n\n    .header-text h2 {\n      margin: 4px 0;\n    }\n\n    table {\n      width: 100%;\n      border-collapse: collapse;\n    }\n\n    th {\n      border: 1px solid black;\n      padding: 6px;\n      text-align: center;\n    }\n    \n    td {\n      border: 1px solid black;\n      padding: 6px;\n      vertical-align: top;\n      text-align: center;\n    }\n\n    #leaveDetailSec {\n      padding: 0px;\n    }\n\n    #LeaveNames {\n    padding: 6px;\n    text-align: start;\n    }\n\n    th {\n      background-color: #fde28bb6;\n    }\n  "),s.write("</style>"),s.write("</head><body>"),s.write('\n    <div class="print-header">\n      <img src="'.concat(Se.A,'" class="logo" alt="Logo" />\n      <div class="header-text">\n      <h2>Leave Summary for ').concat(null===a||void 0===a?void 0:a.employeeName," (").concat(t,")</h2>\n      </div>\n    </div>\n  ")),s.body.appendChild(r.cloneNode(!0)),s.write("</body></html>"),s.close(),n.contentWindow.focus(),n.contentWindow.print(),setTimeout((()=>{document.body.removeChild(n)}),1e3)}},[u,h]=(0,n.useState)(""),[x,f]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),[N,b]=(0,n.useState)({}),[D,A]=(0,n.useState)([]),w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{totalLeave:t?null:e||0,daysTaken:0,waitingApproval:0,remainingLeave:t?null:e}},S=e=>{let t=null;if(null!==e&&void 0!==e&&e.includes("/")){const[a,r,n]=null===e||void 0===e?void 0:e.split("/").map(Number);t=new Date(n,r-1,a)}else null!==e&&void 0!==e&&e.includes("-")&&(t=new Date(e));return t},E=(e,t)=>{let a="Approved"===(null===e||void 0===e?void 0:e.managerStatus)&&"Cancelled"!==(null===e||void 0===e?void 0:e.empStatus),r="Pending"===(null===e||void 0===e?void 0:e.managerStatus)&&"Rejected"!==(null===e||void 0===e?void 0:e.supervisorStatus)&&"Cancelled"!==(null===e||void 0===e?void 0:e.empStatus);return"daysTaken"===t?a:"waitingApproval"===t?r:null},I=(e,t,a,r,n)=>{try{const s=new Date(a).getFullYear();let i,o;t===s?(i=new Date(a),o=new Date("".concat(t,"-12-31"))):t>s&&(i=new Date("".concat(t,"-01-01")),o=new Date("".concat(t,"-12-31")));const d=E(e,n);let c=null;if(null!==e&&void 0!==e&&e.empLeaveSelectedFrom?c=S(null===e||void 0===e?void 0:e.empLeaveSelectedFrom):null!==e&&void 0!==e&&e.empLeaveStartDate&&(c=new Date(null===e||void 0===e?void 0:e.empLeaveStartDate)),c>=i&&c<=o&&(null===e||void 0===e?void 0:e.empLeaveType)===r&&(null===e||void 0===e?void 0:e.empBadgeNo)===(null===l||void 0===l?void 0:l.empBadgeNo)&&d)return e}catch(s){console.log("ERROR : ",s)}},k=(e,t,a,r,n)=>{const s=new Date(a);if(t>=s){let a=new Date(s),i=new Date(s);for(i.setFullYear(i.getFullYear()+1);t>=i;)a.setFullYear(a.getFullYear()+1),i.setFullYear(i.getFullYear()+1);let l=null;e.empLeaveSelectedFrom?l=S(e.empLeaveSelectedFrom):null!==e&&void 0!==e&&e.empLeaveStartDate&&(l=new Date(null===e||void 0===e?void 0:e.empLeaveStartDate));const o=E(e,n);if(l&&l>=a&&l<i&&(null===e||void 0===e?void 0:e.empLeaveType)===r&&o)return e}return null},T=(e,t,a)=>{const r=E(e,a);if((null===e||void 0===e?void 0:e.empLeaveType)===t&&(null===e||void 0===e?void 0:e.empBadgeNo)===(null===l||void 0===l?void 0:l.empBadgeNo)&&r)return e},C=(e,t,a,r)=>{let n=t.getFullYear(),s=new Date("".concat(n,"-01-01")),i=new Date("".concat(n,"-12-31"));const o=E(e,r);let d=null;e.empLeaveSelectedFrom?d=S(e.empLeaveSelectedFrom):null!==e&&void 0!==e&&e.empLeaveStartDate&&(d=new Date(e.empLeaveStartDate));let c="Unpaid Authorize Annual"===a?"Unpaid Authorize - Annual":"Unpaid Authorize Sick"===a?"Unpaid Authorize - Sick":a;if(d>=s&&d<=i&&(null===e||void 0===e?void 0:e.empLeaveType)===c&&(null===e||void 0===e?void 0:e.empBadgeNo)===(null===l||void 0===l?void 0:l.empBadgeNo)&&o)return e},R=(e,t,a,r)=>{var n,s,i;let l=(null===(n=e[t])||void 0===n?void 0:n.daysTaken)||0;l+=Number(null===a||void 0===a?void 0:a.leaveTakenCount)||0;let o=(null===(s=e[t])||void 0===s?void 0:s.waitingApproval)||0;return o+=Number(null===r||void 0===r?void 0:r.leaveTakenCount)||0,{leaveTaken:l,waitingForApproval:o,getRemainingLeave:(null===(i=e[t])||void 0===i?void 0:i.totalLeave)-(l+o)}},P=e=>{let t=new Date(e);return t.setHours(0,0,0,0),t.toLocaleDateString()};(0,n.useEffect)((()=>{(()=>{if(!u||!x){let e=new Date;e.setHours(0,0,0,0);const t=e.getFullYear();let a="".concat(t,"-01-01"),r="".concat(t,"-12-31");const n=P(a),i=P(r),l=p(n,i);return y(l),void A(s)}const e=p(u,x);y(e);const t=/[\/-]/,a=null===s||void 0===s?void 0:s.filter((e=>{let a=null,r=null;String(null===e||void 0===e?void 0:e.empLeaveSelectedFrom)&&String(null===e||void 0===e?void 0:e.empLeaveSelectedTo)&&t.test(null===e||void 0===e?void 0:e.empLeaveSelectedFrom)&&t.test(null===e||void 0===e?void 0:e.empLeaveSelectedTo)?(a=S(e.empLeaveSelectedFrom),r=S(e.empLeaveSelectedTo)):String(null===e||void 0===e?void 0:e.empLeaveStartDate)&&String(null===e||void 0===e?void 0:e.empLeaveEndDate)&&t.test(null===e||void 0===e?void 0:e.empLeaveStartDate)&&t.test(null===e||void 0===e?void 0:e.empLeaveEndDate)&&(a=S(e.empLeaveStartDate),r=S(e.empLeaveEndDate));const n=new Date(a),s=new Date(r),i=new Date(u),l=new Date(x);return n>=i&&s<=l}));A(a)})()}),[u,x,s]),(0,n.useEffect)((()=>{try{const e=(Array.isArray(D)&&D.length>0?null===D||void 0===D?void 0:D.reduce(((e,t)=>{if(t&&null!==t&&void 0!==t&&t.empID&&!e[null===t||void 0===t?void 0:t.empID]){var a;let r=Number(Array.isArray(null===t||void 0===t?void 0:t.annualLeave)&&(null===t||void 0===t||null===(a=t.annualLeave)||void 0===a?void 0:a.length)>0?t.annualLeave[t.annualLeave.length-1]:"string"===typeof t.annualLeave?parseFloat(t.annualLeave):0)+Number(t.empPervAnnualLeaveBal||0),n=parseFloat(r.toFixed(2));e[t.empID]={gender:t.gender,empId:t.empID,employeeName:t.empName,empBadgeNo:t.empBadgeNo,position:t.position,department:t.department,doj:t.doj,annualLeaveEntitlement:Array.isArray(t.annualLeave)?t.annualLeave[t.annualLeave.length-1]:"0",sickLeaveEntitlement:t.sickLeave||0,empAnnualLeaveEffDate:Array.isArray(t.empAnnualLeaveDate)?t.empAnnualLeaveDate[t.empAnnualLeaveDate.length-1]:null,empSickLeaveEffDate:t.empSickLeaveDate,annualLeaveBal:t.empPervAnnualLeaveBal,compassionateLeave:w(0,!0),unPaidAuthorizeSick:w(0,!0),unPaidAuthorizeAnnual:w(0,!0),annualLeave:w(n),marriageLeave:w(Number(t.marriageLeave)||0),hospitalisationLeave:w(Number(t.hospitalLeave)||0),maternityLeave:w(Number(t.maternityLeave)||0),sickLeave:w(Number(t.sickLeave)||0),paternityLeave:w(Number(t.paternityLeave)||0),compensateLeave:w(0,!0)||0,workHrs:Array.isArray(t.workHrs)?t.workHrs[t.workHrs.length-1]:"0",workMonth:Array.isArray(t.workMonth)?t.workMonth[t.workMonth.length-1]:"0",workWeek:Array.isArray(t.workWeek)?t.workWeek[t.workWeek.length-1]:"0",status:{SAT:0,AL:"",SL:""},dojOrSpecifiedDate:"",leaveEntitleToday:"",noOfDaysWorked:"",annualLeaveEntitleBal:"",noOfDaysWorkedUAL:"",totalWorkedDays:"",leaveEligibleForThisYear:"",isEligibleForAnnualLeave:""}}return e}),{}):{})[null===l||void 0===l?void 0:l.empID],{formattedPHList:t}=c({publicHoliday:o}),{getUpdatedLeaveData:a}=d({formattedPHList:t,primaryData:D,getMatchedEmpLeaves:e}),r=((e,t)=>{const a=(new Date).getFullYear(),r=null===Object||void 0===Object?void 0:Object.keys(t);for(let i of r)if(t[i]){let r="";switch(i){case"annualLeave":r="Annual Leave";break;case"sickLeave":r="Sick Leave";break;case"maternityLeave":r="Maternity Leave";break;case"paternityLeave":r="Paternity Leave";break;case"marriageLeave":r="Marriage Leave";break;case"hospitalisationLeave":r="Hospitalisation Leave";break;case"compassionateLeave":r="Compassionate Leave";break;case"compensateLeave":r="Compensate Leave";break;case"unPaidAuthorizeAnnual":r="Unpaid Authorize Annual";break;case"unPaidAuthorizeSick":r="Unpaid Authorize Sick";break;default:r=""}for(let o of e)if((null===o||void 0===o?void 0:o.empBadgeNo)===l.empBadgeNo){let e=Array.isArray(null===o||void 0===o?void 0:o.empAnnualLeaveDate)?null===o||void 0===o?void 0:o.empAnnualLeaveDate[(null===o||void 0===o?void 0:o.empAnnualLeaveDate.length)-1]:null===o||void 0===o?void 0:o.empAnnualLeaveDate;if("Annual Leave"===r&&e){let n=I(o,a,e,r,"daysTaken"),s=I(o,a,e,r,"waitingApproval");const{leaveTaken:l,waitingForApproval:d,getRemainingLeave:c}=R(t,i,n,s);t[i]=(0,g.A)((0,g.A)({},t[i]),{},{daysTaken:l,waitingApproval:d,remainingLeave:c>0?c:0})}else"Annual Leave"!==r||e||(t[i]=(0,g.A)((0,g.A)({},t[i]),{},{totalLeave:"0",daysTaken:"0",waitingApproval:"0",remainingLeave:"0"}));let l=null!==o&&void 0!==o&&o.empSickLeaveDate?null===o||void 0===o?void 0:o.empSickLeaveDate:null;if("Sick Leave"===r&&l){const e=new Date;e.setHours(0,0,0,0);let a=k(o,e,l,r,"daysTaken"),n=k(o,e,l,r,"waitingApproval");const{leaveTaken:s,waitingForApproval:d,getRemainingLeave:c}=R(t,i,a,n);t[i]=(0,g.A)((0,g.A)({},t[i]),{},{daysTaken:s,waitingApproval:d,remainingLeave:c>0?c:0})}else"Sick Leave"!==r||l||(t[i]=(0,g.A)((0,g.A)({},t[i]),{},{totalLeave:"0",daysTaken:"0",waitingApproval:"0",remainingLeave:"0"}));if("Hospitalisation Leave"===r||"Maternity Leave"===r||"Paternity Leave"===r||"Marriage Leave"===r){let e=T(o,r,"daysTaken"),a=T(o,r,"waitingApproval");const{leaveTaken:n,waitingForApproval:s,getRemainingLeave:l}=R(t,i,e,a);t[i]=(0,g.A)((0,g.A)({},t[i]),{},{daysTaken:n,waitingApproval:s,remainingLeave:l>0?l:0})}if("Compassionate Leave"===r||"Compensate Leave"===r||"Unpaid Authorize Annual"===r||"Unpaid Authorize Sick"===r){var n,s;const e=new Date;e.setHours(0,0,0,0);let a=C(o,e,r,"daysTaken"),l=C(o,e,r,"waitingApproval"),d=(null===(n=t[i])||void 0===n?void 0:n.daysTaken)||0;d+=Number(null===a||void 0===a?void 0:a.leaveTakenCount)||0;let c=(null===(s=t[i])||void 0===s?void 0:s.waitingApproval)||0;c+=Number(null===l||void 0===l?void 0:l.leaveTakenCount)||0,t[i]=(0,g.A)((0,g.A)({},t[i]),{},{totalLeave:"-",daysTaken:d,waitingApproval:c,remainingLeave:"-"})}}}return t})(a,e);b(r)}catch(e){b((e=>{const t=(0,g.A)({},e);return["compassionateLeave","unPaidAuthorizeSick","unPaidAuthorizeAnnual","annualLeave","marriageLeave","hospitalisationLeave","maternityLeave","sickLeave","paternityLeave","compensateLeave"].forEach((e=>{t[e]&&(t[e]=(0,g.A)((0,g.A)({},t[e]),{},{daysTaken:0,waitingApproval:0}))})),t}))}}),[D,l,o]);return(0,i.jsxs)("main",{className:"w-full",children:[(0,i.jsx)("i",{className:"text-2xl text-dark_grey cursor-pointer",onClick:()=>t("/leaveManagement/leaveBalance"),children:(0,i.jsx)(j.$jz,{})}),(0,i.jsxs)("section",{className:"flex justify-between items-center mt-5 gap-10",children:[(0,i.jsx)("div",{className:" flex justify-between items-center gap-5 w-full",children:(0,i.jsxs)("section",{className:"flex items-center gap-5 w-full",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"start-date",className:"block text-[16px] font-medium",children:"Start Date"}),(0,i.jsx)("div",{className:"text_size_5 bg-white border py-1.5 rounded text-grey border-medium_grey flex items-center px-2.5 gap-2",children:(0,i.jsx)("input",{id:"start-date",type:"date",value:u,onChange:e=>h(e.target.value),className:"outline-none text-grey"})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"end-date",className:"block text-[16px] font-medium",children:"End Date"}),(0,i.jsx)("div",{className:"text_size_5 bg-white border py-1.5 rounded text-grey border-medium_grey flex items-center px-2.5 gap-2",children:(0,i.jsx)("input",{id:"end-date",type:"date",value:x,onChange:e=>f(e.target.value),className:"outline-none text-grey"})})]})]})}),(0,i.jsx)("div",{className:"center mt-auto",children:(0,i.jsxs)("button",{className:"center gap-2 px-3 py-2 text-dark_grey text_size_5 bg-primary rounded",onClick:()=>{m("downloadTable",v,N)},children:[(0,i.jsx)("i",{children:(0,i.jsx)(es.ne7,{})}),(0,i.jsx)("span",{children:"Print"})]})})]}),(0,i.jsxs)("div",{className:"flex flex-col justify-between items-center pb-5 flex-1",children:[(0,i.jsx)("article",{className:"flex items-center justify-between w-full",children:(0,i.jsx)("div",{className:"flex-1 center",children:(0,i.jsx)("img",{className:"max-w-[240px] w-full",src:Se.A,alt:"Company logo"})})}),(0,i.jsx)("p",{className:"text-center text-dark_grey text-lg font-semibold pt-3",children:v}),(0,i.jsxs)("h2",{className:"uppercase text-xl text-center w-full font-medium mt-2",children:["Leave Summary for"," ",(0,i.jsx)("span",{className:"font-semibold italic",children:null!==(e=null===N||void 0===N?void 0:N.employeeName)&&void 0!==e?e:"N/A"})]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(xd,{selectedDate:v,leaveTypes:{annualLeave:"Annual Leave",sickLeave:"Sick Leave",hospitalisationLeave:"Hospitalisation Leave",maternityLeave:"Maternity Leave",paternityLeave:"Paternity Leave",compensateLeave:"Compensate Leave",compassionateLeave:"Compassionate Leave",marriageLeave:"Marriage Leave",unPaidAuthorizeSick:"unPaidAuthorizeSick",unPaidAuthorizeAnnual:"unPaidAuthorizeAnnual"},leaveSummary:N})})]})},fd=(0,Ee.D)(),vd=()=>{var e;const t=null===(e=localStorage.getItem("userID"))||void 0===e?void 0:e.toUpperCase(),[a,s]=(0,n.useState)([]),[l,o]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[p,m]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),{setPDInfo:x}=(0,Fe.b)(),{personalInfo:g}=(()=>{const[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(!0),[s,i]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(async()=>{r(!0),i(null);const e=localStorage.getItem("userID");if(!e)return i("User ID not found in localStorage"),void r(!1);let a=[],n=null;try{do{const e=await ud.graphql({query:Ie.it,variables:{nextToken:n}});a=[...a,...e.data.listEmpPersonalInfos.items],n=e.data.listEmpPersonalInfos.nextToken}while(n);const r=a.find((t=>t.empID===e));r?t({empID:r.empID,profilePhoto:r.profilePhoto||"",name:r.name||"",email:r.email||"",officialEmail:r.officialEmail||"",contactNo:r.contactNo||""}):(i("No employee found with ID: ".concat(e)),t(null))}catch(s){i("Error fetching employee data"),console.error("Error fetching data:",s)}finally{r(!1)}})()}),[]),{personalInfo:e,loading:a,error:s,notFound:!e&&!a&&!s}})();(0,n.useEffect)((()=>{null!==g&&void 0!==g&&g.name&&x(g.name)}),[g,x]),(0,n.useEffect)((()=>{!async function(){try{var e,a;const r=localStorage.getItem("userType"),n=localStorage.getItem("userID"),i=await fd.graphql({query:Ie.ZZ,variables:{filter:{and:[{empID:{eq:t}},{selectType:{eq:r}}]},limit:2e4}}),l=null===i||void 0===i||null===(e=i.data)||void 0===e||null===(a=e.listUsers)||void 0===a?void 0:a.items[0],d=null===l||void 0===l?void 0:l.setPermissions[0],p=f(d);o(n),c(r),s(p),m(v(p))}catch(r){console.error("Error fetching user data:",r)}finally{h(!1)}}()}),[]);const f=e=>{const t=/(\w+)=\[/g,a=[];let r;for(;null!==(r=t.exec(e));)a.push(r[1]);return a},v=e=>["Dashboard","User","Recruitment","Employee","Training","TimeSheet","Insurance","LeaveManagement","Notification","Report","BenefitsAndRewards"].find((t=>e.includes(t)));if(u)return(0,i.jsx)("div",{className:"flex items-center justify-center h-[82vh] bg-transparent",children:(0,i.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,i.jsx)("p",{className:"text-sm font-semibold",children:"Loading "}),(0,i.jsx)("p",{children:(0,i.jsx)(Fr.TwU,{className:"animate-spin mt-[4px]",size:15})})]})});const y=a.filter((e=>["Dashboard","User","Recruitment","Employee","Training","TimeSheet","LeaveManagement","Insurance","Notification","Report","BenefitsAndRewards"].includes(e)));return(0,i.jsxs)(r.BV,{children:[(0,i.jsx)(r.qh,{path:"/changePassword",element:(0,i.jsx)(Xn,{})}),(0,i.jsx)(r.qh,{path:"/dropdown",Component:od}),(0,i.jsx)(r.qh,{path:"/migrationDataID",element:(0,i.jsx)(po,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataEPI",element:(0,i.jsx)(mo,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataWorkI",element:(0,i.jsx)(uo,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataService",element:(0,i.jsx)(Xo,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataEmpInsu",element:(0,i.jsx)(ho,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataLeaveDetails",element:(0,i.jsx)(xo,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataNLA",element:(0,i.jsx)(go,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataDN",element:(0,i.jsx)(fo,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataTerminated",element:(0,i.jsx)(vo,{})}),(0,i.jsx)(r.qh,{path:"/migrationDataBJL",element:(0,i.jsx)(yo,{})})," ",(0,i.jsx)(r.qh,{path:"/migrationPPValid",element:(0,i.jsx)(ed,{})}),(0,i.jsx)(r.qh,{path:"/migrationLMInfo",element:(0,i.jsx)(ad,{})}),(0,i.jsx)(r.qh,{path:"/migrationNlms",element:(0,i.jsx)(td,{})}),(0,i.jsx)(r.qh,{path:"/migrationLeaveData",element:(0,i.jsx)(id,{})}),(0,i.jsx)(r.qh,{path:"/migrationTrainingCertify",element:(0,i.jsx)(pd.u,{})}),(0,i.jsx)(r.qh,{path:"/migrationTriningReq",element:(0,i.jsx)(md.l,{})}),(0,i.jsx)(r.qh,{path:"/",element:(0,i.jsx)(r.C5,{to:"/".concat(null===p||void 0===p?void 0:p.toLowerCase())})}),(0,i.jsx)(r.qh,{path:"/personalInformation",element:(0,i.jsx)(rs,{})}),y.includes("Dashboard")&&(0,i.jsx)(r.qh,{path:"/dashboard",element:(0,i.jsx)(I,{})}),y.includes("User")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.qh,{path:"/user",element:(0,i.jsx)(va,{})}),(0,i.jsx)(r.qh,{path:"/addNewForm",element:(0,i.jsx)(Ii,{})})]}),y.includes("Recruitment")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.qh,{path:"/recruitment",Component:we}),(0,i.jsxs)(r.qh,{path:"/recrutiles",Component:Gt,children:[(0,i.jsx)(r.qh,{path:"candidate",element:(0,i.jsx)(Qt,{})}),(0,i.jsx)(r.qh,{path:"applyemployreq",element:(0,i.jsx)(Ji,{})}),(0,i.jsx)(r.qh,{path:"listofcandi",element:(0,i.jsx)(Vi,{})}),(0,i.jsx)(r.qh,{path:"localcandi",element:(0,i.jsx)(ma,{})}),(0,i.jsx)(r.qh,{path:"nonloccandi",element:(0,i.jsx)(ha,{})}),(0,i.jsx)(r.qh,{path:"employreq",element:(0,i.jsx)(wa,{})}),(0,i.jsx)(r.qh,{path:"status",element:(0,i.jsx)(ar,{})}),(0,i.jsx)(r.qh,{path:"workpasstracking",element:(0,i.jsx)(Sr,{})})]}),(0,i.jsx)(r.qh,{path:"/hiringJob",element:(0,i.jsx)(Tl,{})}),(0,i.jsx)(r.qh,{path:"/postJob",element:(0,i.jsx)(kl,{})}),(0,i.jsxs)(r.qh,{path:"/addCandidates",Component:xa,children:[(0,i.jsx)(r.qh,{index:!0,element:(0,i.jsx)(kt,{})}),(0,i.jsx)(r.qh,{path:"personalDetails",element:(0,i.jsx)(Pt,{})}),(0,i.jsx)(r.qh,{path:"educationDetails",element:(0,i.jsx)(Ot,{})}),(0,i.jsx)(r.qh,{path:"otherDetails",element:(0,i.jsx)(Vt,{})})]})]}),y.includes("Employee")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.qh,{path:"/insuranceAdd",Component:Ln,children:[(0,i.jsx)(r.qh,{index:!0,element:(0,i.jsx)(qn,{})}),(0,i.jsx)(r.qh,{path:"dependentInsurance",element:(0,i.jsx)(zn,{})})]}),(0,i.jsxs)(r.qh,{path:"/sawp",Component:Yn,children:[(0,i.jsx)(r.qh,{index:!0,element:(0,i.jsx)(ki,{})}),(0,i.jsx)(r.qh,{path:"doe",element:(0,i.jsx)(Ri,{})}),(0,i.jsx)(r.qh,{path:"nlms",element:(0,i.jsx)(Oi,{})}),(0,i.jsx)(r.qh,{path:"bankGuarantee",element:(0,i.jsx)(Fi,{})}),(0,i.jsx)(r.qh,{path:"jitpa",element:(0,i.jsx)(Li,{})}),(0,i.jsx)(r.qh,{path:"labourDeposit",element:(0,i.jsx)(Ui,{})}),(0,i.jsx)(r.qh,{path:"immigration",element:(0,i.jsx)(Hi,{})})]}),(0,i.jsx)(r.qh,{path:"/allempDetails",Component:Lr}),(0,i.jsx)(r.qh,{path:"/employee",Component:M}),(0,i.jsx)(r.qh,{path:"/empRequistion",Component:Fn}),(0,i.jsx)(r.qh,{path:"/employeeInfo",Component:An}),(0,i.jsx)(r.qh,{path:"/workInfo",Component:Cn}),(0,i.jsx)(r.qh,{path:"/workPass",Component:Yn}),(0,i.jsx)(r.qh,{path:"/nonLocalAcco",Component:Jn}),(0,i.jsx)(r.qh,{path:"/labourImmigration",Component:Mn})]}),y.includes("Insurance")&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(r.qh,{path:"/insuranceHr",Component:bl,children:[(0,i.jsx)(r.qh,{index:!0,element:(0,i.jsx)(Cl,{})}),(0,i.jsx)(r.qh,{path:"groupHS",element:(0,i.jsx)(wl,{})}),(0,i.jsx)(r.qh,{path:"workmenComp",element:(0,i.jsx)(Sl,{})}),(0,i.jsx)(r.qh,{path:"travelling",element:(0,i.jsx)(El,{})}),(0,i.jsx)(r.qh,{path:"personalAcci",element:(0,i.jsx)(Il,{})}),(0,i.jsx)(r.qh,{path:"insuranceClaim",element:(0,i.jsx)(jl,{})})]})}),y.includes("Training")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.qh,{path:"/training",Component:H}),(0,i.jsx)(r.qh,{path:"/training/AcTc",Component:bi}),(0,i.jsx)(r.qh,{path:"/training/trainingCertify",Component:co}),(0,i.jsx)(r.qh,{path:"/trainingReq",Component:ao}),(0,i.jsx)(r.qh,{path:"/trainingReq/add",Component:Ai}),(0,i.jsx)(r.qh,{path:"/trainingReq/view",Component:Ol}),(0,i.jsx)(r.qh,{path:"/blngCertify",Component:ro}),(0,i.jsx)(r.qh,{path:"/omgCertify",Component:Fl}),(0,i.jsx)(r.qh,{path:"/training/hr",Component:no}),(0,i.jsx)(r.qh,{path:"/training/tcView",Component:so})]}),y.includes("TimeSheet")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.qh,{path:"/timeSheet",element:(0,i.jsx)(Z,{})}),(0,i.jsx)(r.qh,{path:"/timesheetHO",element:(0,i.jsx)(Wi,{})}),(0,i.jsx)(r.qh,{path:"/timesheetSBW",element:(0,i.jsx)(zi,{})}),(0,i.jsx)(r.qh,{path:"/timesheetORMC",element:(0,i.jsx)(Yi,{})}),(0,i.jsx)(r.qh,{path:"/timesheetOffshore",element:(0,i.jsx)(di,{})}),(0,i.jsx)(r.qh,{path:"/timesheetBlng",element:(0,i.jsx)(ci,{})}),(0,i.jsx)(r.qh,{path:"/OffshoreSheets",element:(0,i.jsx)(cd,{})}),(0,i.jsx)(r.qh,{path:"/OffshoreSheets/OffshoreORMC",element:(0,i.jsx)(dd,{})}),(0,i.jsx)(r.qh,{path:"/viewTimesheet",element:(0,i.jsx)(gi,{})}),(0,i.jsx)(r.qh,{path:"/viewTSheetList",element:(0,i.jsx)(mi,{})}),(0,i.jsx)(r.qh,{path:"/viewTsheetDetails",element:(0,i.jsx)(Ql,{})}),(0,i.jsx)(r.qh,{path:"/viewSummary",element:(0,i.jsx)(Nl,{})})]}),y.includes("LeaveManagement")&&(0,i.jsxs)(r.qh,{path:"/leaveManagement",Component:qe,children:[(0,i.jsx)(r.qh,{index:!0,element:(0,i.jsx)(Bl,{})}),(0,i.jsx)(r.qh,{path:"historyLeave",element:(0,i.jsx)(ql,{})}),(0,i.jsx)(r.qh,{path:"leaveBalance",element:(0,i.jsx)(Wl,{})}),(0,i.jsx)(r.qh,{path:"requestTickets",element:(0,i.jsx)(zl,{})}),(0,i.jsx)(r.qh,{path:"leaveDetails",element:(0,i.jsx)(gd,{})}),(0,i.jsx)(r.qh,{path:"proDataCalculation",element:(0,i.jsx)(xd,{})})]}),y.includes("Notification")&&(0,i.jsx)(r.qh,{path:"/notifications",Component:Xe}),y.includes("Report")&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.qh,{path:"/reports",Component:xe}),(0,i.jsx)(r.qh,{path:"/probForm",element:(0,i.jsx)(il,{userID:l,userType:d})}),(0,i.jsx)(r.qh,{path:"/contractForms",Component:nd}),(0,i.jsx)(r.qh,{path:"/rm",Component:Zl}),(0,i.jsx)(r.qh,{path:"/filterTable",Component:$l}),(0,i.jsx)(r.qh,{path:"/resignation",Component:to}),(0,i.jsx)(r.qh,{path:"/termination",Component:Do}),(0,i.jsx)(r.qh,{path:"/probationReview",Component:Ao}),(0,i.jsx)(r.qh,{path:"/contractReview",Component:Eo}),(0,i.jsx)(r.qh,{path:"/empPassExpiry",Component:To}),(0,i.jsx)(r.qh,{path:"/ldExpiry",Component:Mo}),(0,i.jsx)(r.qh,{path:"/passportExpiry",Component:Po}),(0,i.jsx)(r.qh,{path:"/empMedical",Component:Fo}),(0,i.jsx)(r.qh,{path:"/newRecruit",Component:Uo}),(0,i.jsx)(r.qh,{path:"/trainingRC",Component:Bo}),(0,i.jsx)(r.qh,{path:"/lbdKpi",Component:Ho}),(0,i.jsx)(r.qh,{path:"/groupHS",Component:Yo}),(0,i.jsx)(r.qh,{path:"/leavePass",Component:Jo}),(0,i.jsx)(r.qh,{path:"/contractForms",element:(0,i.jsx)(Ko,{userID:l,userType:d})}),(0,i.jsx)(r.qh,{path:"/promotion",Component:Zo}),(0,i.jsx)(r.qh,{path:"/probFormUpdate",element:(0,i.jsx)(sd,{userID:l,userType:d})}),(0,i.jsx)(r.qh,{path:"/probReviewForm",element:(0,i.jsx)(ll,{userID:l,userType:d})}),(0,i.jsx)(r.qh,{path:"/ContractUp",element:(0,i.jsx)(Ko,{userID:l,userType:d})})]}),y.includes("BenefitsAndRewards")&&(0,i.jsx)(r.qh,{path:"/benfitsAndrewards",Component:Qe}),(0,i.jsx)(r.qh,{path:"/logout",Component:et}),(0,i.jsx)(r.qh,{path:"*",element:(0,i.jsx)(r.C5,{to:"/".concat(null===p||void 0===p?void 0:p.toLowerCase())})})]})}},2902:(e,t,a)=>{"use strict";a.d(t,{$A:()=>o,CF:()=>f,Fh:()=>g,Io:()=>A,M3:()=>u,NL:()=>s,Rr:()=>j,UB:()=>D,UQ:()=>c,Z2:()=>n,_K:()=>x,_j:()=>y,gO:()=>d,gm:()=>N,h4:()=>l,iR:()=>b,mB:()=>h,me:()=>m,s8:()=>v,uL:()=>p,wB:()=>i});var r=a(899);const n=r.Ik({userID:r.Yj().required("UserID is mandatory"),password:r.Yj().required("Password is Required")}),s=r.Ik({newPassword:r.Yj().required("New Password is required").min(8,"Password must be at least 8 characters"),rePassword:r.Yj().required("Please confirm your password").oneOf([r.KR("newPassword"),null],"Passwords must match")}),i=r.Ik({userName:r.Yj().required("User Name is mandatory")}),l=r.Ik({empID:r.Yj().required("Employee ID is required"),password:r.Yj().required("Temporary Password is required"),selectType:r.Yj().required("Please select a type"),officialEmail:r.Yj().required("OfficialEmail is required"),userID:r.Yj().required("User ID is mandatory"),name:r.Yj().required("Name is mandatory"),contactNo:r.Yj().required("Contact number is mandatory"),position:r.Yj().required("Position is mandatory"),department:r.Yj().required("Department is mandatory")}),o=r.Ik({userID:r.Yj().required("User ID is mandatory"),currentPassword:r.Yj().required("Current Password is mandatory"),password:r.Yj().min(8,"Password must be at least 8 characters").max(15,"Password cannot exceed 15 characters").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])/,"Password must contain at least one lowercase letter, one uppercase letter, one number, and one special character").required("Password is required"),confirmPassword:r.Yj().oneOf([r.KR("password"),null],"Passwords must match").required("Confirm password is required")}),d=r.Ik().shape({profilePhoto:r.Yj().required("Profile Photo is mandatory"),agent:r.Yj().notRequired(),position:r.Yj().required("Position is mandatory"),contractType:r.Yj().notRequired(),empType:r.Yj().notRequired(),name:r.Yj().min(3,"Name must be at least 3 characters").required("Name is mandatory"),chinese:r.Yj().notRequired(),gender:r.Yj().required("Gender is mandatory"),dob:r.Yj().required("Date of Birth is mandatory"),age:r.ai().min(20,"Age must be at least 20").max(99,"Age cannot exceed 99").required("Age is required"),email:r.Yj().email("Please enter a valid email").required("Email is required"),cob:r.Yj().required("Country of Birth is mandatory"),nationality:r.Yj().required("Nationality is mandatory"),otherNation:r.Yj().when("nationality",{is:e=>e&&"other"===e.trim().toLowerCase(),then:()=>r.Yj().required("Other Nationality is required"),otherwise:()=>r.Yj()}),marital:r.Yj().required("Marital status is mandatory"),race:r.Yj().required("Race is mandatory"),otherRace:r.Yj().when("race",{is:e=>e&&"other"===e.trim().toLowerCase(),then:()=>r.Yj().required("Other Race is required"),otherwise:()=>r.Yj()}),religion:r.Yj().required("Religion is mandatory"),otherReligion:r.Yj().when("religion",{is:e=>e&&"other"===e.trim().toLowerCase(),then:()=>r.Yj().required("Other religion is required"),otherwise:()=>r.Yj()})}),c=e=>r.Ik({bwnIcNo:r.Yj().notRequired(),bwnIcColour:r.Yj().notRequired(),bwnIcExpiry:r.Yj().notRequired(),ppNo:r.Yj().notRequired(),ppIssued:r.Yj().notRequired(),ppExpiry:r.Yj().notRequired(),ppDestinate:r.Yj().notRequired(),alternateNo:r.Yj().notRequired(),contactNo:r.Yj().required("Contact Number is mandatory"),presentAddress:r.Yj().required("Present Address is mandatory"),permanentAddress:r.Yj().notRequired(),driveLic:r.Yj().notRequired(),OtherLang:r.Yj().notRequired(),familyDetails:r.YO().of(r.Ik().shape({name:r.Yj().notRequired(),relationship:r.Yj().notRequired(),age:r.Yj().notRequired(),occupation:r.Yj().notRequired(),place:r.Yj().notRequired()})).notRequired(),eduDetails:r.YO().of(r.Ik().shape({university:r.Yj().notRequired(),fromDate:r.Yj().notRequired(),toDate:r.Yj().notRequired(),degree:r.Yj().notRequired()})),workExperience:r.YO().of(r.Ik().shape({fromDate:r.Yj().notRequired(),toDate:r.Yj().notRequired(),companyAndAddress:r.Yj().notRequired(),position:r.Yj().notRequired(),salary:r.Yj().notRequired(),reasonLeaving:r.Yj().notRequired()}))}),p=r.Ik({referees:r.YO().of(r.Ik().shape({name:r.Yj().notRequired(),address:r.Yj().notRequired(),phoneNumber:r.Yj().notRequired(),profession:r.Yj().notRequired()})).notRequired(),relatives:r.YO().of(r.Ik().shape({name:r.Yj().notRequired(),position:r.Yj().notRequired(),relationship:r.Yj().notRequired()})).notRequired(),description:r.Yj().notRequired(),emgDetails:r.YO().of(r.Ik().shape({name:r.Yj().notRequired(),relationship:r.Yj().notRequired(),address:r.Yj().notRequired(),phoneNumber:r.Yj().notRequired(),bloodGroup:r.Yj().notRequired()})).required("At least one emergency contact is mandatory"),disease:r.Yj().notRequired(),liquor:r.Yj().notRequired(),crime:r.Yj().notRequired(),diseaseDesc:r.Yj().when("disease",{is:e=>e&&"yes"===e.trim().toLowerCase(),then:()=>r.Yj().notRequired(),otherwise:()=>r.Yj()}),liquorDesc:r.Yj().when("liquor",{is:e=>e&&"yes"===e.trim().toLowerCase(),then:()=>r.Yj().notRequired(),otherwise:()=>r.Yj()}),crimeDesc:r.Yj().when("crime",{is:e=>e&&"yes"===e.trim().toLowerCase(),then:()=>r.Yj().notRequired(),otherwise:()=>r.Yj()})}),m=r.Ik().shape({salaryExpectation:r.Yj().notRequired(),noExperience:r.Yj().notRequired(),noticePeriod:r.Yj().notRequired(),empStatement:r.Yj().notRequired(),perIS:r.Yj().required("Interview status is required"),perID:r.Yj().when("perInterviewStatus",{is:e=>e&&"yes"===e.trim().toLowerCase(),then:()=>r.Yj().notRequired(),otherwise:()=>r.Yj()}),supportInfo:r.Yj()}),u=r.Ik().shape({nameReq:r.Yj().notRequired(),requestorID:r.Yj().notRequired(),approverID:r.Yj().notRequired(),department:r.Yj().required("Department is required"),project:r.Yj().required("Project is required"),position:r.Yj().required("Position is required"),quantity:r.ai().typeError("Quantity must be a number").required("Quantity is required"),reasonForReq:r.Yj().required("Reason for request is required"),justification:r.Yj().required("Justification is required"),replacementFor:r.Yj().notRequired(),qualification:r.Yj().required("State Qualification is required"),tentativeDate:r.p6().min(new Date,"Tentative date must be in the future").required("Tentative date is required").typeError("Please enter a valid date"),status:r.Yj().notRequired(),remarkReq:r.Yj().notRequired()}),h=r.Ik().shape({interDate:r.p6().required("Date is required").typeError("Date is required").min(new Date,"The selected date is in the past. Please choose a valid date."),interTime:r.Yj().required("Time is required").matches(/^(0[8-9]|1[0-5]):([0-5]\d)$/,"Please choose a time between 8:00 AM and 4:00 PM."),venue:r.Yj().required("Venue is required"),interType:r.Yj().notRequired(),empBadgeNo:r.Yj().notRequired("Badge Number is required"),manager:r.Yj().notRequired("Manager is required"),message:r.Yj().optional()}),x=r.Ik().shape({jobTitle:r.Yj().required("Job Title is required"),location:r.Yj().notRequired(),jobDesc:r.Yj().notRequired(),experience:r.Yj().required("Experience is required"),quantity:r.Yj().notRequired(),startDate:r.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired(),expiryDate:r.p6().nullable().transform(((e,t)=>""===t?null:e)).notRequired().test("is-future-date","Only Future Dates Allowed",(function(e){return!e||new Date(e)>new Date})),uploadJobDetails:r.Yj().notRequired()}),g=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),sawpLtrReq:r.p6().notRequired(),sawpLtrRece:r.p6().notRequired(),sawpFile:r.gl().nullable().notRequired()}),f=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),doeSubmit:r.p6().notRequired(),doeApproval:r.p6().notRequired(),doeValid:r.p6().notRequired(),doeRefNo:r.Yj().notRequired(),doeFile:r.gl().nullable().notRequired()}),v=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),nlmsSubmit:r.p6().notRequired(),nlmsSubmitRefNo:r.Yj().notRequired(),nlmsApproval:r.p6().notRequired(),nlmsValid:r.p6().notRequired(),ldRefNo:r.Yj().notRequired(),nlmsFile:r.gl().nullable().notRequired()}),y=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),bgSubmit:r.p6().notRequired(),bgRece:r.p6().notRequired(),bgValid:r.p6().notRequired(),bgRefNo:r.Yj().notRequired(),bgAmount:r.Yj().notRequired(),bgFile:r.gl().nullable().notRequired()}),N=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),jpTbaPurchase:r.p6().notRequired(),jpEndorsement:r.p6().notRequired(),jitpaValid:r.p6().notRequired(),jpAmount:r.Yj().notRequired(),jitpaFile:r.gl().nullable().notRequired()}),b=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),labDepReceiptNo:r.Yj().notRequired(),labDepAmount:r.Yj().notRequired(),labEndrose:r.p6().notRequired(),labDepFile:r.gl().nullable().notRequired()}),D=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),immbdNo:r.Yj().notRequired(),docSubmit:r.p6().notRequired(),visaApproval:r.p6().notRequired(),visaRefNo:r.Yj().notRequired(),visaFile:r.gl().nullable().notRequired()}),j=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),departure:r.p6().notRequired(),arrival:r.p6().notRequired(),cityName:r.Yj().notRequired(),airFare:r.Yj().notRequired(),airTktFile:r.gl().nullable().notRequired()}),A=r.Ik().shape({tempID:r.Yj().required("Temporary ID is Required"),mobSignDate:r.p6().notRequired(),agent:r.Yj().notRequired(),remarkNLMob:r.Yj().notRequired(),mobFile:r.gl().nullable().notRequired()})},5765:(e,t,a)=>{"use strict";a.d(t,{r:()=>i});var r=a(8382),n=a(5043),s=a(3482);const i=()=>{const e=(0,r.D)();return{AddEmpData:(0,n.useCallback)((async t=>{let{AddEmpValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,traineeTrack:JSON.stringify(a.trainingTrack),createdBy:null===a||void 0===a?void 0:a.createdBy};try{const t=await Promise.all([e.graphql({query:s.hK,variables:{input:r}})]);console.log(t,"successfully create data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}}},4791:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(8382),n=a(5043),s=a(3482);const i=()=>{const e=(0,r.D)();return{TCData:(0,n.useCallback)((async t=>{let{TCValue:a}=t;if(!a)throw new Error("Missing required parameters");const r={empID:a.empID,trainingProof:JSON.stringify(a.trainingProof)};try{const t=await Promise.all([e.graphql({query:s.lh,variables:{input:r}})]);console.log(t,"successfully create data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}}},4954:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var r=a(8382),n=a(5043),s=a(3482);const i=()=>{const e=(0,r.D)();return{TrReqUp:(0,n.useCallback)((async t=>{let{TMRDataUp:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,traineeTrack:JSON.stringify(a.trainingTrack),updatedBy:null===a||void 0===a?void 0:a.updatedBy};try{const t=await Promise.all([e.graphql({query:s.Do,variables:{input:r}})]);console.log(t,"successfully update data")}catch(n){throw console.error("Error executing GraphQL requests:",n),n}}),[])}}},940:(e,t,a)=>{"use strict";a.d(t,{P:()=>i});var r=a(8382),n=a(5043),s=a(3482);const i=()=>{const e=(0,r.D)();return{TCDataFunUp:(0,n.useCallback)((async t=>{let{TCDataUp:a}=t;if(!a)throw new Error("Missing required parameters");const r={id:a.id,empID:a.empID,trainingProof:JSON.stringify(a.trainingProof)};try{const t=await Promise.all([e.graphql({query:s.aD,variables:{input:r}})]);console.log(t,"successfully Updated data")}catch(n){throw console.log(n),console.error("Error executing GraphQL requests:",n),n}}),[])}}},2759:(e,t,a)=>{"use strict";a.d(t,{k:()=>n});var r=a(9462);const n=async(e,t,a)=>{if(!t)return alert("File name is missing. Please select a valid file to delete."),console.error("Missing fileName. Received parameters:",{fileType:e,empID:a,fileName:t}),!1;try{const n="public/".concat(e,"/").concat(a,"/").concat(t);return await(0,r.T)({path:n,bucket:"aweadininstorage20242a2fe-dev"}),!0}catch(n){return console.error("Error deleting file:",n),alert("Error processing the file deletion."),!1}}},4598:e=>{"use strict";e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxQHEBEREBIQDhAQEg8SGREQDRUQFxcTFREYGBQVExYYKCosGBolHhMVITEhJSkrMi4uFx8zODMsNygtLisBCgoKBQUFDgUFDisZExkrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrK//AABEIAOAA4QMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABgcBBQgEAgP/xAA+EAACAQEEBQcKBQMFAAAAAAAAAQIDBAURUQYSITGRBxNBYXGBsRQiMkJSYnKhwdEVIzNT4UOCskRzg8Lw/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/ALpAAAAAAAAAAAAAAeS8bypXZHWrTjTXRi9r7F0kLvTlGwxVmpY+/VfhFfVgT8FNWzS212vfWlBZU0oeBq6tuq1fSq1JfFUkwL5BQkbVOO1Tmn1TaPdZdI7VZfRr1eyUtdfMC7QVndvKJVo4KvTjWjnF6kvsyaXLpLZ742U56s/25+bLuz7gNwAAAAAAAAAAAAAyAAMAAAAAAAAAAAQ7SrTWN2t0rPhUrbU5b4w+7PNp3pW7NjZrO/P3Tmn6Pux6yuAP3ttrnbpudWUqk30yePDJH4AAAAAAAAynqvFbGulGABNdGNOZWVqnasalPYlU9aPxe0iyaFaNoipwalGSTUk8U0UCSXQ/SeVyz1Jtys83tXsv2o/VAW4D5pVFVipRalGSTTW5p7mj6AAAAAAAAAyAAMAAAAAAAAGh0yvz8Es+Mf1amMYLLOXcb4pvTO9fxW1zaeNOnjTj2J7X3sDRyk5ttvFtttvpb3mAAAAAAAAAAAAAAACf8m9/7fJKj2bXTbfGH1RYRQdmryss4zg8JQakn1pl4XRbleVCnWj/AFIp4ZPpXHED2AAAAAAAAyAAMAAAAAAAA1mklt/D7LWqLY1BpfE9i8SkS0uU2vzdkjH9yrFdyTf0KtAAAAAAAAAAAAAAAAAFlcl1u52jVov+nJSXwy/lFaku5Mq/N2yUeipSmu9NNeDAtMAAAAAAAGQABgAAAAAAAEG5VX+TZ/8Acn/iVuWdyo0tezUpezV8YsrEAAAAAAAAAAAAAAAAASPk+eFvpfDU/wASOEq5NqXOW5P2KdSXgvqBa4AAAAAAAMgADAAAAAAAANJpnY/LbFWitrjHXX9rxKZOgJRU009qaww6ij7/ALtd1WipSe6Mm4vOL2x+QGvAAAAAAAAAAAAAAAALB5K7Hhz9Z9OrTXjL6FfpY7FtbLq0Xu38KstKm/S1daXxS2v7dwG2AAAAAAABkAAYAAAAAAAAIdyi3H5dSVoprGpRT1klvp/x9yYmGsQOfwSvTfRh3TN1qSxoTe5L0JPofVkRQAAAAAAAAAAAABsbiued9VlSp9spYbIxzYG65Prj/Ea/PTX5VBp7V6U+hd28tY8l13fC66UKVNYRgsOtvpb62esAAAAAAAADIAAwAAAAAAAAAAPitSjXi4zSlGSaaaxTRWOlehc7vbq2dOpR2tw3yh90WiAOfgW7f2htC9sZR/Iqv1oLY370ekgl6aGWq78Woc9H2qW3jHeBHQfVSDpvCScWuhrB8D5AAAADa3bo7aby/TpS1faktSPFk1uTk+hZ8J2mXOy/bjsiu1+t8gIbo9o5Vv2XmLUpr0qslsXZm+otq5bop3NSVOku2T3yebPZRpRoRUYJRjFYKMVgkupH2AAAAAAAAAAAGQABgAAAAAANPpFpFSuKGM/PqNebTT2vreS6wNtUmqScpNRitrbeCXayK3np7Z7HLVpqVoeO1wwUUunBveQC/dIa19yxqSwh0U4vCK+762akC9rsvKnelNVKMlOL4p5SXQz1lE3beVS6569GbhLq3NZNdKLCuLT+nacI2lczP21tg+32QJoD86FaNoipQlGcX60WmvkfoB+NossLUsKkIVF70FLxNdU0YslTfZ6fcsPA24A00dFbJH/T0/me6y3XRsn6dGlB5qmseJ6wAAG4AfNSapJyk1GKWLbeCS6yP31pjZ7rxSlz9RepTeO3rl0Fc3/pLWvt4TepTxxVKL2d+bAsBad2XnXTbkorZzurjFvxw6yR2e0RtUVOnKM4vdKLxRQZ77ovirc89ajNxzi9sZdqAvIEe0Y0rp34tV4Uq6W2Dex5uD6ewkIAAAAABkAAYAAAA1ekd8xuOi6ktsnshDH0pfYDxaW6TRuKGrHCdea82OS9qXUVLa7TO2TlUqSc5yeLbM221zt1SVSo3Kc3i2/BdR+AAAAAAB6bDeFW73rUak6b92WCfaukk9g5QrRQwVWFOss/QfFfYh4Asyzco1Gf6lKrTfU1NfQ98NOrHLfOce2kypABbr05sa/qSf8AxSPJX5Q7NT9GNap2RUfEq0ATm28o9SeyjRhDrnNzfBYEavPSC0Xpsq1ZOL9SL1Y8FvNWAAAAAAD6p1HSalFuMovFNPBp9RaOhelivVKjWajXitkv3Ev+xVh9UqjoyUotxlFppremukC/wR/Q7SFX5Rwlgq1NJTWeU11MkAAAAZAAGAAB8zmqabbwSTbb6Et7Ka0rvt35aHPbzcMYwXu59rJrykXx5JRjZ4Pz62Ll1U1934MrAAAAAAAAAAAAAAAAAAAAAAAAAAAAPfcl5yuivCtD1djXtRe9Muuw2qNupwqweMKkVJd/QUKT7kyvnVcrLN7HjOGOfrR+vECwwABkAAYMSkopt7EtuPUZI9p3eH4fY54PCVX8td+/5YgVjpFebva01Kvqt4RWUFsj/wC6zWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAP3sNqlYakKsPSpyUl3dB+AAvqwWpW6lTqx9GpGMl3rcfuQzkyvHn6E6Le2jLFfDL+cSZgZAAGCtuVK2c5Wo0VupwlN9sns+UfmWSUzpnafKbdXfRGWov7VgBpAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASXk9tnkltguirGVN9u9fNFuFD3bX8lrUqnsThLg9pe8XrJPNJgfQAAwURecnVr1pYPzqlR8ZMvcAc/6ryfAaryfA6AAHP+q8nwGq8nwOgABz/qvJ8BqvJ8DoAAc/6ryfAaryfA6AAHP+q8nwGq8nwOgABz/qvJ8BqvJ8DoAAc/6ryfAaryfA6AAHP+q8nwGq8nwOgABz/qvJ8BqvJ8DoAAc/6ryfAaryfA6AAHP+q8nwGq8nwOgABz/qvJ8BqvJ8DoAAc/6ryfAva6585Qoye+VKk+MEeoAZAAH/2Q=="},7843:()=>{},841:()=>{},1660:()=>{},9212:()=>{},1668:()=>{},180:()=>{},5755:()=>{},2993:()=>{},4698:()=>{},670:()=>{},7926:()=>{},7640:()=>{},5618:()=>{},7492:()=>{},1815:()=>{},6671:()=>{},2787:()=>{}}]);
//# sourceMappingURL=401.e4c36d68.chunk.js.map