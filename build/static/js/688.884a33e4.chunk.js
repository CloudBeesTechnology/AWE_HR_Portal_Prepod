(()=>{importScripts("/workers/libs/jspdf.umd.min.js"),importScripts("/workers/libs/jspdf.plugin.autotable.js");const{jsPDF:t}=self.jspdf;let e=null;!async function(){try{e=await(t="/fonts/fontawesome-webfont.ttf",new Promise(((e,o)=>{const l=new XMLHttpRequest;l.onload=function(){const t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(l.response)},l.onerror=o,l.open("GET",t),l.responseType="blob",l.send()})))}catch(o){}var t}();const o=function(){return String(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},l=async l=>{try{let s=0;for(;!e&&s<50;)await new Promise((t=>setTimeout(t,100))),s++;const{rows:a,dayCounts:r,startDate:i,formattedStartDate:u,formattedEndDate:d,location:c,tableLogoBase64:p}=l;self.postMessage({type:"progress",progress:30,message:"Generating PDF..."});const h=new t({orientation:"landscape",unit:"mm",format:"a3"});if(e)try{const t=e.split(",")[1];h.addFileToVFS("fontawesome-webfont.ttf",t),h.addFont("fontawesome-webfont.ttf","FontAwesome","normal")}catch(n){}const y=((t,e)=>{const o=["Employee Name","PROJECT"];for(let l=0;l<t;l++){const t=new Date(e);t.setDate(new Date(e).getDate()+l),o.push(t.getDate())}return o.push("NH","ND","PH","PH-D","AL/CL","SL","OFF","A","UAL","OT","Verified","Updater"),o})(r,new Date(i)),f=((t,e,l)=>{const n=[];let s={totalHours:0,normalDays:0,PH:0,PHD:0,ALCL:0,SL:0,OFF:0,ABS:0,UAL:0,OT:0};t.forEach((t=>{var a,r,i,u,d,c,p,h,y,f,v,g;s.totalHours+=Number(t.__totalHours||0),s.normalDays+=Number(t.__NormalDays||0),s.PH+=Number((null===t||void 0===t||null===(a=t.hollydayCounts)||void 0===a?void 0:a.PH)||0),s.PHD+=Number(t.__calculatedPHD||0),s.ALCL+=Number(t.__totalOfALCL||0),s.SL+=Number((null===t||void 0===t||null===(r=t.empLeaveCount)||void 0===r?void 0:r.SL)||0),s.OFF+=Number((null===t||void 0===t||null===(i=t.hollydayCounts)||void 0===i?void 0:i.OFF)||0),s.ABS+=Number(t.__roundedTotalAbsentiesHrs||0),s.UAL+=Number((null===t||void 0===t||null===(u=t.empLeaveCount)||void 0===u?void 0:u.UAL)||0),s.OT+=Number(t.__totalOT||0);const m=[],C=[],w=[];for(let n=0;n<e;n++){var F,S,D,b,_;const e=new Date(l);e.setDate(new Date(l).getDate()+n);const s="".concat(e.getDate(),"-").concat(e.getMonth()+1,"-").concat(e.getFullYear()),a=null!==(F=null===t||void 0===t||null===(S=t.workingHrs)||void 0===S?void 0:S[s])&&void 0!==F?F:"",r=null!==(D=null===t||void 0===t||null===(b=t.OVERTIMEHRS)||void 0===b?void 0:b[s])&&void 0!==D?D:"0",i=Boolean(null===t||void 0===t||null===(_=t.getVerify)||void 0===_?void 0:_[s]);m.push(o(String(a))),C.push(o(String(r))),w.push(i?"\xa0":"")}const L=[],H="".concat(o(t.name||""),"\nBadge# : ").concat(o(t.empBadgeNo||"")," | SapID : ").concat(o(t.sapNo||""),"\nHours/Day: ").concat(o(String(Array.isArray(null===t||void 0===t?void 0:t.workHrs)&&(null===t||void 0===t?void 0:t.workHrs.length)>0?t.workHrs[t.workHrs.length-1]:(null===t||void 0===t?void 0:t.workHrs)||"0")),"\nDays/Month: ").concat(o(String(Array.isArray(null===t||void 0===t?void 0:t.workMonth)&&(null===t||void 0===t?void 0:t.workMonth.length)>0?t.workMonth[t.workMonth.length-1]:(null===t||void 0===t?void 0:t.workMonth)||"0")),"\nSalaryType: ").concat(o((Array.isArray(null===t||void 0===t?void 0:t.salaryType)&&(null===t||void 0===t?void 0:t.salaryType.length)>0?t.salaryType[t.salaryType.length-1]:null===t||void 0===t?void 0:t.salaryType)||""));L.push({content:H,rowSpan:2,styles:{valign:"middle"}}),L.push({content:o(t.jobcode||""),rowSpan:2,styles:{valign:"middle"}}),m.forEach((t=>{L.push(t)})),L.push(Number(t.__totalHours||0).toFixed(2)),L.push(Number(t.__NormalDays||0).toFixed(2)),L.push((null===t||void 0===t||null===(d=t.hollydayCounts)||void 0===d?void 0:d.PH)||0),L.push(t.__calculatedPHD||0),L.push(t.__totalOfALCL||0),L.push((null===t||void 0===t||null===(c=t.empLeaveCount)||void 0===c?void 0:c.SL)||0),L.push((null===t||void 0===t||null===(p=t.hollydayCounts)||void 0===p?void 0:p.OFF)||0),L.push(Number(t.__roundedTotalAbsentiesHrs||0).toFixed(2)),L.push((null===t||void 0===t||null===(h=t.empLeaveCount)||void 0===h?void 0:h.UAL)||0),L.push(Number(t.__totalOT||0).toFixed(2)),L.push({content:t.__allFieldsYes?"Yes":"",rowSpan:2,styles:{valign:"middle"}}),L.push({content:o(t.__uniqueTimeKeeperName||""),rowSpan:2,styles:{valign:"middle"}}),n.push(L);const T=[];C.forEach((t=>{T.push(t)}));for(let e=0;e<10;e++)T.push("");n.push(T);const A=[];A.push(""),A.push(""),w.forEach((t=>{A.push(t)}));for(let e=0;e<10;e++)A.push("");A.push(""),A.push(""),n.push(A);const N=[];N.push({content:"Total",styles:{fillColor:[216,211,211]}}),N.push({content:"",styles:{fillColor:[216,211,211]}}),N.push({content:"",colSpan:e,styles:{fillColor:[216,211,211]}}),N.push({content:Number(t.__totalHours||0).toFixed(2),styles:{fillColor:[216,211,211]}}),N.push({content:Number(t.__NormalDays||0).toFixed(2),styles:{fillColor:[216,211,211]}}),N.push({content:(null===t||void 0===t||null===(y=t.hollydayCounts)||void 0===y?void 0:y.PH)||0,styles:{fillColor:[216,211,211]}}),N.push({content:t.__calculatedPHD||0,styles:{fillColor:[216,211,211]}}),N.push({content:t.__totalOfALCL||0,styles:{fillColor:[216,211,211]}}),N.push({content:(null===t||void 0===t||null===(f=t.empLeaveCount)||void 0===f?void 0:f.SL)||0,styles:{fillColor:[216,211,211]}}),N.push({content:(null===t||void 0===t||null===(v=t.hollydayCounts)||void 0===v?void 0:v.OFF)||0,styles:{fillColor:[216,211,211]}}),N.push({content:Number(t.__roundedTotalAbsentiesHrs||0).toFixed(2),styles:{fillColor:[216,211,211]}}),N.push({content:(null===t||void 0===t||null===(g=t.empLeaveCount)||void 0===g?void 0:g.UAL)||0,styles:{fillColor:[216,211,211]}}),N.push({content:Number(t.__totalOT||0).toFixed(2),styles:{fillColor:[216,211,211]}}),N.push({content:"",styles:{fillColor:[216,211,211]}}),N.push({content:"",styles:{fillColor:[216,211,211]}}),n.push(N)}));const a=[];return a.push({content:"Grand Total",styles:{fillColor:[216,211,211]}}),a.push({content:"",styles:{fillColor:[216,211,211]}}),a.push({content:"",colSpan:e,styles:{fillColor:[216,211,211]}}),a.push({content:s.totalHours.toFixed(2),styles:{fillColor:[216,211,211]}}),a.push({content:s.normalDays.toFixed(2),styles:{fillColor:[216,211,211]}}),a.push({content:s.PH,styles:{fillColor:[216,211,211]}}),a.push({content:s.PHD,styles:{fillColor:[216,211,211]}}),a.push({content:s.ALCL.toFixed(2),styles:{fillColor:[216,211,211]}}),a.push({content:s.SL.toFixed(2),styles:{fillColor:[216,211,211]}}),a.push({content:s.OFF,styles:{fillColor:[216,211,211]}}),a.push({content:s.ABS.toFixed(2),styles:{fillColor:[216,211,211]}}),a.push({content:s.UAL,styles:{fillColor:[216,211,211]}}),a.push({content:s.OT.toFixed(2),styles:{fillColor:[216,211,211]}}),a.push({content:"",styles:{fillColor:[216,211,211]}}),a.push({content:"",styles:{fillColor:[216,211,211]}}),n.push(a),n})(a,r,new Date(i)),v=(t=>{const e={0:{cellWidth:23},1:{cellWidth:13}};for(let l=2;l<2+t;l++)e[l]={cellWidth:7};const o=2+t;for(let l=0;l<10;l++)e[o+l]={cellWidth:8};return e[o+10]={cellWidth:"auto"},e[o+11]={cellWidth:17,overflow:"linebreak"},e})(r),g=((t,e,o,l,n)=>{if(n){const e=t.getImageProperties(n),o=40,l=e.height*o/e.width;t.addImage(n,"PNG",5,10,o,l)}const s=n?25:15;return t.setFontSize(10),t.text("TIMESHEET SUMMARY - ".concat(e.toUpperCase()," DIVISION"),5,s),t.text("FOR THE PERIOD ".concat(o," TO ").concat(l),5,s+5),s+7})(h,c,u,d,p);h.autoTable({tableWidth:"wrap",head:[y],body:f,foot:[],showFoot:"never",useCss:!0,startY:g+5,margin:{top:5,right:5,bottom:10,left:5},styles:{fontSize:8,cellPadding:1,overflow:"linebreak",cellWidth:"wrap",lineColor:[0,0,0],lineWidth:.1},columnStyles:v,headStyles:{fillColor:[120,120,120],textColor:[255,255,255],fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:[255,255,255]},pageBreak:"auto",horizontalPageBreak:!1,didDrawCell:t=>{try{const o=t.cell,l=o.raw,n=String(o.text||"");if(("\xa0"===l||"\xa0"===n)&&e){h.getFont(),h.getFontSize();h.setFont("FontAwesome"),h.setFontSize(8);const t="\uf00c",e=o.x+o.width/2,l=o.y+o.height/2;h.text(t,e,l,{align:"center",baseline:"middle"})}}catch(o){}},didDrawPage:t=>{h.setFontSize(8),h.setTextColor(100),h.text("Page ".concat(t.pageNumber),h.internal.pageSize.width-15,h.internal.pageSize.height-10,{align:"right"}),h.text("Generated on ".concat((new Date).toLocaleDateString()),15,h.internal.pageSize.height-10,{align:"left"})}}),self.postMessage({type:"progress",progress:90,message:"Preparing download..."});const m=h.output("arraybuffer");self.postMessage({type:"complete",arrayBuffer:m,filename:"TIMESHEET SUMMARY - ".concat(c," DIVISION FOR THE PERIOD ").concat(u," TO ").concat(d,".pdf")})}catch(s){self.postMessage({type:"error",error:s.message})}};self.addEventListener("message",(async t=>{const{type:e,data:o}=t.data;if("GENERATE_PDF"===e)await l(o);else self.postMessage({type:"error",error:"Unknown message type"})}))})();
//# sourceMappingURL=688.884a33e4.chunk.js.map