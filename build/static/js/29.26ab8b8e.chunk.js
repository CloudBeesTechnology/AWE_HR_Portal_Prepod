(self.webpackChunkcheckingproject=self.webpackChunkcheckingproject||[]).push([[29],{6592:(e,t,A)=>{"use strict";A.r(t),A.d(t,{default:()=>q});var a=A(9379),l=A(423),s=A(7305),o=A(4598),r=A(2250),n=A(5043),i=A(6833),c=A(3986),d=A(5394),p=A(432),u=A(2926),f=A(5200),m=A(579);const x=e=>{let{handleProfile:t,profilePhoto:A,changeProfilePhoto:a,handleFileUpload:l,PPLastUP:s,setPPLastUP:r,loading:i,message:c,removeProfilePhoto:p}=e;localStorage.getItem("userID").toString().toUpperCase();return(0,n.useEffect)((()=>{if(null!==a&&void 0!==a&&a.profilePhoto){(async e=>{var t;const A=await(0,u.I)({path:e});r(null===A||void 0===A||null===(t=A.url)||void 0===t?void 0:t.toString())})(a.profilePhoto)}}),[a]),(0,m.jsx)("section",{className:"fixed top-0 left-0 center w-full h-full z-50 bg-grey bg-opacity-15 inset-0",children:(0,m.jsxs)("div",{className:"bg-white max-w-md w-full max-h-80 h-full rounded-md center flex-col shadow-xl p-5 gap-1",children:[(0,m.jsx)("div",{className:"flex justify-end w-full h-[50px] ",onClick:t,children:(0,m.jsx)(d.LwM,{className:"text-[28px] text-dark_grey cursor-pointer"})}),(0,m.jsx)("div",{className:"center pb-2",children:(0,m.jsxs)("div",{className:"py-2 center flex-col max-w-[160px]",children:[(0,m.jsx)("input",{type:"file",id:"fileInput",name:"profilePhoto",accept:".jpg,.jpeg,.png",onChange:e=>l(e,"profilePhoto"),className:"hidden"}),(0,m.jsx)("div",{className:"h-[180px] w-[180px] border border-grey rounded-full center ",children:(0,m.jsxs)("div",{className:"h-[150px] w-[150px] rounded-full overflow-hidden flex items-center justify-center ".concat(i?"bg-lite_grey":""),children:[i&&(0,m.jsx)(f.TwU,{className:"absolute animate-spin-slow text-grey text-[40px]"}),(0,m.jsx)("img",{src:A||o,id:"previewImg",alt:"profile",className:"object-cover w-full h-full ".concat(i?"opacity-50":""),onError:e=>e.target.src=o})]})})]})}),(0,m.jsx)("div",{className:"flex justify-center"}),(0,m.jsxs)("div",{className:"flex justify-evenly items-center w-full pb-2",children:[(0,m.jsx)("button",{className:"border-2 border-primary bg-[#FFFCD7] rounded-md px-5 py-2",onClick:()=>document.getElementById("fileInput").click(),children:"Change"}),(0,m.jsx)("button",{className:"border-2 border-primary rounded-md px-5 py-2",onClick:()=>{p()},children:"Remove"})]})]})})};var h=A(1580),v=A(3305);var g=A(2759),y=A(8382),N=A(3646),w=A(3482);const j=["profilePhoto"],P=["__typename","createdAt","updatedAt"],b=(0,y.D)(),S=e=>{var t;let{setIsOpen:A,profilePhoto:s,name:i,email:u,contactNo:f,getPPhotoString:y,setPersonalInfo:S,handleAfterUpload:k,loading:F,setLoading:q}=e;const U=(0,n.useRef)(null),E=null===(t=localStorage.getItem("userID"))||void 0===t?void 0:t.toString().toUpperCase(),[B,T]=(0,n.useState)(""),[D,K]=(0,n.useState)(null),[L,R]=(0,n.useState)(!1),[C,Q]=(0,n.useState)(""),V=async(e,t)=>{try{await(0,g.k)("profilePhoto",e,t)}catch(A){console.error("Error deleting file:",A)}},I=(0,n.useCallback)((async()=>{try{q(!0),Q("Removing profile photo...");const e=y.split("/").pop();await V(e,E),T(""),S((e=>{let{profilePhoto:t}=e,A=(0,c.A)(e,j);return(0,a.A)((0,a.A)({},A),{},{profilePhoto:null})})),K(null),await O(null,E)}catch(e){}}),[y]),O=async(e,t)=>{!async function(){const A=await async function(e){let A=[],a=null;const l={and:[{empID:{eq:t||null}}]};do{const t=await b.graphql({query:e,variables:{filter:l,nextToken:a}}),s=t.data[Object.keys(t.data)[0]].items;A=[...A,...s],a=t.data[Object.keys(t.data)[0]].nextToken}while(a);return A}(N.it),l="public/".concat("profilePhoto","/",t,"/").concat(e);!async function(e){try{for(const t of e){const{__typename:e,createdAt:A,updatedAt:a}=t,l=(0,c.A)(t,P),s=(await b.graphql({query:w.CD,variables:{input:l}})).data.updateEmpPersonalInfo;let o=null===s||void 0===s?void 0:s.profilePhoto;const r=null===o||void 0===o?void 0:o.split("/").pop();"null"!==r?await k():"null"===r&&q(!1),Q("null"===r?"Profile photo removed.":r?"Profile photo added.":"Change Profile File")}}catch(t){console.error("Error fetching employee data: ",t)}}(A.map((e=>(0,a.A)((0,a.A)({},e),{},{profilePhoto:l||null}))))}()},G=async(e,t)=>{try{q(!0),Q("Uploading profile photo...");const A=e.target,l=A.files[0];if(!l)return;if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(l.type))return void alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)");l&&R(!0),await V(l.name,E),await(async(e,t,A,l,s)=>{try{if(await(0,h.H)()){const o=(await(0,v.C)({path:"public/".concat(t,"/").concat(l,"/").concat(e.name),data:e}).result).path,r=(new Date).toISOString().split("T")[0];A("number"===typeof s?e=>{const A=(0,a.A)({},e);return A[t]=A[t]||[],A[t][s]=A[t][s]||[],A[t][s].find((e=>e.upload===o))||A[t][s].push({upload:o,date:r}),A}:"profilePhoto"===t||"inducBriefUp"===t||"uploadJobDetails"===t?e=>(0,a.A)((0,a.A)({},e),{},{[t]:o}):e=>(0,a.A)((0,a.A)({},e),{},{[t]:[...e[t]||[],{upload:o,date:r}]}))}}catch(o){}})(l,t,T,E),await O(l.name,E),A.value=""}catch(A){}};return(0,m.jsxs)("section",{children:[(0,m.jsxs)("div",{className:"center flex-col gap-2 py-2",children:[(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsx)("div",{className:"max-w-10 h-10 w-full rounded-full center relative overflow-hidden shadow-md shadow-[#00000033]",children:(0,m.jsx)("img",{className:"w-full object-cover h-full ",src:s||o,alt:"avatar not found",onError:e=>e.target.src=o})}),(0,m.jsx)("input",{type:"file",id:"fileInput",name:"profilePhoto",ref:U,accept:".jpg,.jpeg,.png",onChange:e=>G(e,"profilePhoto"),className:"hidden"}),(0,m.jsx)("p",{className:"absolute -right-2 bottom-0 h-5 w-5 rounded-full bg-[#D9D9D9] center",onClick:()=>{U.current.click()},children:(0,m.jsx)(d.iog,{className:"text-xs text-dark_grey cursor-pointer"})})]}),(0,m.jsx)(r.N_,{to:"/personalInformation",className:"text-xs text-dark_grey",onClick:()=>{A(!1)},children:"Personal Info Edit"}),(0,m.jsx)("div",{className:"h-1 w-full bg-[#AAAAAA]"})]}),(0,m.jsxs)("div",{className:"space-y-2 mb-3 px-4",children:[(0,m.jsxs)("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[(0,m.jsx)("label",{htmlFor:"name",className:"font-medium ",children:"Name"}),(0,m.jsx)("div",{className:"border flex-1 rounded-md border-[#d4cfcf]  px-2 py-1 ",children:(0,m.jsx)("input",{id:"name",className:"outline-none w-full",type:"text",value:i,readOnly:!0})})]}),(0,m.jsxs)("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[(0,m.jsx)("label",{htmlFor:"phoneNo",className:"font-medium ",children:"Phone Number"}),(0,m.jsx)("div",{className:"border rounded-md border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-1 ",children:(0,m.jsx)("input",{id:"phoneNo",className:"outline-none w-full",type:"text",value:f,readOnly:!0})})]}),(0,m.jsxs)("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[(0,m.jsx)("label",{htmlFor:"email",className:"font-medium ",children:"Email"}),(0,m.jsx)("div",{className:"border rounded-md border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-1 ",children:(0,m.jsx)("input",{id:"email",className:"outline-none w-full",type:"text",value:u,readOnly:!0})})]}),(0,m.jsxs)("div",{className:"flex justify-between text-xs text-dark_grey font-semibold pt-3",children:[(0,m.jsx)(r.N_,{to:"/changePassword",className:"py-1 px-2 border-2 rounded-md border-primary ",children:"Change Password"}),(0,m.jsxs)(r.N_,{className:"flex items-center gap-1 py-1 px-2 bg-primary  rounded-md ",onClick:async()=>{try{await(0,p.C)(),localStorage.removeItem("userID"),localStorage.removeItem("userType"),window.location.href="/login"}catch(e){}},children:["Logout",(0,m.jsx)("span",{children:(0,m.jsx)(l.mXW,{className:"text-lg text-dark_grey"})})]})]})]}),L&&(0,m.jsx)(x,{handleProfile:()=>{R(!L)},profilePhoto:s,changeProfilePhoto:B,handleFileUpload:G,PPLastUP:D,setPPLastUP:K,loading:F,message:C,removeProfilePhoto:I})]})};var k=A(8280);const F=(0,y.D)(),q=()=>{const{unreadCount:e}=(0,k.q)();(0,n.useEffect)((()=>{}),[e]);const[t,A]=(0,n.useState)(!1),[a,c]=(0,n.useState)(""),[d,p]=(0,n.useState)(""),[f,x]=(0,n.useState)(""),[h,v]=(0,n.useState)(null),[g,y]=(0,n.useState)(!1),[w,j]=(0,n.useState)(null),[P,b]=(0,n.useState)({profilePhoto:"",name:"",email:"",contactNo:""}),[q,U]=(0,n.useState)(""),E=()=>{A((e=>!e))},B=(0,n.useRef)(null),T=e=>{B.current&&!B.current.contains(e.target)&&A(!1)};(0,n.useEffect)((()=>{const e=localStorage.getItem("userType");return c(e),document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}}),[]),(0,n.useEffect)((()=>{const e=setInterval((()=>{const e=new Date,t=e.getDate(),A=e.getMonth()+1,a=e.getFullYear(),l="".concat(t,"/").concat(A,"/").concat(a);x(l);let s=e.getHours();const o=e.getMinutes(),r=e.getSeconds(),n=s>=12?"PM":"AM";s%=12,s=s||12;const i=o<10?"0"+o:o,c=r<10?"0"+r:r,d="".concat(s,":").concat(i,":").concat(c," ").concat(n),u="".concat(l," ").concat(d);p(u)}),1e3);return()=>clearInterval(e)}),[]);(0,n.useEffect)((()=>{const e=localStorage.getItem("userID");U(e)}),[]);return(0,n.useEffect)((()=>{q&&(async()=>{try{let e=[],t=null;do{const A=await F.graphql({query:N.it,variables:{nextToken:t}});e=[...e,...A.data.listEmpPersonalInfos.items],t=A.data.listEmpPersonalInfos.nextToken}while(t);const A=e;if(0===A.length)return;const a=A.find((e=>e.empID.toString().toLowerCase()===q.toString().toLowerCase()));if(a){let e="null"===(null===a||void 0===a?void 0:a.profilePhoto.split("/").pop())?"User-avatar.svg.png":null===a||void 0===a?void 0:a.profilePhoto;v(e),(async e=>{var t;const A=await(0,u.I)({path:e});j(!1),b({name:null===a||void 0===a?void 0:a.name,profilePhoto:null===A||void 0===A||null===(t=A.url)||void 0===t?void 0:t.toString(),email:null===a||void 0===a?void 0:a.email,contactNo:(null===a||void 0===a?void 0:a.contactNo)||""})})(e)}}catch(e){}})()}),[q,g]),(0,m.jsx)("nav",{className:"center bg-medium_white h-28 fixed top-0 w-full z-50 shadow-sm",children:(0,m.jsxs)("div",{className:"screen-size flex justify-between items-center gap-10 py-7 px-3",children:[(0,m.jsx)("section",{className:"flex-initial",children:(0,m.jsx)("div",{className:"max-w-[250px] w-full",children:(0,m.jsx)("img",{className:"w-full",src:s.A,alt:"not found"})})}),(0,m.jsxs)("section",{className:"flex-initial flex item-center gap-5 ",children:[(0,m.jsx)("div",{className:" my-auto",children:(0,m.jsxs)("p",{className:"relative",children:[(0,m.jsxs)(r.N_,{to:"/notifications",children:[" ",(0,m.jsx)(l.KB1,{className:"text-2xl"})]}),e>0&&(0,m.jsx)("span",{className:"absolute -top-[4px] right-[2px] rounded-full h-2 w-2 text-dark_grey bg-[#d04545] text-xs center",children:" "})]})}),(0,m.jsxs)("div",{className:"flex items-center gap-5 px-5",children:[(0,m.jsxs)("div",{className:"space-y-2 ",children:[(0,m.jsxs)("p",{className:"text-dark_grey text_size_5",children:[" ","Welcome ",P.name]}),(0,m.jsx)("article",{className:"flex gap-5 text_size_7 text-dark_grey",children:(0,m.jsx)("p",{children:d})})]}),(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsx)("div",{className:"w-12 h-12 rounded-full relative center overflow-hidden shadow-md shadow-[#00000033]",onClick:()=>E(),children:(0,m.jsx)("img",{className:"w-full object-center",src:(null===P||void 0===P?void 0:P.profilePhoto)||o,alt:"avatar not found",onError:e=>e.target.src=o})}),(0,m.jsx)("p",{className:"absolute -right-2 bottom-0 h-5 w-5 rounded-full bg-[#D9D9D9] center",onClick:()=>E(),children:(0,m.jsx)(i.i5t,{className:"text-xs text-dark_grey"})})]}),t&&(0,m.jsx)("div",{ref:B,className:"absolute top-12 -left-40 bg-white shadow-md  py-2 text-dark_grey text-[15px]  w-[250px]  flex flex-col",children:(0,m.jsx)(S,{setIsOpen:A,name:null===P||void 0===P?void 0:P.name,email:null===P||void 0===P?void 0:P.email,profilePhoto:null===P||void 0===P?void 0:P.profilePhoto,contactNo:null===P||void 0===P?void 0:P.contactNo,getPPhotoString:h,setPersonalInfo:b,handleAfterUpload:async()=>{y(!g)},loading:w,setLoading:j})})]})]})]})]})})}},2759:(e,t,A)=>{"use strict";A.d(t,{k:()=>l});var a=A(9462);const l=async(e,t,A)=>{if(!t)return alert("File name is missing. Please select a valid file to delete."),console.error("Missing fileName. Received parameters:",{fileType:e,empID:A,fileName:t}),!1;try{const l="public/".concat(e,"/").concat(A,"/").concat(t);return await(0,a.T)({path:l,bucket:"aweadininstorage20242a2fe-dev"}),!0}catch(l){return console.error("Error deleting file:",l),alert("Error processing the file deletion."),!1}}},4598:e=>{"use strict";e.exports="data:image/jpeg;base64,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"},7843:()=>{},841:()=>{},1660:()=>{},9212:()=>{},1668:()=>{},180:()=>{},5755:()=>{},2993:()=>{},4698:()=>{},670:()=>{},7926:()=>{}}]);
//# sourceMappingURL=29.26ab8b8e.chunk.js.map