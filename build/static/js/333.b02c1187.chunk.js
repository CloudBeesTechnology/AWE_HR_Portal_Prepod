"use strict";(self.webpackChunkcheckingproject=self.webpackChunkcheckingproject||[]).push([[333],{2333:(e,t,a)=>{a.r(t),a.d(t,{default:()=>J});var l=a(9379),o=a(423),s=a(7305),n=a(4598),r=a(2250),c=a(5043),i=a(6833),d=a(5394),u=a(432),m=a(3986),p=a(2926),x=a(6720),f=a(8490),h=a(2600),g=(a(180),a(1668),a(8714)),v=a(9431),y=a(287),j=a(1839),w=a(5614),N=a(3827),b=a(727),P=a(7161),k=a(9784),I=(a(2993),a(5755),a(5735)),S=a(5734),A=a(8403),D=a(9806);const C=(0,P.A)(k.o,((e,t)=>{const a=new b.o(t.url.toString());(0,S.Nt)(!!e.Key,"Key"),a.pathname=(0,S.DB)(a,e.Key),(0,A.L)({bucketName:e.Bucket,key:e.Key,objectURL:a});return{method:"DELETE",headers:(0,S.Sl)({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),url:a}}),(async e=>{if(e.statusCode>=300){const t=await(0,D.VY)(e);throw(0,I.Pu)(t,e.statusCode)}{const t=(0,I.Tj)(e.headers,{DeleteMarker:["x-amz-delete-marker",I.OI],VersionId:"x-amz-version-id",RequestCharged:"x-amz-request-charged"});return(0,l.A)((0,l.A)({},t),{},{$metadata:(0,N.j)(e)})}}),(0,l.A)((0,l.A)({},D.sb),{},{responseType:"text"}));var F=a(2969);function E(e){return(async(e,t)=>{var a,o;const{s3Config:s,keyPrefix:n,bucket:r,identityId:c}=await(0,g.a)(e,t),{inputType:i,objectKey:d}=(0,j.d)(t,c);let u;return(0,y.L)(null===(a=t.options)||void 0===a?void 0:a.expectedBucketOwner),i===w.nf?(u="".concat(n).concat(d),v.v.debug('remove "'.concat(d,'" from "').concat(u,'".'))):(u=d,v.v.debug('removing object in path "'.concat(u,'"'))),await C((0,l.A)((0,l.A)({},s),{},{userAgentValue:(0,F.B)(h.sZ.Remove)}),{Bucket:r,Key:u,ExpectedBucketOwner:null===(o=t.options)||void 0===o?void 0:o.expectedBucketOwner}),i===w.nf?{key:d}:{path:d}})(f.H,e)}var _=a(8382),O=a(3646);var q=a(3482),B=a(1580),T=a(3305);var z=a(579);const L=["profilePhoto"],K=["__typename","createdAt","updatedAt"],M=e=>{let{handleProfile:t,profilePhoto:a,getPPhotoString:o,setPersonalInfo:s}=e;const r=(0,_.D)(),[i,d]=(0,c.useState)(""),[u,f]=(0,c.useState)(null),[h,g]=(0,c.useState)(null),[v,y]=(0,c.useState)(!1),[j,w]=(0,c.useState)(!1),N=localStorage.getItem("userID").toString().toUpperCase(),b=async(e,t)=>{if(!N)return;const a=e.target.files[0];if(!a)return;["application/pdf","image/jpeg","image/png","image/jpg"].includes(a.type)?(g(a.name),await(async(e,t,a,o,s)=>{try{if(await(0,B.H)()){const n=(await(0,T.C)({path:"public/".concat(t,"/").concat(o,"/").concat(e.name),data:e}).result).path,r=(new Date).toISOString().split("T")[0];a("number"===typeof s?e=>{const a=(0,l.A)({},e);return a[t]=a[t]||[],a[t][s]=a[t][s]||[],a[t][s].find((e=>e.upload===n))||a[t][s].push({upload:n,date:r}),a}:"profilePhoto"===t||"inducBriefUp"===t||"uploadJobDetails"===t?e=>(0,l.A)((0,l.A)({},e),{},{[t]:n}):e=>(0,l.A)((0,l.A)({},e),{},{[t]:[...e[t]||[],{upload:n,date:r}]}))}}catch(n){}})(a,t,d,N)):alert("Upload must be a PDF file or an image (JPG, JPEG, PNG)")};(0,c.useEffect)((()=>{if(null!==i&&void 0!==i&&i.profilePhoto){(async e=>{var t;const a=await(0,p.I)({path:e});f(null===a||void 0===a||null===(t=a.url)||void 0===t?void 0:t.toString()),y(!1),w(!0)})(i.profilePhoto)}}),[i]),(0,c.useEffect)((()=>{if(o){const e=o.split("/").pop();String(e)===String(null)?(y(!0),w(!1)):w(!0),g(e)}}),[o]);const P=()=>{!async function(){const e=await async function(e){let t=[],a=null;const l={and:[{empID:{eq:N||null}}]};do{const o=await r.graphql({query:e,variables:{filter:l,nextToken:a}}),s=o.data[Object.keys(o.data)[0]].items;t=[...t,...s],a=o.data[Object.keys(o.data)[0]].nextToken}while(a);return t}(O.it),t="public/".concat("profilePhoto","/",N,"/").concat(h);!async function(e){try{for(const t of e){const{__typename:e,createdAt:a,updatedAt:l}=t,o=(0,m.A)(t,K);(await r.graphql({query:q.CD,variables:{input:o}})).data.updateEmpPersonalInfo,window.location.reload()}}catch(t){console.error("Error fetching employee data: ",t)}}(e.map((e=>(0,l.A)((0,l.A)({},e),{},{profilePhoto:t||null}))))}()};return(0,z.jsx)("section",{className:"fixed top-0 left-0 center w-full h-full z-50 bg-grey bg-opacity-15 inset-0",children:(0,z.jsxs)("div",{className:"bg-white max-w-md w-full max-h-72 h-full rounded-md center flex-col shadow-xl p-5 gap-5",children:[(0,z.jsx)("button",{className:"absolute top-4 right-5",onClick:t,children:(0,z.jsx)(x.qiG,{size:30,className:"text-dark_grey"})}),(0,z.jsx)("div",{className:"center",children:(0,z.jsxs)("div",{className:"py-2 center flex-col max-w-[160px]",children:[(0,z.jsx)("input",{type:"file",id:"fileInput",name:"profilePhoto",accept:".jpg,.jpeg,.png",onChange:e=>b(e,"profilePhoto"),className:"hidden"}),(0,z.jsx)("div",{className:"h-[180px] w-[180px] border border-grey rounded-full center",children:(0,z.jsx)("div",{className:"h-[150px] w-[150px] rounded-full overflow-hidden bg-lite_skyBlue",children:(0,z.jsx)("img",{src:u||(i||a||n),id:"previewImg",alt:"profile",className:"object-cover w-full h-full",onError:e=>e.target.src=n})})})]})}),(0,z.jsxs)("div",{className:"flex justify-evenly items-center w-full",children:[v&&(0,z.jsx)("button",{className:"border-2 border-primary bg-[#FFFCD7] rounded-md px-5 py-2",onClick:()=>document.getElementById("fileInput").click(),children:"Change"}),(0,z.jsx)("button",{className:"border-2 border-primary bg-[#FFFCD7] rounded-md px-5 py-2",onClick:()=>{P()},children:"Save"}),j&&(0,z.jsx)("button",{className:"border-2 border-primary rounded-md px-5 py-2",onClick:async()=>{if(h)try{await(async(e,t,a,o,s,n,r,c)=>{const i=(0,_.D)();if(a){if(!t)return alert("File name is missing. Please select a valid file to delete."),void console.error("Missing fileName. Received parameters:",{fileType:e,empID:a,fileName:t});try{const r="".concat(e,"/").concat(a,"/").concat(t);await E({path:"public/".concat(r),bucket:"aweadininstorage20242a2fe-dev"}),o((a=>{const o=(0,l.A)({},a);var s;return Array.isArray(o[e])?(o[e]=o[e].filter((e=>e!==t)),0===(null===(s=o[e])||void 0===s?void 0:s.length)&&delete o[e]):o[e]===t&&delete o[e],o}));const d=(await i.graphql({query:O.G8,variables:{id:s}})).data.getIDDetails,u=JSON.parse(d[e]).filter((e=>!e.upload||!e.upload.includes(t)));return n(e,u),c(e),!0}catch(d){}}else alert("Please provide the Employee ID before deleting files.")})("profilePhoto",h,N),f(null),d(""),g(null),s((e=>{let{profilePhoto:t}=e,a=(0,m.A)(e,L);return(0,l.A)((0,l.A)({},a),{},{profilePhoto:null})})),y(!0),w(!1)}catch(e){console.error("Error deleting file:",e)}},children:"Remove"})]})]})})},R=e=>{let{setIsOpen:t,profilePhoto:a,name:l,email:s,contactNo:n,getPPhotoString:i,setPersonalInfo:m}=e;const[p,x]=(0,c.useState)(!1),f=()=>{x(!p)};return(0,z.jsxs)("section",{children:[(0,z.jsxs)("div",{className:"center flex-col gap-2 py-2",children:[(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsx)("div",{className:"max-w-10 h-10 w-full rounded-full center relative overflow-hidden shadow-md shadow-[#00000033]",children:(0,z.jsx)("img",{className:"w-full object-cover h-full ",src:a,alt:"avatar not found"})}),(0,z.jsx)("p",{className:"absolute -right-2 bottom-0 h-5 w-5 rounded-full bg-[#D9D9D9] center",onClick:f,children:(0,z.jsx)(d.iog,{className:"text-xs text-dark_grey cursor-pointer"})})]}),(0,z.jsx)(r.N_,{to:"/personalInformation",className:"text-xs text-dark_grey",onClick:()=>{t(!1)},children:"Personal Info Edit"}),(0,z.jsx)("div",{className:"h-1 w-full bg-[#AAAAAA]"})]}),(0,z.jsxs)("div",{className:"space-y-2 mb-3 px-4",children:[(0,z.jsxs)("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[(0,z.jsx)("label",{htmlFor:"name",className:"font-medium ",children:"Name"}),(0,z.jsx)("div",{className:"border flex-1 rounded-md border-[#d4cfcf]  px-2 py-1 ",children:(0,z.jsx)("input",{id:"name",className:"outline-none w-full",type:"text",value:l,readOnly:!0})})]}),(0,z.jsxs)("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[(0,z.jsx)("label",{htmlFor:"phoneNo",className:"font-medium ",children:"Phone Number"}),(0,z.jsx)("div",{className:"border rounded-md border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-1 ",children:(0,z.jsx)("input",{id:"phoneNo",className:"outline-none w-full",type:"text",value:n,readOnly:!0})})]}),(0,z.jsxs)("div",{className:" space-y-1 text-[#4F4F4F] text-xs",children:[(0,z.jsx)("label",{htmlFor:"email",className:"font-medium ",children:"Email"}),(0,z.jsx)("div",{className:"border rounded-md border-[#d4cfcf] text-[#4F4F4F] text-xs px-2 py-1 ",children:(0,z.jsx)("input",{id:"email",className:"outline-none w-full",type:"text",value:s,readOnly:!0})})]}),(0,z.jsxs)("div",{className:"flex justify-between text-xs text-dark_grey font-semibold pt-3",children:[(0,z.jsx)(r.N_,{to:"/changePassword",className:"py-1 px-2 border-2 rounded-md border-primary ",children:"Change Password"}),(0,z.jsxs)(r.N_,{className:"flex items-center gap-1 py-1 px-2 bg-primary  rounded-md ",onClick:async()=>{try{await(0,u.C)(),localStorage.removeItem("userID"),localStorage.removeItem("userType"),window.location.href="/login"}catch(e){}},children:["Logout",(0,z.jsx)("span",{children:(0,z.jsx)(o.mXW,{className:"text-lg text-dark_grey"})})]})]})]}),p&&(0,z.jsx)(M,{handleProfile:f,profilePhoto:a,getPPhotoString:i,setPersonalInfo:m})]})};var G=a(5318);const U=(0,_.D)(),J=()=>{const{unreadCount:e}=(0,G.q)();(0,c.useEffect)((()=>{}),[e]);const[t,a]=(0,c.useState)(!1),[l,d]=(0,c.useState)(""),[u,m]=(0,c.useState)(""),[x,f]=(0,c.useState)(""),[h,g]=(0,c.useState)(null),[v,y]=(0,c.useState)({profilePhoto:"",name:"",email:"",contactNo:""}),[j,w]=(0,c.useState)(""),N=()=>{a((e=>!e))},b=(0,c.useRef)(null),P=e=>{b.current&&!b.current.contains(e.target)&&a(!1)};(0,c.useEffect)((()=>{const e=localStorage.getItem("userType");return d(e),document.addEventListener("mousedown",P),()=>{document.removeEventListener("mousedown",P)}}),[]),(0,c.useEffect)((()=>{const e=setInterval((()=>{const e=new Date,t=e.getDate(),a=e.getMonth()+1,l=e.getFullYear(),o="".concat(t,"/").concat(a,"/").concat(l);f(o);let s=e.getHours();const n=e.getMinutes(),r=e.getSeconds(),c=s>=12?"PM":"AM";s%=12,s=s||12;const i=n<10?"0"+n:n,d=r<10?"0"+r:r,u="".concat(s,":").concat(i,":").concat(d," ").concat(c),p="".concat(o," ").concat(u);m(p)}),1e3);return()=>clearInterval(e)}),[]);return(0,c.useEffect)((()=>{const e=localStorage.getItem("userID");w(e)}),[]),(0,c.useEffect)((()=>{j&&(async()=>{try{let e=[],t=null;do{const a=await U.graphql({query:O.it,variables:{nextToken:t}});e=[...e,...a.data.listEmpPersonalInfos.items],t=a.data.listEmpPersonalInfos.nextToken}while(t);const a=e;if(0===a.length)return;const l=a.find((e=>e.empID.toString().toLowerCase()===j.toString().toLowerCase()));if(l){const e=(null===l||void 0===l?void 0:l.profilePhoto)||"public/profilePhoto/User-avatar.svg.png";g(e),(async e=>{var t;const a=await(0,p.I)({path:e});y({name:null===l||void 0===l?void 0:l.name,profilePhoto:null===a||void 0===a||null===(t=a.url)||void 0===t?void 0:t.toString(),email:null===l||void 0===l?void 0:l.email,contactNo:(null===l||void 0===l?void 0:l.contactNo)||""})})(e)}else console.log("No matching employee found for userID: ".concat(j))}catch(e){console.log("Error fetching employee personal infos:",e)}})()}),[j,h]),(0,z.jsx)("nav",{className:"center bg-medium_white h-28 fixed top-0 w-full z-50 shadow-sm",children:(0,z.jsxs)("div",{className:"screen-size flex justify-between items-center gap-10 py-7 px-3",children:[(0,z.jsx)("section",{className:"flex-initial",children:(0,z.jsx)("div",{className:"max-w-[250px] w-full",children:(0,z.jsx)("img",{className:"w-full",src:s.A,alt:"not found"})})}),(0,z.jsxs)("section",{className:"flex-initial flex item-center gap-5 ",children:[(0,z.jsx)("div",{className:" my-auto",children:(0,z.jsxs)("p",{className:"relative",children:[(0,z.jsxs)(r.N_,{to:"/notifications",children:[" ",(0,z.jsx)(o.KB1,{className:"text-2xl"})]}),e>0&&(0,z.jsx)("span",{className:"absolute -top-[4px] right-[2px] rounded-full h-2 w-2 text-dark_grey bg-[#d04545] text-xs center",children:" "})]})}),(0,z.jsxs)("div",{className:"flex items-center gap-5 px-5",children:[(0,z.jsxs)("div",{className:"space-y-2 ",children:[(0,z.jsxs)("p",{className:"text-dark_grey text_size_5",children:[" ","Welcome ",v.name]}),(0,z.jsx)("article",{className:"flex gap-5 text_size_7 text-dark_grey",children:(0,z.jsx)("p",{children:u})})]}),(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsx)("div",{className:"w-12 h-12 rounded-full relative center overflow-hidden shadow-md shadow-[#00000033]",onClick:()=>N(),children:(0,z.jsx)("img",{className:"w-full object-center",src:(null===v||void 0===v?void 0:v.profilePhoto)||n,alt:"avatar not found"})}),(0,z.jsx)("p",{className:"absolute -right-2 bottom-0 h-5 w-5 rounded-full bg-[#D9D9D9] center",onClick:()=>N(),children:(0,z.jsx)(i.i5t,{className:"text-xs text-dark_grey"})})]}),t&&(0,z.jsx)("div",{ref:b,className:"absolute top-12 -left-40 bg-white shadow-md  py-2 text-dark_grey text-[15px]  w-[250px]  flex flex-col",children:(0,z.jsx)(R,{setIsOpen:a,name:null===v||void 0===v?void 0:v.name,email:null===v||void 0===v?void 0:v.email,profilePhoto:null===v||void 0===v?void 0:v.profilePhoto,contactNo:null===v||void 0===v?void 0:v.contactNo,getPPhotoString:h,setPersonalInfo:y})})]})]})]})]})})}}}]);
//# sourceMappingURL=333.b02c1187.chunk.js.map